"use strict";(self.webpackChunkever_wading_birds=self.webpackChunkever_wading_birds||[]).push([[64798,79538],{23708:(t,e,i)=>{i.d(e,{A:()=>d});var s=i(93800),o=i(48602),a=(i(21265),i(50925),i(14746),i(75269)),n=i(78076),r=i(76713),l=i(82368);let u=class extends r.A{constructor(t){super(t),this.arcadeEditType="NA",this.editableExpressionExecutor=null}get editable(){return!!this.layerAllowsEdits&&(this.evaluatedEditableExpression??!0)}get evaluatedEditableExpression(){const{editableExpressionExecutor:t}=this;return null!=t?!!t.lastEvaluatedValue:null}get layerAllowsEdits(){const{layer:t}=this;if(!t)return!1;const e=(0,n.BR)(t),i=e?.operations.supportsEditing,s=(0,l.of)(e,this.arcadeEditType);return!(!i||!s)}};(0,s._)([(0,o.MZ)()],u.prototype,"arcadeEditType",void 0),(0,s._)([(0,o.MZ)()],u.prototype,"editable",null),(0,s._)([(0,o.MZ)()],u.prototype,"editableExpressionExecutor",void 0),(0,s._)([(0,o.MZ)()],u.prototype,"evaluatedEditableExpression",null),(0,s._)([(0,o.MZ)()],u.prototype,"layerAllowsEdits",null),u=(0,s._)([(0,a.$)("esri.widgets.FeatureForm.EditableInput")],u);const d=u},73585:(t,e,i)=>{i.r(e),i.d(e,{default:()=>g});var s=i(93800),o=i(93633),a=i(49959),n=i(79953),r=i(48602),l=(i(21265),i(50925),i(14746),i(75269)),u=i(15492),d=i(92471),p=i(23708),c=i(81558),y=i(39652);let h=class extends(o.A.IdentifiableMixin(p.A)){constructor(t){super(t),this.group=null,this.type="utilityNetworkAssociations",this.featureItem=null,this._updatingHandlesSetUp=new u.U,this.addHandles([(0,n.watch)((()=>({feature:this.feature,element:this.element,layer:this.layer})),(t=>this._createAssociationVM(t)),n.initial),(0,n.watch)((()=>this.feature),(()=>this._setFeatureItem())),(0,n.watch)((()=>this.associatedLayer),((t,e)=>this._updateLayerEditHandle(t,e)),n.initial)])}destroy(){this._associationsVM?.destroy(),this._updatingHandlesSetUp.destroy()}get activeAssociationType(){return this._associationsVM?.activeAssociationType}get associatedFeatures(){const{associatedLayer:t}=this;if(t)return this.associatedFeatureInfos.get(t)}get associatedFeatureInfos(){const{_associationsVM:t}=this;if(!t?.associationFeatures?.size||!t?.utilityNetwork)return new Map;const{associationFeatures:e}=t,i=new Map;return e.forEach(((t,e)=>{const s=t.map((t=>{if(null==t.title){const e=(0,y.R)(t.feature);return{...t,title:e}}return t}));i.set(e,s)})),i}get associatedLayer(){return this._get("associatedLayer")}set associatedLayer(t){this._associationsVM.showAllEnabled=null!=t,this._set("associatedLayer",t)}get associationsViewModel(){return this._associationsVM}get canAddAssociation(){const{editable:t,utilityNetwork:e}=this;return!(!e||!this.loaded)&&t}get editable(){return this.evaluatedEditableExpression??!0}get featureCount(){return this._associationsVM?.featureCount??0}get viewModel(){return this._associationsVM}get loaded(){return"loading"!==this._associationsVM?.state&&!this._updatingHandlesSetUp.updating}get map(){return this._get("map")}set map(t){t&&this._associationsVM?.set("map",t),this._set("map",t)}get utilityNetwork(){return this._associationsVM?.utilityNetwork}get associationTypes(){return this._associationsVM?.associationTypes??this.element.associationTypes}get visible(){const{utilityNetwork:t}=this;return!!t&&(null!=this.evaluatedVisibilityExpression?this.evaluatedVisibilityExpression:null!=this.element)}get updating(){return"loading"===this._associationsVM?.state||"querying"===this._associationsVM?.state}async refresh(){await(0,a.ignoreAbortErrors)(this._associationsVM.refresh())}_updateLayerEditHandle(t,e){e&&"layerId"in e&&this.removeHandles(e?.layerId),(0,d.isAssociatedFeatureSupportedLayer)(t)&&this.addHandles((0,n.on)((()=>t),"edits",(()=>this.refresh())),t.layerId)}_createAssociationVM(t){const{feature:e,element:i,layer:s}=t;if(this._associationsVM?.destroy(),!e||!i||!s)return;const{map:o,associationTypes:a}=this;(0,d.isAssociatedFeatureSupportedLayer)(s)&&(this._associationsVM=new c.A({graphic:e,layer:s,map:o,associationTypes:a,source:"featureForm",title:this.label,description:this.description}))}_setFeatureItem(){this._updatingHandlesSetUp.addPromise((async()=>{const{feature:t,layer:e}=this;t&&e&&"getFeatureTitle"in e&&(this.featureItem={feature:t,label:await e.getFeatureTitle(t)})})())}};(0,s._)([(0,r.MZ)()],h.prototype,"_associationsVM",void 0),(0,s._)([(0,r.MZ)()],h.prototype,"activeAssociationType",null),(0,s._)([(0,r.MZ)()],h.prototype,"associatedFeatures",null),(0,s._)([(0,r.MZ)()],h.prototype,"associatedFeatureInfos",null),(0,s._)([(0,r.MZ)()],h.prototype,"associatedLayer",null),(0,s._)([(0,r.MZ)()],h.prototype,"associationsViewModel",null),(0,s._)([(0,r.MZ)()],h.prototype,"canAddAssociation",null),(0,s._)([(0,r.MZ)()],h.prototype,"editable",null),(0,s._)([(0,r.MZ)()],h.prototype,"featureCount",null),(0,s._)([(0,r.MZ)()],h.prototype,"viewModel",null),(0,s._)([(0,r.MZ)()],h.prototype,"group",void 0),(0,s._)([(0,r.MZ)()],h.prototype,"loaded",null),(0,s._)([(0,r.MZ)()],h.prototype,"map",null),(0,s._)([(0,r.MZ)()],h.prototype,"utilityNetwork",null),(0,s._)([(0,r.MZ)()],h.prototype,"associationTypes",null),(0,s._)([(0,r.MZ)({readOnly:!0})],h.prototype,"type",void 0),(0,s._)([(0,r.MZ)()],h.prototype,"visible",null),(0,s._)([(0,r.MZ)()],h.prototype,"updating",null),(0,s._)([(0,r.MZ)()],h.prototype,"featureItem",void 0),h=(0,s._)([(0,l.$)("esri.widgets.FeatureForm.UtilityNetworkAssociationInput")],h);const g=h},76713:(t,e,i)=>{i.d(e,{A:()=>u});var s=i(93800),o=i(6946),a=i(48602),n=(i(21265),i(50925),i(14746),i(75269)),r=i(41327);let l=class extends o.default{constructor(t){super(t),this.element=null,this.feature=null,this.layer=null,this.timeZone=null,this.type=null,this.visibilityExpressionExecutor=null}get description(){return this.getFormattedLabel(this.element?.description)}get evaluatedVisibilityExpression(){const{visibilityExpressionExecutor:t}=this;return null!=t?!!t.lastEvaluatedValue:null}get label(){return this.getFormattedLabel(this.element?.label)}get updating(){return!1}get visible(){return null!=this.evaluatedVisibilityExpression?this.evaluatedVisibilityExpression:null!=this.element}getFormattedLabel(t){const{feature:e,layer:i,timeZone:s}=this;return null==i||null==t?t:(0,r.LZ)({label:t,attributes:e.attributes,fieldsIndex:i.fieldsIndex,timeZone:s})}};(0,s._)([(0,a.MZ)({readOnly:!0})],l.prototype,"description",null),(0,s._)([(0,a.MZ)({constructOnly:!0})],l.prototype,"element",void 0),(0,s._)([(0,a.MZ)()],l.prototype,"evaluatedVisibilityExpression",null),(0,s._)([(0,a.MZ)()],l.prototype,"feature",void 0),(0,s._)([(0,a.MZ)()],l.prototype,"label",null),(0,s._)([(0,a.MZ)()],l.prototype,"layer",void 0),(0,s._)([(0,a.MZ)()],l.prototype,"timeZone",void 0),(0,s._)([(0,a.MZ)()],l.prototype,"type",void 0),(0,s._)([(0,a.MZ)()],l.prototype,"updating",null),(0,s._)([(0,a.MZ)()],l.prototype,"visible",null),(0,s._)([(0,a.MZ)()],l.prototype,"visibilityExpressionExecutor",void 0),l=(0,s._)([(0,n.$)("esri.widgets.FeatureForm.InputBase")],l);const u=l},79538:(t,e,i)=>{i.d(e,{BV:()=>F,EG:()=>M,Lk:()=>w,Ll:()=>V,Np:()=>d,R3:()=>T,SO:()=>h,T1:()=>x,UH:()=>u,Wy:()=>v,XR:()=>y,aM:()=>E,fs:()=>_,i0:()=>A,i3:()=>m});var s=i(66845),o=i(95011),a=i(96247),n=i(76983),r=i(73210),l=i(40731);const u=",",d={light:["streets","gray","topo","terrain","oceans","osm","gray-vector","streets-vector","topo-vector","streets-relief-vector","streets-navigation-vector","topo-3d","navigation-3d","streets-3d","osm-3d","gray-3d"],dark:["satellite","hybrid","dark-gray","dark-gray-vector","streets-night-vector","navigation-dark-3d","streets-dark-3d","dark-gray-3d"]},p="percent-of-total",c="field",y={exclude:["median"]},h={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864e5},g=new Set(["integer","small-integer"]);let f=null;const m=["date","date-only","timestamp-offset"];function _(t){return(0,o.isDateField)(t)||(0,o.isDateOnlyField)(t)||(0,o.isTimestampOffsetField)(t)}async function M(t){const{field:e,field2:i,field3:s,normalizationField:o,valueExpression:n}=t;let r=[];if(n){if(!f){const{arcadeUtils:t}=await(0,a.lw)();f=t}r=f.extractFieldNames(n)}return e&&r.push(e),i&&r.push(i),s&&r.push(s),o&&r.push(o),r}function v(t){let e=t.normalizationType;return e||(t.normalizationField?e=c:null!=t.normalizationTotal&&(e=p)),e??void 0}function Z(t){return String(t).padStart(2,"0")}function b(t,e,i){let s;return"date"===e||"number"===e?("number"===e&&(t=new Date(t)),s=`TIMESTAMP'${i?t.getFullYear():t.getUTCFullYear()}-${Z((i?t.getMonth():t.getUTCMonth())+1)}-${Z(i?t.getDate():t.getUTCDate())} ${Z(i?t.getHours():t.getUTCHours())}:${Z(i?t.getMinutes():t.getUTCMinutes())}:${Z(i?t.getSeconds():t.getUTCSeconds())}'`):s=t,s}function E(t,e,i,s){const{hasQueryEngine:o}=t,a=`(${b(i,w(t,i),o)} - ${b(e,w(t,e),o)})`;let n=h[s],r="/";return n<1&&(n=1/n,r="*"),{sqlExpression:1===n?a:`(${a} ${r} ${n})`,sqlWhere:null}}function w(t,e){if(e instanceof Date)return"date";if("number"==typeof e)return"number";if("string"==typeof e){const i=t.getField(e);if("<now>"===e.toLowerCase())return;if((0,o.isDateField)(i))return"field"}}function F(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d;for(const i in e)if(e[i].includes(t))return i}function x(t,e){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=null;return t&&("string"==typeof t?e.includes(t)&&(s=t):s=(0,n.q3)(t)),i?s||"gray":s}function T(t,e){const i=e&&t.getField(e);return!!i&&g.has(i.type)}function V(t){return`cast(${t} as float)`}function A(t,e){const{format:i,timeZoneOptions:o,fieldType:a}=e??{};let n,u;if(o&&({timeZone:n,timeZoneName:u}=(0,l.hv)(o.layerTimeZone,o.datesInUnknownTimezone,o.viewTimeZone,(0,s.J2)(i||"short-date-short-time"),a)),"string"==typeof t&&isNaN(Date.parse("time-only"===a?`1970-01-01T${t}Z`:t)))return t;switch(a){case"date-only":{const e=(0,s.J2)(i||"short-date");return"string"==typeof t?(0,s.iS)(t,{...e}):(0,s.Yq)(t,{...e,timeZone:r.n$})}case"time-only":{const e=(0,s.J2)(i||"short-time");return"string"==typeof t?(0,s.F8)(t,e):(0,s.Yq)(t,{...e,timeZone:r.n$})}case"timestamp-offset":{if(!n&&"string"==typeof t&&new Date(t).toISOString()!==t)return t;const e=i||o?(0,s.J2)(i||"short-date-short-time"):void 0,a=e?{...e,timeZone:n,timeZoneName:u}:void 0;return"string"==typeof t?(0,s.Ey)(t,a):(0,s.Yq)(t,a)}default:{const e=i||o?(0,s.J2)(i||"short-date-short-time"):void 0;return(0,s.Yq)("string"==typeof t?new Date(t):t,e?{...e,timeZone:n,timeZoneName:u}:void 0)}}}}}]);