"use strict";(self.webpackChunkever_wading_birds=self.webpackChunkever_wading_birds||[]).push([[3395,50778,74458,87627],{3395:(t,e,o)=>{o.r(e),o.d(e,{default:()=>p});var i=o(93800),s=o(6946),a=o(48602),l=(o(21265),o(50925),o(14746),o(75269)),r=o(93321);let n=class extends s.default{constructor(t){super(t),this.extent=null,this.extraParameters=null,this.outSpatialReference=null,this.template=null,this.updateDelay=1e3,this.view=null}};(0,i._)([(0,a.MZ)()],n.prototype,"extent",void 0),(0,i._)([(0,a.MZ)()],n.prototype,"extraParameters",void 0),(0,i._)([(0,a.MZ)({type:r.default})],n.prototype,"outSpatialReference",void 0),(0,i._)([(0,a.MZ)()],n.prototype,"template",void 0),(0,i._)([(0,a.MZ)()],n.prototype,"updateDelay",void 0),(0,i._)([(0,a.MZ)()],n.prototype,"view",void 0),n=(0,i._)([(0,l.$)("esri.rest.support.PrintParameters")],n);const p=n},23414:(t,e,o)=>{o.d(e,{u:()=>r});var i=o(74719),s=o(94685),a=o(4401),l=o(12037);async function r(t,e,o){if(!t)throw new i.default("print:invalid-layout-info-task-url","Can't fetch layout template info",{url:t});if("async"===await(0,s.getMode)(t)){const i=await(0,l.O)(t,e,void 0,o||void 0);return await i.waitForJobCompletion(),(await i.fetchResultData("Output_JSON")).value}return(await(0,a.g)(t,e,null,o)).results[0].value}},50778:(t,e,o)=>{o.r(e),o.d(e,{default:()=>V});var i=o(93800),s=o(23060),a=o(62631),l=o(89129),r=o(74719),n=o(42761),p=o(82301),d=o(81933),u=o(49959),h=o(90450),y=o(79953),m=o(16804),c=o(84190),f=o(48602),v=(o(21265),o(50925),o(75269)),_=o(12560),T=o(93321),w=o(66845),g=o(12711),b=o(78139),I=o(94252),O=o(88272),M=o(94685),k=o(36627),x=o(66374),Z=o(3395),S=o(53829),E=o(5077),C=o(51232),L=o(6946),P=(o(14746),o(17745),o(87118));let U=class extends L.default{constructor(t){super(t),this.strokeDash=[],this.strokeWidth=2,this.strokeColor=[0,0,0,1],this.strokeBackgroundColor=[0,0,0,0],this.fillColor=[0,0,0,0],this.backgroundFillColor=[0,0,0,.5],this.visible=!0,this.isDecoration=!1,this.boxWidth=0,this.boxHeight=0,this.backgroundWidth=0,this.backgroundHeight=0,this.padding={left:0,top:0,right:0,bottom:0}}get _strokeStyle(){return`rgba(${this.strokeColor.join()})`}get _strokeBackgroundStyle(){return`rgba(${this.strokeBackgroundColor.join()})`}get _fillStyle(){return`rgba(${this.fillColor.join()})`}get _backgroundFillStyle(){return`rgba(${this.backgroundFillColor.join()})`}render(){const{backgroundWidth:t,backgroundHeight:e,boxWidth:o,boxHeight:i,padding:s}=this,a=s.left,l=s.top,r=this.x??a+t/2-o/2,n=this.y??l+e/2-i/2,p=r+o,d=n+i;return(0,P.K)("div",{classes:{"esri-box-overlay-item":!0},styles:{left:"0px",top:"0px",width:"100%",height:"100%",visibility:this.visible?"visible":"hidden"}},(0,P.K)("svg",{styles:{width:"100%",height:"100%"}},(0,P.K)("path",{d:`M ${a} ${l} L ${t+a} ${l} L ${t+a} ${e+l} L ${a} ${e+l} Z M ${r} ${n} L ${r} ${d} L ${p} ${d} L ${p} ${n} Z`,fill:this._backgroundFillStyle,stroke:this._strokeBackgroundStyle,"stroke-width":this.strokeWidth}),(0,P.K)("rect",{fill:this._fillStyle,height:i,stroke:this._strokeStyle,"stroke-dasharray":this.strokeDash.join(" ")||void 0,"stroke-width":this.strokeWidth,width:o,x:r,y:n})))}renderCanvas(){}};(0,i._)([(0,f.MZ)()],U.prototype,"strokeDash",void 0),(0,i._)([(0,f.MZ)()],U.prototype,"strokeWidth",void 0),(0,i._)([(0,f.MZ)()],U.prototype,"strokeColor",void 0),(0,i._)([(0,f.MZ)()],U.prototype,"strokeBackgroundColor",void 0),(0,i._)([(0,f.MZ)()],U.prototype,"fillColor",void 0),(0,i._)([(0,f.MZ)()],U.prototype,"backgroundFillColor",void 0),(0,i._)([(0,f.MZ)()],U.prototype,"visible",void 0),(0,i._)([(0,f.MZ)()],U.prototype,"isDecoration",void 0),(0,i._)([(0,f.MZ)()],U.prototype,"boxWidth",void 0),(0,i._)([(0,f.MZ)()],U.prototype,"boxHeight",void 0),(0,i._)([(0,f.MZ)()],U.prototype,"backgroundWidth",void 0),(0,i._)([(0,f.MZ)()],U.prototype,"backgroundHeight",void 0),(0,i._)([(0,f.MZ)()],U.prototype,"x",void 0),(0,i._)([(0,f.MZ)()],U.prototype,"y",void 0),(0,i._)([(0,f.MZ)()],U.prototype,"padding",void 0),(0,i._)([(0,f.MZ)({readOnly:!0})],U.prototype,"_strokeStyle",null),(0,i._)([(0,f.MZ)({readOnly:!0})],U.prototype,"_strokeBackgroundStyle",null),(0,i._)([(0,f.MZ)({readOnly:!0})],U.prototype,"_fillStyle",null),(0,i._)([(0,f.MZ)({readOnly:!0})],U.prototype,"_backgroundFillStyle",null),U=(0,i._)([(0,v.$)("esri.views.overlay.BoxOverlayItem")],U);const A=U;var $=o(74458),H=o(87627),B=o(23414);const D=[30,144,255,255],F=[237,211,23,255],W=[216,48,32,255],j=new Set(["GISProfessionalStdUT","GISProfessionalAdvUT"]),R=/(\/GPServer\/).+/i,J=new n.J({inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers"}),N=l.default.ofType($.default);function G(t,e,o){e&&e.visible!==o&&t.layoutOptions&&(t.layoutOptions.elementOverrides?t.layoutOptions.elementOverrides[e.name]={visible:o}:t.layoutOptions.elementOverrides={[e.name]:{visible:o}})}let z=class extends d.A{constructor(t){super(t),this._serviceTemplateCustomTextElements=null,this._templateIdToCustomTemplate=new h.A,this._isFreeHand=!1,this._freeHandWidth=0,this._freehandHeight=0,this._asyncPrintTaskUrl=null,this._layoutInfoTaskUrl=null,this._customLayoutOptions=null,this.allowedFormats="all",this.allowedLayouts="all",this.browseTemplates=new N,this.defaultTemplates=new N,this.error=null,this.extraParameters=null,this.includeDefaultTemplates=!0,this.outSpatialReference=null,this.portal=b.default.getDefault(),this.portalTemplateIds=[],this.printServiceTemplates=new N,this.defaultTemplate=null,this.showPrintAreaEnabled=!1,this.printServiceUrl=null,this.printTimeout=12e4,this.templatesInfo=null,this.updateDelay=1e3,this.view=null,this.templateCustomTextElements=null,this.templateOptions=new H.default}initialize(){this.addHandles([(0,y.watch)((()=>[this.showPrintAreaEnabled,this.view]),(()=>{this.showPrintAreaEnabled?this._enablePrintPreview():(this.removeHandles("overlay-handler"),this.view?.overlay?.removeItem(this._getOverlayItem()))})),(0,y.watch)((()=>[this.templateOptions.layout,this.templateOptions.layoutItem]),(()=>{this.loaded&&this._processTemplateOptions()}))])}destroy(){this.removeHandles("overlay-handler"),this.view&&(this._overlayItem&&(this.view.overlay?.removeItem(this._overlayItem),this._overlayItem.destroy(),this._overlayItem=null),this.view=null)}get effectivePrintServiceUrl(){return this.printServiceUrl??null}get effectiveTemplateCustomTextElements(){if(!this._serviceTemplateCustomTextElements)return{};const t=(0,p.clone)(this._serviceTemplateCustomTextElements);return this.templateCustomTextElements&&Object.keys(this.templateCustomTextElements).forEach((e=>{const o=t[e];if(o){const t=this.templateCustomTextElements?.[e];o.forEach((e=>{const[o]=Object.entries(e)[0];t?.forEach((t=>{const[i,s]=Object.entries(t)[0];o===i&&(e[o]=s)}))}))}})),Object.freeze(t)}get state(){return"loading"===this.loadStatus?"initializing":"failed"===this.loadStatus||this.error?"error":"loaded"===this.loadStatus&&this.view?.ready?"ready":"disabled"}async load(t){return this.addResolvingPromise(this._loadResources(t).catch((t=>this.error=t))),this}async print(t){const{view:e,extraParameters:o,updateDelay:i,outSpatialReference:s}=this;if(!e)throw new r.default("print:view-required","view is not set");!function(t){if(t.layoutOptions??={},t.layoutOptions.customTextElements??=[],!t.layoutOptions.customTextElements.find((t=>"date"in t))){const{customTextElements:e}=t.layoutOptions;let o=(0,w.Yq)(Date.now(),(0,w.J2)("short-date"));"ar"===(0,g.Z0)()&&(o="\u200f"+o),e.push({date:o})}}(t);const a=this._getOverlayItem(),l=t.scalePreserved||!this.showPrintAreaEnabled?void 0:(0,E.Z7)(new _.default,e.viewpoint,"map-only"===t.layout?[t.exportOptions.width,t.exportOptions.height]:[a.boxWidth,a.boxHeight]),n=new Z.default({view:e,template:t,extent:l,extraParameters:o,updateDelay:i,outSpatialReference:s});try{const e=!!t.layoutItem?.id&&(this.portalTemplateIds.includes(t.layoutItem.id)||this.browseTemplates.some((e=>e.layoutItem?.id===t.layoutItem?.id)));return await(0,M.execute)(e&&this._asyncPrintTaskUrl?this._asyncPrintTaskUrl:this.effectivePrintServiceUrl,n,{timeout:this.printTimeout})}catch(p){throw new r.default("print:export-error","An error occurred while exporting the web map.",{error:p})}}toPrintTemplate(t){let{attributionEnabled:e,author:o,copyright:i,customTextElements:s,dpi:a,forceFeatureAttributes:l,format:n,height:p,id:d,includeTables:u,layout:h,layoutItem:y,legendEnabled:m,northArrowEnabled:c,scale:f,scaleBarEnabled:v,scaleEnabled:_,title:T,width:w}=t;if(!h&&!y)throw new r.default("print:layout-required","layout is not set");const g=new S.default({attributionVisible:e,forceFeatureAttributes:l,format:n,includeTables:u,layout:h,layoutItem:y,layoutOptions:{authorText:o||"",copyrightText:i||"",customTextElements:s,titleText:T||""},outScale:f??0,scalePreserved:_});if(w&&(g.exportOptions.width=w),p&&(g.exportOptions.height=p),a&&(g.exportOptions.dpi=a),g.layoutOptions){m||(g.layoutOptions.legendLayers=[]);const t=this.getLayoutTemplateById(d)?.mapSurroundInfoOptions;if(t){const e=t.northArrow;for(const t of e)G(g,t,c);const o=t.scaleBar;for(const t of o)G(g,t,v);const i=t.legend;for(const t of i)G(g,t,m)}}return g}getLayoutTemplateById(t){return t?this._templateIdToCustomTemplate.get(t):null}async addPortalTemplate(t){if(!this.portal||!t?.id)return;try{t.loaded||await t.load()}catch{return void this.applyTemplate(this.defaultTemplate)}const e=new $.default({type:"browse-template",layoutInfoTaskUrl:this._layoutInfoTaskUrl,label:t.title,layoutItem:t});this._templateIdToCustomTemplate.set(e.id,e),this.browseTemplates.add(e)}removePortalTemplate(t){t.layoutItem&&this.templateOptions.id===t.layoutItem.id&&(this.defaultTemplate?this.applyTemplate(this.defaultTemplate):this.templateOptions.reset()),this.browseTemplates.remove(t),this._templateIdToCustomTemplate.delete(t.id)}async applyTemplate(t){if(!t)return void this.templateOptions.reset();!t.layout||!this.templatesInfo||this.templatesInfo.layout.choiceList.includes(t.layout)||(this.defaultTemplate?t=this.defaultTemplate:this.templateOptions.reset());const e=t.layout||t.layoutItem?.id,o=e?this.templateCustomTextElements?.[e]:void 0;if(await this.templateOptions.applyTemplate(t,{customTextElements:o,customLayoutOptions:this._customLayoutOptions}),e&&this._serviceTemplateCustomTextElements&&!this._serviceTemplateCustomTextElements[e]&&t.layoutTemplateInfo?.layoutOptions?.customTextElements){const o=(0,p.clone)(this._serviceTemplateCustomTextElements);o[e]=t.layoutTemplateInfo.layoutOptions.customTextElements,this._serviceTemplateCustomTextElements=Object.freeze(o)}}async _loadResources(t){if(this.destroyed)return;await this._loadUrls(t);const[e,o]=await Promise.all([this._getLayoutToLayoutTemplateInfos(t),this._getPrintServiceTemplatesInfo(t)]);await this._loadAllTemplates(e,o,t),this._processPrintServiceTemplatesInfo(o),await this._processTemplateOptions(),this._updateOverLayItem()}async _processTemplateOptions(){const{layout:t,layoutItem:e}=this.templateOptions;if("map-only"!==t&&!this.templateOptions.id)if(this._customLayoutOptions={legend:this.templateOptions.legendEnabled,northArrow:this.templateOptions.northArrowEnabled,scaleBar:this.templateOptions.scaleBarEnabled},e?.id){try{e.loaded||await e.load()}catch{return void this.applyTemplate(this.defaultTemplate)}let t=this._templateIdToCustomTemplate.get(e.id);t||(t=new $.default({label:e.title,layoutItem:e,layoutInfoTaskUrl:this._layoutInfoTaskUrl}),this._templateIdToCustomTemplate.set(t.id,t)),await this.applyTemplate(t)}else if(t){const t=this.defaultTemplates.find((t=>t.layout===this.templateOptions.layout))??this.printServiceTemplates.find((t=>t.layout===this.templateOptions.layout));await this.applyTemplate(t??this.defaultTemplate)}}async _loadPortal(t){try{await this.portal.load(t)}catch(e){throw new r.default("print:could-not-load-portal","Cannot load print resource information from portal",{error:e,url:this.effectivePrintServiceUrl})}}async _loadUrls(t){if(this.printServiceUrl)this._set("effectivePrintServiceUrl",this.printServiceUrl),await this._updateLayoutInfoTaskUrl(this.effectivePrintServiceUrl);else{await this._loadPortal(t);const{printTask:e,asyncPrintTask:o,layoutInfoTask:i}=this.portal?.helperServices??{};this._set("effectivePrintServiceUrl",e?.url),this._asyncPrintTaskUrl=o?.url,await this._updateLayoutInfoTaskUrl(i?.url||this.effectivePrintServiceUrl)}const e=this.effectivePrintServiceUrl?.toLowerCase().split("/");if(!e?.includes("gpserver"))throw new r.default("print:invalid-print-service-url","Can't fetch print templates information from provided URL",{url:this.effectivePrintServiceUrl})}async _updateLayoutInfoTaskUrl(t,e){if(!t)return;const o=(await(0,M.getTasks)(t,e)).find((t=>t.includes("Get Layout Templates Info")));o&&(this._layoutInfoTaskUrl=t.replace(R,`$1${encodeURI(o)}`))}_getPortalDefaultTemplates(t,e){return this.portal?.helperServices?.printTask?.templates?.filter((t=>"map_only"!==t.layout.toLowerCase()&&(!e||e.includes((0,x.r)(t.layout)))))?.map((e=>{const o=$.default.fromJSON(e);if(o.type="default-template",o.layoutInfoTaskUrl=this._layoutInfoTaskUrl,o.layout){const e=t.get(o.layout);e&&o.setLayoutTemplateInfo(e)}return o}))??[]}async _getPortalCustomTemplates(t){if(this.printServiceUrl||!this.portal)return[];const{layoutGroupQuery:e,user:o}=this.portal,i=O.oQ.test(this.portal.url),s=o?.userLicenseTypeId,a=s&&j.has(s);if(!e||i&&!a)return[];const l=new I.default({query:e,disableExtraQuery:!0}),r=await this.portal.queryGroups(l,t);if(!r.total)return[];const n=r.results[0],p=new I.default({num:100,query:"type:Layout",sortField:n.sortField,sortOrder:n.sortOrder??void 0}),d=(await n.queryItems(p,t)).results;return d.length?d.map((t=>(this.portalTemplateIds.push(t.id),new $.default({type:"default-template",label:t.title,layoutItem:t,layoutInfoTaskUrl:this._layoutInfoTaskUrl})))):[]}async _loadAllTemplates(t,e,o){let i=!1;const s=e?.layout?.choiceList;if(this.includeDefaultTemplates&&this.portal&&!this.printServiceUrl){const e=this._getPortalDefaultTemplates(t,s);i=!!e.length,this.defaultTemplates.addMany(e);const a=await this._getPortalCustomTemplates(o);this.defaultTemplates.addMany(a);for(const t of this.defaultTemplates)this._templateIdToCustomTemplate.set(t.id,t)}i||t.forEach(((t,e)=>{if(!s||s.includes(e)){const o=new $.default({type:"print-service-template",layout:e,layoutInfoTaskUrl:this._layoutInfoTaskUrl});o.setLayoutTemplateInfo(t),this.printServiceTemplates.add(o),this._templateIdToCustomTemplate.set(o.id,o)}}))}_processPrintServiceTemplatesInfo(t){this._set("templatesInfo",t);const e=t?.layout?.defaultValue;if(e&&"map-only"!==e){const t=this.defaultTemplates.find((t=>t.layout===e))??this.printServiceTemplates.find((t=>t.layout===e))??this.defaultTemplates.at(0)??this.printServiceTemplates.at(0);this._set("defaultTemplate",t)}}async _getLayoutToLayoutTemplateInfos(t){const e=await(0,B.u)(this._layoutInfoTaskUrl,void 0,t),o=new Map,i={};for(const s of e){const t=(0,x.r)(s.layoutTemplate);o.set(t,s),i[t]=s.layoutOptions.customTextElements}return this._serviceTemplateCustomTextElements=Object.freeze(i),o}async _getPrintServiceTemplatesInfo(t){let e;try{({data:e}=await(0,s.default)(this.effectivePrintServiceUrl,{...t,query:{f:"json"},timeout:this.printTimeout}))}catch(A){throw(0,u.isAbortError)(A)?A:new r.default("print:unavailable-service-info","Can't fetch templates info from service",{error:A})}const{parameters:o}=e,i=o.find((t=>{let{name:e}=t;return"Format"===e})),a=o.find((t=>{let{name:e}=t;return"Layout_Template"===e}));return{format:this._getFormat(i),layout:this._getLayout(a)}}_getFormat(t){const e="all"===this.allowedFormats?t.choiceList:t.choiceList.filter((t=>"string"!=typeof this.allowedFormats&&this.allowedFormats.some((e=>new RegExp(`\\b${e}\\b`,"i").test(t))))),o=(e.length?e:t.choiceList).map((t=>k.U.fromJSON(t))).filter(a.Ru),i=k.U.fromJSON(t.defaultValue),s=o.some((t=>new RegExp(`\\b${i}\\b`,"i").test(t)))?i:o[0];return{choiceList:o,defaultValue:s}}_getLayout(t){const e=t.choiceList.filter((t=>"map_only"!==t.toLowerCase())),o="all"===this.allowedLayouts?e:e.filter((t=>this.allowedLayouts.includes((0,x.r)(t)))),i=(o.length?o:e).map(x.r).filter(a.Ru),s=(0,x.r)(t.defaultValue),l=i.includes(s)?s:i.find((t=>/(?=.*letter)(?=.*landscape)/i.test(t)))??i.find((t=>/(?=.*a4)(?=.*landscape)/i.test(t)))??i[0];return{choiceList:i,defaultValue:l}}_getOverlayItem(){return this._overlayItem||(this._overlayItem=new A({strokeDash:[5],strokeWidth:2,strokeColor:[30,144,255,255]})),this._overlayItem}_enablePrintPreview(){if(!this.view?.overlay)return;const t=this.templateOptions,e=this._getOverlayItem();this.addHandles([(0,y.watch)((()=>[t.width,t.height,t.scaleEnabled,t.scale,t.layout,t.layoutItem,t.id,t.state,this.view?.scale,this.view?.size,this.view?.state.paddedViewState.size,this.view?.state.padding,this.loaded]),(()=>this._updateOverLayItem()),y.initial),this.view?.on("drag",["Shift"],(t=>this._handleDrag(t)),C.o.WIDGET),this.view?.on("key-down",["Escape"],(()=>this._resetDrag()),C.o.WIDGET)],"overlay-handler"),this.view.overlay.addItem(e)}_updateOverLayItem(){if(!this.view)return;const t=this.templateOptions,e=this._getOverlayItem(),o=t.layoutItem?.id??t.layout,i=this.view,s=i.spatialReference,[a,l]=i.state.paddedViewState.size,r=i.state.padding;let n=0,p=0;if("map-only"===o)null!=t.width&&null!=t.height&&(n=t.width,p=t.height);else if(o){const e=t.id?this._templateIdToCustomTemplate.get(t.id):null,{webMapFrameSize:o,pageUnits:i}=e?.layoutTemplateInfo??{};let r=!1;if(o&&i)if(this._isFreeHand){const t=o[0]/o[1];n=this._freeHandWidth,p=this._freehandHeight,n>p?p=n/t:n=p*t}else{const t=J.fromJSON(i.toLowerCase()),e=s.unit;(0,c.t$)(t)===(0,c.t$)(e)?(n=(0,c.oU)(o[0],t,e),p=(0,c.oU)(o[1],t,e)):(r=!0,n=o[0],p=o[1])}if(!this._isFreeHand)if(t.scaleEnabled&&t.scale){const e=r?Math.min(a/n,l/p):(0,c.GA)(s)*c.dy*t.dpi;n*=e,p*=e}else if(0===n||0===p)n=a,p=l;else{const t=(a-.1*a)/n,e=(l-.1*l)/p,o=Math.min(t,e);n*=o,p*=o}}const{scaleEnabled:d,scale:u}=t,h=d&&u?u/this.view.scale:1;if(e.boxWidth=n*h||a,e.boxHeight=p*h||l,r&&(e.padding=r),e.backgroundWidth=a??0,e.backgroundHeight=l??0,"loading"===this.loadStatus)e.strokeColor=F;else if("loaded"===this.loadStatus)switch(this.templateOptions.state){case"pending":e.strokeColor=F;break;case"ready":e.strokeColor=D;break;case"error":e.strokeColor=W}}_resetDrag(){this._isFreeHand=!1,this._updateOverLayItem()}_handleDrag(t){switch(t.action){case"start":this._start();break;case"update":this._update(t);break;case"end":this._end()}t.stopPropagation()}_start(){this._isFreeHand=!0}_update(t){const e=this._getOverlayItem(),{x:o,y:i}=t,{x:s,y:a}=t.origin;o>s?(e.x=s,e.boxWidth=o-s):(e.x=o,e.boxWidth=s-o),i>a?(e.y=a,e.boxHeight=i-a):(e.y=i,e.boxHeight=a-i)}_end(){const t=this._getOverlayItem();if(!this.view||null==t.x||null==t.y)return;const e=this.view,o=e.toMap((0,m.tc)(t.x+.5*t.boxWidth,t.y+.5*t.boxHeight));t.x=null,t.y=null,e.goTo({center:o}),this._freeHandWidth=t.boxWidth,this._freehandHeight=t.boxHeight,"map-only"===this.templateOptions.layout&&(this.templateOptions.width=this._freeHandWidth,this.templateOptions.height=this._freehandHeight),this.templateOptions.scale=this.view.scale,this._updateOverLayItem()}};(0,i._)([(0,f.MZ)()],z.prototype,"_serviceTemplateCustomTextElements",void 0),(0,i._)([(0,f.MZ)()],z.prototype,"_templateIdToCustomTemplate",void 0),(0,i._)([(0,f.MZ)()],z.prototype,"allowedFormats",void 0),(0,i._)([(0,f.MZ)()],z.prototype,"allowedLayouts",void 0),(0,i._)([(0,f.MZ)({type:N})],z.prototype,"browseTemplates",void 0),(0,i._)([(0,f.MZ)({type:N})],z.prototype,"defaultTemplates",void 0),(0,i._)([(0,f.MZ)()],z.prototype,"error",void 0),(0,i._)([(0,f.MZ)()],z.prototype,"extraParameters",void 0),(0,i._)([(0,f.MZ)()],z.prototype,"includeDefaultTemplates",void 0),(0,i._)([(0,f.MZ)({readOnly:!0})],z.prototype,"effectivePrintServiceUrl",null),(0,i._)([(0,f.MZ)()],z.prototype,"effectiveTemplateCustomTextElements",null),(0,i._)([(0,f.MZ)({type:T.default})],z.prototype,"outSpatialReference",void 0),(0,i._)([(0,f.MZ)({type:b.default})],z.prototype,"portal",void 0),(0,i._)([(0,f.MZ)()],z.prototype,"portalTemplateIds",void 0),(0,i._)([(0,f.MZ)({type:N})],z.prototype,"printServiceTemplates",void 0),(0,i._)([(0,f.MZ)({readOnly:!0})],z.prototype,"defaultTemplate",void 0),(0,i._)([(0,f.MZ)()],z.prototype,"showPrintAreaEnabled",void 0),(0,i._)([(0,f.MZ)()],z.prototype,"printServiceUrl",void 0),(0,i._)([(0,f.MZ)()],z.prototype,"printTimeout",void 0),(0,i._)([(0,f.MZ)({readOnly:!0})],z.prototype,"state",null),(0,i._)([(0,f.MZ)({readOnly:!0})],z.prototype,"templatesInfo",void 0),(0,i._)([(0,f.MZ)()],z.prototype,"updateDelay",void 0),(0,i._)([(0,f.MZ)()],z.prototype,"view",void 0),(0,i._)([(0,f.MZ)()],z.prototype,"templateCustomTextElements",void 0),(0,i._)([(0,f.MZ)({type:H.default})],z.prototype,"templateOptions",void 0),z=(0,i._)([(0,v.$)("esri.widgets.Print.PrintViewModel")],z);const V=z},74458:(t,e,o)=>{o.r(e),o.d(e,{default:()=>v});var i=o(93800),s=o(13248),a=o(74719),l=o(19455),r=o(99521),n=o(49959),p=o(48602),d=(o(21265),o(50925),o(14746),o(47332)),u=o(75269),h=o(34587),y=o(36627),m=o(66374),c=o(23414);let f=class extends l.A{constructor(t){super(t),this.description=null,this.format=null,this.state="not-loaded",this.label=null,this.layoutInfoTaskUrl=null,this.layout=null,this.layoutItem=null,this.layoutOptions=null,this.layoutTemplateInfo=null,this.type=null}get id(){return this.layoutItem?.id??`${this.layout}-${(0,r.d)(JSON.stringify(this.toJSON()))}`}get mapSurroundInfoOptions(){const t=this.layoutTemplateInfo?.layoutOptions?.mapSurroundInfos;if(!t)return null;const e={northArrow:[],scaleBar:[],legend:[]};for(const o of t)switch(o.type){case"CIMMarkerNorthArrow":e.northArrow.push(o);break;case"CIMScaleLine":e.scaleBar.push(o);break;case"CIMGroupElement":o.elements?.some((t=>"CIMScaleLine"===t.type))&&e.scaleBar.push(o);break;case"CIMLegend":e.legend.push(o)}return e}_updateLayoutOptions(t){const e=this.layoutOptions?.legend??t.layoutOptions?.hasLegend,o=this.layoutOptions?.northArrow??(this.mapSurroundInfoOptions?.northArrow.length?this.mapSurroundInfoOptions?.northArrow.some((t=>{let{visible:e}=t;return e})):void 0),i=this.layoutOptions?.scaleBar??(this.mapSurroundInfoOptions?.scaleBar.length?this.mapSurroundInfoOptions?.scaleBar.some((t=>{let{visible:e}=t;return e})):void 0);this._set("layoutOptions",{legend:e,northArrow:o,scaleBar:i})}async fetchLayoutItemTemplateInfo(t){const{layoutItem:e}=this;if(e?.id&&!this.layoutTemplateInfo&&"loaded"!==this.state)try{this._set("state","loading");const o=this.layoutInfoTaskUrl;if(!o)throw new a.default("print:invalid-layout-info-task-url","Can't fetch layout template info",{url:o});"public"!==e.access&&s.id&&await s.id.getCredential(o);const i={Layout_Item_ID:JSON.stringify({id:e.id})},l=(await(0,c.u)(o,i,t))[0];this.setLayoutTemplateInfo(l)}catch(o){this._set("state",(0,n.isAbortError)(o)?"not-loaded":"error")}}setLayoutTemplateInfo(t){this._set("layoutTemplateInfo",t),this._updateLayoutOptions(t),this._set("state","loaded")}};(0,i._)([(0,p.MZ)({json:{write:!0}})],f.prototype,"description",void 0),(0,i._)([(0,d.e)(y.U)],f.prototype,"format",void 0),(0,i._)([(0,p.MZ)({readOnly:!0})],f.prototype,"id",null),(0,i._)([(0,p.MZ)({readOnly:!0})],f.prototype,"state",void 0),(0,i._)([(0,p.MZ)({json:{write:!0}})],f.prototype,"label",void 0),(0,i._)([(0,p.MZ)()],f.prototype,"layoutInfoTaskUrl",void 0),(0,i._)([(0,p.MZ)({json:{read:m.r,write:!0}})],f.prototype,"layout",void 0),(0,i._)([(0,p.MZ)({type:h.default,json:{write:!0}})],f.prototype,"layoutItem",void 0),(0,i._)([(0,p.MZ)({readOnly:!0,json:{write:!0}})],f.prototype,"layoutOptions",void 0),(0,i._)([(0,p.MZ)({readOnly:!0})],f.prototype,"layoutTemplateInfo",void 0),(0,i._)([(0,p.MZ)({readOnly:!0})],f.prototype,"mapSurroundInfoOptions",null),(0,i._)([(0,p.MZ)()],f.prototype,"type",void 0),f=(0,i._)([(0,u.$)("esri.widgets.Print.CustomTemplate")],f);const v=f},87627:(t,e,o)=>{o.r(e),o.d(e,{default:()=>d});var i=o(93800),s=o(6946),a=o(82301),l=o(48602),r=(o(21265),o(50925),o(75269)),n=o(34587);let p=class extends s.default{constructor(t){super(t),this._abortController=null,this.attributionEnabled=!0,this.author=null,this.copyright=null,this.customTextElements=null,this.dpi=96,this.fileName=null,this.forceFeatureAttributes=!1,this.format="pdf",this.height=null,this.includeTables=!0,this.id=null,this.state="ready",this.layout="letter-ansi-a-landscape",this.layoutItem=null,this.legendEnabled=void 0,this.northArrowEnabled=void 0,this.scale=null,this.scaleBarEnabled=void 0,this.scaleEnabled=!1,this.title=null,this.width=null}async applyTemplate(t,e){if(t?.id===this.id&&"error"!==t?.state)return;if(this._abortController&&(this._abortController.abort(),this._abortController=null),!t)return;if(this._set("state","pending"),this._resetMapSurroundInfoOptions(),this._set("id",t.id),this.set({layout:t.layout,layoutItem:t.layoutItem}),!t.layoutOptions&&t.layoutItem){const e=new AbortController;if(this._abortController=e,await t.fetchLayoutItemTemplateInfo({signal:this._abortController.signal}),"loaded"!==t.state){if("error"===t.state&&this._set("state","error"),this._abortController!==e)return;return void(this._abortController=null)}this._abortController=null}const o=e?.customLayoutOptions,i=e?.customTextElements??t.layoutTemplateInfo?.layoutOptions?.customTextElements??this.customTextElements;this.set({customTextElements:i?(0,a.clone)(i):void 0,format:this.format??t.format,legendEnabled:o?.legend??t.layoutOptions?.legend??this.legendEnabled,northArrowEnabled:o?.northArrow??t.layoutOptions?.northArrow??this.northArrowEnabled,scaleBarEnabled:o?.scaleBar??t.layoutOptions?.scaleBar??this.scaleBarEnabled}),this._set("state","ready")}reset(){this._set("id",null),this._set("state","ready"),this.set({layout:null,layoutItem:null,customTextElements:null}),this._resetMapSurroundInfoOptions()}_resetMapSurroundInfoOptions(){this.set({legendEnabled:void 0,northArrowEnabled:void 0,scaleBarEnabled:void 0})}};(0,i._)([(0,l.MZ)()],p.prototype,"attributionEnabled",void 0),(0,i._)([(0,l.MZ)()],p.prototype,"author",void 0),(0,i._)([(0,l.MZ)()],p.prototype,"copyright",void 0),(0,i._)([(0,l.MZ)()],p.prototype,"customTextElements",void 0),(0,i._)([(0,l.MZ)()],p.prototype,"dpi",void 0),(0,i._)([(0,l.MZ)()],p.prototype,"fileName",void 0),(0,i._)([(0,l.MZ)()],p.prototype,"forceFeatureAttributes",void 0),(0,i._)([(0,l.MZ)()],p.prototype,"format",void 0),(0,i._)([(0,l.MZ)()],p.prototype,"height",void 0),(0,i._)([(0,l.MZ)()],p.prototype,"includeTables",void 0),(0,i._)([(0,l.MZ)({readOnly:!0})],p.prototype,"id",void 0),(0,i._)([(0,l.MZ)({readOnly:!0})],p.prototype,"state",void 0),(0,i._)([(0,l.MZ)()],p.prototype,"layout",void 0),(0,i._)([(0,l.MZ)({type:n.default})],p.prototype,"layoutItem",void 0),(0,i._)([(0,l.MZ)()],p.prototype,"legendEnabled",void 0),(0,i._)([(0,l.MZ)()],p.prototype,"northArrowEnabled",void 0),(0,i._)([(0,l.MZ)()],p.prototype,"scale",void 0),(0,i._)([(0,l.MZ)()],p.prototype,"scaleBarEnabled",void 0),(0,i._)([(0,l.MZ)()],p.prototype,"scaleEnabled",void 0),(0,i._)([(0,l.MZ)()],p.prototype,"title",void 0),(0,i._)([(0,l.MZ)()],p.prototype,"width",void 0),p=(0,i._)([(0,r.$)("esri.widgets.Print.TemplateOptions")],p);const d=p}}]);