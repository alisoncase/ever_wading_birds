"use strict";(self.webpackChunkever_wading_birds=self.webpackChunkever_wading_birds||[]).push([[66809],{43943:(n,e,t)=>{t.r(e),t.d(e,{fieldNamesFromFieldInfos:()=>p,getArcadeForOrderedFields:()=>$,getArcadeForPredominanceMargin:()=>h,getArcadeForPredominantCategory:()=>f,getArcadeForPredominantCategoryAlias:()=>m,getArcadeForPredominantCategoryValue:()=>d,getArcadeForStrengthOfPredominance:()=>v,getArcadeForSumOfFields:()=>g,getPredominanceExpressions:()=>u,getSQLForPredominantCategoryName:()=>i,noDominantCategoryField:()=>a});var l=t(79538);const a="no_dominant_category";function r(n){return`(${n.map((n=>`${n} >= 0`)).join(" OR ")})`}function i(n){return{expression:o(n,{returnFieldName:!0,defaultValue:`'${a}'`})}}function o(n,e){const{returnFieldName:t,defaultValue:a,layer:r}=e,i=[];if(t&&a){const e=n.map((n=>`${n} <= 0`)).join(" AND ");i.push(`WHEN ${e} THEN ${a}`)}for(const o of n){const e=n.reduce(((n,e)=>(o!==e&&n.push(`${o} > ${e}`),n)),[]).join(" AND "),a=r&&(0,l.R3)(r,o),u=t&&`'${o}'`?`'${o}'`:a?(0,l.Ll)(o):o;i.push(`WHEN ${e} THEN ${u}`)}return`CASE ${i.join(" ")} ELSE ${a||"0"} END`}function u(n,e){const t=e.join(" + "),l={sqlExpression:`(${t})`,sqlWhere:r(e)},a={sqlExpression:`(( (${o(e,{layer:n})}) / (${t}) ) * 100)`,sqlWhere:`${r(e)} AND ((${t}) > 0)`};return{predominantCategory:{valueExpression:f(e)},size:{valueExpression:g(e),statisticsQuery:l,histogramQuery:l},opacity:{valueExpression:v(e),statisticsQuery:a,histogramQuery:a}}}function s(n){return n&&n.map((n=>`$feature["${n}"];`)).join("\n")+"\n"||""}function c(n){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const t=n.map((n=>`"${n}"`));return`\n  var fieldNames = [ ${t.join(", ")} ];\n  var numFields = ${t.length};\n  var maxValueField = null;\n  var maxValue = -Infinity;\n  var value, i, totalValue = null;\n\n  for(i = 0; i < numFields; i++) {\n    value = $feature[fieldNames[i]];\n\n    if(value > 0) {\n      if(value > maxValue) {\n        maxValue = value;\n        maxValueField = fieldNames[i];\n      }\n      else if (value == maxValue) {\n        maxValueField = null;\n      }\n    }\n    ${e?"\n  if(value != null && value >= 0) {\n    if (totalValue == null) { totalValue = 0; }\n    totalValue = totalValue + value;\n  }\n  ":""}\n  }\n  `}function f(n){const e=c(n);return`\n  ${s(n)}\n  ${e}\n  return maxValueField;\n  `}function d(n){const e=c(n);return`\n  ${s(n)}\n  ${e}\n  return maxValue;\n  `}function m(n,e){const t=p(n),l=s(t),a=n.map((n=>n.label?`"${n.label}"`:`"${n.fieldName}"`)),r=t.map((n=>`Number($feature["${n}"])`)),i=[];return e&&e.forEach(((n,e)=>{i.push(`function getValueForExpr${e}() {\n  ${n.expression} \n}`),r.push(`Number(getValueForExpr${e}())`),a.push(`"${n.title||n.name}"`)})),`\n  ${l}\n\n  ${i.length?i.join("\n"):""}\n\n  var values = [ ${r.join(", ")} ];\n  var aliases = [ ${a.join(", ")} ];\n  var numValues = ${r.length};\n  var maxValueAlias = null;\n  var maxValue = -Infinity;\n  var value, i, totalValue = null;\n\n  for(i = 0; i < numValues; i++) {\n    value = values[i];\n\n    if(value > 0) {\n      if(value > maxValue) {\n        maxValue = value;\n        maxValueAlias = aliases[i];\n      }\n      else if (value == maxValue) {\n        maxValueAlias = "Tie";\n      }\n    }\n  }\n  return maxValueAlias;\n  `}function p(n){return n.filter((n=>{let{fieldName:e}=n;return!!e})).map((n=>n.fieldName))}function h(n){return`\n  ${s(n)}\n  var fieldValues = [ ${n.map((n=>`$feature["${n}"]`)).join(", ")} ];\n  var totalValue = Sum(fieldValues);\n  var order = Reverse(Sort(fieldValues));\n  return IIF(totalValue > 0, Round(((order[0] - order[1]) / totalValue) * 100, 2), null);\n  `}function g(n){const e=s(n),t=n.map((n=>`"${n}"`));return`\n  ${e}\n  var fieldNames = [ ${t.join(", ")} ];\n  var numFields = ${t.length};\n  var value, i, totalValue = null;\n\n  for(i = 0; i < numFields; i++) {\n    value = $feature[fieldNames[i]];\n\n    if(value != null && value >= 0) {\n      if (totalValue == null) { totalValue = 0; }\n      totalValue = totalValue + value;\n    }\n  }\n\n  return totalValue;\n  `}function v(n){const e=c(n,!0);return`\n  ${s(n)}\n  ${e}\n\n  var strength = null;\n\n  if (maxValueField != null && totalValue > 0) {\n    strength = (maxValue / totalValue) * 100;\n  }\n\n  return strength;\n  `}function $(n,e){const t=s(p(n)),l=n.map((n=>`{\n    value: Number($feature["${n.fieldName}"]),\n    alias: "${n.label||n.fieldName}"\n    }`)),a=[];return e&&e.forEach(((n,e)=>{a.push(`function getValueForExpr${e}() {\n  ${n.expression} \n}`),l.push(`{\n          value: Number(getValueForExpr${e}()),\n          alias: "${n.title||n.name}"\n          }`)})),`\n  ${t}\n\n  ${a.length?a.join("\n"):""}\n\n  var groups = [ ${l.join(", ")} ];\n  var numTopValues = Count(groups);\n\n  function getValuesArray(arr){\n    var valuesArray = []\n    for(var i in arr){\n      valuesArray[i] = arr[i].value;\n    }\n    return valuesArray;\n  }\n\n  function findAliases(top5Array, fullArray){\n    var aliases = [];\n    var found = "";\n    for(var i in top5Array){\n      for(var k in fullArray){\n        if(top5Array[i] == fullArray[k].value && Find(fullArray[k].alias, found) == -1){\n          found += fullArray[k].alias;\n          aliases[Count(aliases)] = {\n            alias: fullArray[k].alias,\n            value: top5Array[i]\n          };\n        }\n      }\n    }\n    return aliases;\n  }\n\n  function getTopGroups(groupsArray){\n    var values = getValuesArray(groupsArray);\n    var top5Values = IIF(Max(values) > 0, Top(Reverse(Sort(values)),numTopValues), "no data");\n    var top5Aliases = findAliases(top5Values,groupsArray);\n\n    if(TypeOf(top5Values) == "String"){\n      return top5Values;\n    } else {\n      var content = "";\n      for(var i in top5Aliases){\n        if(top5Aliases[i].value > 0){\n          content += (i+1) + ". " + top5Aliases[i].alias + " (" + Text(top5Aliases[i].value, "#,###") + ")";\n          content += IIF(i < numTopValues-1, TextFormatting.NewLine, "");\n        }\n      }\n    }\n\n    return content;\n  }\n\n  getTopGroups(groups);\n  `}},66809:(n,e,t)=>{t.d(e,{Co:()=>R,I$:()=>F,KY:()=>v,Qm:()=>y,Rm:()=>C,Zw:()=>N,aG:()=>T,aI:()=>q,a_:()=>x,iN:()=>O,iX:()=>w,o6:()=>S,qI:()=>j,sQ:()=>$,tM:()=>V,uw:()=>z,w1:()=>L,xK:()=>D});var l=t(62631),a=t(49959),r=t(89406),i=(t(21265),t(3266)),o=(t(30542),t(19090),t(49445),t(50616)),u=t(95011),s=t(97975),c=t(43943),f=t(70934),d=t(79538),m=t(68584);const p=/_value$/i,h=Math.LOG10E,g={SECOND:1e3,MINUTE:6e4,HOUR:36e5},v=10;function $(n){return n.map((n=>n.toJSON()))}function y(n,e){const t=[],l=n.layer,a="featureReduction"in l?l.featureReduction:null,r="binning"===a?.type,i=null!=a&&"fields"in a?a.fields?.map((n=>n.name?.toLowerCase())).filter(Boolean):[];if(!r||!e)return t;for(const o of e)i.includes(o.toLowerCase())||t.push(o);return t}function x(n,e,t){const l=[];if(e)for(const a of e){const e=n.getField(a);e&&t&&"availableFields"in t&&!t.availableFields?.includes(e.name)&&l.push(e.name)}return l}function F(n,e){const t=n&&n.features;if(0===t?.length)return{avg:null,count:0,max:null,median:null,min:null,nullcount:0,stddev:null,sum:null,variance:null};const l=t?.[0]?.attributes,a={};for(const r in l)a[r.replace(p,"").toLowerCase()]=l[r];return null!=a.totalcount&&a.totalcount>=a.count&&(a.nullcount=a.totalcount-a.count),delete a.totalcount,a.min===a.max&&null!=a.min&&null==a.stddev&&(a.stddev=a.variance=0),e&&(["min","max","avg","stddev","sum","variance"].forEach((n=>{null!=a[n]&&(a[n]=Math.ceil(a[n]))})),a.min===a.max&&null!=a.min&&(a.avg=a.min,a.stddev=a.variance=0)),a}function V(n){const e=[],t=n.classBreaks,l=t[0].minValue,a=t[t.length-1].maxValue;t.forEach((n=>{e.push([n.minValue,n.maxValue])}));const r={field:n.field,normalizationType:n.normalizationType,normalizationField:n.normalizationField,normalizationTotal:n.normalizationTotal,layer:n.layer};return{min:l,max:a,intervals:e,sqlExpr:w(r),excludeZerosExpr:n.where,normTotal:n.normalizationTotal}}function w(n){const{field:e,normalizationType:t,normalizationField:l,normalizationTotal:a,layer:r}=n,i=(0,d.R3)(r,e);let o=e;return"percent-of-total"===t?o=`((${i?(0,d.Ll)(e):e} / ${a}) * 100)`:"log"===t?o=`(log(${e}) * ${h})`:"field"===t?o=`(${i?(0,d.Ll)(e):e} / ${l})`:"natural-log"===t?o=`(log(${i?(0,d.Ll)(e):e}))`:"square-root"===t&&(o=`(power(${i?(0,d.Ll)(e):e}, 0.5))`),o}function E(n,e){let t;if(e=e.toLowerCase(),n)for(const l in n)if(l.toLowerCase()!==e){t=n[l];break}return t}function A(n,e){let t;if(e=e.toLowerCase(),n)for(const l in n)if(l.toLowerCase()===e){t=n[l];break}return t}function N(n,e,t,l,a){const r={},i="countOFExpr";n&&n.features&&n.features.forEach((n=>{const e=n.attributes,t=E(e,i),l=A(e,i);null!=t&&null!=l&&0!==t&&(r[t]=l)}));const o=[];return(0,m.OR)(e,t,l).forEach(((n,e)=>{const t=(e+1).toString();o.push({minValue:n[0],maxValue:n[1],count:r.hasOwnProperty(t)?r[t]:0})})),{bins:o,minValue:e,maxValue:t,normalizationTotal:a}}async function T(n,e){const t=n&&n.features,{field:l,field2:r,field3:i,fieldDelimiter:o,layer:u,view:s,signal:c,labels:f}=e,d=`countOF${l&&r?"Expr":l||"Expr"}`,p={};let h=!1;for(const a of t){const n=a.attributes,e=A(n,d);let t=l?A(n,l):E(n,d),u=r?A(n,r):null,s=i?A(n,i):null;null===t&&0===e&&(h=!0),(null==t||"string"==typeof t&&""===t.trim())&&(t=null),r&&(null==u||"string"==typeof u&&""===u.trim())&&(u=null),i&&(null==s||"string"==typeof s&&""===s.trim())&&(s=null);let c=t;r&&(c=`${(0,m.gJ)(c)}${o}${(0,m.gJ)(u)}`,i&&(c=`${c}${o}${(0,m.gJ)(s)}`)),null==p[c]?p[c]={count:e,data:c}:p[c].count=p[c].count+e}if(l&&h){const n=l+" is NULL";try{const e=await u.queryFeatureCount({whereClause:n,view:s,signal:c});return p.null.count=p.null.count+e,b(p,f)}catch{return(0,a.throwIfAborted)(c),b(p,f)}}return b(p,f)}function b(n,e){if(e)for(const t in n)n[t].label=e[t];return{count:n}}async function I(n,e,t){const l=n?t.getField(n):null,a=l?t.getFieldDomain(l.name):null;if(a)return a;const{uniqueValueInfos:o}=await t.uniqueValues({field:n,sqlWhere:e.sqlWhere,features:e.features,useFeaturesInView:e.useFeaturesInView,view:e.view,signal:e.signal}),u=o.map((n=>new r.H({code:n.value})));return new i.default({codedValues:u})}async function S(n,e){if(!n.returnAllCodedValues)return[];const{field:t,field2:l,field3:a}=n;if(t&&!l){const n=t?e.getField(t):null,l=n?e.getFieldDomain(n.name):null;return l?[l]:[]}const r=[];return t&&(r.push(I(t,n,e)),l&&(r.push(I(l,n,e)),a&&r.push(I(a,n,e)))),Promise.all(r)}function M(n){return n?(0,d.Ll)(["HOUR","MINUTE","SECOND"].map((e=>`(${function(n,e){return`EXTRACT(${e} FROM ${n}) * ${g[e]}`}(n,e)})`)).join(" + ")):null}function z(n){return{viewingMode:"2d"===n.type?"map":n.viewingMode,scale:n.scale,spatialReference:n.spatialReference?.toJSON()}}function L(n,e){const t=new Set(n.map((n=>n.value))),l=e.filter((n=>!t.has(n)));for(const a of l)n.push({value:a,count:0});n.sort(((n,t)=>e.indexOf(n.value)-e.indexOf(t.value)));for(const a of n)a.value===c.noDominantCategoryField&&(a.value=null);return{predominantCategoryInfos:n}}function C(n){const e="featureReduction"in n?n.featureReduction:null;return((null!=e&&"fields"in e?e.fields:null)??[]).map((e=>{const t=function(n,e){switch(n.statisticType){case"avg":case"avg_angle":return"double";case"count":return"integer";case"min":case"max":case"sum":return n.onStatisticField?e.get(n.onStatisticField)?.type??null:n.onStatisticExpression?"string"===n.onStatisticExpression.returnType?null:"double":null;case"mode":return n.onStatisticField?e.get(n.onStatisticField)?.type??null:n.onStatisticExpression?"string"===n.onStatisticExpression.returnType?"string":"double":null;default:return null}}(e,n.fieldsIndex);return t?new o.default({type:t,name:e.name,alias:e.alias}):null})).filter(l.Ru)}function O(n,e){return(0,d.fs)(e)?function(n,e){return(0,d.aM)(n,new Date(0),e,"milliseconds").sqlExpression}(n,e?.name):(0,u.isTimeOnlyField)(e)?M(e?.name):null}function j(n,e,t){const{field:l,normalizationType:a,normalizationField:r,normalizationTotal:i,minValue:o,maxValue:c,filter:d}=e,p=n.supportsSQLExpression?O(n,t)||e.sqlExpression:null,h=w({field:l,normalizationType:a,normalizationField:r,normalizationTotal:i,layer:n}),g=p||h,v=g?(0,f.lX)(g,o,c):null,$=(0,f.Lc)({field:l,normalizationField:r,normalizationType:a}),y=(0,f.sf)(e.sqlWhere,$),x=(0,f.sf)(y,v),F=(0,m.Vb)({normalizationField:r,normalizationType:a,sqlExpression:p,supportsSQLExpression:n.supportsSQLExpression,minValue:o,maxValue:c}),V=(0,u.isStringField)(n.getField(l??void 0)),{include:E,exclude:A}=e.outStatisticTypes||{},N=m.wy.filter((n=>(!E||E.includes(n))&&(!A||!A.includes(n))&&("nullcount"===n?F:!V||"count"===n))),T=n.createQuery();return T.where=(0,f.sf)(T.where,x),T.sqlFormat=p?"standard":null,T.outStatistics=N.map((e=>{const t=new s.default;let l=null,a=null,r=`${e}_value`;if("variance"===e)l="var",a=g;else if("nullcount"===e){const e=n.objectIdField;l="count",a=e&&n.getField(e)?e:"1",r="totalcount_value"}else"median"===e?(l="percentile-continuous",a=g,t.statisticParameters={value:.5}):(l=e,a=g);return t.statisticType=l,t.onStatisticField=a,t.outStatisticFieldName=r,t})),R(T,d),T}function R(n,e){e&&(n.geometry=e.geometry,n.spatialRelationship=e.spatialRelationship)}function q(n,e){const{field:t,field2:l,field3:a,sqlExpression:r}=e,i=!(!t||!l),o=n.createQuery();return o.where=(0,f.sf)(o.where,e.sqlWhere),o.sqlFormat=r?"standard":null,o.outStatistics=[P(i?null:t,i?"1":r)].filter(Boolean),o.groupByFieldsForStatistics=[t||r,l,a].filter(Boolean),R(o,e.filter),o}function P(n,e){const t="countOF"+(n||"Expr"),l=new s.default;return l.statisticType="count",l.onStatisticField=e?"1":n,l.outStatisticFieldName=t,l}function D(n,e,t){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:v,a=arguments.length>4?arguments[4]:void 0,r=arguments.length>5?arguments[5]:void 0,i=arguments.length>6?arguments[6]:void 0;const{min:o,max:u,normTotal:s,excludeZerosExpr:c}=e,d=e.intervals||(0,m.OR)(o,u,l),p=e.sqlExpr||t;return function(n,e,t,l,a,r,i){const o=[],u=e.length;for(let s=0;s<u;s++){const n=(0,f.sf)(l,(0,f.sf)(t+" >= "+e[s][0],null!==e[s][1]?t+(s===u-1?" <= ":" < ")+e[s][1]:""));o.push(n)}return Promise.allSettled(o.map((e=>n.queryFeatureCount({whereClause:e,view:a,filter:r,signal:i}))))}(n,d,p,c,a,r,i).then((n=>({bins:n.map(((n,e)=>({minValue:d[e][0],maxValue:d[e][1],count:"fulfilled"===n.status?n.value:0}))),minValue:o,maxValue:u,normalizationTotal:s})))}},70934:(n,e,t)=>{t.d(e,{$r:()=>v,D9:()=>b,Jc:()=>x,Lc:()=>F,MH:()=>T,Wk:()=>N,a:()=>w,gV:()=>$,hw:()=>E,lX:()=>V,rb:()=>y,sf:()=>A});var l=t(74719),a=t(16804),r=t(87431),i=t(75400),o=t(93321),u=t(73532),s=t(70576),c=t(95011),f=t(98785),d=t(79538),m=t(68584),p=t(96247);let h=null;const g=/^(?<hh>([0-1][0-9])|([2][0-3])):(?<mm>[0-5][0-9])(:(?<ss>[0-5][0-9]))?([.](?<ms>\d+))?$/;function v(n,e,t,l){const a=(0,s.d9)(t)?(0,s.Vp)(t):null,r=a?Math.round((a.valid[1]-a.valid[0])/e.scale[0]):null;return n.map((n=>{const t=new i.default(n.geometry);return(0,u.Gy)(e,t,t),n.geometry=a?function(n,e,t){return n.x<0?n.x+=e:n.x>t&&(n.x-=e),n}(t,r??0,l[0]):t,n}))}function $(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:18,t=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;const i=new Float64Array(l*r);e=Math.round((0,a.Lz)(e));let o=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY;const s=(0,f.YW)(t);for(const{geometry:a,attributes:c}of n){const{x:n,y:t}=a,d=Math.max(0,n-e),m=Math.max(0,t-e),p=Math.min(r,t+e),h=Math.min(l,n+e),g=+s(c);for(let a=m;a<p;a++)for(let r=d;r<h;r++){const s=a*l+r,c=(0,f.hv)(r-n,a-t,e)*g,d=i[s]+=c;o=Math.min(o,d),u=Math.max(u,d)}}return{min:o,max:u}}function y(n){const e=g.exec(n);if(!e)return null;const{hh:t,mm:l,ss:a,ms:i}=e.groups;return Number(t)*r.vf.hours+Number(l)*r.vf.minutes+Number(a)*r.vf.seconds+Number(i||0)}async function x(n,e){let t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e)return[];const{field:l,field2:a,field3:r,fieldDelimiter:i,fieldInfos:u,timeZone:s}=n,f=l&&u?.find((n=>n.name.toLowerCase()===l.toLowerCase())),g=!!f&&(0,c.isTimeOnlyField)(f),v=!!f&&(0,d.fs)(f),$=n.valueExpression,x=n.normalizationType,F=n.normalizationField,V=n.normalizationTotal,w=[],E=n.viewInfoParams;let A=null,N=null;if($){if(!h){const{arcadeUtils:n}=await(0,p.lw)();h=n}h.hasGeometryOperations($)&&await h.enableGeometryOperations(),A=h.createFunction($),N=E?h.getViewInfo({viewingMode:E.viewingMode,scale:E.scale,spatialReference:new o.default(E.spatialReference)}):null}const T=n.fieldInfos,b=e[0]&&"declaredClass"in e[0]&&"esri.Graphic"===e[0].declaredClass||!T?null:{fields:T};return e.forEach((n=>{const e=n.attributes;let o;if($){const e=b?{...n,layer:b}:n,t=h.createExecContext(e,N,s);o=h.executeFunction(A,t)}else e&&(o=e[l],a?(o=`${(0,m.gJ)(o)}${i}${(0,m.gJ)(e[a])}`,r&&(o=`${o}${i}${(0,m.gJ)(e[r])}`)):"string"==typeof o&&t&&(v?o=o?new Date(o).getTime():null:g&&(o=o?y(o):null)));if(x&&"number"==typeof o&&isFinite(o)){const n=e&&parseFloat(e[F]);o=(0,m.zS)(o,x,n,V)}w.push(o)})),w}function F(n){const e=n.field,t=n.normalizationType,l=n.normalizationField;let a;return"field"===t?a="(NOT "+l+" = 0)":"log"!==t&&"natural-log"!==t&&"square-root"!==t||(a=`(${e} > 0)`),a}function V(n,e,t){const l=null!=e?n+" >= "+e:"",a=null!=t?n+" <= "+t:"";let r="";return r=l&&a?A(l,a):l||a,r?"("+r+")":""}function w(n,e,t,a){let r;return e?e.name!==n.objectIdField&&a.includes(e.type)||(r=new l.default(t,"'field' should be one of these types: "+a.join(","))):r=new l.default(t,"'field' is not defined in the layer schema"),r}function E(n,e,t){let a;return e?e.name!==n.objectIdField&&(0,c.isNumericField)(e)||(a=new l.default(t,"'field' should be one of these numeric types: "+c.numericTypes.join(","))):a=new l.default(t,"'field' is not defined in the layer schema"),a}function A(n,e){let t=null!=n?n:"";return null!=e&&e&&(t=t?"("+t+") AND ("+e+")":e),t}function N(n,e){if(n&&"intersects"!==n.spatialRelationship)return new l.default(e,"Only 'intersects' spatialRelationship is supported for featureFilter")}function T(n,e,t){const a=function(n){const e=n.layer;return n.fields.filter((n=>!e.getField(n)))}({layer:n,fields:e});if(a.length)return new l.default(t,"Unknown fields: "+a.join(", ")+". You can only use fields defined in the layer schema");const r=function(n){const e=n.layer;return n.fields.filter((n=>{const t=e.getFieldUsageInfo(n);return!t||!t.supportsStatistics}))}({layer:n,fields:e});return r.length?new l.default(t,"Unsupported fields: "+r.join(", ")+". You can only use fields that can be fetched i.e. AdapterFieldUsageInfo.supportsStatistics must be true"):void 0}function b(n,e,t){const l=[],a=[],r=[],i=[],o=[];n.forEach(((n,e)=>{const u=n.field?"field":"expression",s=n.field||n.valueExpression;n.field?(o.push(s),a.push(`var ${u}${e} = Number($feature["${s}"]);`)):(l.push(`function getValueForExpr${e}() {\n  ${s} \n}`),a.push(`var ${u}${e} = Number(getValueForExpr${e}());`)),t||r.push(`${u}${e} = IIf(${u}${e} < 0, 0, ${u}${e});`),i.push(`${u}${e}`)}));const u=l.length?null:o.reduce(((n,e)=>`${n} + ${e}`));let s=null;return e||t?e?t||u&&(s=`(( ${u} ) >= 0)`):u&&(s=`(( ${u} ) <> 0)`):u&&(s=`(( ${u} ) > 0)`),{valueExpression:[l.length?l.join("\n"):"",a.join("\n"),r.join("\n"),`var total = ${i.join(" + ")};`,"return total;"].filter(Boolean).join("\n\n"),sqlExpression:u,sqlWhere:s}}},73532:(n,e,t)=>{t.d(e,{$X:()=>I,B2:()=>i,Gy:()=>E,IE:()=>r,P5:()=>S,Q1:()=>a,QE:()=>N,SW:()=>T,Tr:()=>b,VV:()=>l,wp:()=>A});t(78629);function l(n){return n?{originPosition:"upper-left"===n.originPosition?"upperLeft":"lower-left"===n.originPosition?"lowerLeft":n.originPosition,scale:n.tolerance?[n.tolerance,n.tolerance,1,1]:[1,1,1,1],translate:null!=n.extent?[n.extent.xmin,n.extent.ymax,n.extent.zmin??0,n.extent.mmin??0]:[0,0,0,0]}:null}function a(n){if(function(n){return"lowerLeft"===n.originPosition&&4===n.scale.length&&4===n.translate.length}(n))return n;const{originPosition:e,scale:t,translate:l}=n,a=t[0]??1,r=t[1]??1;return{originPosition:"lowerLeft",scale:[a,"lowerLeft"===e?r:-r,t[2]??1,t[3]??1],translate:[l[0]??0,l[1]??0,l[2]??0,l[3]??0]}}function r(n,e){let{scale:t,translate:l}=n;return Math.round((e-l[0])/t[0])}function i(n,e){let{scale:t,translate:l}=n;return Math.round((e-l[1])/t[1])}function o(n,e){let{scale:t,translate:l}=n;return Math.round(((e??0)-l[2])/t[2])}function u(n,e){let{scale:t,translate:l}=n;return e?Math.round((e-l[3])/t[3]):0}function s(n,e){return n&&e?m:n&&!e?f:!n&&e?d:c}const c=(n,e)=>{const t=[];if(!e.length)return null;const l=e[0];let a=r(n,l[0]),o=i(n,l[1]);t.push([a,o]);for(let u=1;u<e.length;u++){const[l,s]=e[u],c=r(n,l),f=i(n,s);c===a&&f===o||t.push([c-a,f-o]),a=c,o=f}return t},f=(n,e)=>{const t=[];if(!e.length)return null;const l=e[0];let a=r(n,l[0]),u=i(n,l[1]),s=o(n,l[2]);t.push([a,u,s]);for(let c=1;c<e.length;c++){const[l,f,d]=e[c],m=r(n,l),p=i(n,f),h=o(n,d);m===a&&p===u&&h===s||t.push([m-a,p-u,h]),a=m,u=p,s=h}return t},d=(n,e)=>{const t=[];if(!e.length)return null;const l=e[0];let a=r(n,l[0]),o=i(n,l[1]),s=u(n,l[2]);t.push([a,o,s]);for(let c=1;c<e.length;c++){const[l,f,d]=e[c],m=r(n,l),p=i(n,f),h=u(n,d);m===a&&p===o&&h===s||t.push([m-a,p-o,h]),a=m,o=p,s=h}return t},m=(n,e)=>{const t=[];if(!e.length)return null;const l=e[0];let a=r(n,l[0]),s=i(n,l[1]),c=o(n,l[2]),f=u(n,l[3]);t.push([a,s,c,f]);for(let d=1;d<e.length;d++){const[l,m,p,h]=e[d],g=r(n,l),v=i(n,m),$=o(n,p),y=u(n,h);g===a&&v===s&&$===c&&y===f||t.push([g-a,v-s,$,y]),a=g,s=v,c=$,f=y}return t};function p(n,e){let{scale:t,translate:l}=n;return e*t[0]+l[0]}function h(n,e){let{scale:t,translate:l}=n;return e*t[1]+l[1]}function g(n,e){let{scale:t,translate:l}=n;return(e??0)*t[2]+l[2]}function v(n,e){let{scale:t,translate:l}=n;return e?e*t[3]+l[3]:0}function $(n,e){return n&&e?V:n&&!e?x:!n&&e?F:y}const y=(n,e)=>{const t=new Array(e.length);if(!e.length)return t;const l=e[0];let a=p(n,l[0]),r=h(n,l[1]);t[0]=[a,r];const{scale:i,originPosition:o}=n,u=i[0],s="lowerLeft"===o?i[1]:-i[1];for(let c=1;c<e.length;c++){const[n,l]=e[c];a+=u*n,r+=s*l,t[c]=[a,r]}return t},x=(n,e)=>{const t=new Array(e.length);if(!e.length)return t;const l=e[0];let a=p(n,l[0]),r=h(n,l[1]);t[0]=[a,r,g(n,l[2])];const{scale:i,originPosition:o}=n,u=i[0],s="lowerLeft"===o?i[1]:-i[1];for(let c=1;c<e.length;c++){const[l,i,o]=e[c];a+=u*l,r+=s*i,t[c]=[a,r,g(n,o)]}return t},F=(n,e)=>{const t=new Array(e.length);if(!e.length)return t;const l=e[0];let a=p(n,l[0]),r=h(n,l[1]);t[0]=[a,r,v(n,l[2])];const{scale:i,originPosition:o}=n,u=i[0],s="lowerLeft"===o?i[1]:-i[1];for(let c=1;c<e.length;c++){const[l,i,o]=e[c];a+=u*l,r+=s*i,t[c]=[a,r,v(n,o)]}return t},V=(n,e)=>{const t=new Array(e.length);if(!e.length)return t;const l=e[0];let a=p(n,l[0]),r=h(n,l[1]);t[0]=[a,r,g(n,l[2]),v(n,l[3])];const{scale:i,originPosition:o}=n,u=i[0],s="lowerLeft"===o?i[1]:-i[1];for(let c=1;c<e.length;c++){const[l,i,o,f]=e[c];a+=u*l,r+=s*i,t[c]=[a,r,g(n,o),v(n,f)]}return t};function w(n,e,t){const l=new Array(t.length);for(let a=0;a<t.length;a++)l[a]=e(n,t[a]);return l}function E(n,e,t){const l=a(n);return e.x=r(l,t.x),e.y=i(l,t.y),null!=t.z&&(e.z=o(l,t.z)),null!=t.m&&(e.m=u(l,t.m)),e}function A(n,e,t){const l=function(n,e,t,l){const a=[],r=s(t,l);for(let i=0;i<e.length;i++){const t=r(n,e[i]);t&&t.length>=3&&a.push(t)}return a.length?a:null}(a(n),t.rings,t.hasZ,t.hasM);return l?(e.rings=l,e.hasZ=t.hasZ??!1,e.hasM=t.hasM??!1,e):null}function N(n,e,t){const l=function(n,e,t,l){const a=[],r=s(t,l);for(let i=0;i<e.length;i++){const t=r(n,e[i]);t&&t.length>=2&&a.push(t)}return a.length?a:null}(a(n),t.paths,t.hasZ,t.hasM);return l?(e.paths=l,e.hasZ=t.hasZ??!1,e.hasM=t.hasM??!1,e):null}function T(n,e,t){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t?.hasZ??!1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:t?.hasM??!1;if(null!=t){const i=a(n);e.points=$(l,r)(i,t.points),e.hasZ=l,e.hasM=r}return e}function b(n,e,t){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null!=t?.z,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null!=t?.m;if(null==t)return e;const i=a(n);return e.x=p(i,t.x),e.y=h(i,t.y),l&&(e.z=g(i,t.z)),r&&(e.m=v(i,t.m)),e}function I(n,e,t){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t?.hasZ??!1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:t?.hasM??!1;if(null!=t){const i=a(n);e.rings=w(i,$(l,r),t.rings),e.hasZ=l,e.hasM=r}return e}function S(n,e,t){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t?.hasZ??!1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:t?.hasM??!1;if(null!=t){const i=a(n);e.paths=w(i,$(l,r),t.paths),e.hasZ=l,e.hasM=r}return e}}}]);