"use strict";(self.webpackChunkever_wading_birds=self.webpackChunkever_wading_birds||[]).push([[31826,61315,84442],{31826:(e,t,r)=>{r.r(t),r.d(t,{identify:()=>g});var o=r(23060),n=r(30312),i=r(10193),l=r(14125),s=r(78629),a=r(11099),u=r(70576),p=r(83563),y=r(99292);function f(e,t){const{dpi:r,gdbVersion:o,geometry:n,geometryPrecision:i,height:l,historicMoment:a,layerOption:p,mapExtent:y,maxAllowableOffset:f,returnFieldName:m,returnGeometry:c,returnUnformattedValues:g,returnZ:h,spatialReference:b,timeExtent:I,tolerance:v,width:w}=e.toJSON(),{dynamicLayers:M,layerDefs:_,layerIds:O}=d(e),x=null!=t?.geometry?t.geometry:null,S={historicMoment:a,geometryPrecision:i,maxAllowableOffset:f,returnFieldName:m,returnGeometry:c,returnUnformattedValues:g,returnZ:h,tolerance:v},Z=x?.toJSON()||n;S.imageDisplay=`${w},${l},${r}`,o&&(S.gdbVersion=o),Z&&(delete Z.spatialReference,S.geometry=JSON.stringify(Z),S.geometryType=(0,s.getJsonType)(Z));const E=b??Z?.spatialReference??y?.spatialReference;if(E&&(S.sr=(0,u.YX)(E)),S.time=I?[I.start,I.end].join(","):null,y){const{xmin:e,ymin:t,xmax:r,ymax:o}=y;S.mapExtent=`${e},${t},${r},${o}`}return _&&(S.layerDefs=_),M&&!_&&(S.dynamicLayers=M),S.layers="popup"===p?"visible":p,O&&!M&&(S.layers+=`:${O.join(",")}`),S}function d(e){const{mapExtent:t,floors:r,width:o,sublayers:n,layerIds:i,layerOption:s,gdbVersion:u}=e,f=n?.find((e=>null!=e.layer))?.layer?.serviceSublayers,d="popup"===s,m={},c=(0,a.X_)({extent:t,width:o,spatialReference:t?.spatialReference}),g=[],h=e=>{const t=0===c,r=0===e.minScale||c<=e.minScale,o=0===e.maxScale||c>=e.maxScale;if(e.visible&&(t||r&&o))if(e.sublayers)e.sublayers.forEach(h);else{if(!1===i?.includes(e.id)||d&&(!e.popupTemplate||!e.popupEnabled))return;g.unshift(e)}};if(n?.forEach(h),n&&!g.length)m.layerIds=[];else{const e=(0,y.Sk)(g,f,u),t=g.map((e=>{const t=(0,p.f)(r,e);return e.toExportImageJSON(t)}));if(e)m.dynamicLayers=JSON.stringify(t);else{if(n){let e=g.map((e=>{let{id:t}=e;return t}));i&&(e=e.filter((e=>i.includes(e)))),m.layerIds=e}else i?.length&&(m.layerIds=i);const e=function(e,t){const r=!!e?.length,o=t.filter((e=>null!=e.definitionExpression||r&&null!=e.floorInfo));return o.length?o.map((t=>{const r=(0,p.f)(e,t),o=(0,l.sqlAnd)(r,t.definitionExpression);return{id:t.id,definitionExpression:o??void 0}})):null}(r,g);if(null!=e&&e.length){const t={};for(const r of e)r.definitionExpression&&(t[r.id]=r.definitionExpression);Object.keys(t).length&&(m.layerDefs=JSON.stringify(t))}}}return m}var m=r(84442),c=r(83696);async function g(e,t,r){const l=(a=t,t=m.default.from(a)).geometry?[t.geometry]:[],s=(0,i.Dl)(e);var a;return s.path+="/identify",(0,n.normalizeCentralMeridian)(l).then((e=>{const n=f(t,{geometry:e?.[0]}),l=(0,i.lF)({...s.query,f:"json",...n}),a=(0,i.jV)(l,r);return(0,o.default)(s.path,a).then(h).then((e=>function(e,t){if(!t?.length)return e;const r=new Map;function o(e){r.set(e.id,e),e.sublayers&&e.sublayers.forEach(o)}t.forEach(o);for(const n of e.results)n.feature.sourceLayer=r.get(n.layerId);return e}(e,t.sublayers)))}))}function h(e){const t=e.data;return t.results=t.results||[],t.exceededTransferLimit=Boolean(t.exceededTransferLimit),t.results=t.results.map((e=>c.default.fromJSON(e))),t}},83563:(e,t,r)=>{function o(e){const t=e.layer;return"floorInfo"in t&&t.floorInfo?.floorField&&"floors"in e.view?i(e.view.floors,t.floorInfo.floorField):null}function n(e,t){return"floorInfo"in t&&t.floorInfo?.floorField?i(e,t.floorInfo.floorField):null}function i(e,t){if(!e?.length)return null;const r=e.filter((e=>""!==e)).map((e=>`'${e}'`));return r.push("''"),`${t} IN (${r.join(",")}) OR ${t} IS NULL`}r.d(t,{E:()=>o,f:()=>n})},83696:(e,t,r)=>{r.r(t),r.d(t,{default:()=>f});var o=r(93800),n=r(79625),i=r(19455),l=r(48602),s=(r(21265),r(50925),r(14746),r(14800)),a=r(75269),u=r(15484),p=r(54723);let y=class extends i.A{constructor(e){super(e),this.displayFieldName=null,this.feature=null,this.layerId=null,this.layerName=null}readFeature(e,t){return n.default.fromJSON({attributes:{...t.attributes},geometry:{...t.geometry}})}writeFeature(e,t){if(!e)return;const{attributes:r,geometry:o}=e;r&&(t.attributes={...r}),null!=o&&(t.geometry=o.toJSON(),t.geometryType=p.Ye.toJSON(o.type))}};(0,o._)([(0,l.MZ)({type:String,json:{write:!0}})],y.prototype,"displayFieldName",void 0),(0,o._)([(0,l.MZ)({type:n.default})],y.prototype,"feature",void 0),(0,o._)([(0,s.w)("feature",["attributes","geometry"])],y.prototype,"readFeature",null),(0,o._)([(0,u.K)("feature")],y.prototype,"writeFeature",null),(0,o._)([(0,l.MZ)({type:Number,json:{write:!0}})],y.prototype,"layerId",void 0),(0,o._)([(0,l.MZ)({type:String,json:{write:!0}})],y.prototype,"layerName",void 0),y=(0,o._)([(0,a.$)("esri.rest.support.IdentifyResult")],y);const f=y},84442:(e,t,r)=>{r.r(t),r.d(t,{default:()=>h});var o,n=r(93800),i=r(89129),l=r(19455),s=r(48602),a=r(80556),u=(r(21265),r(14746),r(75269)),p=r(15484),y=r(12560),f=r(93321),d=r(78629),m=r(54723),c=r(32474);let g=o=class extends l.A{static from(e){return(0,a.PZ)(o,e)}constructor(e){super(e),this.dpi=96,this.floors=null,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=null,this.height=400,this.historicMoment=null,this.layerIds=null,this.layerOption="top",this.mapExtent=null,this.maxAllowableOffset=null,this.returnFieldName=!0,this.returnGeometry=!1,this.returnM=!1,this.returnUnformattedValues=!0,this.returnZ=!1,this.spatialReference=null,this.sublayers=null,this.timeExtent=null,this.tolerance=null,this.width=400}writeHistoricMoment(e,t){t.historicMoment=e&&e.getTime()}};(0,n._)([(0,s.MZ)({type:Number,json:{write:!0}})],g.prototype,"dpi",void 0),(0,n._)([(0,s.MZ)()],g.prototype,"floors",void 0),(0,n._)([(0,s.MZ)({type:String,json:{write:!0}})],g.prototype,"gdbVersion",void 0),(0,n._)([(0,s.MZ)({types:m.yR,json:{read:d.fromJSON,write:!0}})],g.prototype,"geometry",void 0),(0,n._)([(0,s.MZ)({type:Number,json:{write:!0}})],g.prototype,"geometryPrecision",void 0),(0,n._)([(0,s.MZ)({type:Number,json:{write:!0}})],g.prototype,"height",void 0),(0,n._)([(0,s.MZ)({type:Date})],g.prototype,"historicMoment",void 0),(0,n._)([(0,p.K)("historicMoment")],g.prototype,"writeHistoricMoment",null),(0,n._)([(0,s.MZ)({type:[Number],json:{write:!0}})],g.prototype,"layerIds",void 0),(0,n._)([(0,s.MZ)({type:["top","visible","all","popup"],json:{write:!0}})],g.prototype,"layerOption",void 0),(0,n._)([(0,s.MZ)({type:y.default,json:{write:!0}})],g.prototype,"mapExtent",void 0),(0,n._)([(0,s.MZ)({type:Number,json:{write:!0}})],g.prototype,"maxAllowableOffset",void 0),(0,n._)([(0,s.MZ)({type:Boolean,json:{write:!0}})],g.prototype,"returnFieldName",void 0),(0,n._)([(0,s.MZ)({type:Boolean,json:{write:!0}})],g.prototype,"returnGeometry",void 0),(0,n._)([(0,s.MZ)({type:Boolean,json:{write:!0}})],g.prototype,"returnM",void 0),(0,n._)([(0,s.MZ)({type:Boolean,json:{write:!0}})],g.prototype,"returnUnformattedValues",void 0),(0,n._)([(0,s.MZ)({type:Boolean,json:{write:!0}})],g.prototype,"returnZ",void 0),(0,n._)([(0,s.MZ)({type:f.default,json:{write:!0}})],g.prototype,"spatialReference",void 0),(0,n._)([(0,s.MZ)({type:i.default})],g.prototype,"sublayers",void 0),(0,n._)([(0,s.MZ)({type:c.default,json:{write:!0}})],g.prototype,"timeExtent",void 0),(0,n._)([(0,s.MZ)({type:Number,json:{write:!0}})],g.prototype,"tolerance",void 0),(0,n._)([(0,s.MZ)({type:Number,json:{write:!0}})],g.prototype,"width",void 0),g=o=(0,n._)([(0,u.$)("esri.rest.support.IdentifyParameters")],g);const h=g},99292:(e,t,r)=>{r.d(t,{Sk:()=>i,Zx:()=>n,_X:()=>s});var o=r(70605);function n(e,t,r){const o=t.flatten((e=>{let{sublayers:t}=e;return t})).length;return o!==e.length||(!!e.some((e=>e.originIdOf("minScale")>r||e.originIdOf("maxScale")>r||e.originIdOf("renderer")>r||e.originIdOf("labelingInfo")>r||e.originIdOf("opacity")>r||e.originIdOf("labelsVisible")>r||e.originIdOf("source")>r))||!l(e,t))}function i(e,t,r){return!!e.some((e=>{const t=e.source,n=!t||"map-layer"===t.type&&t.mapLayerId===e.id&&(null==t.gdbVersion||t.gdbVersion===r);e.commitProperty("renderer"),e.commitProperty("labelingInfo"),e.commitProperty("opacity"),e.commitProperty("labelsVisible"),e.commitProperty("orderBy");const i=e.layer?.capabilities?.exportMap?.supportsSublayerOrderBy??!1;return!n||e.originIdOf("renderer")>o.Gr.SERVICE||e.originIdOf("labelingInfo")>o.Gr.SERVICE||e.originIdOf("opacity")>o.Gr.SERVICE||e.originIdOf("labelsVisible")>o.Gr.SERVICE||i&&e.originIdOf("orderBy")>o.Gr.SERVICE}))||!l(e,t)}function l(e,t){if(!e?.length||null==t)return!0;const r=t.slice().reverse().flatten((e=>{let{sublayers:t}=e;return t&&t.toArray().reverse()})).map((e=>e.id)).toArray();if(e.length>r.length)return!1;let o=0;const n=r.length;for(const{id:i}of e){for(;o<n&&r[o]!==i;)o++;if(o>=n)return!1}return!0}function s(e){return!!e&&e.some((e=>null!=e.minScale||null!=e.layerDefinition?.minScale))}}}]);