"use strict";(self.webpackChunkever_wading_birds=self.webpackChunkever_wading_birds||[]).push([[70674,99490],{22093:(t,i,e)=>{function s(t,i,e){if(!i||!t?.map)return;const{map:s}=t,o=s.layers.find((t=>t===i));o||s.add(i,e),o&&null!=e&&s.layers.reorder(o,e)}function o(t,i){const e="subtype-sublayer"===i?.type?i.parent:i;return t.allLayerViews.find((t=>{const i=t.layer;return i===e||"sublayers"in i&&null!=i.sublayers&&i.sublayers.includes(e)}))}e.d(i,{Y:()=>s,i:()=>o})},70674:(t,i,e)=>{e.r(i),e.d(i,{default:()=>d});var s=e(93800),o=e(48602),n=(e(21265),e(50925),e(14746),e(75269)),r=e(21),a=e(57457),c=e(24203),l=e(75215),h=e(33580),y=e(87730);let u=class extends((0,c.dM)((0,l.j)(a.default))){constructor(t){super(t),this.elevationInfo=null,this.graphics=new h.Y,this.screenSizePerspectiveEnabled=!0,this.type="graphics",this.internal=!1}destroy(){this.removeAll(),this.graphics.destroy()}add(t){return this.graphics.add(t),this}addMany(t){return this.graphics.addMany(t),this}removeAll(){return this.graphics.removeAll(),this}remove(t){this.graphics.remove(t)}removeMany(t){this.graphics.removeMany(t)}on(t,i){return super.on(t,i)}graphicChanged(t){this.emit("graphic-update",t)}};(0,s._)([(0,o.MZ)({type:y.A})],u.prototype,"elevationInfo",void 0),(0,s._)([(0,o.MZ)((0,r.C)(h.Y,"graphics"))],u.prototype,"graphics",void 0),(0,s._)([(0,o.MZ)({type:["show","hide"]})],u.prototype,"listMode",void 0),(0,s._)([(0,o.MZ)()],u.prototype,"screenSizePerspectiveEnabled",void 0),(0,s._)([(0,o.MZ)({readOnly:!0})],u.prototype,"type",void 0),(0,s._)([(0,o.MZ)({constructOnly:!0})],u.prototype,"internal",void 0),u=(0,s._)([(0,n.$)("esri.layers.GraphicsLayer")],u);const d=u},99490:(t,i,e)=>{e.r(i),e.d(i,{default:()=>g});var s=e(93800),o=e(79625),n=(e(88677),e(6946)),r=e(89129),a=e(74719),c=e(50925),l=e(79953),h=e(48602),y=(e(21265),e(14746),e(75269)),u=e(15492),d=e(70674),m=e(80043),p=e(99071),A=e(22093),w=e(12711),v=e(53957);const _=-2147208504;let b=class extends n.default{constructor(t){super(t),this._internalGraphicsLayerConnectivity=this._createInternalGraphicsLayer("Connectivity Associations (Internal)"),this._internalGraphicsLayerStructuralAttachment=this._createInternalGraphicsLayer("Structural Attachment Associations (Internal)"),this._initialValidationsFinished=!1,this._updatingHandles=new u.U,this.autoRefreshAssociations=!1,this.connectivityAssociationsLineSymbol=new p.default({style:"short-dash",width:2,color:[190,159,159,1]}),this.executionError="",this.loadErrors=new r.default,this.maxAllowableAssociations=250,this.showAssociationsEnabled=!1,this.showArrowsConnectivity=!1,this.showArrowsStructuralAttachment=!1,this.structuralAttachmentAssociationsLineSymbol=new p.default({style:"short-dash",width:2,color:[159,190,159,1]})}initialize(){const t=async()=>{this.messages||(this.messages=await(0,v.ud)("esri/widgets/UtilityNetworkAssociations/t9n/UtilityNetworkAssociations"))};t().then((()=>{this.view||(this.view=null),this.utilityNetwork||(this.utilityNetwork=null),this.addHandles([(0,l.watch)((()=>[this.view,this.utilityNetwork]),(async()=>{const{loadErrors:t,messages:{info:{noUtilityNetwork:i,noView:e}}}=this;this._initialValidationsFinished=!1,t.removeAll();let s=!1,o=!1;this.removeAssociations(),"2d"===this.view?.type?((0,A.Y)(this.view,this._internalGraphicsLayerConnectivity),(0,A.Y)(this.view,this._internalGraphicsLayerStructuralAttachment),s=!0):(this.loadErrors.push(e),c.A.getLogger(this).error(new a.default("utilityNetworkAssociations:missing-property",e))),"utility"===this.utilityNetwork?.type?o=!0:(this.loadErrors.push(i),c.A.getLogger(this).error(new a.default("utilityNetworkAssociations:missing-property",i))),s&&o&&this.showAssociationsEnabled&&await this.showAssociations(),this._internalGraphicsLayerConnectivity.visible=this.includeConnectivityAssociations,this._internalGraphicsLayerStructuralAttachment.visible=this.includeStructuralAttachmentAssociations,this._initialValidationsFinished=!0}),{initial:!0}),(0,l.watch)((()=>[this.view?.stationary,this.showAssociationsEnabled,this.maxAllowableAssociations]),(async()=>{this.view?.stationary&&this.showAssociationsEnabled&&(this.includeConnectivityAssociations||this.includeStructuralAttachmentAssociations)&&await this.showAssociations()})),(0,l.watch)((()=>[this.showArrowsConnectivity]),(()=>{const t=this.connectivityAssociationsLineSymbol.clone();t.marker=null,this.showArrowsConnectivity&&(t.marker=new m.default({color:this.connectivityAssociationsLineSymbol.color,placement:"end",style:"arrow"}));for(const i of this._internalGraphicsLayerConnectivity.graphics)i.symbol=t})),(0,l.watch)((()=>[this.showArrowsStructuralAttachment]),(()=>{const t=this.structuralAttachmentAssociationsLineSymbol.clone();t.marker=null,this.showArrowsStructuralAttachment&&(t.marker=new m.default({color:this.structuralAttachmentAssociationsLineSymbol.color,placement:"end",style:"arrow"}));for(const i of this._internalGraphicsLayerStructuralAttachment.graphics)i.symbol=t})),(0,l.watch)((()=>{const{cap:t,color:i,style:e,width:s,marker:o}=this.connectivityAssociationsLineSymbol;return[t,i,e,s,o]}),(()=>{const t=this.connectivityAssociationsLineSymbol.clone();for(const i of this._internalGraphicsLayerConnectivity.graphics)i.symbol=t;this.showArrowsConnectivity=!1,t.marker=null,this.connectivityAssociationsLineSymbol.marker&&(this.showArrowsConnectivity=!0,t.marker=new m.default({color:this.connectivityAssociationsLineSymbol.color,placement:"end",style:"arrow"}))})),(0,l.watch)((()=>{const{cap:t,color:i,style:e,width:s,marker:o}=this.structuralAttachmentAssociationsLineSymbol;return[t,i,e,s,o]}),(()=>{const t=this.structuralAttachmentAssociationsLineSymbol.clone();for(const i of this._internalGraphicsLayerStructuralAttachment.graphics)i.symbol=t;this.showArrowsStructuralAttachment=!1,t.marker=null,this.structuralAttachmentAssociationsLineSymbol.marker&&(this.showArrowsStructuralAttachment=!0,t.marker=new m.default({color:this.structuralAttachmentAssociationsLineSymbol.color,placement:"end",style:"arrow"}))})),(0,w.oQ)(t)])}))}destroy(){this._updatingHandles.destroy(),this.view=null,this._removeInternalGraphicsLayers()}set includeConnectivityAssociations(t){this._set("includeConnectivityAssociations",t),this._internalGraphicsLayerConnectivity.visible=t}set includeStructuralAttachmentAssociations(t){this._set("includeStructuralAttachmentAssociations",t),this._internalGraphicsLayerStructuralAttachment.visible=t}get state(){return this.loadErrors.length?"disabled":this._updatingHandles.updating?"executing":""!==this.executionError?"warning":this._initialValidationsFinished?"ready":"loading"}get utilityNetwork(){return this.utilityNetwork}set utilityNetwork(t){this._get("utilityNetwork")!==t&&this._set("utilityNetwork",t)}get view(){return this.view}set view(t){this._get("view")!==t&&this._set("view",t)}removeAssociations(){this._internalGraphicsLayerConnectivity.removeAll(),this._internalGraphicsLayerStructuralAttachment.removeAll()}async showAssociations(){const{messages:{info:{maxAllowableAssociationsExceeded:t,noAssociationsFound:i,noAssociationTypeSpecified:e}},utilityNetwork:s}=this;this._set("executionError","");const n={extent:this.view?.extent,gdbVersion:this.utilityNetwork?.gdbVersion,maxGeometryCount:this.maxAllowableAssociations,moment:this.utilityNetwork?.historicMoment,outSpatialReference:this.view?.spatialReference.clone(),returnConnectivityAssociations:this.includeConnectivityAssociations,returnAttachmentAssociations:this.includeStructuralAttachmentAssociations};this._updatingHandles.addPromise(s?.synthesizeAssociationGeometries(n).then((e=>{let s=[],n=[];return e?.maxGeometryCountExceeded?(this.removeAssociations(),void this._set("executionError",t)):0===e?.associations.length?(this.removeAssociations(),void this._set("executionError",i)):void(e&&(s=e?.associations.filter((t=>{let{associationType:i}=t;return"connectivity"===i})).map((t=>(this.connectivityAssociationsLineSymbol.marker=null,this.showArrowsConnectivity&&(this.connectivityAssociationsLineSymbol.marker=new m.default({color:this.connectivityAssociationsLineSymbol.color,placement:"end",style:"arrow"})),new o.default({geometry:t.geometry.clone(),symbol:this.connectivityAssociationsLineSymbol})))),n=e.associations.filter((t=>{let{associationType:i}=t;return"attachment"===i})).map((t=>(this.structuralAttachmentAssociationsLineSymbol.marker=null,this.showArrowsStructuralAttachment&&(this.structuralAttachmentAssociationsLineSymbol.marker=new m.default({color:this.structuralAttachmentAssociationsLineSymbol.color,placement:"end",style:"arrow"})),new o.default({geometry:t.geometry.clone(),symbol:this.structuralAttachmentAssociationsLineSymbol})))),this._internalGraphicsLayerConnectivity.removeAll(),s.length>0&&this._internalGraphicsLayerConnectivity.addMany(s),this._internalGraphicsLayerStructuralAttachment.removeAll(),n.length>0&&this._internalGraphicsLayerStructuralAttachment.addMany(n)))}),(t=>{let i="Error: "+t;t instanceof a.default&&t.details?.raw&&(i=t.details.raw.extendedCode===_?e:t.details.message),this._set("executionError",i)})))}_createInternalGraphicsLayer(t){return new d.default({listMode:"hide",internal:!0,title:t})}_removeInternalGraphicsLayers(){this._internalGraphicsLayerConnectivity&&this._internalGraphicsLayerStructuralAttachment&&this.view?.map&&(this.view.map.remove(this._internalGraphicsLayerConnectivity),this.view.map.remove(this._internalGraphicsLayerStructuralAttachment))}};(0,s._)([(0,h.MZ)()],b.prototype,"_initialValidationsFinished",void 0),(0,s._)([(0,h.MZ)()],b.prototype,"autoRefreshAssociations",void 0),(0,s._)([(0,h.MZ)({type:p.default,nonNullable:!0})],b.prototype,"connectivityAssociationsLineSymbol",void 0),(0,s._)([(0,h.MZ)({readOnly:!0})],b.prototype,"executionError",void 0),(0,s._)([(0,h.MZ)({type:Boolean,value:!0})],b.prototype,"includeConnectivityAssociations",null),(0,s._)([(0,h.MZ)({type:Boolean,value:!0})],b.prototype,"includeStructuralAttachmentAssociations",null),(0,s._)([(0,h.MZ)()],b.prototype,"loadErrors",void 0),(0,s._)([(0,h.MZ)()],b.prototype,"maxAllowableAssociations",void 0),(0,s._)([(0,h.MZ)()],b.prototype,"messages",void 0),(0,s._)([(0,h.MZ)()],b.prototype,"showAssociationsEnabled",void 0),(0,s._)([(0,h.MZ)()],b.prototype,"showArrowsConnectivity",void 0),(0,s._)([(0,h.MZ)()],b.prototype,"showArrowsStructuralAttachment",void 0),(0,s._)([(0,h.MZ)({readOnly:!0})],b.prototype,"state",null),(0,s._)([(0,h.MZ)({type:p.default,nonNullable:!0})],b.prototype,"structuralAttachmentAssociationsLineSymbol",void 0),(0,s._)([(0,h.MZ)()],b.prototype,"utilityNetwork",null),(0,s._)([(0,h.MZ)()],b.prototype,"view",null),b=(0,s._)([(0,y.$)("esri.widgets.UtilityNetworkAssociations.UtilityNetworkAssociationsViewModel")],b);const g=b}}]);