"use strict";(self.webpackChunkever_wading_birds=self.webpackChunkever_wading_birds||[]).push([[20726],{20726:(e,t,a)=>{a.r(t),a.d(t,{default:()=>F});var s=a(93800),i=a(89129),r=a(93633),o=a(79953),l=a(48602),n=(a(21265),a(50925),a(14746),a(75269)),d=a(5172),c=a(84915),h=a(27811),p=a(88473),y=a(3835),u=a(73212),m=(a(74719),a(99572));let _=class extends m.default{_compileList(){const e=this.view?.map?.allLayers;if(!e)return;const t=e.filter(y.gl);this._watchLayersListMode(t);const a=this._getViewableLayers(t);a?.length?(this._createNewItems(a),this._removeItems(a),this._sortItems(a)):this._removeAllItems()}};_=(0,s._)([(0,n.$)("esri.widgets.OrientedImageryViewer.components.OverlayLayersListViewModel")],_);const L=_;let v=class extends u.default{constructor(){super(...arguments),this._rootListEl=null,this.viewModel=new L,this.selectionMode="multiple",this.visibilityAppearance=void 0}initialize(){super.initialize(),this.addHandles([(0,o.watch)((()=>this._rootListEl),(()=>{this._rootListEl&&(this._rootListEl.selectionAppearance="icon")}),o.syncAndInitial)])}};(0,s._)([(0,l.MZ)()],v.prototype,"_rootListEl",void 0),(0,s._)([(0,l.MZ)()],v.prototype,"viewModel",void 0),(0,s._)([(0,l.MZ)()],v.prototype,"selectionMode",void 0),(0,s._)([(0,l.MZ)()],v.prototype,"visibilityAppearance",void 0),v=(0,s._)([(0,n.$)("esri.widgets.OrientedImageryViewer.components.OverlayLayersList")],v);const g=v;var w=a(49403),C=a(50821),M=(a(17745),a(87118));let I=class extends(r.A.IdentifiableMixin(h.default)){constructor(e){super(e),this._previousAction=null,this.closed=!1,this.dataCaptureEnabled=!1,this.dataCaptureLayer=null,this.imageGeometryField=null,this.imageReferenceField=null,this.layerList=new g({selectionMode:"multiple"}),this.messages=null,this.overlayedLayers=new i.default,this.showCameraLocations=!1,this.showMapFeatures=!1,this._createSelectedItemsHandle=()=>{this.removeHandles("selected-items"),this.addHandles(this._trackLayerSelectionChanges(),"selected-items")},this._createDataCaptureLayerHandle=()=>(0,o.watch)((()=>({dataCaptureLayer:this.dataCaptureLayer,operationalItems:this.layerList.operationalItems})),((e,t)=>{let{dataCaptureLayer:a,operationalItems:s}=e;if(!a&&t?.dataCaptureLayer){const e=s.find((e=>e.layer===t.dataCaptureLayer));e&&e.actionsSections?.items.forEach((e=>{e.items.forEach((e=>{"create-features"===e.id&&(e.value=!1)}))}))}}),o.syncAndInitial),this._handleSelectedItemsChange=e=>{let{added:t,removed:a}=e;t.forEach((e=>{this.overlayedLayers.includes(e.layer)||this.onLayerSelected?.(e)})),a.forEach((e=>{this.overlayedLayers.includes(e.layer)&&this.onLayerDeselected?.(e)})),this.overlayedLayers.removeAll(),this.overlayedLayers.addMany(this.layerList.selectedItems.items.map((e=>e.layer)))},this._layerListTriggerActionHandle=()=>(0,o.on)((()=>this.layerList),"trigger-action",(e=>{const{action:t,item:{layer:a}}=e;this._resetPreviousAction(t),"create-features"===t.id&&this._toggleDataCaptureLayer(t,a)})),this._resetPreviousAction=e=>{"toggle"===this._previousAction?.type&&this._previousAction!==e&&(this._previousAction.value=!1,this._previousAction=null)},this._toggleDataCaptureLayer=(e,t)=>{this._previousAction=e;const a=e.value;this.dataCaptureLayer=a?t:null,this.onDataCaptureLayerChanged?.(this.dataCaptureLayer)},this._trackLayerSelectionChanges=()=>(0,o.on)((()=>this.layerList.selectedItems),"change",this._handleSelectedItemsChange),this._watchLayerListForListItemCreatedFunction=()=>(0,o.watch)((()=>({layerList:this.layerList,listItemCreatedFunction:this._listItemCreatedFunction})),(()=>{this.layerList.listItemCreatedFunction=this._listItemCreatedFunction}),o.syncAndInitial),this._watchSelectedItems=()=>(0,o.watch)((()=>this.layerList.selectedItems),this._createSelectedItemsHandle,o.syncAndInitial)}initialize(){this.addHandles([this._watchSelectedItems(),this._layerListTriggerActionHandle(),this._watchLayerListForListItemCreatedFunction(),this._createDataCaptureLayerHandle()])}loadDependencies(){return(0,w.W)({list:()=>Promise.all([a.e(46138),a.e(89939),a.e(18170)]).then(a.bind(a,18170)),"list-item":()=>Promise.all([a.e(73373),a.e(14960)]).then(a.bind(a,28898)),panel:()=>Promise.all([a.e(86290),a.e(74597),a.e(99776)]).then(a.bind(a,99776)),switch:()=>a.e(92812).then(a.bind(a,92812))})}get _listItemCreatedFunction(){const{dataCaptureEnabled:e,imageGeometryField:t,imageReferenceField:a}=this;return e&&t&&a?async e=>{const{item:s}=e,r=s.layer,{dataCaptureLayer:l,overlayedLayers:n,messages:{createFeaturesFromImage:h},layerList:p}=this,u=n.includes(r),{selectedItems:m}=p;if(function(e,t,a){e&&t.items.push(a)}(u,m,s),await(r?.load()),!r||!(0,y.gE)(r,t,a)||!(0,d.S)(r))return;const _=l===r,L=function(e,t,a){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=new c.default({icon:"pencil",id:"create-features",title:e,value:s});return t.addHandles((0,o.watch)((()=>a.includes(t)),(e=>{r.visible=e}),o.syncAndInitial)),function(e,t){const a=new i.default;a.add(e),t.actionsSections=new i.default([a])}(r,t),r}(h,s,m,_);_&&(this._previousAction=L)}:null}get view(){return this.layerList?.view}set view(e){this.layerList.view=e}_renderCameraLocationsSwitch(e){return(0,M.K)("calcite-list-item",{bind:this,label:this.messages.overlayCameraLocations,onclick:this._toggleShowCameraLocations},(0,M.K)("calcite-switch",{bind:this,checked:e,class:p.AH.overlaysSwitch,onchange:this._toggleShowCameraLocations,scale:"s",slot:"actions-end"}))}_renderOverlayMapFeatures(e){return(0,M.K)("calcite-list-item",{bind:this,label:this.messages?.overlayMapFeatures,onclick:this._toggleShowMapFeatures},(0,M.K)("calcite-switch",{bind:this,checked:e,class:p.AH.overlaysSwitch,onchange:this._toggleShowMapFeatures,scale:"s",slot:"actions-end"}))}_renderList(e){return e?(0,M.K)("div",{class:p.AH.imageOverlaysLayerList},this.layerList.render()):null}_renderPanel(){const{closed:e,messages:t,showCameraLocations:a,showMapFeatures:s}=this;return(0,M.K)("calcite-panel",{bind:this,closable:!0,closed:e,heading:t.imageOverlays,onCalcitePanelClose:this.onImageOverlaysClosed},(0,M.K)("calcite-list",{label:t.imageOverlays},this._renderCameraLocationsSwitch(a),this._renderOverlayMapFeatures(s)),this._renderList(s))}_toggleShowCameraLocations(e){e.stopPropagation(),this.showCameraLocations=!this.showCameraLocations,this.onShowCameraLocationsChanged?.(this.showCameraLocations)}_toggleShowMapFeatures(e){e.stopPropagation(),this.showMapFeatures=!this.showMapFeatures,this.onShowMapFeaturesChanged?.(this.showMapFeatures)}render(){const e=this.layerList.operationalItems.items.length,t=this.showMapFeatures&&0===e,a=this.showMapFeatures&&e>0,s={[C.D.widget]:!0,[p.AH.imageOverlaysNoResult]:t,[p.AH.imageOverlaysIncreasedHeight]:a,[p.AH.imageOverlays]:!t&&!a};return(0,M.K)("div",{class:this.classes(s)},this._renderPanel())}};(0,s._)([(0,l.MZ)()],I.prototype,"_previousAction",void 0),(0,s._)([(0,l.MZ)()],I.prototype,"_listItemCreatedFunction",null),(0,s._)([(0,l.MZ)()],I.prototype,"closed",void 0),(0,s._)([(0,l.MZ)()],I.prototype,"dataCaptureEnabled",void 0),(0,s._)([(0,l.MZ)()],I.prototype,"dataCaptureLayer",void 0),(0,s._)([(0,l.MZ)()],I.prototype,"imageGeometryField",void 0),(0,s._)([(0,l.MZ)()],I.prototype,"imageReferenceField",void 0),(0,s._)([(0,l.MZ)()],I.prototype,"layerList",void 0),(0,s._)([(0,l.MZ)()],I.prototype,"messages",void 0),(0,s._)([(0,l.MZ)()],I.prototype,"onDataCaptureLayerChanged",void 0),(0,s._)([(0,l.MZ)()],I.prototype,"onImageOverlaysClosed",void 0),(0,s._)([(0,l.MZ)()],I.prototype,"onLayerDeselected",void 0),(0,s._)([(0,l.MZ)()],I.prototype,"onLayerSelected",void 0),(0,s._)([(0,l.MZ)()],I.prototype,"onShowCameraLocationsChanged",void 0),(0,s._)([(0,l.MZ)()],I.prototype,"onShowMapFeaturesChanged",void 0),(0,s._)([(0,l.MZ)()],I.prototype,"overlayedLayers",void 0),(0,s._)([(0,l.MZ)()],I.prototype,"showCameraLocations",void 0),(0,s._)([(0,l.MZ)()],I.prototype,"showMapFeatures",void 0),(0,s._)([(0,l.MZ)()],I.prototype,"view",null),I=(0,s._)([(0,n.$)("esri.widgets.OrientedImageryViewer.components.ImageOverlays")],I);const F=I}}]);