"use strict";(self.webpackChunkever_wading_birds=self.webpackChunkever_wading_birds||[]).push([[10346],{10346:(e,n,r)=>{r.r(n),r.d(n,{getTemplates:()=>R});var t=r(74719),i=r(35377),a=r(53957),o=r(43579);async function s(e){const{layer:n,renderer:r}=e;await n.load();const i=r??("renderer"in n?n.renderer:void 0);if("class-breaks"!==i?.type)throw new t.default("class-breaks-popup:invalid-parameters","renderer.type must be 'class-breaks'");return{layer:n,renderer:i}}async function l(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"divide";const{fieldInfos:t,expressionInfos:a}=await(0,o.Xj)({renderer:e,layer:n,normFieldExpressionTemplate:r});return new i.default({content:await(0,o.Lb)(n,{fieldInfos:t,expressionInfos:a}),fieldInfos:t,expressionInfos:a})}var f=r(56488),d=r(26964),p=r(43943);async function u(e){const{layer:n,renderer:r}=e;await n.load();const i=r??("renderer"in n?n.renderer:void 0);if("dot-density"!==i?.type)throw new t.default("dot-density-popup:invalid-parameters","renderer.type must be 'dot-density'");return{layer:n,renderer:i}}async function m(e,n){const{fieldInfos:r,expressionInfos:t}=await(0,o.Xj)({renderer:e,layer:n});return new i.default({content:await(0,o.Lb)(n,{fieldInfos:r,expressionInfos:t}),expressionInfos:t,fieldInfos:r})}async function c(e,n,r){const{fieldInfos:t,expressionInfos:a}=await(0,o.Xj)({renderer:e,layer:n}),s=t.filter((e=>!e.fieldName?.includes(o.bF))),l={fieldInfo:new d.default({fieldName:"expression/dot-density-categories-list"}),expressionInfo:new f.default({name:"dot-density-categories-list",title:r.listOfCategories,expression:(0,p.getArcadeForOrderedFields)(s,a)})},u=new i.default({expressionInfos:[l.expressionInfo],fieldInfos:[l.fieldInfo],title:r.competingFields,content:`{${l.fieldInfo.fieldName}}`});return{name:"dot-density-categories-list",title:r.orderedListOfValues,value:u}}async function y(e,n,r){const{fieldInfos:t,expressionInfos:a}=await(0,o.Xj)({renderer:e,layer:n}),s=t.filter((e=>!e.fieldName?.includes(o.bF))),l={fieldInfo:new d.default({fieldName:"expression/dot-density-category"}),expressionInfo:new f.default({name:"dot-density-category",title:r.predominantCategory,expression:(0,p.getArcadeForPredominantCategoryAlias)(s,a)})},u=new i.default({expressionInfos:[l.expressionInfo,...a],fieldInfos:[l.fieldInfo,...t],content:[{type:"text",text:`<div><b><font size="3">{${l.fieldInfo.fieldName}}</font></b></div>`},{type:"media",mediaInfos:{type:"pie-chart",title:r.competingFields,value:{fields:t.map((e=>e.fieldName))}}}]});return{name:"dot-density-category-chart",title:r.predominantCategoryWithChart,value:u}}async function I(e){const[{renderer:n,layer:r},t]=await Promise.all([u(e),(0,a.ud)("esri/smartMapping/t9n/smartMapping")]);return{primaryTemplate:{name:"dot-density",title:t.dotDensity,value:await m(n,r)},secondaryTemplates:[await c(n,r,t),await y(n,r,t)]}}async function g(e){const{layer:n,renderer:r}=e;await n.load();const i=r??("renderer"in n?n.renderer:void 0);if("heatmap"!==i?.type)throw new t.default("heatmap-popup:invalid-parameters","renderer.type must be 'heatmap'");return{layer:n,renderer:i}}var x=r(99961),w=r(67823);function b(e,n){return e.legendOptions?.title??n.competingFields}function v(e,n){return{fieldInfo:new d.default({fieldName:"expression/predominant-category"}),expressionInfo:new f.default({name:"predominant-category",title:n.predominantCategory,expression:(0,p.getArcadeForPredominantCategoryAlias)(e)})}}function h(e,n){const r=(0,p.fieldNamesFromFieldInfos)(e);return{fieldInfo:new d.default({fieldName:"expression/predominant-value",format:new w.default({digitSeparator:!0,places:1})}),expressionInfo:new f.default({name:"predominant-value",title:n.predominantCategoryValue,expression:(0,p.getArcadeForPredominantCategoryValue)(r),returnType:"number"})}}function F(e,n){const r=(0,p.fieldNamesFromFieldInfos)(e);return{fieldInfo:new d.default({fieldName:"expression/predominant-strength",format:new w.default({digitSeparator:!0,places:0})}),expressionInfo:new f.default({name:"predominant-strength",title:n.strengthOfPredominance,expression:(0,p.getArcadeForStrengthOfPredominance)(r),returnType:"number"})}}function N(e,n){const r=v(e.fieldInfos,n),t=new i.default({expressionInfos:[r.expressionInfo],fieldInfos:[r.fieldInfo],content:(0,x.V)(n.predominantCategoryContent,{expression:`<b>{${r.fieldInfo.fieldName}}</b>`})});return{name:"predominant-category",title:n.predominantCategory,value:t}}function T(e,n){const{fieldInfos:r}=e,t=v(r,n),a=h(r,n),o=new i.default({expressionInfos:[a.expressionInfo,t.expressionInfo],fieldInfos:[a.fieldInfo,t.fieldInfo],content:(0,x.V)(n.predominantCategoryValueContent,{expression1:`<b>{${t.fieldInfo.fieldName}}</b>`,expression2:`<b>{${a.fieldInfo.fieldName}}</b>`})});return{name:"predominant-category-value",title:n.predominantCategoryValue,value:o}}function $(e,n){const{fieldInfos:r}=e,t=v(r,n),a=h(r,n),o=function(e,n){const r=(0,p.fieldNamesFromFieldInfos)(e);return{fieldInfo:new d.default({fieldName:"expression/predominant-margin",format:new w.default({digitSeparator:!0,places:0})}),expressionInfo:new f.default({name:"predominant-margin",title:n.marginOfVictory,expression:(0,p.getArcadeForPredominanceMargin)(r),returnType:"number"})}}(r,n),s=new i.default({expressionInfos:[a.expressionInfo,t.expressionInfo,o.expressionInfo],fieldInfos:[a.fieldInfo,t.fieldInfo,o.fieldInfo],title:(0,x.V)(n.mostCommon,{expression:"{expression/predominant-category}"}),content:(0,x.V)(n.predominantCategoryValueMarginContent,{expression1:`<b>{${t.fieldInfo.fieldName}}</b>`,expression2:`<b>{${a.fieldInfo.fieldName}}</b>`,expression3:`<b>{${o.fieldInfo.fieldName}}</b>`})});return{name:"predominant-category-value-margin",title:n.marginOfVictory,value:s}}function C(e,n){const{fieldInfos:r}=e,t=v(r,n),a=h(r,n),o=F(r,n),s=new i.default({expressionInfos:[a.expressionInfo,t.expressionInfo,o.expressionInfo],fieldInfos:[a.fieldInfo,t.fieldInfo,o.fieldInfo],content:(0,x.V)(n.predominantCategoryStrengthContent,{expression1:`{${a.fieldInfo.fieldName}}`,expression2:`<b>{${t.fieldInfo.fieldName}}</b>`,expression3:`<b>{${o.fieldInfo.fieldName}}%</b>`})});return{name:"predominant-category-strength",title:n.strengthOfPredominance,value:s}}function V(e,n){const{renderer:r,fieldInfos:t}=e,a=v(t,n),o=h(t,n),s=F(t,n),l=function(e,n){return{fieldInfo:new d.default({fieldName:"expression/predominant-categories-list"}),expressionInfo:new f.default({name:"predominant-categories-list",title:n.listOfCategories,expression:(0,p.getArcadeForOrderedFields)(e)})}}(t,n),u=new i.default({expressionInfos:[a.expressionInfo,o.expressionInfo,s.expressionInfo,l.expressionInfo],fieldInfos:[a.fieldInfo,o.fieldInfo,s.fieldInfo,l.fieldInfo],title:b(r,n),content:[{type:"text",text:(0,x.V)(n.predominantCategoryStrengthContent,{expression1:`{${o.fieldInfo.fieldName}}`,expression2:`<b>{${a.fieldInfo.fieldName}}</b>`,expression3:`<b>{${s.fieldInfo.fieldName}}%</b>`})},{type:"text",text:`{${l.fieldInfo.fieldName}}`}]});return{name:"predominant-categories-list",title:n.orderedListOfValues,value:u}}function M(e,n){const{fieldInfos:r}=e,t=v(r,n),a=h(r,n),o=F(r,n),s=function(e,n){const r=(0,p.fieldNamesFromFieldInfos)(e);return{fieldInfo:new d.default({fieldName:"expression/predominant-total",format:new w.default({digitSeparator:!0,places:0})}),expressionInfo:new f.default({name:"predominant-total",title:n.sumOfCategories,expression:(0,p.getArcadeForSumOfFields)(r),returnType:"number"})}}(r,n),l=new i.default({expressionInfos:[a.expressionInfo,t.expressionInfo,s.expressionInfo,o.expressionInfo],fieldInfos:[a.fieldInfo,t.fieldInfo,s.fieldInfo,o.fieldInfo],content:(0,x.V)(n.predominantCategoryTotalStrengthContent,{expression1:`{${a.fieldInfo.fieldName}}`,expression2:`<b>{${t.fieldInfo.fieldName}}</b>`,expression3:`<b>{${o.fieldInfo.fieldName}}%</b>`,expression4:`{${s.fieldInfo.fieldName}}`})});return{name:"predominant-category-total-strength",title:n.predominantCategoryWithTotalAndStrength,value:l}}function P(e,n){const{renderer:r,fieldInfos:t}=e,a=v(t,n),o=h(t,n),s=F(t,n),l=new i.default({expressionInfos:[o.expressionInfo,a.expressionInfo,s.expressionInfo],fieldInfos:[o.fieldInfo,a.fieldInfo,s.fieldInfo],title:b(r,n),content:[{type:"text",text:(0,x.V)(n.predominantCategoryStrengthContent,{expression1:`{${o.fieldInfo.fieldName}}`,expression2:`<b>{${a.fieldInfo.fieldName}}</b>`,expression3:`<b>{${s.fieldInfo.fieldName}}%</b>`})},{type:"media",mediaInfos:{type:"pie-chart",value:{fields:t.map((e=>e.fieldName))}}}]});return{name:"predominant-category-chart",title:n.predominantCategoryWithChart,value:l}}function A(e,n){const r=e.authoringInfo,i="predominance"===r?.type?r.fields:[];if(!i?.length)throw new t.default("predominance-popup:insufficient-info","unable to find input fields in authoringInfo");return i.map((e=>(0,o.lm)(n,e)))}async function S(e){const{layer:n,renderer:r}=e;await n.load();const i=r??("renderer"in n?n.renderer:void 0);if("unique-value"!==i?.type)throw new t.default("predominance-popup:invalid-parameters","renderer.type must be 'unique-value'");return{renderer:i,fieldInfos:A(i,n)}}async function L(e){const[n,r]=await Promise.all([S(e),(0,a.ud)("esri/smartMapping/t9n/smartMapping")]),t=V(n,r),i=await async function(e){const[n,r]=await Promise.all([S(e),(0,a.ud)("esri/smartMapping/t9n/smartMapping")]);return[N(n,r),T(n,r),$(n,r),M(n,r),V(n,r),C(n,r),P(n,r)]}(e);return{primaryTemplate:t,secondaryTemplates:i.filter((e=>e.name!==t.name))}}async function O(e){const{layer:n,renderer:r}=e;await n.load();const i=r??("renderer"in n?n.renderer:void 0);if("unique-value"!==i?.type)throw new t.default("relationship-popup:invalid-parameters","renderer.type must be 'unique-value'");const a=i.authoringInfo;if(!a||"relationship"!==a.type)throw new t.default("relationship-popup:invalid-parameters","renderer.authoringInfo.type must be 'relationship'");if(!a.field1?.field||!a.field2?.field)throw new t.default("relationship-popup:invalid-parameters","'field1' and/or 'field2' properties are missing in renderer.authoringInfo");return{layer:n,renderer:i}}async function k(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"divide";const{fieldInfos:t,expressionInfos:a}=await(0,o.Xj)({renderer:e,layer:n,normFieldExpressionTemplate:r});return new i.default({content:await(0,o.Lb)(n,{fieldInfos:t,expressionInfos:a}),fieldInfos:t,expressionInfos:a})}var q=r(1802);async function z(e){const{layer:n,renderer:r}=e;await n.load();const i=r??("renderer"in n?n.renderer:void 0);if("simple"!==i?.type)throw new t.default("simple-popup:invalid-parameters","renderer.type must be 'simple'");return{layer:n,renderer:i}}async function j(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"divide";const{fieldInfos:t,expressionInfos:a}=await(0,o.Xj)({renderer:e,layer:n,normFieldExpressionTemplate:r});return new i.default({content:await(0,o.Lb)(n,{fieldInfos:t,expressionInfos:a}),expressionInfos:a,fieldInfos:t})}async function X(e){const{layer:n,renderer:r}=e;await n.load();const i=r??("renderer"in n?n.renderer:void 0);if("unique-value"!==i?.type)throw new t.default("unique-values-popup:invalid-parameters","renderer.type must be 'unique-value'");return{layer:n,renderer:i}}async function E(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"divide";const{fieldInfos:t,expressionInfos:a}=await(0,o.Xj)({renderer:e,layer:n,normFieldExpressionTemplate:r});return new i.default({content:await(0,o.Lb)(n,{fieldInfos:t,expressionInfos:a}),fieldInfos:t,expressionInfos:a})}async function R(e){const{renderer:n,layer:r}=function(e){const{layer:n}=e,r=e.renderer??("renderer"in n?n.renderer:void 0);if(!r)throw new t.default("getTemplates:invalid-parameters","'renderer' or 'layer.renderer' must be provided");return{layer:n,renderer:r}}(e);if(!n)return null;if("simple"===n.type)return async function(e){const[{renderer:n,layer:r},t]=await Promise.all([z(e),(0,a.ud)("esri/smartMapping/t9n/smartMapping")]),i=[];if(!(0,o.G2)(n).length){const e=(0,q.createPopupTemplate)(r);return e?{primaryTemplate:{name:"simple",title:t.simple,value:e},secondaryTemplates:i}:null}const s={name:"simple",title:t.simple,value:await j(n,r)};return(0,o.gS)(n)&&i.push({name:"simple-percent",title:t.simpleNormFieldAsPercent,value:await j(n,r,"percentage")}),{primaryTemplate:s,secondaryTemplates:i}}({renderer:n,layer:r});if("class-breaks"===n.type)return async function(e){const[{renderer:n,layer:r},t]=await Promise.all([s(e),(0,a.ud)("esri/smartMapping/t9n/smartMapping")]),i={name:"class-breaks",title:t.classBreaks,value:await l(n,r)},f=[];return(0,o.gS)(n)&&f.push({name:"class-breaks-percent",title:t.classBreaksNormFieldAsPercent,value:await l(n,r,"percentage")}),{primaryTemplate:i,secondaryTemplates:f}}({renderer:n,layer:r});if("dot-density"===n.type)return I({renderer:n,layer:r});if("heatmap"===n.type)return async function(e){const[{renderer:n,layer:r},t]=await Promise.all([g(e),(0,a.ud)("esri/smartMapping/t9n/smartMapping")]);if(!n.field)return null;const{fieldInfos:s}=await(0,o.Xj)({renderer:n,layer:r}),l=new i.default({content:await(0,o.Lb)(r,{fieldInfos:s}),fieldInfos:s});return{primaryTemplate:{name:"heatmap",title:t.heatmap,value:l},secondaryTemplates:[]}}({renderer:n,layer:r});if("unique-value"===n.type){const e=n.authoringInfo?.type;return"predominance"===e?L({renderer:n,layer:r}):"relationship"===e?async function(e){const[{renderer:n,layer:r},t]=await Promise.all([O(e),(0,a.ud)("esri/smartMapping/t9n/smartMapping")]),i={name:"relationship",title:t.relationshipPopupTitle,value:await k(n,r)},o=[];return function(e){const n=e.authoringInfo;return!(!n?.field1?.normalizationField&&!n?.field2?.normalizationField)}(n)&&o.push({name:"relationship-percent",title:t.relationshipNormFieldAsPercent,value:await k(n,r,"percentage")}),{primaryTemplate:i,secondaryTemplates:o}}({renderer:n,layer:r}):async function(e){const[{renderer:n,layer:r},t]=await Promise.all([X(e),(0,a.ud)("esri/smartMapping/t9n/smartMapping")]),i={name:"unique-values",title:t.uniqueValues,value:await E(n,r)},s=[];return(0,o.gS)(n)&&s.push({name:"unique-values-percent",title:t.uniqueValuesNormFieldAsPercent,value:await E(n,r,"percentage")}),{primaryTemplate:i,secondaryTemplates:s}}({renderer:n,layer:r})}return null}},43579:(e,n,r)=>{r.d(n,{G2:()=>g,Lb:()=>F,Xj:()=>h,bF:()=>I,gS:()=>N,lm:()=>w});var t=r(62631),i=(r(21265),r(53957)),a=r(99961),o=r(95011),s=(r(76519),r(62155),r(83014),r(23621),r(45608)),l=(r(36917),r(19609),r(7282)),f=(r(12969),r(56488)),d=r(26964),p=r(67823),u=r(88171),m=r(71237),c=r(66809);let y=0;const I="expression/";function g(e){return"hasVisualVariables"in e&&e.hasVisualVariables()?e.visualVariables.filter((e=>!m.viewScaleRE.test(e.valueExpression)&&(!("target"in e)||"outline"!==e.target))):[]}function x(e,n){if(!n)return null;const r=(0,c.Rm)(e);return r?.find((e=>e.name.toLowerCase()===n.toLowerCase()))}function w(e,n,r){let t=null;if(r&&"featureReduction"in e){const n=e.featureReduction;n&&"popupTemplate"in n&&n.popupTemplate&&(t=n.popupTemplate.fieldInfos)}else"popupTemplate"in e&&e.popupTemplate&&(t=e.popupTemplate.fieldInfos);const i=r?x(e,n):e.getField(n);let a=null;if(t&&t.some((e=>!(!e||e.fieldName?.toLowerCase()!==i?.name.toLowerCase())&&(a=e.clone(),!0))),!a){const e=o.numericTypes.includes(i.type),n="integer"===i.type||"small-integer"===i.type;a=new d.default({fieldName:i.name,isEditable:i.editable,visible:!0,format:e?new p.default({places:n?0:2,digitSeparator:!0}):void 0})}return a.label||(a.label=i.alias),a}function b(e){const{expression:n,title:r,returnType:t}=e;return new f.default({name:"expr"+y++,expression:n,title:r,returnType:t})}function v(e){const n="number"===e.returnType?new p.default({places:2,digitSeparator:!0}):void 0;return new d.default({fieldName:`${I}${e.name}`,visible:!0,format:n})}async function h(e){const n=await(0,i.ud)("esri/smartMapping/t9n/smartMapping"),{renderer:r,layer:o,normFieldExpressionTemplate:s,isFeatureReduction:l}=e,f=[],d=[],p=(0,u.getAttributes)(r,g);for(const t of p)if("field"===t.type)f.push(w(o,t.field,l));else if("normalized-field"===t.type){const e=l?x(o,t.field):o.getField(t.field),r=l?x(o,t.normalizationField):o.getField(t.normalizationField),i=b({type:"expression",expression:`\n      $feature["${e.name}"];\n      $feature["${r.name}"];\n      ${"percentage"===s?`($feature["${e.name}"] / $feature["${r.name}"]) * 100;`:`$feature["${e.name}"] / $feature["${r.name}"];`}\n      `,title:(0,a.V)("percentage"===s?n.normFieldLabelAsPercent:n.normFieldLabel,{expression1:e.alias,expression2:r.alias}),returnType:"number"});f.push(v(i),w(o,t.field,l),w(o,t.normalizationField,l)),d.push(i)}else if("expression"===t.type){const e=b(t);f.push(v(e)),d.push(e)}return{fieldInfos:(0,t.Am)(f,((e,n)=>e.fieldName===n.fieldName)),expressionInfos:(0,t.Am)(d,((e,n)=>e.expression===n.expression))}}async function F(e,n,r){const{fieldInfos:t,expressionInfos:o}=n,f=await(0,i.ud)("esri/smartMapping/t9n/smartMapping");if(t.length>2)return[new s.default({fieldInfos:t})];const d=[];for(const i of t){const n=i.fieldName||"";let t=i.label;if(!t){const i=r?x(e,n):e.getField(n);if(i)t=i.alias||n;else if(o){const e=n.split(I)[1],r=o[o.findIndex((n=>n.name===e))];r&&(t=r.title||r.name)}}d.push(new l.default({text:(0,a.V)(f.fieldInfo,{fieldLabel:t,fieldValue:`{${n}}`})}))}return d}function N(e){return!(!("normalizationField"in e)||!e.normalizationField)||"hasVisualVariables"in e&&e.hasVisualVariables()&&e.visualVariables.some((e=>!(!("normalizationField"in e)||!e.normalizationField)))}}}]);