"use strict";(self.webpackChunkever_wading_birds=self.webpackChunkever_wading_birds||[]).push([[35377],{1277:(e,t,i)=>{i.d(t,{C:()=>c,Cr:()=>d,H6:()=>x,LV:()=>h,_I:()=>v,dz:()=>m,fA:()=>p,kb:()=>u,ld:()=>g,sd:()=>y,vt:()=>l});var r=i(64682),n=i(32636),o=i(89227),s=i(28473),a=i(1696);function l(e){return e?{origin:(0,s.o8)(e.origin),vector:(0,s.o8)(e.vector)}:{origin:(0,s.vt)(),vector:(0,s.vt)()}}function h(e,t){const i=b.get();return i.origin=e,i.vector=t,i}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l();return p(e.origin,e.vector,t)}function p(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l();return(0,o.c)(i.origin,e),(0,o.c)(i.vector,t),i}function d(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l();return(0,o.c)(i.origin,e),(0,o.d)(i.vector,t,e),i}function u(e,t){const i=(0,o.d)(a.rq.get(),t,e.origin),n=(0,o.f)(e.vector,i),s=(0,o.f)(e.vector,e.vector),l=(0,r.qE)(n/s,0,1),h=(0,o.d)(a.rq.get(),(0,o.h)(a.rq.get(),e.vector,l),i);return(0,o.f)(h,h)}function v(e,t,i){return x(e,t,0,1,i)}function y(e,t,i){return(0,o.g)(i,e.origin,(0,o.h)(i,e.vector,t))}function x(e,t,i,n,s){const{vector:l,origin:h}=e,c=(0,o.d)(a.rq.get(),t,h),p=(0,o.f)(l,c)/(0,o.k)(l);return(0,o.h)(s,l,(0,r.qE)(p,i,n)),(0,o.g)(s,s,e.origin)}function m(e,t){if(f(e,h(t.origin,t.direction),!1,_)){const{tA:t,pB:i,distance2:r}=_;if(t>=0&&t<=1)return r;if(t<0)return(0,o.s)(e.origin,i);if(t>1)return(0,o.s)((0,o.g)(a.rq.get(),e.origin,e.vector),i)}return null}function g(e,t,i){return!!f(e,t,!0,_)&&((0,o.c)(i,_.pA),!0)}function f(e,t,i,n){const s=1e-6,l=e.origin,h=(0,o.g)(a.rq.get(),l,e.vector),c=t.origin,p=(0,o.g)(a.rq.get(),c,t.vector),d=a.rq.get(),u=a.rq.get();if(d[0]=l[0]-c[0],d[1]=l[1]-c[1],d[2]=l[2]-c[2],u[0]=p[0]-c[0],u[1]=p[1]-c[1],u[2]=p[2]-c[2],Math.abs(u[0])<s&&Math.abs(u[1])<s&&Math.abs(u[2])<s)return!1;const v=a.rq.get();if(v[0]=h[0]-l[0],v[1]=h[1]-l[1],v[2]=h[2]-l[2],Math.abs(v[0])<s&&Math.abs(v[1])<s&&Math.abs(v[2])<s)return!1;const y=d[0]*u[0]+d[1]*u[1]+d[2]*u[2],x=u[0]*v[0]+u[1]*v[1]+u[2]*v[2],m=d[0]*v[0]+d[1]*v[1]+d[2]*v[2],g=u[0]*u[0]+u[1]*u[1]+u[2]*u[2],f=(v[0]*v[0]+v[1]*v[1]+v[2]*v[2])*g-x*x;if(Math.abs(f)<s)return!1;let _=(y*x-m*g)/f,b=(y+x*_)/g;i&&(_=(0,r.qE)(_,0,1),b=(0,r.qE)(b,0,1));const M=a.rq.get(),w=a.rq.get();return M[0]=l[0]+_*v[0],M[1]=l[1]+_*v[1],M[2]=l[2]+_*v[2],w[0]=c[0]+b*u[0],w[1]=c[1]+b*u[1],w[2]=c[2]+b*u[2],n.tA=_,n.tB=b,n.pA=M,n.pB=w,n.distance2=(0,o.s)(M,w),!0}const _={tA:0,tB:0,pA:(0,s.vt)(),pB:(0,s.vt)(),distance2:0},b=new n.I((()=>l()))},8374:(e,t,i)=>{function r(e,t,i){i=i||2;var r,o,a,l,h,c,d,u=t&&t.length,v=u?t[0]*i:e.length,y=n(e,0,v,i,!0),x=[];if(!y||y.next===y.prev)return x;if(u&&(y=p(e,t,y,i)),e.length>80*i){r=a=e[0],o=l=e[1];for(var m=i;m<v;m+=i)(h=e[m])<r&&(r=h),(c=e[m+1])<o&&(o=c),h>a&&(a=h),c>l&&(l=c);d=0!==(d=Math.max(a-r,l-o))?1/d:0}return s(y,x,i,r,o,d),x}function n(e,t,i,r,n){var o,s;if(n===E(e,t,i,r)>0)for(o=t;o<i;o+=r)s=C(o,e[o],e[o+1],s);else for(o=i-r;o>=t;o-=r)s=C(o,e[o],e[o+1],s);if(s&&M(s,s.next)){var a=s.next;k(s),s=a}return s}function o(e,t){if(!e)return e;t||(t=e);var i,r=e;do{if(i=!1,r.steiner||!M(r,r.next)&&0!==b(r.prev,r,r.next))r=r.next;else{var n=r.prev;if(k(r),(r=t=n)===r.next)break;i=!0}}while(i||r!==t);return t}function s(e,t,i,r,n,p,d){if(e){!d&&p&&x(e,r,n,p);for(var u,v,y=e;e.prev!==e.next;)if(u=e.prev,v=e.next,p?l(e,r,n,p):a(e))t.push(u.i/i),t.push(e.i/i),t.push(v.i/i),k(e),e=v.next,y=v.next;else if((e=v)===y){d?1===d?s(e=h(o(e),t,i),t,i,r,n,p,2):2===d&&c(e,t,i,r,n,p):s(o(e),t,i,r,n,p,1);break}}}function a(e){var t=e.prev,i=e,r=e.next;if(b(t,i,r)>=0)return!1;for(var n=e.next.next;n!==e.prev;){if(f(t.x,t.y,i.x,i.y,r.x,r.y,n.x,n.y)&&b(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function l(e,t,i,r){var n=e.prev,o=e,s=e.next;if(b(n,o,s)>=0)return!1;for(var a=n.x<o.x?n.x<s.x?n.x:s.x:o.x<s.x?o.x:s.x,l=n.y<o.y?n.y<s.y?n.y:s.y:o.y<s.y?o.y:s.y,h=n.x>o.x?n.x>s.x?n.x:s.x:o.x>s.x?o.x:s.x,c=n.y>o.y?n.y>s.y?n.y:s.y:o.y>s.y?o.y:s.y,p=m(a,l,t,i,r),d=m(h,c,t,i,r),u=e.prevZ,v=e.nextZ;u&&u.z>=p&&v&&v.z<=d;){if(u!==e.prev&&u!==e.next&&f(n.x,n.y,o.x,o.y,s.x,s.y,u.x,u.y)&&b(u.prev,u,u.next)>=0)return!1;if(u=u.prevZ,v!==e.prev&&v!==e.next&&f(n.x,n.y,o.x,o.y,s.x,s.y,v.x,v.y)&&b(v.prev,v,v.next)>=0)return!1;v=v.nextZ}for(;u&&u.z>=p;){if(u!==e.prev&&u!==e.next&&f(n.x,n.y,o.x,o.y,s.x,s.y,u.x,u.y)&&b(u.prev,u,u.next)>=0)return!1;u=u.prevZ}for(;v&&v.z<=d;){if(v!==e.prev&&v!==e.next&&f(n.x,n.y,o.x,o.y,s.x,s.y,v.x,v.y)&&b(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function h(e,t,i){var r=e;do{var n=r.prev,s=r.next.next;!M(n,s)&&w(n,r,r.next,s)&&V(n,s)&&V(s,n)&&(t.push(n.i/i),t.push(r.i/i),t.push(s.i/i),k(r),k(r.next),r=e=s),r=r.next}while(r!==e);return o(r)}function c(e,t,i,r,n,a){var l=e;do{for(var h=l.next.next;h!==l.prev;){if(l.i!==h.i&&_(l,h)){var c=I(l,h);return l=o(l,l.next),c=o(c,c.next),s(l,t,i,r,n,a),void s(c,t,i,r,n,a)}h=h.next}l=l.next}while(l!==e)}function p(e,t,i,r){var s,a,l,h=[];for(s=0,a=t.length;s<a;s++)(l=n(e,t[s]*r,s<a-1?t[s+1]*r:e.length,r,!1))===l.next&&(l.steiner=!0),h.push(g(l));for(h.sort(d),s=0;s<h.length;s++)i=o(i=v(h[s],i),i.next);return i}function d(e,t){return e.x-t.x}function u(e){if(e.next.prev===e)return e;let t=e;for(;;){const i=t.next;if(i.prev===t||i===t||i===e)break;t=i}return t}function v(e,t){var i=function(e,t){var i,r=t,n=e.x,o=e.y,s=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var a=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=n&&a>s){if(s=a,a===n){if(o===r.y)return r;if(o===r.next.y)return r.next}i=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!i)return null;if(n===s)return i;var l,h=i,c=i.x,p=i.y,d=1/0;r=i;do{n>=r.x&&r.x>=c&&n!==r.x&&f(o<p?n:s,o,c,p,o<p?s:n,o,r.x,r.y)&&(l=Math.abs(o-r.y)/(n-r.x),V(r,e)&&(l<d||l===d&&(r.x>i.x||r.x===i.x&&y(i,r)))&&(i=r,d=l)),r=r.next}while(r!==h);return i}(e,t);if(!i)return t;var r=I(i,e),n=o(i,i.next);let s=u(r);return o(s,s.next),n=u(n),u(t===i?n:t)}function y(e,t){return b(e.prev,e,t.prev)<0&&b(t.next,e,e.next)<0}function x(e,t,i,r){var n=e;do{null===n.z&&(n.z=m(n.x,n.y,t,i,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,function(e){var t,i,r,n,o,s,a,l,h=1;do{for(i=e,e=null,o=null,s=0;i;){for(s++,r=i,a=0,t=0;t<h&&(a++,r=r.nextZ);t++);for(l=h;a>0||l>0&&r;)0!==a&&(0===l||!r||i.z<=r.z)?(n=i,i=i.nextZ,a--):(n=r,r=r.nextZ,l--),o?o.nextZ=n:e=n,n.prevZ=o,o=n;i=r}o.nextZ=null,h*=2}while(s>1)}(n)}function m(e,t,i,r,n){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*n)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*n)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function g(e){var t=e,i=e;do{(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next}while(t!==e);return i}function f(e,t,i,r,n,o,s,a){return(n-s)*(t-a)-(e-s)*(o-a)>=0&&(e-s)*(r-a)-(i-s)*(t-a)>=0&&(i-s)*(o-a)-(n-s)*(r-a)>=0}function _(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&w(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}(e,t)&&(V(e,t)&&V(t,e)&&function(e,t){var i=e,r=!1,n=(e.x+t.x)/2,o=(e.y+t.y)/2;do{i.y>o!=i.next.y>o&&i.next.y!==i.y&&n<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next}while(i!==e);return r}(e,t)&&(b(e.prev,e,t.prev)||b(e,t.prev,t))||M(e,t)&&b(e.prev,e,e.next)>0&&b(t.prev,t,t.next)>0)}function b(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function M(e,t){return e.x===t.x&&e.y===t.y}function w(e,t,i,r){var n=S(b(e,t,i)),o=S(b(e,t,r)),s=S(b(i,r,e)),a=S(b(i,r,t));return n!==o&&s!==a||!(0!==n||!G(e,i,t))||!(0!==o||!G(e,r,t))||!(0!==s||!G(i,e,r))||!(0!==a||!G(i,t,r))}function G(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function S(e){return e>0?1:e<0?-1:0}function V(e,t){return b(e.prev,e,e.next)<0?b(e,t,e.next)>=0&&b(e,e.prev,t)>=0:b(e,t,e.prev)<0||b(e,e.next,t)<0}function I(e,t){var i=new T(e.i,e.x,e.y),r=new T(t.i,t.x,t.y),n=e.next,o=t.prev;return e.next=t,t.prev=e,i.next=n,n.prev=i,r.next=i,i.prev=r,o.next=r,r.prev=o,r}function C(e,t,i,r){var n=new T(e,t,i);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function k(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function T(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function E(e,t,i,r){for(var n=0,o=t,s=i-r;o<i;o+=r)n+=(e[s]-e[o])*(e[o+1]+e[s+1]),s=o;return n}i.d(t,{e:()=>r}),r.deviation=function(e,t,i,r){var n=t&&t.length,o=n?t[0]*i:e.length,s=Math.abs(E(e,0,o,i));if(n)for(var a=0,l=t.length;a<l;a++){var h=t[a]*i,c=a<l-1?t[a+1]*i:e.length;s-=Math.abs(E(e,h,c,i))}var p=0;for(a=0;a<r.length;a+=3){var d=r[a]*i,u=r[a+1]*i,v=r[a+2]*i;p+=Math.abs((e[d]-e[v])*(e[u+1]-e[d+1])-(e[d]-e[u])*(e[v+1]-e[d+1]))}return 0===s&&0===p?0:Math.abs((p-s)/s)},r.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},r=0,n=0;n<e.length;n++){for(var o=0;o<e[n].length;o++)for(var s=0;s<t;s++)i.vertices.push(e[n][o][s]);n>0&&(r+=e[n-1].length,i.holes.push(r))}return i}},25253:(e,t,i)=>{i.r(t),i.d(t,{default:()=>ce});var r=i(93800),n=i(79625),o=i(58828),s=i(89129),a=i(74719),l=i(58448),h=i(50925),c=i(17741),p=i(79953),d=i(48602),u=(i(21265),i(14746),i(75269)),v=i(75400),y=i(54824),x=i(53053),m=i(70674),g=i(83031),f=i(51064),_=i(85675),b=i(79984),M=i(85525),w=i(68947),G=i(22093),S=i(42198),V=i(92143),I=i(16804),C=i(38412),k=i(83789),T=i(99431),E=i(53336),O=i(28454);let Z=class extends O.w{constructor(e){super(e),this.type="translate-vertex",this.distance=V.r7,this.elevation=null,this.area=null,this.totalLength=null}clear(){this.distance=V.r7,this.elevation=null,this.area=null,this.totalLength=null}};(0,r._)([(0,d.MZ)()],Z.prototype,"type",void 0),(0,r._)([(0,d.MZ)()],Z.prototype,"distance",void 0),(0,r._)([(0,d.MZ)()],Z.prototype,"elevation",void 0),(0,r._)([(0,d.MZ)()],Z.prototype,"area",void 0),(0,r._)([(0,d.MZ)()],Z.prototype,"totalLength",void 0),Z=(0,r._)([(0,u.$)("esri.views.interactive.tooltip.infos.TranslateVertexTooltipInfo")],Z);var R=i(6435),z=i(42050),P=i(36089);function A(e,t){function i(){const e=t(),i=e.sketchOptions.tooltips.effectiveEnabled?e.activeTooltipInfo:null;return{...e,activeTooltipInfo:i}}let r=!1;function n(e){r||(r=!0,e(),r=!1)}return(0,S.vE)([(0,p.watch)((()=>{const e=i();return{context:e,geometry:e.graphic?.geometry,vertexGeometry:e.selectedVertex?.geometry}}),(t=>{let{context:i}=t;n((()=>{(function(e){const t=e.activeTooltipInfo;if(t){switch(t?.type){case"move-point":return function(e,t){let{graphic:i}=t;H(e,i,i?.geometry)}(t,e);case"selected-vertex":return function(e,t){let{graphic:i,selectedVertex:r}=t;H(e,i,r?.geometry);const n=i?.geometry;switch(n?.type){case"polygon":e.geometryType="polygon",e.totalLength.visible=!1,e.area.actual=(0,R.n)(n);break;case"polyline":e.geometryType="polyline",e.totalLength.actual=(0,z.ob)(n),e.area.visible=!1}}(t,e)}t.sketchOptions=e.sketchOptions}})(i),e.info=i.activeTooltipInfo}))}),p.syncAndInitial),(0,p.watch)((()=>{const e=i(),{activeTooltipInfo:t}=e;if(t&&"key"in t)return{context:e,key:t.key}}),((e,t)=>{e&&t&&e.key!==t.key&&n((()=>L(e.context)))}),p.sync),(0,C.sZ)(e,{onBeforePaste:()=>{r=!0},onAfterPaste:()=>{L(i()),r=!1}})])}function H(e,t,i){t&&"point"===i?.type&&(e.setLocationFromPoint(i),e.elevation.actual=(0,P.Of)(i),e.elevation.visible=!!t.geometry?.hasZ,e.elevation.readOnly=!1,e.elevation.showAsZ=!0)}function L(e){function t(t,i){const r=i?.geometry;if(!r||"point"!==r.type)return;const{dx:n,dy:o,dz:s}=(0,C.mu)(t,r);if(0===n&&0===o&&0===s)return;const{x:a,y:l,z:h,m:c,spatialReference:p}=r,d=new v.default({x:a+n,y:l+o,z:null!=h?h+s:void 0,m:c,spatialReference:p});e.updateGeometry(i,d,r,n,o)}const{activeTooltipInfo:i,graphic:r,selectedVertex:n}=e;switch(i?.type){case"move-point":return t(i,r);case"selected-vertex":return t(i,n)}}function F(e,t,i){if(!i)return;const{x:r,y:n}=i.origin,o=t.toMap(i),s=t.toMap((0,I.tc)(r,n)),a=(0,z.Kt)(s,o);e.distance=null!=a?a:V.r7}var U=i(87714),q=i(51232),D=i(50337),B=i(4542),$=i(30124),K=i(91690),N=i(68263);class Q{constructor(e,t,i){this.graphic=e,this.mover=t,this.selected=i,this.type="reshape-start"}}class X{constructor(e,t,i){this.graphic=e,this.mover=t,this.selected=i,this.type="reshape"}}class Y{constructor(e,t,i){this.graphic=e,this.mover=t,this.selected=i,this.type="reshape-stop"}}class j{constructor(e,t,i){this.mover=e,this.dx=t,this.dy=i,this.type="move-start"}}class J{constructor(e,t,i){this.mover=e,this.dx=t,this.dy=i,this.type="move"}}class W{constructor(e,t,i){this.mover=e,this.dx=t,this.dy=i,this.type="move-stop"}}class ee{constructor(e){this.added=e,this.type="vertex-select"}}class te{constructor(e){this.removed=e,this.type="vertex-deselect"}}class ie{constructor(e,t,i,r){this.added=e,this.graphic=t,this.oldGraphic=i,this.vertices=r,this.type="vertex-add"}}class re{constructor(e,t,i,r){this.removed=e,this.graphic=t,this.oldGraphic=i,this.vertices=r,this.type="vertex-remove"}}const ne=U.W.reshapeGraphics,oe={vertices:{default:new g.default({style:"circle",size:ne.vertex.size,color:ne.vertex.color,outline:{color:ne.vertex.outlineColor,width:1}}),hover:new g.default({style:"circle",size:ne.vertex.hoverSize,color:ne.vertex.hoverColor,outline:{color:ne.vertex.hoverOutlineColor,width:1}}),selected:new g.default({style:"circle",size:ne.selected.size,color:ne.selected.color,outline:{color:ne.selected.outlineColor,width:1}})},midpoints:{default:new g.default({style:"circle",size:ne.midpoint.size,color:ne.midpoint.color,outline:{color:ne.midpoint.outlineColor,width:1}}),hover:new g.default({style:"circle",size:ne.midpoint.size,color:ne.midpoint.color,outline:{color:ne.midpoint.outlineColor,width:1}})}};let se=class extends l.A.EventedAccessor{constructor(e){super(e),this._updateHandlesOnExternalGeometryChange=null,this._activeOperationInfo=null,this._editGeometryOperations=null,this._graphicAttributes={esriSketchTool:"box"},this._mover=null,this._snappingContext=null,this._snappingGraphicsLayer=null,this._hoverGraphic=null,this._snappingTask=null,this._stagedVertex=null,this.tooltip=null,this.activeTooltipInfo=null,this.callbacks={onReshapeStart(){},onReshape(){},onReshapeStop(){},onMoveStart(){},onMove(){},onMoveStop(){},onGraphicClick(){}},this.enableMidpoints=!0,this.enableMovement=!0,this.enableVertices=!0,this.graphic=null,this.layer=null,this.midpointGraphics=new s.default,this.midpointSymbol=new g.default({style:"circle",size:6,color:[200,200,200],outline:{color:[100,100,100],width:1}}),this.selectedVertices=new s.default,this.snappingManager=null,this.symbols=oe,this.sketchOptions=new K.A,this.type="reshape",this.vertexGraphics=new s.default,this.view=null}initialize(){const e=this.view;this._highlightHelper=new w.A({view:e}),this._setup(),this._updateHandlesOnExternalGeometryChange=(0,p.pausable)((()=>this.graphic?.geometry),(e=>{if(!e)return;const t=new Set(this.selectedVertices.map((e=>e.attributes?.pointIndex)));this._highlightHelper.removeAll(),this._setUpHighlights(),this._setupGraphics(),this._clearSelection(),this.vertexGraphics.filter((e=>t.has(e.attributes.pointIndex))).forEach((e=>this._addToSelection(e)));const{enableMovement:i,_mover:r,graphic:n,midpointGraphics:o,vertexGraphics:s}=this,a=s.concat(o).items;i&&a.push(n),r?.set("graphics",a)}),p.sync),this.tooltip=(0,C.A)((()=>({view:e,options:this.sketchOptions.tooltips}))),this.tooltipInfos=function(e){const t={sketchOptions:e,viewType:"2d"};return{movePoint:new k.F(t),selectedVertex:new T.d(t),translateGraphic:new E.M(t),translateVertices:new Z(t)}}(this.sketchOptions),this.addHandles([(0,p.when)((()=>e?.ready),(()=>{const{layer:e,view:t}=this;(0,G.Y)(t,e),this.addHandles(t.on("key-down",(e=>this._keyDownHandler(e)),q.o.TOOL))}),{once:!0,initial:!0}),(0,p.watch)((()=>this.graphic),(()=>this.refresh())),(0,p.watch)((()=>this.layer),((e,t)=>{t&&(this._clearSelection(),this._resetGraphics(t)),this.refresh()})),(0,p.watch)((()=>this.enableMidpoints),(()=>this.refresh())),A(this.tooltip,(()=>this._tooltipsContext)),(0,p.watch)((()=>this.view.effectiveTheme.accentColor),(()=>this._updateSymbolsForTheme()),p.initial),this._updateHandlesOnExternalGeometryChange]),this._updateTooltip()}destroy(){this._reset(),this._mover?.destroy(),this._mover=null,this.tooltip=(0,c.pR)(this.tooltip)}get _coordinateHelper(){return this._editGeometryOperations?.data.coordinateHelper??(0,D.BV)(!!this.graphic.geometry?.hasZ,!!this.graphic.geometry?.hasM,this.view.spatialReference)}get _selectedVertex(){return 1===this.selectedVertices.length?this.selectedVertices.at(0):void 0}get _tooltipsContext(){return{sketchOptions:this.sketchOptions,activeTooltipInfo:this.activeTooltipInfo,graphic:this.graphic,selectedVertex:this._selectedVertex,updateGeometry:(e,t,i,r,n)=>{this._setUpGeometryHelper();const o=e===this.graphic;o?this._emitMoveStartEvent(0,0):this._emitReshapeStartEvent(e);if(this._syncGeometryAfterVertexMove(e,t,r,n,!0),o){const{view:e}=this,r=e.toScreen(i),n=e.toScreen(t),o=(n?.x??0)-(r?.x??0),s=(n?.y??0)-(r?.y??0);this._emitMoveEvent(o,s),this._emitMoveStopEvent(o,s)}else this._emitReshapeEvent(e),this._emitReshapeStopEvent(e);this._editGeometryOperations=(0,c.pR)(this._editGeometryOperations)}}}set highlightsEnabled(e){this._highlightHelper?.removeAll(),this._set("highlightsEnabled",e),this._setUpHighlights()}get state(){const e=this.view.ready,t=!(!this.graphic||!this.layer);return e&&t?"active":e?"ready":"disabled"}isUIGraphic(e){const t=[];return this.graphic&&t.push(this.graphic),t.concat(this.vertexGraphics.items,this.midpointGraphics.items),t.length>0&&t.includes(e)}refresh(){this._reset(),this._setup()}reset(){this.graphic=null}clearSelection(){this._clearSelection()}removeSelectedVertices(){const{selectedVertices:e}=this;e.length&&this._removeVertices(e)}_setup(){const{graphic:e,layer:t}=this;if(!t||null==e?.geometry)return;const i=e.geometry;"mesh"!==i.type&&"extent"!==i.type?("polygon"===i.type&&(0,x.uC)(i),this._setUpHighlights(),this._setupGraphics(),this._setupMover()):this._logGeometryTypeError()}_setUpHighlights(){this.highlightsEnabled&&this.graphic&&this._highlightHelper?.add(this.graphic)}_setUpGeometryHelper(){const e=this.graphic.geometry;if(null==e||"mesh"===e.type||"extent"===e.type)return void this._logGeometryTypeError();const t="multipoint"===e.type?new y.default({paths:[e.points],spatialReference:e.spatialReference}):e;this._editGeometryOperations=$.p.fromGeometry(t,f.RT.Local)}_saveSnappingContextForHandle(e,t){this._snappingGraphicsLayer=new m.default({listMode:"hide",internal:!0,title:"Reshape snapping layer"}),this.view.map.layers.add(this._snappingGraphicsLayer);const i=this._editGeometryOperations;(0,c.Lw)(i),this._snappingContext=new N.e({editGeometryOperations:i,elevationInfo:{mode:"on-the-ground",offset:0},pointer:t.viewEvent?.pointerType||"mouse",excludeFeature:this.graphic,feature:this.graphic,visualizer:new _.J(this._snappingGraphicsLayer),vertexHandle:this._getVertexFromEditGeometry(e)})}_reset(){this._clearSelection(),this._highlightHelper?.removeAll(),this._updateTooltip(),this._resetGraphics(),this._resetSnappingStateVars(),this._activeOperationInfo=null,this._mover&&this._mover.destroy(),this._mover=null,this.view.cursor="default"}_resetSnappingStateVars(){null!=this.snappingManager&&this.snappingManager.doneSnapping(),null!=this._snappingGraphicsLayer&&(this.view?.map&&this.view.map.layers.remove(this._snappingGraphicsLayer),this._snappingGraphicsLayer.destroy()),this._editGeometryOperations=(0,c.pR)(this._editGeometryOperations),this._snappingTask=(0,c.DC)(this._snappingTask),this._snappingTask=null,this._snappingContext=null,this._stagedVertex=null}_resetGraphics(e){this._removeMidpointGraphics(e),this._removeVertexGraphics(e),this.selectedVertices.removeAll(),this._updateTooltip()}_removeMidpointGraphics(e){const t=e||this.layer;t&&t.removeMany(this.midpointGraphics.items),this.midpointGraphics.items.forEach((e=>e.destroy())),this.midpointGraphics.removeAll()}_removeVertexGraphics(e){const t=e||this.layer;t&&t.removeMany(this.vertexGraphics.items),this.vertexGraphics.items.forEach((e=>e.destroy())),this.vertexGraphics.removeAll()}_setupGraphics(){const e=this.graphic.geometry;if(null!=e&&("polyline"===e.type||"polygon"===e.type)){const t=ae(e);this.enableMidpoints&&this._setUpMidpointGraphics(t),this.enableVertices&&this._setUpVertexGraphics(t)}}_setUpMidpointGraphics(e){this._removeMidpointGraphics();const t=this._createMidpointGraphics(e);this.midpointGraphics.addMany(t),this.layer.addMany(t)}_setUpVertexGraphics(e){this._removeVertexGraphics();const t=this._createVertexGraphics(e);this.vertexGraphics.addMany(t),this._storeRelatedVertexIndices(),this.layer.addMany(t)}_createVertexGraphics(e){const{_graphicAttributes:t,symbols:i}=this,r=[];return e?.forEach(((e,o)=>{e.forEach(((e,s)=>{r.push(new n.default({geometry:this._coordinateHelper.arrayToPoint(e),symbol:i?.vertices?.default,attributes:{...t,pathIndex:o,pointIndex:s}}))}))})),r}_createMidpointGraphics(e){const{_graphicAttributes:t,symbols:i}=this,r=[];for(let o=0;o<e.length;o++){const s=e[o];for(let e=0;e<s.length;e++){const a=(e+1)%s.length;if("polyline"===this.graphic.geometry?.type&&0===a)continue;const l=s[e],h=s[a],c=this._getMidpoint(l,h);r.push(new n.default({geometry:c,symbol:i.midpoints.default,attributes:{...t,pathIndex:o,pointIndexStart:e,pointIndexEnd:a}}))}}return r}_updateSymbolsForTheme(){const e=this.view.effectiveTheme.accentColor;this.symbols={vertices:{...this.symbols.vertices,default:this.symbols.vertices.default.clone().set("color",e),hover:this.symbols.vertices.hover?.clone().set("color",e)},midpoints:{...this.symbols.midpoints}};for(const t of this.vertexGraphics)this._isSelected(t)?t.symbol=this.symbols.vertices.selected:this._hoverGraphic===t?t.symbol=this.symbols.vertices.hover:t.symbol=this.symbols.vertices.default}_storeRelatedVertexIndices(){const e=this.vertexGraphics.items;if(!e)return;const t=e.map((e=>{let{geometry:t}=e;return{x:t.x,y:t.y}}));for(let i=0;i<t.length;i++){const r=[];for(let e=0;e<t.length;e++){if(i===e)continue;const n=t[i],o=t[e];n.x===o.x&&n.y===o.y&&r.push(e)}e[i].attributes.relatedGraphicIndices=r}}_setupMover(){const{enableMovement:e,graphic:t,midpointGraphics:i,vertexGraphics:r,view:n}=this,o=r.concat(i).items;e&&o.push(t),this._mover=new M.default({enableMoveAllGraphics:!1,highlightsEnabled:!1,indicatorsEnabled:!1,graphics:o,view:n,callbacks:{onGraphicClick:e=>this._onGraphicClickCallback(e),onGraphicMoveStart:e=>this._onGraphicMoveStartCallback(e),onGraphicMove:e=>this._onGraphicMoveCallback(e),onGraphicMoveStop:e=>this._onGraphicMoveStopCallback(e),onGraphicPointerOver:e=>this._onGraphicPointerOverCallback(e),onGraphicPointerOut:e=>this._onGraphicPointerOutCallback(e)}})}_onGraphicClickCallback(e){e.viewEvent.stopPropagation();const t=e.graphic;if(t===this.graphic)this.clearSelection(),this.emit("graphic-click",e),this.callbacks.onGraphicClick?.(e);else if(this._isMidpoint(t)){if(2===e.viewEvent.button)return;const i=this.graphic.clone(),r=this._createVertexFromMidpoint(t);this.refresh(),this._emitVertexAddEvent([t],i,r)}else this._isVertex(t)&&(e.viewEvent.stopPropagation(),2===e.viewEvent.button?this._removeVertices(t):(e.viewEvent.native.shiftKey||this._clearSelection(),this.selectedVertices.includes(t)?this._removeFromSelection(t,!0):this._addToSelection(t)))}_setUpOperation(e){const{graphic:t,dx:i,dy:r}=e,n=t===this.graphic;this._resetSnappingStateVars(),this._setUpGeometryHelper(),this._saveSnappingContextForHandle(t,e),this._activeOperationInfo={target:this.graphic,mover:t,operationType:n?"move":"reshape",totalDx:i,totalDy:r}}_onGraphicMoveStartCallback(e){const{dx:t,dy:i,graphic:r}=e;if(r===this.graphic){const{geometry:n}=r;return this._setUpOperation(e),this._emitMoveStartEvent(t,i),void(null!=n&&"point"===n.type&&this._onHandleMove(r,t,i,e,(()=>{this._updateTooltip(this.graphic,e.viewEvent),this._emitMoveEvent(t,i)})))}if(!this.selectedVertices.includes(r)){if(this._clearSelection(),this._isMidpoint(r)){const e=this.graphic.clone(),t=this._createVertexFromMidpoint(r);this._emitVertexAddEvent([r],e,t)}this._addToSelection(r)}this._setUpOperation(e),this._emitReshapeStartEvent(r),this._onHandleMove(r,t,i,e,(()=>{this._updateTooltip(r,e.viewEvent),this._emitReshapeEvent(r)}))}_onGraphicMoveCallback(e){const t=this._activeOperationInfo;if(!t)return;const{dx:i,dy:r,graphic:n}=e;t.totalDx+=i,t.totalDy+=r;const{operationType:o}=t,{geometry:s}=n;if(null!=s)if("move"!==o)this._onHandleMove(n,i,r,e,(()=>{this._updateTooltip(n,e.viewEvent),this._emitReshapeEvent(n)}));else if("point"===s.type)this._onHandleMove(n,i,r,e,(()=>{this._updateTooltip(this.graphic,e.viewEvent),this._emitMoveEvent(i,r)}));else if("polyline"===s.type||"polygon"===s.type){const t=ae(s);this._updateVertexGraphicLocations(t),this._updateTooltip(this.graphic,e.viewEvent),this._emitMoveEvent(i,r)}}_onGraphicMoveStopCallback(e){const t=this._activeOperationInfo;if(!t)return;const{dx:i,dy:r,graphic:n}=e,{operationType:o}=t;t.totalDx+=i,t.totalDy+=r,this._onHandleMove(n,i,r,e,(()=>"move"===o?this._emitMoveStopEvent():this._emitReshapeStopEvent(n))),this._isMidpoint(n)?this.refresh():(this._updateTooltip(this._isVertex(n)?n:null),this._resetSnappingStateVars(),this._activeOperationInfo=null)}_updateVertexGraphicLocations(e){const{_coordinateHelper:t}=this;for(const i of this.vertexGraphics){const{pathIndex:r,pointIndex:n}=i.attributes;i.geometry=t.arrayToPoint(e[r][n])}this._updateMidpointGraphicLocations(e)}_updateMidpointGraphicLocations(e){for(const t of this.midpointGraphics){const{pathIndex:i,pointIndexStart:r,pointIndexEnd:n}=t.attributes,o=e[i];t.geometry=this._getMidpoint(o[r],o[n])}}_getMidpoint(e,t){const{_coordinateHelper:i}=this,r=i.arrayToVector(e),n=i.arrayToVector(t),o=i.toXYZ(r),s=i.toXYZ(n),[a,l,h]=(0,x.t9)(o,s),c=i.hasM()?0:void 0;return new v.default({x:a,y:l,z:h,m:c,spatialReference:i.spatialReference})}_getVertexFromEditGeometry(e){const[t,i]=le(e);return(0,c.Lw)(this._editGeometryOperations),this._editGeometryOperations.data.components[t].vertices[i]}_onHandleMove(e,t,i,r,n){(0,c.DC)(this._snappingTask);const s=this._snappingContext;if(!s)return;const a=e.geometry,l="graphic-move-stop"===r.type;if(null!=this.snappingManager&&this.selectedVertices.length<2&&!l){const r=this.snappingManager;this._stagedVertex=r.update({point:a,context:s}),this._syncGeometryAfterVertexMove(e,new v.default(this._stagedVertex),t,i,l),n(),this._snappingTask=(0,o.UT)((async o=>{const h=await r.snap({point:a,context:s,signal:o});h.valid&&(this._stagedVertex=h.apply(),this._syncGeometryAfterVertexMove(e,new v.default(this._stagedVertex),t,i,l),n())}))}else{const r=null!=this._stagedVertex?new v.default(this._stagedVertex):a;this._syncGeometryAfterVertexMove(e,r,t,i,l),n()}}_syncGeometryAfterVertexMove(e,t,i,r){let n=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const o=this._editGeometryOperations?.data.geometry;if(o)if("point"===o.type)e.geometry=t;else if("mesh"===o.type)e.geometry=o.centerAt(t);else{const{_coordinateHelper:s}=this,[a,l]=le(e);let h=(0,x.$K)(o);const c=h[a].length-1,p=s.pointToArray(t);h[a][l]=p,"polygon"===o.type&&(0===l?h[a][c]=p:l===c&&(h[a][0]=p)),this._isVertex(e)&&(h=this._moveRelatedCoordinates(h,e,p),h=this._moveSelectedHandleCoordinates(h,e,i,r,"polygon"===o.type),this._updateMidpointGraphicLocations(h)),this._updateGraphicGeometry(o.clone());const d=s.pointToVector(t),u=this._getVertexFromEditGeometry(e),v=s.getZ(d),y=d[0]-u.pos[0],m=d[1]-u.pos[1],g=null!=v?v-u.pos[2]:0;this._editGeometryOperations?.moveVertices([u],y,m,g),n&&(this._mover?this._mover.updateGeometry(this._mover.graphics.indexOf(e),t):e.geometry=t)}}_moveRelatedCoordinates(e,t,i){const{relatedGraphicIndices:r}=t.attributes;for(const n of r){const r=this.vertexGraphics.at(n),{pathIndex:o,pointIndex:s}=r.attributes;e[o][s]=i,r.geometry=t.geometry}return e}_moveSelectedHandleCoordinates(e,t,i,r,n){for(const o of this.selectedVertices)if(o!==t){const{pathIndex:t,pointIndex:s,relatedGraphicIndices:a}=o.attributes,l=(0,b.lR)(o.geometry,i,r,this.view),h=(0,x.$K)(l),c=e[t].length-1;e[t][s]=h,o.geometry=l,n&&(0===s?e[t][c]=h:s===c&&(e[t][0]=h));for(const i of a){const t=this.vertexGraphics.at(i),{pathIndex:r,pointIndex:n}=t.attributes;e[r][n]=h,t.geometry=l}}return e}_onGraphicPointerOverCallback(e){const t=e.graphic;this._hoverGraphic=t;const i=this._isVertex(t);i&&!this._isSelected(t)&&(t.symbol=this.symbols.vertices.hover),this._updateTooltip(i?t:null),this._updateHoverCursor(t)}_onGraphicPointerOutCallback(e){const t=e.graphic;this._hoverGraphic=null,this._isVertex(t)&&!this._isSelected(t)&&(t.symbol=this.symbols.vertices.default),this.view.cursor="default",this._updateTooltip()}_createVertexFromMidpoint(e){const{_graphicAttributes:t,graphic:i}=this,r=i.geometry;if(null==r||"polygon"!==r.type&&"polyline"!==r.type)return[];const n=r.clone(),o=[],{pathIndex:s,pointIndexStart:a,pointIndexEnd:l}=e.attributes,h=(0,x.$K)(e.geometry),c=0===l?a+1:l,p=(0,x.$K)(n);return p[s].splice(c,0,h),e.attributes={...t,pathIndex:s,pointIndex:c,relatedGraphicIndices:[]},o.push({coordinates:p[s][c],componentIndex:s,vertexIndex:c}),this._updateGraphicGeometry(n),o}_addToSelection(e){const t=he(e);for(const i of t)i.symbol=this.symbols.vertices.selected,this.selectedVertices.add(i),this._updateTooltip(i);this._emitSelectEvent(t)}_removeFromSelection(e,t){const{vertices:i}=this.symbols,r=t?i.hover:i.default;this.selectedVertices.remove(e),e.symbol=r,this._emitDeselectEvent([e]),this._updateTooltip()}_clearSelection(){const e=this.selectedVertices.toArray();if(e.length>0){for(const t of e)t.set("symbol",this.symbols.vertices.default);this.selectedVertices.removeAll(),this._emitDeselectEvent(e),this._updateTooltip()}}_keyDownHandler(e){null==this._activeOperationInfo&&(0,C.wG)(e,this.tooltip)||B.NE.delete.includes(e.key)&&!e.repeat&&this.selectedVertices.length&&this._removeVertices(this.selectedVertices)}_removeVertices(e){const t=this.graphic.geometry;if(null==t||"polygon"!==t.type&&"polyline"!==t.type)return;if("polygon"===t.type&&this.vertexGraphics.length<4||this.vertexGraphics.length<3)return;const i=this.graphic.clone(),r=t.clone();let n=(0,x.$K)(r);const o=[],s=he(e);for(const a of s){const{x:e,y:t}=a.geometry;for(let i=0;i<n.length;i++){const r=n[i];for(let s=0;s<r.length;s++){const[a,l]=r[s];e===a&&t===l&&(o.push({coordinates:n[i][s],componentIndex:i,vertexIndex:s}),n[i].splice(Number(s),1))}}}if("polygon"===r.type)n=n.filter((e=>{if(e.length<2)return!1;const[t,i]=e[0],[r,n]=e[e.length-1];return(2!==e.length||t!==r||i!==n)&&(t===r&&i===n||e.push(e[0]),!0)})),r.rings=n;else{for(const e of n)1===e.length&&n.splice(n.indexOf(e),1);r.paths=n}this._updateGraphicGeometry(r),this.refresh(),this._emitVertexRemoveEvent(s,i,o)}_isVertex(e){return this.vertexGraphics.includes(e)}_isSelected(e){return this._isVertex(e)&&this.selectedVertices.includes(e)}_isMidpoint(e){return this.midpointGraphics.includes(e)}_updateHoverCursor(e){this.view.cursor=this._isMidpoint(e)?"copy":"move"}_updateTooltip(e,t){let i=null;const{graphic:r,view:n,tooltipInfos:o}=this,s=r?.geometry;"point"===s?.type?i=o.movePoint:this._selectedVertex?i=o.selectedVertex:e===this.graphic?(i=o.translateGraphic,function(e,t,i){e.clear(),F(e,t,i)}(i,n,t)):e&&this.selectedVertices.length>1&&(i=o.translateVertices,function(e,t,i,r){e.clear(),"polygon"===i?.type?e.area=(0,R.n)(i):"polyline"===i?.type&&(e.totalLength=(0,z.ob)(i)),F(e,t,r)}(i,n,s,t)),this.activeTooltipInfo=i}_updateGraphicGeometry(e){this._updateHandlesOnExternalGeometryChange?.pause(),this.graphic.geometry=e,this._updateHandlesOnExternalGeometryChange?.resume()}_emitMoveStartEvent(e,t){const i=new j(this.graphic,e,t);this.emit("move-start",i),this.callbacks.onMoveStart?.(i)}_emitMoveEvent(e,t){const i=new J(this.graphic,e,t);this.emit("move",i),this.callbacks.onMove?.(i)}_emitMoveStopEvent(e,t){if(null==e||null==t){const i=this._activeOperationInfo;if(!i)return;e=i.totalDx,t=i.totalDy}const i=new W(this.graphic,e,t);this.emit("move-stop",i),this.callbacks.onMoveStop?.(i)}_emitReshapeStartEvent(e){const t=new Q(this.graphic,e,this.selectedVertices.toArray());this.emit("reshape-start",t),this.callbacks.onReshapeStart?.(t)}_emitReshapeEvent(e){const t=new X(this.graphic,e,this.selectedVertices.toArray());this.emit("reshape",t),this.callbacks.onReshape?.(t)}_emitReshapeStopEvent(e){const t=new Y(this.graphic,e,this.selectedVertices.toArray());this.emit("reshape-stop",t),this.callbacks.onReshapeStop?.(t)}_emitSelectEvent(e){const t=new ee(e);this.emit("select",t),this.callbacks.onVertexSelect?.(t)}_emitDeselectEvent(e){const t=new te(e);this.emit("deselect",t),this.callbacks.onVertexDeselect?.(t)}_emitVertexAddEvent(e,t,i){const r=new ie(e,this.graphic,t,i);this.emit("vertex-add",r),this.callbacks.onVertexAdd?.(r)}_emitVertexRemoveEvent(e,t,i){const r=new re(e,this.graphic,t,i);this.emit("vertex-remove",r),this.callbacks.onVertexRemove?.(r)}_logGeometryTypeError(){h.A.getLogger(this).error(new a.default("reshape:invalid-geometry","Reshape operation not supported for the provided graphic. The geometry type is not supported."))}};function ae(e){const t=(0,x.$K)(e.clone());if("polygon"===e.type)for(const i of t){const e=i[i.length-1];i[0][0]===e[0]&&i[0][1]===e[1]&&i.length>2&&i.pop()}return t}function le(e){let{attributes:t}=e;return[t?.pathIndex||0,t?.pointIndex||0]}function he(e){return e instanceof n.default?[e]:[...e]}(0,r._)([(0,d.MZ)()],se.prototype,"_activeOperationInfo",void 0),(0,r._)([(0,d.MZ)()],se.prototype,"_coordinateHelper",null),(0,r._)([(0,d.MZ)()],se.prototype,"_editGeometryOperations",void 0),(0,r._)([(0,d.MZ)()],se.prototype,"tooltip",void 0),(0,r._)([(0,d.MZ)()],se.prototype,"tooltipInfos",void 0),(0,r._)([(0,d.MZ)()],se.prototype,"activeTooltipInfo",void 0),(0,r._)([(0,d.MZ)()],se.prototype,"_selectedVertex",null),(0,r._)([(0,d.MZ)()],se.prototype,"_tooltipsContext",null),(0,r._)([(0,d.MZ)()],se.prototype,"callbacks",void 0),(0,r._)([(0,d.MZ)()],se.prototype,"enableMidpoints",void 0),(0,r._)([(0,d.MZ)()],se.prototype,"enableMovement",void 0),(0,r._)([(0,d.MZ)()],se.prototype,"enableVertices",void 0),(0,r._)([(0,d.MZ)()],se.prototype,"graphic",void 0),(0,r._)([(0,d.MZ)({value:!0})],se.prototype,"highlightsEnabled",null),(0,r._)([(0,d.MZ)()],se.prototype,"layer",void 0),(0,r._)([(0,d.MZ)({readOnly:!0})],se.prototype,"midpointGraphics",void 0),(0,r._)([(0,d.MZ)()],se.prototype,"midpointSymbol",void 0),(0,r._)([(0,d.MZ)({readOnly:!0})],se.prototype,"selectedVertices",void 0),(0,r._)([(0,d.MZ)()],se.prototype,"snappingManager",void 0),(0,r._)([(0,d.MZ)({readOnly:!0})],se.prototype,"state",null),(0,r._)([(0,d.MZ)()],se.prototype,"symbols",void 0),(0,r._)([(0,d.MZ)({type:K.A})],se.prototype,"sketchOptions",void 0),(0,r._)([(0,d.MZ)({readOnly:!0})],se.prototype,"type",void 0),(0,r._)([(0,d.MZ)({readOnly:!0})],se.prototype,"vertexGraphics",void 0),(0,r._)([(0,d.MZ)()],se.prototype,"view",void 0),se=(0,r._)([(0,u.$)("esri.views.draw.support.Reshape")],se);const ce=se},31814:(e,t,i)=>{i.d(t,{b:()=>h});var r=i(42198),n=i(74309),o=i(65022),s=i(70755),a=i(73530),l=i(61073);class h{draw(e,t){const i=function(e){const t=[];for(const i of e){let e=!0;for(const r of t)if(i.equals(r)){e=!1;break}e&&t.push(i)}return t}(e),h=this.sortUniqueHints(i),c=[];for(const r of h)r instanceof n.v&&c.push(this.visualizeIntersectionPoint(r,t)),r instanceof o.c&&c.push(this.visualizeLine(r,t)),r instanceof s.r&&c.push(this.visualizeParallelSign(r,t)),r instanceof l.l&&c.push(this.visualizeRightAngleQuad(r,t)),r instanceof a._&&c.push(this.visualizePoint(r,t));return(0,r.vE)(c)}sortUniqueHints(e){return e}}},54380:(e,t,i)=>{i.d(t,{Fm:()=>h,Q7:()=>c,Ui:()=>l});var r=i(32636),n=i(89227),o=i(28473),s=i(1277);i(1696);function a(e){return e?{p0:(0,o.o8)(e.p0),p1:(0,o.o8)(e.p1),p2:(0,o.o8)(e.p2)}:{p0:(0,o.vt)(),p1:(0,o.vt)(),p2:(0,o.vt)()}}function l(e,t,i){const{direction:r,origin:o}=t,{p0:s,p1:a,p2:l}=e,h=a[0]-s[0],c=a[1]-s[1],p=a[2]-s[2],d=l[0]-s[0],u=l[1]-s[1],v=l[2]-s[2],y=r[1]*v-u*r[2],x=r[2]*d-v*r[0],m=r[0]*u-d*r[1],g=h*y+c*x+p*m;if(g>-1e-5&&g<1e-5)return!1;const f=1/g,_=o[0]-s[0],b=o[1]-s[1],M=o[2]-s[2],w=f*(_*y+b*x+M*m);if(w<0||w>1)return!1;const G=b*p-c*M,S=M*h-p*_,V=_*c-h*b,I=f*(r[0]*G+r[1]*S+r[2]*V);return!(I<0||w+I>1)&&(i&&((0,n.h)(i,r,f*(d*G+u*S+v*V)),(0,n.g)(i,o,i)),!0)}function h(e,t,i){const r=t[0]-e[0],n=t[1]-e[1],o=i[0]-e[0],s=i[1]-e[1];return.5*Math.abs(r*s-n*o)}function c(e,t,i){return(0,n.d)(p,t,e),(0,n.d)(d,i,e),.5*(0,n.l)((0,n.e)(p,p,d))}new r.I(s.vt),new r.I((()=>a()));const p=(0,o.vt)(),d=(0,o.vt)()},68263:(e,t,i)=>{i.d(t,{e:()=>r});class r{constructor(e){this.vertexHandle=null,this.excludeFeature=null,this.visualizer=null,this.selfSnappingZ=null,this.drawConstraints=null,this.editGeometryOperations=e.editGeometryOperations,this.elevationInfo=e.elevationInfo,this.pointer=e.pointer,this.vertexHandle=e.vertexHandle,this.excludeFeature=e.excludeFeature,this.feature=e.feature,this.visualizer=e.visualizer,this.selfSnappingZ=e.selfSnappingZ,this.drawConstraints=e.drawConstraints}get coordinateHelper(){return this.editGeometryOperations.data.coordinateHelper}get spatialReference(){return this.coordinateHelper.spatialReference}}},73530:(e,t,i)=>{i.d(t,{_:()=>o});var r=i(89227),n=i(43536);class o extends n.m{constructor(e,t,i){super(t,i),this.point=e}equals(e){return e instanceof o&&(0,r.p)(this.point,e.point)}}},83789:(e,t,i)=>{i.d(t,{F:()=>l});var r=i(93800),n=i(48602),o=(i(21265),i(50925),i(14746),i(75269)),s=i(28454),a=i(58771);let l=class extends((0,a.B)(s.w)){constructor(e){super(e),this.type="move-point",this.allFields.forEach((e=>{e.lockable=!1,e.setActual(null)}))}get allFields(){return[this.longitude,this.latitude,this.x,this.y,this.elevation]}};(0,r._)([(0,n.MZ)()],l.prototype,"allFields",null),l=(0,r._)([(0,o.$)("esri.views.interactive.tooltip.infos.MovePointTooltipInfo")],l)},85675:(e,t,i)=>{i.d(t,{J:()=>_});var r=i(79625),n=i(42198),o=i(16804),s=i(80556),a=i(32006),l=i(98080),h=i(28473),c=i(75400),p=i(54824),d=i(93321),u=i(14360),v=i(99071),y=i(83031),x=i(55601),m=i(49281),g=i(34519),f=i(31814);class _ extends f.b{constructor(e){super(),this._graphicsLayer=e,this._symbolPairingsByType=new Map}visualizeIntersectionPoint(e,t){return this._visualizeSnappingIndicator(new c.default({x:e.intersectionPoint[0],y:e.intersectionPoint[1],spatialReference:t.spatialReference}),this._getOrCreateSymbol("intersectionPoint",t.view.effectiveTheme.accentColor))}visualizePoint(e,t){return this._visualizeSnappingIndicator(new c.default({x:e.point[0],y:e.point[1],spatialReference:t.spatialReference}),this._getOrCreateSymbol("point",t.view.effectiveTheme.accentColor))}visualizeLine(e,t){return this._visualizeSnappingIndicator(new p.default({paths:[[[...e.lineStart],[...e.lineEnd]]],spatialReference:(0,s.PZ)(d.default,t.spatialReference)}),this._getOrCreateSymbol("line",t.view.effectiveTheme.accentColor))}visualizeParallelSign(e,t){return this._visualizeSnappingIndicator(new p.default({paths:[[[...e.lineStart],[...e.lineEnd]]],spatialReference:(0,s.PZ)(d.default,t.spatialReference)}),this._getOrCreateSymbol("parallelSign",t.view.effectiveTheme.accentColor))}visualizeRightAngleQuad(e,t){const i=(0,l.vt)(),r=(0,l.vt)(),n=(0,h.vt)();(0,a.Re)(i,(0,m.Xz)(e.centerVertex),(0,m.Xz)(e.previousVertex)),(0,a.Re)(r,(0,m.Xz)(e.nextVertex),(0,m.Xz)(e.previousVertex)),(0,a.$A)(n,i,r);const o="rightAngleQuad"+(n[2]<0?45:225);return this._visualizeSnappingIndicator(new p.default({paths:[[[...e.previousVertex],[...e.centerVertex],[...e.nextVertex]]],spatialReference:(0,s.PZ)(d.default,t.spatialReference)}),this._getOrCreateSymbol(o,t.view.effectiveTheme.accentColor))}_visualizeSnappingIndicator(e,t){const i=new r.default({geometry:e,symbol:t});return this._graphicsLayer.add(i),(0,n.hA)((()=>{this._graphicsLayer.remove(i)}))}_getOrCreateSymbol(e,t){const i=this._symbolPairingsByType;return i.get(e)?.color!==t&&i.set(e,{color:t,symbol:b(e,t)}),i.get(e).symbol}}function b(e,t){const i=[...t.toRgb(),255*t.a];switch(e){case"point":return new y.default({outline:{width:.5,color:[0,0,0,1]},size:10,color:t});case"intersectionPoint":return new y.default({outline:new v.default({width:1.5,color:t}),size:15,color:[0,0,0,0]});case"line":return new u.default({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",enable:!0,capStyle:x.uT.Butt,joinStyle:x.wd.Round,miterLimit:10,width:(0,o.PN)(g.N.lineHintWidthTarget),color:i}]}}});case"parallelSign":return new u.default({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:0,y:-1,z:0},anchorPointUnits:"Relative",size:5,markerPlacement:{type:"CIMMarkerPlacementOnLine",placePerPart:!0,angleToLine:!0,relativeTo:"LineMiddle"},frame:{xmin:-5,ymin:-1.5,xmax:5,ymax:1.5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[7,0],[-7,0],[-7,1.5],[7,1.5]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:i}]}}],scaleSymbolsProportionally:!0,respectFrame:!0},{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:0,y:1,z:0},anchorPointUnits:"Relative",size:5,markerPlacement:{type:"CIMMarkerPlacementOnLine",placePerPart:!0,angleToLine:!0,relativeTo:"LineMiddle"},frame:{xmin:-5,ymin:-1.5,xmax:5,ymax:1.5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[7,0],[-7,0],[-7,-1.5],[7,-1.5]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:i}]}}],scaleSymbolsProportionally:!0,respectFrame:!0}]}}});case"rightAngleQuad45":case"rightAngleQuad225":{const r="rightAngleQuad45"===e?45:225;return new u.default({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:.5,y:.5,z:0},anchorPointUnits:"Relative",size:(0,o.PN)(g.N.rightAngleHintSize),rotation:r,markerPlacement:{type:"CIMMarkerPlacementOnVertices",placePerPart:!0,angleToLine:!0,placeOnEndPoints:!1},frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[5,-5],[-5,-5],[-5,5],[5,5],[5,-5]]]},symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",miterLimit:10,width:(0,o.PN)(g.N.rightAngleHintOutlineSize),color:i},{type:"CIMSolidFill",enable:!0,color:[...t.toRgb(),255*t.a*.4]}]}}],scaleSymbolsProportionally:!0,respectFrame:!0}]}}})}}}},99431:(e,t,i)=>{i.d(t,{d:()=>h});var r=i(93800),n=i(48602),o=(i(21265),i(50925),i(14746),i(75269)),s=i(96076),a=i(28454),l=i(58771);let h=class extends((0,l.B)(a.w)){constructor(e){super(e),this.type="selected-vertex",this.area=(0,s.Am)(),this.totalLength=(0,s.fr)(),this.geometryType="polyline",this.allFields.forEach((e=>{e.lockable=!1,e.setActual(null)}))}get allFields(){return[this.longitude,this.latitude,this.x,this.y,this.elevation,"polygon"===this.geometryType?this.area:this.totalLength]}};(0,r._)([(0,n.MZ)()],h.prototype,"geometryType",void 0),(0,r._)([(0,n.MZ)()],h.prototype,"allFields",null),h=(0,r._)([(0,o.$)("esri.views.interactive.tooltip.infos.SelectedVertexTooltipInfo")],h)}}]);