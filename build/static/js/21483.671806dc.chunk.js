"use strict";(self.webpackChunkever_wading_birds=self.webpackChunkever_wading_birds||[]).push([[21483,60814],{7472:(e,t,n)=>{n.d(t,{X:()=>i});const i=Symbol("WebScene")},21483:(e,t,n)=>{n.r(t),n.d(t,{default:()=>c});var i=n(93800),l=n(74719),s=n(49959),r=n(48602),u=(n(21265),n(50925),n(14746),n(75269)),a=n(75400),o=n(75972),d=n(90801),m=n(53512),f=n(49996);const c=e=>{let t=class extends e{constructor(){super(...arguments),this.view=null}get timeExtent(){return(0,o.F)(this.layer,this.view?.timeExtent,this._get("timeExtent"))}async fetchPopupFeaturesAtLocation(e,t){const{layer:n}=this;if(!e)throw new l.default("imagerylayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:n});const{popupEnabled:i}=n,r=(0,f.D8)(n,t);if(!i||null==r)return[];const u=await r.getRequiredFields();(0,s.throwIfAborted)(t);const o=new m.default;o.timeExtent=this.timeExtent,o.geometry=e,o.outFields=u,o.outSpatialReference=e.spatialReference;const{resolution:d,spatialReference:c}=this.view,p="2d"===this.view.type?new a.default(d,d,c):new a.default(.5*d,.5*d,c),{returnTopmostRaster:w,showNoDataRecords:h}=r.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1},T={returnDomainValues:!0,returnTopmostRaster:w,pixelSize:p,showNoDataRecords:h,signal:t?.signal};return n.queryVisibleRasters(o,T).then((e=>e))}async getSourceScale(){return await(0,d.Hh)(),await this.layer.load(),(0,d.OO)(this.layer.serviceRasterInfo,this.view.spatialReference)}canResume(){return!!super.canResume()&&!this.timeExtent?.isEmpty}};return(0,i._)([(0,r.MZ)()],t.prototype,"layer",void 0),(0,i._)([(0,r.MZ)()],t.prototype,"suspended",void 0),(0,i._)([(0,r.MZ)({readOnly:!0})],t.prototype,"timeExtent",null),(0,i._)([(0,r.MZ)()],t.prototype,"view",void 0),t=(0,i._)([(0,u.$)("esri.views.layers.ImageryLayerView")],t),t}},49996:(e,t,n)=>{n.d(t,{D8:()=>s,TO:()=>l,d0:()=>r});var i=n(95011);async function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.popupTemplate;if(null==t)return[];const n=await t.getRequiredFields(e.fieldsIndex),{lastEditInfoEnabled:l}=t,{objectIdField:s,typeIdField:r,globalIdField:u,relationships:a}=e;if(n.includes("*"))return["*"];const o=l?(0,i.getFeatureEditFields)(e):[],d=(0,i.fixFields)(e.fieldsIndex,[...n,...o]);return r&&d.push(r),d&&s&&e.fieldsIndex?.has(s)&&!d.includes(s)&&d.push(s),d&&u&&e.fieldsIndex?.has(u)&&!d.includes(u)&&d.push(u),a&&a.forEach((t=>{const{keyField:n}=t;d&&n&&e.fieldsIndex?.has(n)&&!d.includes(n)&&d.push(n)})),d}function s(e,t){return e.popupTemplate?e.popupTemplate:null!=t&&t.defaultPopupTemplateEnabled&&null!=e.defaultPopupTemplate?e.defaultPopupTemplate:null}function r(e,t){return null!=s(e,{defaultPopupTemplateEnabled:t})}},60814:(e,t,n)=>{n.r(t),n.d(t,{getTimeExtentFromLayers:()=>f,getTimeSliderSettingsFromWebDocument:()=>p,toLocalTimeExtent:()=>h,toUTCTimeExtent:()=>w});var i=n(62631),l=n(82301),s=n(87431),r=n(32474),u=n(46047),a=n(7472);function o(e){return void 0!==e.timeInfo}async function d(e,t){return e.widgets?.timeSlider?.fullTimeExtent??f(e.allLayers,t)}function m(e){const{numStops:t,stopInterval:n,stops:i}=e;return i?{dates:(0,l.clone)(i)}:n?{interval:n.clone()}:{count:t??5}}async function f(e,t){if(0===e.length)return r.default.allTime;await Promise.all(e.map((e=>e.load({signal:t}))));const n=e.filter(o),l=e.filter((e=>!o(e)&&null!=e.visibilityTimeExtent));if(0===n.length&&0===l.length)return r.default.allTime;const s=[],u=[];for(const i of n)"feature"!==i?.type&&"map-image"!==i?.type||!i.timeInfo?.hasLiveData?u.push(i):s.push(i);const a=e=>null==e||e.isAllTime,d=[...u.map((e=>{const t=e.timeInfo?.fullTimeExtent,{visibilityTimeExtent:n}=e;return t?.intersection(n)??n})),...l.map((e=>e.visibilityTimeExtent))];if(d.some(a))return r.default.allTime;const m=s.map((async e=>{const n=(await e.fetchRecomputedExtents({signal:t}))?.timeExtent??e.timeInfo?.fullTimeExtent,{visibilityTimeExtent:i}=e;return n?.intersection(i)??i})),f=(await Promise.allSettled(m)).map((e=>"fulfilled"===e.status?e.value:null));if(f.some(a))return r.default.allTime;const c=[...f,...d].filter(i.Ru);return 0===c.length?r.default.allTime:c.reduce(((e,t)=>e.union(t)))}function c(e,t){const n=e.currentTimeExtent;if(!n)return null;const{start:i,end:l}=n,s=i??l??null;switch(t){case"time-window":return new r.default({start:i,end:l});case"cumulative-from-start":return new r.default({start:null,end:s});case"cumulative-from-end":return new r.default({start:s,end:null});case"instant":return new r.default({start:s,end:s})}}async function p(e,t){if(!(0,u.r)(e)&&!function(e){return null!=e&&"object"==typeof e&&a.X in e}(e))return null;await e.load({signal:t});const n=e?.widgets?.timeSlider;if(!n)return null;const i=await d(e,t),l=n.loop,s=function(e){const t=e.numThumbs??2,n=e.currentTimeExtent;if(n){const{start:e,end:i}=n;return null!=e&&null!=i&&e.getTime()===i.getTime()?"instant":2===t?"time-window":null==e||0===e.getTime()?"cumulative-from-start":"cumulative-from-end"}return 2===t?"time-window":"cumulative-from-start"}(n);return{fullTimeExtent:i,loop:l,mode:s,playRate:n.stopDelay??2e3,stops:m(n),timeExtent:c(n,s)}}function w(e){if(!e)return e;const{start:t,end:n}=e;return new r.default({start:null!=t?(0,s.S1)(t,-t.getTimezoneOffset(),"minutes"):t,end:null!=n?(0,s.S1)(n,-n.getTimezoneOffset(),"minutes"):n})}function h(e){if(!e)return e;const{start:t,end:n}=e;return new r.default({start:null!=t?(0,s.S1)(t,t.getTimezoneOffset(),"minutes"):t,end:null!=n?(0,s.S1)(n,n.getTimezoneOffset(),"minutes"):n})}},75972:(e,t,n)=>{n.d(t,{F:()=>l});var i=n(60814);function l(e,t,n){if(null==e?.timeInfo)return null;const{datesInUnknownTimezone:l=!1,timeOffset:s,useViewTime:r}=e;let u=e.timeExtent;l&&(u=(0,i.toLocalTimeExtent)(u));let a=r?t&&u?t.intersection(u):t||u:u;return!a||a.isEmpty||a.isAllTime?a:(s&&(a=a.offset(-s.value,s.unit)),l&&(a=(0,i.toUTCTimeExtent)(a)),a.equals(n)?n:a)}}}]);