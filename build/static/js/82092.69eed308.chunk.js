"use strict";(self.webpackChunkever_wading_birds=self.webpackChunkever_wading_birds||[]).push([[34472,79538,82092],{2925:(e,t,n)=>{n.d(t,{$:()=>x,IB:()=>u,Iy:()=>A,KV:()=>G,N2:()=>M,QP:()=>O,RH:()=>E,Vl:()=>z,Ws:()=>D,ZD:()=>T,_L:()=>N,bJ:()=>I,e$:()=>q,f6:()=>R,hw:()=>Z,pW:()=>F,pf:()=>L,rs:()=>V,sn:()=>$,we:()=>C});var r=n(88102),a=n(62631),i=n(82301),s=n(64682),o=n(60548),l=n(24646);function u(e){return"r"in e&&"g"in e&&"b"in e}function c(e){return"h"in e&&"s"in e&&"v"in e}function d(e){return"l"in e&&"a"in e&&"b"in e}function f(e){return"l"in e&&"c"in e&&"h"in e}const m=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],p=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function h(e,t){const n=[];let r,a;if(e[0].length!==t.length)throw new Error("dimensions do not match");const i=e.length,s=e[0].length;let o=0;for(r=0;r<i;r++){for(o=0,a=0;a<s;a++)o+=e[r][a]*t[a];n.push(o)}return n}function g(e){const t=[e.r/255,e.g/255,e.b/255].map((e=>e<=.04045?e/12.92:((e+.055)/1.055)**2.4)),n=h(m,t);return{x:100*n[0],y:100*n[1],z:100*n[2]}}function y(e){const t=h(p,[e.x/100,e.y/100,e.z/100]).map((e=>{const t=e<=.0031308?12.92*e:1.055*e**(1/2.4)-.055;return Math.min(1,Math.max(t,0))}));return{r:Math.round(255*t[0]),g:Math.round(255*t[1]),b:Math.round(255*t[2])}}function b(e){const t=[e.x/95.047,e.y/100,e.z/108.883].map((e=>e>(6/29)**3?e**(1/3):1/3*(29/6)**2*e+4/29));return{l:116*t[1]-16,a:500*(t[0]-t[1]),b:200*(t[1]-t[2])}}function v(e){const t=e.l,n=[(t+16)/116+e.a/500,(t+16)/116,(t+16)/116-e.b/200].map((e=>e>6/29?e**3:3*(6/29)**2*(e-4/29)));return{x:95.047*n[0],y:100*n[1],z:108.883*n[2]}}function w(e){return function(e){const t=e.l,n=e.a,r=e.b,a=Math.sqrt(n*n+r*r);let i=Math.atan2(r,n);return i=i>0?i:i+2*Math.PI,{l:t,c:a,h:i}}(b(g(e)))}function S(e){return y(v(function(e){const t=e.l,n=e.c,r=e.h;return{l:t,a:n*Math.cos(r),b:n*Math.sin(r)}}(e)))}function x(e){return u(e)?e:f(e)?S(e):d(e)?function(e){return y(v(e))}(e):function(e){return"x"in e&&"y"in e&&"z"in e}(e)?y(e):c(e)?function(e){const t=(e.h+360)%360/60,n=e.s/100,r=e.v/100*255,a=r*n,i=a*(1-Math.abs(t%2-1));let s;switch(Math.floor(t)){case 0:s={r:a,g:i,b:0};break;case 1:s={r:i,g:a,b:0};break;case 2:s={r:0,g:a,b:i};break;case 3:s={r:0,g:i,b:a};break;case 4:s={r:i,g:0,b:a};break;case 5:case 6:s={r:a,g:0,b:i};break;default:s={r:0,g:0,b:0}}return s.r=Math.round(s.r+r-a),s.g=Math.round(s.g+r-a),s.b=Math.round(s.b+r-a),s}(e):e}function M(e){return c(e)?e:function(e){const t=e.r,n=e.g,r=e.b,a=Math.max(t,n,r),i=a-Math.min(t,n,r);let s=a,o=0===i?0:a===t?(n-r)/i%6:a===n?(r-t)/i+2:(t-n)/i+4,l=0===i?0:i/s;return o<0&&(o+=6),o*=60,l*=100,s*=100/255,{h:o,s:l,v:s}}(x(e))}function T(e){return d(e)?e:function(e){return b(g(e))}(x(e))}function E(e){return f(e)?e:w(x(e))}function V(e){return k(e).isBright?"light":"dark"}function k(e){let{r:t,g:n,b:a,a:i}=e;return i<1&&(t=Math.round(i*t+255*(1-i)),n=Math.round(i*n+255*(1-i)),a=Math.round(i*a+255*(1-i))),new r.default({r:t,g:n,b:a})}function D(e,t){const{r:n,g:r,b:a}=t?.ignoreAlpha?e:k(e);return.2126*n+.7152*r+.0722*a}var F,B;function I(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:F.High;return D(e,{ignoreAlpha:!0})>t?new r.default([0,0,0,e.a]):new r.default([255,255,255,e.a])}function q(e,t){const n=T(e);n.l*=1-t;const r=x(n),a=e.clone();return a.setColor(r),a.a=e.a,a}function N(e,t){const n=e.clone();return n.a*=t,n}function z(e,t){const n=M(e);n.s*=t;const r=x(n),a=e.clone();return a.setColor(r),a.a=e.a,a}function O(e){return r.default.toUnitRGBA(e)}function Z(e,t){return e===t||null!=e&&e.equals(t)}function C(e,t){return e===t||null!=e&&null!=t&&(0,o.e)(e,t)}function L(e){return(0,l.fA)(e[0],e[1],e[2],e.length>3?e[3]:1)}function G(e){return e[0]??=0,e[1]??=0,e[2]??=0,e}function $(e){return e.length=4,G(e),e[3]??=1,(0,s.qE)(e[3],0,1),e}function R(e,t){const n=r.default.toUnitRGBA(e);return n[3]*=t,n}function A(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(0===e.length||t<=0)return[];if(1===(e=e.map((e=>"string"==typeof e?new r.default(e):e))).length||1===t){const n=[],r=e[0];for(let e=0;e<t;e++)n.push(r.clone());return n}if(n.shuffle&&(e=(0,a.k4)((0,i.clone)(e),n.seed)),e.length>=t){const n=[],r=(e.length-1)/(t-1);for(let a=0;a<t;a++){const t=Math.round(a*r);n.push(e[t].clone())}return n}return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=[],i=e.length-1,s=Math.ceil((t-e.length)/i);e:for(let a=0;a<i;a++){const i=e[a],o=e[a+1];for(let a=1;a<=s;a++){const l=a/(s+1);if(r.push(J(i,o,l,n)),r.length+e.length===t)break e}}return[...e.map((e=>e.clone())),...(0,a.k4)(r,n.seed??1)]}(e,t,n)}(B=F||(F={}))[B.Low=160]="Low",B[B.High=225]="High";const U=(e,t)=>{const n=Math.floor(10*t())-5;return Math.min(255,Math.max(0,e+n))};function J(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const s=e.r,o=e.g,l=e.b,u=t.r,c=t.g,d=t.b,f=Math.round(s+(u-s)*n),m=Math.round(o+(c-o)*n),p=Math.round(l+(d-l)*n);if(!i.offset)return new r.default([f,m,p]);const h=(0,a.Mo)(i.seed);return new r.default([U(f,h),U(m,h),U(p,h)])}},22420:(e,t,n)=>{n.d(t,{GP:()=>f,LI:()=>c,lc:()=>l,u5:()=>u});n(88677);var r=n(23224);const a=/^-?(\d+)(\.(\d+))?$/i;function i(e,t){return e-t}function s(e,t){let n,r;return n=Number(e.toFixed(t)),n<e?r=n+1/10**t:(r=n,n-=1/10**t),n=Number(n.toFixed(t)),r=Number(r.toFixed(t)),[n,r]}function o(e,t,n,r,a){const i=u(e,t,n,r),s=null==i.previous||i.previous<=a,o=null==i.next||i.next<=a;return s&&o||i.previous+i.next<=2*a}function l(e){const t=String(e),n=t.match(a);if(n?.[1])return{integer:n[1].split("").length,fractional:n[3]?n[3].split("").length:0};if(t.toLowerCase().includes("e")){const e=t.split("e"),n=e[0],r=e[1];if(n&&r){const e=Number(n);let t=Number(r);const a=t>0;a||(t=Math.abs(t));const i=l(e);return a?(i.integer+=t,t>i.fractional?i.fractional=0:i.fractional-=t):(i.fractional+=t,t>i.integer?i.integer=1:i.integer-=t),i}}return{integer:0,fractional:0}}function u(e,t,n,r){const a={previous:null,next:null};if(null!=n){const r=e-n,i=t-n-r;a.previous=Math.floor(Math.abs(100*i/r))}if(null!=r){const n=r-e,i=r-t-n;a.next=Math.floor(Math.abs(100*i/n))}return a}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.slice(),{tolerance:r=2,strictBounds:a=!1,indexes:u=n.map(((e,t)=>t))}=t;u.sort(i);for(let i=0;i<u.length;i++){const e=u[i],t=n[e],c=0===e?null:n[e-1],d=e===n.length-1?null:n[e+1],f=l(t).fractional;if(f){let l,u=0,m=!1;for(;u<=f&&!m;){const e=s(t,u);l=a&&0===i?e[1]:e[0],m=o(t,l,c,d,r),u++}m&&(n[e]=l)}}return n}const d={maximumFractionDigits:20};function f(e){return(0,r.ZV)(e,d)}},28245:(e,t,n)=>{n.d(t,{bG:()=>s,Ty:()=>l,YJ:()=>u,Fq:()=>c,vt:()=>o});var r=n(82301),a=n(79538);class i{constructor(e){const{name:t,label:n,description:r,schemes:i}=e;this.name=t,this.label=n,this.description=r,this.schemes=i;const s=e.basemapGroups||a.Np;let o=[];Object.keys(s).forEach((e=>{o=o.concat(s[e])})),this.supportedBasemaps=o,this.basemapGroups=s}isBasemapSupported(e){const t=(0,a.T1)(e,this.supportedBasemaps);return!(!t||!this.supportedBasemaps.includes(t))}getRawSchemes(e){const{basemapId:t,basemapTheme:n}=function(e,t,n){let r=null,i=null;if(t&&(r=(0,a.T1)(t,e,!1),r)){const e=(0,a.BV)(r);null!=e&&(i=e)}return!r&&n&&(r="dark"===n?"dark-gray":"gray",i=n),r||i||(r="gray",i="light"),{basemapId:r,basemapTheme:i}}(this.supportedBasemaps,e.basemap,e.basemapTheme);let i=n;if(t){const e=(0,a.BV)(t,this.basemapGroups);null!=e&&(i=e)}let s=e.geometryType;"multipoint"===s?s="point":"mesh"===s&&(s="polygon");const o=this.schemes[s]||this.schemes.default;return{schemesInfo:(0,r.clone)(o[i]),basemapId:t,basemapTheme:n}}}function s(e){const t=e.themeDictionary,n=new Map;for(const r in t){const e=t[r];n.set(r,new i(e))}return n}function o(e,t){const n=[];return e.forEach((e=>{e.isBasemapSupported(t)&&n.push({name:e.name,label:e.label,description:e.description,basemaps:[...e.supportedBasemaps]})})),n}function l(e,t){if(!e)return;if(!t)return;let n=null;const r=[t.primaryScheme,...t.secondarySchemes];for(const a of r)if(a.name?.toLowerCase()===e.toLowerCase()){n=a;break}return n}function u(e,t,n){if(!e&&!t)return[];if(!n)return[];const r=!e?.length,a=!t?.length,i=[n.primaryScheme,...n.secondarySchemes],s=[];for(const o of i){const n=!!r||e.some((e=>o.tags.includes(e))),i=!a&&t.some((e=>o.tags.includes(e)));n&&!i&&s.push(o)}return s}function c(e){const t=e.theme;if(t)return t.getRawSchemes({basemap:e.basemap,geometryType:e.geometryType,basemapTheme:e.basemapTheme})}},34472:(e,t,n)=>{n.r(t),n.d(t,{cloneScheme:()=>h,getSchemeByName:()=>m,getSchemes:()=>f,getSchemesByTag:()=>p,getThemes:()=>d});var r=n(88102),a=n(62631),i=n(2925),s=n(43073),o=n(28245);const l={light:{color:[153,153,153,.25],width:"1px"},dark:{color:[153,153,153,.25],width:"1px"}},u=["vibrant-rainbow","cat-dark","predominant-v2","predominant-v1","predominance-race","desert-blooms","tropical-bliss","under-the-sea","ocean-bay","cat-light","predominant-v4","predominance-money","predominant-v3","predominance-race-ethnic","pastel-chalk","predominance-rainbow","predominance-sequence","cat-popup-olympic-sunset"],c=(0,o.bG)({themeDictionary:{default:{name:"default",label:"Default",description:"Default theme for visualizing features using the density of randomly placed dots.",schemes:{default:{light:{primary:"predominant-v5",secondary:u,common:{outline:l.light,fillOpacity:.8}},dark:{primary:"predominant-v5",secondary:u,common:{outline:l.dark,fillOpacity:.8}}}}}}});function d(e){return(0,o.vt)(c,e)}function f(e){const t=(0,o.Fq)({basemap:e.basemap,basemapTheme:e.basemapTheme,theme:c.get("default")});if(!t)return;const{schemesInfo:n,basemapId:r,basemapTheme:i}=t,s=n.common,l=e.numColors;return{primaryScheme:g(n.primary,s,l),secondarySchemes:n.secondary.map((e=>g(e,s,l))).filter(a.Ru),basemapId:r,basemapTheme:i}}function m(e){return(0,o.Ty)(e.name,f(e))}function p(e){return(0,o.YJ)(e.includedTags,e.excludedTags,f(e))}function h(e){if(!e)return;const t={...e};return t.tags=[...t.tags],t.colors&&(t.colors=t.colors.map((e=>new r.default(e)))),t.outline&&(t.outline={color:t.outline.color&&new r.default(t.outline.color),width:t.outline.width}),t}function g(e,t,n){const a=s.A[e];if(a)return function(e){return{name:e.name,tags:[...e.tags],colors:e.colors.map((e=>new r.default(e))),outline:{color:new r.default(e.outline.color),width:e.outline.width},opacity:e.opacity}}({name:a.name,tags:a.tags,colors:a[n]||(0,i.Iy)(a.stops,n),opacity:t.fillOpacity,outline:t.outline})}},68990:(e,t,n)=>{n.r(t),n.d(t,{createRenderer:()=>k,regenerateRenderer:()=>D});var r=n(2925),a=n(74719),i=n(11099),s=n(19560),o=n(45023),l=n(70183);function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=Math.round(e);if(n<=1)return 1;const r=n.toString().length;for(let a=r-1>=3?3:r-1;a>=0;a--){const r=10**a,i=Math.floor(e/r)*r,s=Math.ceil(e/r)*r,o=Math.round((i+s)/2),l=Math.abs(e-i)/e*100,u=Math.abs(e-s)/e*100,c=Math.abs(e-o)/e*100,d=Math.min(l,u,c);if(d<=t){if(d===l){n=i;break}if(d===u){n=s;break}if(d===c){n=o;break}}}return n}var c=n(40663),d=n(39569),f=n(46176),m=n(70934),p=n(85151),h=n(79538),g=n(2938);async function y(e){const{layerAdapter:t,...n}=await async function(e){if(!(e&&e.layer&&e.attributes))throw new a.default("summary-statistics-for-attributes:missing-parameters","'layer' and 'attributes' parameters are required");if(e.attributes.some((e=>!!e.valueExpression))&&!e.view)throw new a.default("summary-statistics-for-attributes:missing-parameters","View is required when 'valueExpression' is specified in attributes");e.forBinning&&(0,p.p)(e,"summary-statistics-for-attributes");const{layer:t,...n}=e,r=[g.mb.CSVLayer,g.mb.FeatureLayer,g.mb.OGCFeatureLayer,g.mb.GeoJSONLayer,g.mb.KnowledgeGraphSublayer,g.mb.ParquetLayer,g.mb.WFSLayer],i=e.forBinning?g.Mi:r,s=(0,g.Jg)(t,i,e.forBinning);if(!s)throw new a.default("summary-statistics-for-attributes:invalid-parameters","'layer' must be one of these types: "+(0,g.Ho)(i).join(", "));const o={layerAdapter:s,...n};o.includeZeros=null==o.includeZeros||o.includeZeros,o.includeNegatives=null==o.includeNegatives||o.includeNegatives;const l=o.view,u=null!=o.signal?{signal:o.signal}:null;await Promise.all([l?.when(),s.load(u)]);const c=[];for(const a of o.attributes){const e=await(0,h.EG)({field:a.field,valueExpression:a.valueExpression});Array.prototype.push.apply(c,e)}const d=(0,m.MH)(s,c,"summary-statistics-for-attributes:invalid-parameters");if(d)throw d;return o}(e),r=(0,m.D9)(n.attributes,n.includeZeros,n.includeNegatives);return t.summaryStatistics({valueExpression:r.valueExpression,sqlExpression:r.sqlExpression,sqlWhere:r.sqlWhere,view:n.view,filter:n.filter,outStatisticTypes:h.XR,signal:n.signal})}var b=n(96247);function v(e,t,n){return null!=e&&isFinite(e)&&((t??!0)||0!==e)&&((n??!0)||e>=0)}async function w(e){const{features:t,attributes:n,includeZeros:r,includeNegatives:a,view:i}=e;let s=0,o=0,l=1/0,u=-1/0,c=null;const d=new Map;for(let m=0;m<n.length;m++){const{valueExpression:e}=n[m];if(e){if(!c){const{arcadeUtils:e}=await(0,b.lw)();c=e}d.set(m,c.createFunction(e))}}const f=i?c?.getViewInfo({viewingMode:"2d"===i.type?"map":i.viewingMode,scale:i.scale,spatialReference:i.spatialReference}):null;for(const m of t){const e=m.geometry,t=m.attributes;if(e){const p=e.extent;if(p){const e=p.width*p.height;if(e>0){let p=0;const h=c?.createExecContext(m,f,i?.timeZone);for(let e=0;e<n.length;e++){const{field:i,valueExpression:s}=n[e];let o=null;if(i)o=t[i];else if(s){const t=d.get(e);o=c.executeFunction(t,h)}v(o,r,a)&&(p+=o||0)}if(v(p,r,a)){const t=p/e;++s,o+=t,t<l&&(l=t),t>u&&(u=t)}}}}}return{minDensity:l!==1/0?l:null,maxDensity:u!==-1/0?u:null,avgDensity:s?o/s:null}}var S=n(34472);const x=500;async function M(e){const t=e.view;if(!(e?.layer&&t&&e.attributes?.length))throw new a.default("dot-density-renderer:missing-parameters","'layer', 'view' and 'attributes' parameters are required");if(e.attributes.length>8)throw new a.default("dot-density-renderer:invalid-parameters","Dot density renderer does not support more than 8 attributes");e.forBinning&&(0,p.p)(e,"dot-density-renderer");const n={...e,view:t,layer:e.layer,attributes:e.attributes},r=[g.mb.FeatureLayer,g.mb.ParquetLayer,g.mb.KnowledgeGraphSublayer,g.mb.OGCFeatureLayer,g.mb.GeoJSONLayer,g.mb.WFSLayer],i=e.forBinning?g.Mi:r,s=(0,g.Jg)(n.layer,i,e.forBinning);if(!s)throw new a.default("dot-density-renderer:invalid-parameters","'layer' must be one of these types: "+(0,g.Ho)(i).join(", "));n.dotBlendingEnabled??=!0,n.dotValueOptimizationEnabled??=!0;const o=null!=n.signal?{signal:n.signal}:null;if(await Promise.all([t.when(),s.load(o)]),"polygon"!==s.geometryType)throw new a.default("dot-density-renderer:not-supported","Dot density renderer is supported for polygon layers only");const l=[],u=n.attributes;for(const a of u){const e=await(0,h.EG)({field:a.field,valueExpression:a.valueExpression});l.push(...e)}const c=(0,d.MH)(s,l.filter(Boolean),"dot-density-renderer:invalid-parameters");if(c)throw c;return{...n,layer:s}}function T(e){return{dotValue:1,referenceScale:e.scale,minSliderValue:1,maxSliderValue:100}}async function E(e){const{view:t,layer:n,attributes:r,signal:a,filter:s}=e,o=await n.getSampleFeatures({view:t,sampleSize:x,returnGeometry:!0,filter:s,signal:a},"json"),[l,c]=await Promise.all([(0,f.A)({features:o,geometryType:n.geometryType}),y({layer:n,attributes:r,filter:s,includeZeros:!1,includeNegatives:!1,view:t,signal:a})]),d=null!=l&&"avgSize"in l&&l.avgSize,m=c.avg;if(!d||!m)return T(t);const p=(0,i.i1)(t.scale,t.spatialReference);return{dotValue:u(m/(d*d/(p*p)*.1))||1,referenceScale:t.scale,minSliderValue:1,maxSliderValue:u(m)}}async function V(e){const{view:t,layer:n,attributes:r,signal:a,filter:s}=e,o=[];for(const i of r){const e=await(0,h.EG)({field:i.field,valueExpression:i.valueExpression});o.push(...e)}const l=await n.getSampleFeatures({view:t,sampleSize:x,requiredFields:o,filter:s,returnGeometry:!0,signal:a},"json"),{minDensity:c,maxDensity:d,avgDensity:f}=await w({features:l,attributes:r,includeZeros:!1,includeNegatives:!1,view:t});if(!f||!c||!d)return T(t);const m=(0,i.i1)(t.scale,t.spatialReference),p=m*m,g=u(c*p),y=u(d*p);let b=u(f*p*10)||1;return b>y&&(b=y),{dotValue:b,referenceScale:t.scale,minSliderValue:g,maxSliderValue:y}}async function k(e){const t=await M(e),n=t.layer,i=n.geometryType,u=await async function(e){let t=e.dotDensityScheme,n=null,r=null;const a=await(0,d.Ib)(e.basemap,e.view);if(n=null!=a.basemapId?a.basemapId:null,r=null!=a.basemapTheme?a.basemapTheme:null,t)return{scheme:(0,S.cloneScheme)(t),basemapId:n,basemapTheme:r};const i=(0,S.getSchemes)({numColors:e.attributes.length,basemapTheme:r});return i&&(t=i.primaryScheme,n=i.basemapId,r=i.basemapTheme),{scheme:t,basemapId:n,basemapTheme:r}}(t),c=u?.scheme;if(!c)throw new a.default("dot-density-renderer:insufficient-info","Unable to find dot-density scheme");const f=t.view,m=t.filter,p={layer:n,view:f,filter:m,attributes:t.attributes,signal:t.signal},h={layer:t.layer,view:f,filter:m,signal:t.signal},[g,y]=await Promise.all([t.trueDensity?V(p):E(p),t.outlineOptimizationEnabled?(0,l.A)(h).catch(d.ou):null]),{dotValue:b,referenceScale:v,minSliderValue:w,maxSliderValue:x}=g,T=(0,r.Iy)(c.colors,t.attributes.length),k=t.attributes.map(((e,t)=>({field:e.field,valueExpression:e.valueExpression,label:e.label,valueExpressionTitle:e.valueExpressionTitle,color:T[t]}))),D=new s.default({attributes:k,dotBlendingEnabled:t.dotBlendingEnabled,outline:y?(0,d.qc)(c,i,y.opacity):null,dotValue:b,referenceScale:t.dotValueOptimizationEnabled?v:null,legendOptions:t.legendOptions});return y?.visualVariables.length&&(D.visualVariables=y.visualVariables.map((e=>e.clone()))),D.authoringInfo=new o.default({type:"dot-density",minSliderValue:w,maxSliderValue:x}),{renderer:D,dotDensityScheme:c,basemapId:u.basemapId,basemapTheme:u.basemapTheme}}async function D(e){const{creatorParameters:t,renderer:n}=await async function(e){const t="regenerate-dot-density-renderer";await(0,c.AC)(e,t);const n=await(0,c.mE)(e);if("dot-density"!==(0,c.UJ)(n))throw new a.default(`${t}:invalid-parameters`,"Renderer is invalid");const{layer:r,forBinning:i,filter:s,view:o,signal:l}=e,u=(0,c.DW)(n),d=n.attributes.map((e=>({field:e.field,valueExpression:e.valueExpression,label:e.label,valueExpressionTitle:e.valueExpressionTitle}))),f=await M({layer:r,attributes:d,dotValueOptimizationEnabled:null!=n.referenceScale,outlineOptimizationEnabled:u,forBinning:i,filter:s,view:o,signal:l});return{...e,creatorParameters:f,renderer:n}}(e),{layer:r,attributes:i,outlineOptimizationEnabled:s,view:o,signal:u,filter:f}=t,m={layer:r,view:o,filter:f,attributes:i,signal:u},[p,h]=await Promise.all([t.trueDensity?V(m):E(m),s?(0,l.A)({layer:r,view:o,signal:u,filter:f}).catch(d.ou):null]),{dotValue:g,referenceScale:y,minSliderValue:b,maxSliderValue:v}=p;return n.dotValue=g,n.referenceScale=t.dotValueOptimizationEnabled?y:null,n.authoringInfo&&(n.authoringInfo.minSliderValue=b,n.authoringInfo.maxSliderValue=v),(0,c.ke)(n,h?.visualVariables,c._i),{renderer:n}}},79538:(e,t,n)=>{n.d(t,{BV:()=>E,EG:()=>v,Lk:()=>T,Ll:()=>D,Np:()=>c,R3:()=>k,SO:()=>p,T1:()=>V,UH:()=>u,Wy:()=>w,XR:()=>m,aM:()=>M,fs:()=>b,i0:()=>F,i3:()=>y});var r=n(66845),a=n(95011),i=n(96247),s=n(76983),o=n(73210),l=n(40731);const u=",",c={light:["streets","gray","topo","terrain","oceans","osm","gray-vector","streets-vector","topo-vector","streets-relief-vector","streets-navigation-vector","topo-3d","navigation-3d","streets-3d","osm-3d","gray-3d"],dark:["satellite","hybrid","dark-gray","dark-gray-vector","streets-night-vector","navigation-dark-3d","streets-dark-3d","dark-gray-3d"]},d="percent-of-total",f="field",m={exclude:["median"]},p={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864e5},h=new Set(["integer","small-integer"]);let g=null;const y=["date","date-only","timestamp-offset"];function b(e){return(0,a.isDateField)(e)||(0,a.isDateOnlyField)(e)||(0,a.isTimestampOffsetField)(e)}async function v(e){const{field:t,field2:n,field3:r,normalizationField:a,valueExpression:s}=e;let o=[];if(s){if(!g){const{arcadeUtils:e}=await(0,i.lw)();g=e}o=g.extractFieldNames(s)}return t&&o.push(t),n&&o.push(n),r&&o.push(r),a&&o.push(a),o}function w(e){let t=e.normalizationType;return t||(e.normalizationField?t=f:null!=e.normalizationTotal&&(t=d)),t??void 0}function S(e){return String(e).padStart(2,"0")}function x(e,t,n){let r;return"date"===t||"number"===t?("number"===t&&(e=new Date(e)),r=`TIMESTAMP'${n?e.getFullYear():e.getUTCFullYear()}-${S((n?e.getMonth():e.getUTCMonth())+1)}-${S(n?e.getDate():e.getUTCDate())} ${S(n?e.getHours():e.getUTCHours())}:${S(n?e.getMinutes():e.getUTCMinutes())}:${S(n?e.getSeconds():e.getUTCSeconds())}'`):r=e,r}function M(e,t,n,r){const{hasQueryEngine:a}=e,i=`(${x(n,T(e,n),a)} - ${x(t,T(e,t),a)})`;let s=p[r],o="/";return s<1&&(s=1/s,o="*"),{sqlExpression:1===s?i:`(${i} ${o} ${s})`,sqlWhere:null}}function T(e,t){if(t instanceof Date)return"date";if("number"==typeof t)return"number";if("string"==typeof t){const n=e.getField(t);if("<now>"===t.toLowerCase())return;if((0,a.isDateField)(n))return"field"}}function E(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c;for(const n in t)if(t[n].includes(e))return n}function V(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=null;return e&&("string"==typeof e?t.includes(e)&&(r=e):r=(0,s.q3)(e)),n?r||"gray":r}function k(e,t){const n=t&&e.getField(t);return!!n&&h.has(n.type)}function D(e){return`cast(${e} as float)`}function F(e,t){const{format:n,timeZoneOptions:a,fieldType:i}=t??{};let s,u;if(a&&({timeZone:s,timeZoneName:u}=(0,l.hv)(a.layerTimeZone,a.datesInUnknownTimezone,a.viewTimeZone,(0,r.J2)(n||"short-date-short-time"),i)),"string"==typeof e&&isNaN(Date.parse("time-only"===i?`1970-01-01T${e}Z`:e)))return e;switch(i){case"date-only":{const t=(0,r.J2)(n||"short-date");return"string"==typeof e?(0,r.iS)(e,{...t}):(0,r.Yq)(e,{...t,timeZone:o.n$})}case"time-only":{const t=(0,r.J2)(n||"short-time");return"string"==typeof e?(0,r.F8)(e,t):(0,r.Yq)(e,{...t,timeZone:o.n$})}case"timestamp-offset":{if(!s&&"string"==typeof e&&new Date(e).toISOString()!==e)return e;const t=n||a?(0,r.J2)(n||"short-date-short-time"):void 0,i=t?{...t,timeZone:s,timeZoneName:u}:void 0;return"string"==typeof e?(0,r.Ey)(e,i):(0,r.Yq)(e,i)}default:{const t=n||a?(0,r.J2)(n||"short-date-short-time"):void 0;return(0,r.Yq)("string"==typeof e?new Date(e):e,t?{...t,timeZone:s,timeZoneName:u}:void 0)}}}}}]);