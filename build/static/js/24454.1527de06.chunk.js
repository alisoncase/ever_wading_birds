"use strict";(self.webpackChunkever_wading_birds=self.webpackChunkever_wading_birds||[]).push([[24454,36447],{15739:(e,t,a)=>{a.d(t,{BH:()=>u,PD:()=>o,RK:()=>h,Vx:()=>c,Z5:()=>n,dx:()=>r,j5:()=>f,p4:()=>d,rV:()=>i,uS:()=>p});const n=120,i=[21,36,51,60],r=3.5,o=["FAR_WEST","FAR_NORTH","FAR_EAST","FAR_SOUTH","WEST","NORTH","EAST","SOUTH","NEAR_WEST","NEAR_NORTH","NEAR_EAST","NEAR_SOUTH"],s=23.937554159486076,l=96.06244584051393,c={EAST:[s,s,l,s,60,s],NORTH:[s,l,s,s,s,60],SOUTH:[l,s,l,l,l,60],WEST:[l,l,s,l,60,l]},u=-999,h=100,d=()=>["after-data-capture-complete","deselect-data-capture-features","select-data-capture-features"],f="ImageGeometry",p="OIObjectId"},24454:(e,t,a)=>{a.r(t),a.d(t,{worldToImage:()=>l,worldToImagePanoramic:()=>u,worldToImageWithLTPFlag:()=>c});var n=a(64682),i=a(28473),r=a(89227),o=a(5616),s=a(58507);function l(e,t){const{cameraLocation:a,pointsToTransform:n,scalingFactor:o}=function(e,t,a){const n=Array.isArray(e)||"items"in e?e:[e];(0,s.N5)(n,t),h(n,t),(0,s._)(a);const i=(0,s.i2)(t.y,t.spatialReference);return{pointsToTransform:n.map((e=>e.toArray())),scalingFactor:i,cameraLocation:t.toArray()}}(e,t.cameraLocation,t.rotationMatrix),l=new Array;return function(e,t,a){const{affineTransformations:n,cameraLocation:o,focalLengthX:s,focalLengthY:l,principalOffsetPoint:c,radialDistortionCoefficients:u,rotationMatrix:h,scalingFactor:d,tangentialDistortionCoefficients:f}=a;for(const p of e){const e=(0,i.vt)();(0,r.a)(e,p,o),e[0]=e[0]/d,e[1]=e[1]/d;const a=-s*((h[0]*e[0]+h[3]*e[1]+h[6]*e[2])/(h[2]*e[0]+h[5]*e[1]+h[8]*e[2])),m=-l*((h[1]*e[0]+h[4]*e[1]+h[7]*e[2])/(h[2]*e[0]+h[5]*e[1]+h[8]*e[2])),v=a*a+m*m;let y=0,g=0,w=0,M=0,x=0,_=0,A=0;u&&(y=u[0]??0,g=u[1]??0,w=u[2]??0),f&&(M=f[0],x=f[1]),c&&(_=c[0]??0,A=c[1]??0);const b=1+y*v+g*v*v+w*v*v*v;let T=a*b+M*(v+2*a**2)+2*x*a*m,E=m*b+x*(v+2*m**2)+2*M*a*m;T+=_,E+=A;const L=Number(n[0])+Number(n[1])*T+Number(n[2])*E,S=Number(n[3])+Number(n[4])*T+Number(n[5])*E;t.push({x:L,y:S})}}(n,l,{...t,cameraLocation:a,scalingFactor:o,...d(t)}),Array.isArray(e)?l:l[0]}function c(e,t,a){return l(e?t.map((e=>(0,o.webMercatorToGeographic)(e))):t,a).map((e=>({...e,z:1})))}function u(e,t){const{cameraHeading:a,imageHeight:i,imageWidth:o}=t,{cameraLocation:l,pointsToTransform:c}=function(e,t){const a=Array.isArray(e)||"items"in e?e:[e];return(0,s.N5)(a,t),h(a,t),{pointsToTransform:a.map((e=>e.toArray())),cameraLocation:t.toArray()}}(e,t.cameraLocation),u=new Array;for(const h of c){const e=(0,r.j)(l,h),t=(0,s.MO)((0,n.KJ)(Math.atan2(h[0]-l[0],h[1]-l[1]))-a),c=(0,n.KJ)(Math.acos((l[2]-h[2])/e));u.push((0,s._H)(t,c,o,i))}return Array.isArray(e)?u:u[0]}function h(e,t){if(e.some((e=>!e.spatialReference.equals(t.spatialReference))))throw new Error("Input points and camera location must have the same spatial reference")}function d(e){if(function(e){return null!=e?.focalLength}(e))return{focalLengthX:e.focalLength,focalLengthY:e.focalLength};const{imageWidth:t,imageHeight:a,horizontalFieldOfView:i,verticalFieldOfView:r}=e;return{focalLengthX:t/(2*Math.tan((0,n.kU)(i)/2)),focalLengthY:a/(2*Math.tan((0,n.kU)(r)/2))}}},24795:(e,t,a)=>{a.d(t,{i:()=>n});class n{constructor(e,t,a,n){this._hasNoDataValues=null,this._minValue=null,this._maxValue=null,"pixelData"in e?(this.values=e.pixelData,this.width=e.width,this.height=e.height,this.noDataValue=e.noDataValue):(this.values=e,this.width=t,this.height=a,this.noDataValue=n)}get hasNoDataValues(){if(null==this._hasNoDataValues){const e=this.noDataValue;this._hasNoDataValues=this.values.includes(e)}return this._hasNoDataValues}get minValue(){return this._ensureBounds(),this._minValue}get maxValue(){return this._ensureBounds(),this._maxValue}get cachedMemory(){return this.values.byteLength+256}_ensureBounds(){if(null!=this._minValue)return;const{noDataValue:e,values:t}=this;let a=1/0,n=-1/0,i=!0;for(const r of t)r===e?this._hasNoDataValues=!0:(a=r<a?r:a,n=r>n?r:n,i=!1);i?(this._minValue=0,this._maxValue=0):(this._minValue=a,this._maxValue=n>-3e38?n:0)}}},27411:(e,t,a)=>{a.d(t,{q:()=>i});var n=a(68039);class i{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.tile=e,null!=t&&null!=e){const a=e.extent;this._samplerData=new n.Q(t,a)}}get zmin(){return null!=this._samplerData?this._samplerData.data.minValue:0}get zmax(){return null!=this._samplerData?this._samplerData.data.maxValue:0}get hasNoDataValues(){return!!this._samplerData?.data.hasNoDataValues}sample(e,t){if(null==this._samplerData)return;const{safeWidth:a,data:n,dx:i,dy:o,y1:s,x0:l}=this._samplerData,{width:c,values:u,noDataValue:h}=n,d=r(o*(s-t),0,a),f=r(i*(e-l),0,a),p=Math.floor(d),m=Math.floor(f),v=p*c+m,y=v+c,g=u[v],w=u[y],M=u[v+1],x=u[y+1];if(g!==h&&w!==h&&M!==h&&x!==h){const e=f-m,t=g+(M-g)*e;return t+(w+(x-w)*e-t)*(d-p)}}}function r(e,t,a){return e<t?t:e>a?a:e}},33894:(e,t,a)=>{a.d(t,{A:()=>r});var n=a(74719),i=a(49959);class r{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.lods[e.lods.length-1].level;this.tileInfo=e,this.minLOD=t,this.maxLOD=a,e.lodAt(t)||(this.minLOD=e.lods[0].level),e.lodAt(a)||(this.maxLOD=e.lods[e.lods.length-1].level)}get effectiveMinLOD(){return this.minLOD??this.tileInfo.lods[0].level}get effectiveMaxLOD(){return this.maxLOD??this.tileInfo.lods[this.tileInfo.lods.length-1].level}getAvailability(e,t,a){const n=this.tileInfo?.lodAt(e);return!n||e<this.minLOD||e>this.maxLOD?"unavailable":n.cols&&n.rows?a>=n.cols[0]&&a<=n.cols[1]&&t>=n.rows[0]&&t<=n.rows[1]?"unknown":"unavailable":"unknown"}async fetchAvailability(e,t,a,r){await(0,i.waitTick)(r);const o=this.getAvailability(e,t,a);if("unavailable"===o)throw new n.default("tile-map:tile-unavailable","Tile is not available",{level:e,row:t,col:a});return o}async fetchAvailabilityUpsample(e,t,a,n,r){await(0,i.waitTick)(r),n.level=e,n.row=t,n.col=a;const o=this.tileInfo;return o.updateTileInfo(n),this.fetchAvailability(e,t,a,r).catch((e=>{if((0,i.isAbortError)(e))throw e;if(o.upsampleTile(n))return this.fetchAvailabilityUpsample(n.level,n.row,n.col,n,r);throw e}))}}},36447:(e,t,a)=>{a.r(t),a.d(t,{ElevationSamplerBase:()=>u,MultiTileElevationSampler:()=>d,TileElevationSampler:()=>h,updateGeometryElevation:()=>f});a(21265);var n=a(42198),i=a(50925),r=a(84190),o=a(75400),s=a(90772),l=a(5616);const c=()=>i.A.getLogger("esri.layers.support.ElevationSampler");class u{queryElevation(e){return f(e.clone(),this)}on(){return(0,n.hA)()}projectIfRequired(e,t){return p(e,t)}}class h extends u{get spatialReference(){return this.extent.spatialReference}constructor(e,t,a){super(),this.tile=e,this.noDataValue=a;const n=e.tile.extent;this.extent=(0,s.w1)(n,t.spatialReference),this.extent.zmin=e.zmin,this.extent.zmax=e.zmax,this._aaExtent=n;const i=(0,r.GA)(t.spatialReference),o=t.lodAt(e.tile.level).resolution*i;this.demResolution={min:o,max:o}}contains(e){const t=this.projectIfRequired(e,this.spatialReference);return null!=t&&this.containsAt(t.x,t.y)}containsAt(e,t){return(0,s.Rj)(this._aaExtent,e,t)}elevationAt(e,t){if(!this.containsAt(e,t)){const a=this.extent,n=`${a.xmin}, ${a.ymin}, ${a.xmax}, ${a.ymax}`;return c().warn("#elevationAt()",`Point used to sample elevation (${e}, ${t}) is outside of the sampler extent (${n})`),this.noDataValue}return this.tile.sample(e,t)??this.noDataValue}}class d extends u{get spatialReference(){return this.extent.spatialReference}constructor(e,t,a){let n;super(),"number"==typeof t?(this.noDataValue=t,n=null):(n=t,this.noDataValue=a),this.samplers=n?e.map((e=>new h(e,n,this.noDataValue))):e;const i=this.samplers[0];if(i){this.extent=i.extent.clone();const{min:e,max:t}=i.demResolution;this.demResolution={min:e,max:t};for(let a=1;a<this.samplers.length;a++){const e=this.samplers[a];this.extent.union(e.extent),this.demResolution.min=Math.min(this.demResolution.min,e.demResolution.min),this.demResolution.max=Math.max(this.demResolution.max,e.demResolution.max)}}else this.extent=(0,s.w1)((0,s.vt)(),n.spatialReference),this.demResolution={min:0,max:0}}elevationAt(e,t){let a,n=!1;for(const i of this.samplers)if(i.containsAt(e,t)&&(n=!0,a=i.elevationAt(e,t),a!==i.noDataValue))return a;return null!=a?a:(n||c().warn("#elevationAt()",`Point used to sample elevation (${e}, ${t}) is outside of the sampler`),this.noDataValue)}}function f(e,t){const a=p(e,t.spatialReference);if(!a)return null;switch(e.type){case"point":!function(e,t,a){e.z=a.elevationAt(t.x,t.y)}(e,a,t);break;case"polyline":!function(e,t,a){m.spatialReference=t.spatialReference;const n=e.hasM&&!e.hasZ;for(let i=0;i<e.paths.length;i++){const r=e.paths[i],o=t.paths[i];for(let e=0;e<r.length;e++){const t=r[e],i=o[e];m.x=i[0],m.y=i[1],n&&(t[3]=t[2]),t[2]=a.elevationAt(m.x,m.y)}}e.hasZ=!0}(e,a,t);break;case"multipoint":!function(e,t,a){m.spatialReference=t.spatialReference;const n=e.hasM&&!e.hasZ;for(let i=0;i<e.points.length;i++){const r=e.points[i],o=t.points[i];m.x=o[0],m.y=o[1],n&&(r[3]=r[2]),r[2]=a.elevationAt(m.x,m.y)}e.hasZ=!0}(e,a,t)}return e}function p(e,t){if(null==e)return null;const a=e.spatialReference;if(a.equals(t))return e;const n=(0,l.project)(e,t);return n||c().error(`Cannot project geometry spatial reference (wkid:${a.wkid}) to elevation sampler spatial reference (wkid:${t.wkid})`),n}const m=new o.default},41755:(e,t,a)=>{a.d(t,{Cg:()=>h,DU:()=>s,EW:()=>y,FL:()=>f,Fe:()=>m,Gd:()=>o,NL:()=>p,RP:()=>l,_U:()=>c,br:()=>v,gt:()=>g,mz:()=>d,wB:()=>u});var n=a(23060),i=a(50925),r=a(15739);function o(e){return"3d"===e?.type}function s(e){return"esri.Graphic"===e?.declaredClass}function l(e){return/(tiff|tif|mrf)$/i.test(e??"")}function c(e){if(!e)return!1;if(!URL.canParse(e))return!1;const{pathname:t}=new URL(e);return/.*\.(tiff|tif|mrf)$/i.test(t??"")}function u(e){return Math.abs(e)>=135?"WEST":e<-45&&e>-135?"SOUTH":e<=45?"EAST":"NORTH"}function h(e,t){const a=e/t*r.rV[2];return a<=r.rV[0]?"NEAR":a<=r.rV[1]?"":"FAR"}function d(e){return"string"==typeof e&&e.length?e:function(e){return e&&e.url&&e.datasetFormat?e:null}(e)}const f=e=>t=>t.layer===e;function p(e){return"NoAttachmentError"===e?.name}const m=e=>`${e}:missing-property`,v=(e,t)=>`Property ${t} is missing in ${e}`,y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"esri.widgets.OrientedImageryViewer",t=arguments.length>1?arguments[1]:void 0;throw i.A.getLogger(e).error(t),t},g=async(e,t)=>{const a=await(0,n.default)(e,{...t,method:"head"}),i=a?.getHeader?.("Content-Type");if(i)return i.split("/")[1]}},43879:(e,t,a)=>{a.d(t,{EA:()=>l,EF:()=>s,ZH:()=>r,li:()=>c,vK:()=>o});var n=a(75400),i=a(93321);const r=new n.default({x:0,y:0,z:0,spatialReference:i.default.WebMercator}),o=1e3,s=114,l=120,c=50},48039:(e,t,a)=>{a.d(t,{E1:()=>u,Mr:()=>c,TH:()=>l,jV:()=>h});var n=a(93800),i=a(85715),r=a(19455),o=a(48602),s=(a(21265),a(50925),a(14746),a(75269));let l=class extends(i.A.ClonableMixin(r.A)){constructor(){super(...arguments),this.url=null}};(0,n._)([(0,o.MZ)({type:Number,json:{write:!0}})],l.prototype,"lod",void 0),(0,n._)([(0,o.MZ)({type:String,json:{write:!0}})],l.prototype,"rasterFunction",void 0),(0,n._)([(0,o.MZ)({type:String,json:{write:!0}})],l.prototype,"url",void 0),l=(0,n._)([(0,s.$)("esri.layers.orientedImagery.core.ElevationSourceDefinitions.ElevationSource")],l);let c=class extends(i.A.ClonableMixin(r.A)){constructor(){super(...arguments),this.constantElevation=null}};(0,n._)([(0,o.MZ)({type:Number,json:{write:!0}})],c.prototype,"constantElevation",void 0),c=(0,n._)([(0,s.$)("esri.layers.orientedImagery.core.ElevationSourceDefinitions.ConstantElevation")],c);const u=e=>null!=e&&"number"==typeof e.constantElevation,h=e=>null!=e&&e.url?.length>0},52622:(e,t,a)=>{a.r(t),a.d(t,{default:()=>b});var n=a(93800),i=a(23060),r=a(74719),o=a(17741),s=a(59321),l=a(49959),c=a(43103),u=a(48602),h=(a(21265),a(50925),a(14746),a(14800)),d=a(75269),f=a(82770),p=a(57457),m=a(67033),v=a(9171),y=a(8592),g=a(30528),w=a(75238),M=a(24795),x=a(54028);let _=class extends((0,m.f)((0,v.b)((0,y.q)((0,g.A)((0,s.P)(p.default)))))){constructor(){super(...arguments),this.capabilities={operations:{supportsTileMap:!1}},this.copyright=null,this.heightModelInfo=null,this.path=null,this.minScale=void 0,this.maxScale=void 0,this.opacity=1,this.operationalLayerType="ArcGISTiledElevationServiceLayer",this.sourceJSON=null,this.type="elevation",this.url=null,this.version=null,this._lercDecoder=(0,x.b)()}normalizeCtorArgs(e,t){return"string"==typeof e?{url:e,...t}:e}destroy(){this._lercDecoder=(0,o.Gz)(this._lercDecoder)}readCapabilities(e,t){const a=t.capabilities&&t.capabilities.split(",").map((e=>e.toLowerCase().trim()));return a?{operations:{supportsTileMap:a.includes("tilemap")}}:{operations:{supportsTileMap:!1}}}readVersion(e,t){let a=t.currentVersion;return a||(a=9.3),a}load(e){const t=null!=e?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"],supportsData:!1,validateItem:e=>{if(e.typeKeywords)for(let t=0;t<e.typeKeywords.length;t++)if("elevation 3d layer"===e.typeKeywords[t].toLowerCase())return!0;throw new r.default("portal:invalid-layer-item-type","Invalid layer item type '${type}', expected '${expectedType}' ",{type:"Image Service",expectedType:"Image Service Elevation 3D Layer"})}},e).catch(l.throwIfAbortError).then((()=>this._fetchImageService(t)))),Promise.resolve(this)}fetchTile(e,t,a,n){const r=n?.signal,o={responseType:"array-buffer",signal:r},s={noDataValue:n?.noDataValue,returnFileInfo:!0};return this.load().then((()=>this._fetchTileAvailability(e,t,a,n))).then((()=>(0,i.default)(this.getTileUrl(e,t,a),o))).then((e=>this._lercDecoder.decode(e.data,s,r))).then((e=>new M.i(e)))}getTileUrl(e,t,a){const n=!this.capabilities.operations.supportsTileMap&&this.supportsBlankTile,i=(0,c.objectToQuery)({...this.parsedUrl.query,blankTile:!n&&null});return`${this.parsedUrl.path}/tile/${e}/${t}/${a}${i?"?"+i:""}`}async queryElevation(e,t){const{ElevationQuery:n}=await a.e(3363).then(a.bind(a,3363));return(0,l.throwIfAborted)(t),(new n).query(this,e,t)}async createElevationSampler(e,t){const{ElevationQuery:n}=await a.e(3363).then(a.bind(a,3363));return(0,l.throwIfAborted)(t),(new n).createSampler(this,e,t)}_fetchTileAvailability(e,t,a,n){return this.tilemapCache?this.tilemapCache.fetchAvailability(e,t,a,n):Promise.resolve("unknown")}async _fetchImageService(e){if(this.sourceJSON)return this.sourceJSON;const t={query:{f:"json",...this.parsedUrl.query},responseType:"json",signal:e},a=await(0,i.default)(this.parsedUrl.path,t);a.ssl&&(this.url=this.url?.replace(/^http:/i,"https:")),this.sourceJSON=a.data,this.read(a.data,{origin:"service",url:this.parsedUrl})}get hasOverriddenFetchTile(){return!this.fetchTile[A]}};(0,n._)([(0,u.MZ)({readOnly:!0})],_.prototype,"capabilities",void 0),(0,n._)([(0,h.w)("service","capabilities",["capabilities"])],_.prototype,"readCapabilities",null),(0,n._)([(0,u.MZ)({json:{read:{source:"copyrightText"}}})],_.prototype,"copyright",void 0),(0,n._)([(0,u.MZ)({readOnly:!0,type:f.default})],_.prototype,"heightModelInfo",void 0),(0,n._)([(0,u.MZ)({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],_.prototype,"path",void 0),(0,n._)([(0,u.MZ)({type:["show","hide"]})],_.prototype,"listMode",void 0),(0,n._)([(0,u.MZ)({json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-document":{read:!1,write:!1}}},readOnly:!0})],_.prototype,"minScale",void 0),(0,n._)([(0,u.MZ)({json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-document":{read:!1,write:!1}}},readOnly:!0})],_.prototype,"maxScale",void 0),(0,n._)([(0,u.MZ)({json:{read:!1,write:!1,origins:{"web-document":{read:!1,write:!1}}}})],_.prototype,"opacity",void 0),(0,n._)([(0,u.MZ)({type:["ArcGISTiledElevationServiceLayer"]})],_.prototype,"operationalLayerType",void 0),(0,n._)([(0,u.MZ)()],_.prototype,"sourceJSON",void 0),(0,n._)([(0,u.MZ)({json:{read:!1},value:"elevation",readOnly:!0})],_.prototype,"type",void 0),(0,n._)([(0,u.MZ)(w.OZ)],_.prototype,"url",void 0),(0,n._)([(0,u.MZ)()],_.prototype,"version",void 0),(0,n._)([(0,h.w)("version",["currentVersion"])],_.prototype,"readVersion",null),_=(0,n._)([(0,d.$)("esri.layers.ElevationLayer")],_);const A=Symbol("default-fetch-tile");_.prototype.fetchTile[A]=!0;const b=_},54028:(e,t,a)=>{a.d(t,{b:()=>o});var n=a(74125);class i extends n.B{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super("LercWorker","_decode",{_decode:e=>[e.buffer]},e,{strategy:"dedicated"}),this.schedule=e,this.ref=0}decode(e,t,a){return e&&0!==e.byteLength?this.invoke({buffer:e,options:t},a):Promise.resolve(null)}release(){--this.ref<=0&&(r.forEach(((e,t)=>{e===this&&r.delete(t)})),this.destroy())}}const r=new Map;function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=r.get(e);return t||(null!=e?(t=new i((t=>e.immediate.schedule(t))),r.set(e,t)):(t=new i,r.set(null,t))),++t.ref,t}},58507:(e,t,a)=>{a.d(t,{D5:()=>F,Dy:()=>ue,Hk:()=>re,L2:()=>ie,MO:()=>ce,MY:()=>T,Mm:()=>Y,N5:()=>j,Ns:()=>ne,Qu:()=>E,SP:()=>te,Yc:()=>K,ZA:()=>$,Zq:()=>I,_:()=>q,_H:()=>C,_i:()=>R,cC:()=>Z,cL:()=>_,cV:()=>G,cb:()=>ee,dM:()=>N,eM:()=>oe,ei:()=>L,i2:()=>W,id:()=>U,m0:()=>X,n3:()=>P,or:()=>H,ox:()=>z,pq:()=>k,sp:()=>B,tB:()=>ae,x1:()=>V});var n=a(74719),i=a(19455),r=a(64682),o=a(13473),s=a(10382),l=a(24646),c=a(28473),u=a(67965),h=a(87752),d=a(89227),f=a(75400),p=a(96913),m=a(23311),v=a(70576),y=a(40753),g=a(48039),w=a(74197),M=a(69943),x=a(43879);function _(e,t,a){const[n,i,r,o]=t,[l,c,u,d]=a;A(n,i,r,o);const f=A(l,c,u,d),p=b(n,i,r,o),m=b(l,c,u,d),v=(0,h.Qw)((0,s.vt)(),p),y=(0,h.lK)((0,s.vt)(),v,m),[g,w,M,x]=function(e,t){const[a,n,i]=e,r=[0,0,0,0];return r[0]=a*t[0]+n*t[1]+i*t[2]+t[3],r[1]=a*t[4]+n*t[5]+i*t[6]+t[7],r[2]=a*t[8]+n*t[9]+i*t[10]+t[11],r[3]=function(e){return 0===e?1:e}(a*t[12]+n*t[13]+i*t[14]+t[15]),r}(e,y);return[g/x,w/x,f?0:M/x]}function A(e,t,a,n){return 0===e[2]&&0===t[2]&&0===a[2]&&0===n[2]&&(e[2]=t[2]=a[2]=n[2]=1,!0)}function b(e,t,a,n){const i=function(e,t){const[a,n,i,r]=e,o=new Array(4);return o[0]=a*t[0]+n*t[1]+i*t[2]+r*t[3],o[1]=a*t[4]+n*t[5]+i*t[6]+r*t[7],o[2]=a*t[8]+n*t[9]+i*t[10]+r*t[11],o[3]=a*t[12]+n*t[13]+i*t[14]+r*t[15],o}((0,l.ci)([...n,1]),(0,h.Qw)(new Array(16),(0,s.fA)(e[0],t[0],a[0],0,e[1],t[1],a[1],0,e[2],t[2],a[2],0,1,1,1,1))),r=i[0],o=i[1],c=i[2],u=(0,s.vt)();return u[0]=r*e[0],u[1]=o*t[0],u[2]=c*a[0],u[3]=0,u[4]=r*e[1],u[5]=o*t[1],u[6]=c*a[1],u[7]=0,u[8]=r*e[2],u[9]=o*t[2],u[10]=c*a[2],u[11]=0,u[12]=r,u[13]=o,u[14]=c,u[15]=1,u}function T(e,t,a,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:(0,c.Ul)();return i[0]=e[0]+t[0]*a,i[1]=e[1]+t[1]*a,i[2]=e[2]+t[2]*(a/n),i}function E(e,t,a){const n=(0,c.Ul)();return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*(t/a),n}function L(e,t){const[a,n,i]=e,r=(0,c.Ul)();return r[0]=a*t[0]+n*t[3]+i*t[6],r[1]=a*t[1]+n*t[4]+i*t[7],r[2]=a*t[2]+n*t[5]+i*t[8],r}function S(e,t,a){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!Number.isFinite(e))throw new n.default("InvalidRotationAngle","Please specify a valid angle for rotation");const s=a*(i?(0,r.kU)(e):e),l=Math.cos(s),c=Math.sin(s),u=(0,o.vt)();switch(t){case 0:u[4]=l,u[5]=-c,u[7]=c,u[8]=l;break;case 1:u[0]=l,u[2]=c,u[6]=-c,u[8]=l;break;case 2:u[0]=l,u[1]=-c,u[3]=c,u[4]=l;break;default:throw new n.default("InvalidRotationAxis","Please specify either 0, 1 or 2 for X, Y or Z axis respectively")}return u}const D={HPR:[[2,-1],[0,1],[2,-1]],OPK:[[0,1],[1,1],[2,1]]};function O(e,t){let a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(3!==e?.length||3!==t?.length)throw new n.default("InvalidRotationAngles","Please specify three angles with config for rotation");const i=(0,o.vt)();for(let n=0;n<3;n++){const[r,o]=t[n],s=S(e[n],r,o,a);(0,u.lw)(i,s,i)}return i}function R(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return O(e,D.HPR,t)}function V(e,t,a){const n=Math.sin((0,r.kU)(a)),i=Math.cos((0,r.kU)(a)),o=[[e,0],[e,t],[0,t]];o.forEach(((e,t)=>{o[t]=[i*e[0]-n*e[1],n*e[0]+i*e[1]]}));const s=Math.min(0,o[0][0],o[1][0],o[2][0]),l=Math.max(0,o[0][0],o[1][0],o[2][0]),c=Math.min(0,o[0][1],o[1][1],o[2][1]),u=Math.max(0,o[0][1],o[1][1],o[2][1]);return{hfov:Math.abs(l-s),vfov:Math.abs(u-c)}}function I(e,t){const a=Number(e[0]),n=Number(e[1]),i=Number(e[2]),[o,s,l,c]=t,u=(0,r.kU)(o),h=(0,r.kU)(s),d=l/Math.sqrt(1-c*Math.sin(u)**2),f=a/d,p=n/d,m=i/d,v=Math.cos(u)-Math.sin(u)*p+Math.cos(u)*m,y=Math.sin(u)+Math.cos(u)*p+Math.sin(u)*m,g=Math.sqrt(v**2+f**2),w=c*d*Math.sin(u),M=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if(0===t)return e;const a=M(e,t-1);return Math.atan(y/g-(w-c*(l/Math.sqrt(1-c*Math.sin(a)**2))*Math.sin(a))/(d*g))},x=M(u),_=Math.atan(a/(d*v))+h,A=(0,r.KJ)(x);return[(0,r.KJ)(_),A,a/(Math.cos(x)*Math.sin(_-h))-l/Math.sqrt(1-c*Math.sin(x)**2)]}function N(e,t,a){const n=360/t,i=180/a;return{heading:(e.x-t/2)*n,pitch:90-(e.y-a/2)*i}}function k(e,t,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:x.vK/2;const{heading:i,pitch:o}=function(e,t){const a=(0,r.KJ)(Math.acos(-e.z/t));return{heading:(0,r.KJ)(Math.atan2(e.x,e.y)),pitch:a}}(e,n);return C(i,o,t,a)}function C(e,t,a,n){return{x:a/2+e/(360/a),y:n-t/(180/n),heading:e,pitch:t}}function U(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:x.vK/2;return[a*(Math.sin((0,r.kU)(e))*Math.sin((0,r.kU)(t))),a*(Math.cos((0,r.kU)(e))*Math.sin((0,r.kU)(t))),a*Math.cos((0,r.kU)(180-t))]}function F(e,t,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:x.vK/2;const{heading:i,pitch:r}=N(e,t,a);return U(i,r,n)}async function z(e,t,a){const n=await(0,p.projectWithZConversion)(t,e.spatialReference,a);let i=(0,r.KJ)(Math.atan2(n.y-e.y,n.x-e.x));return i=i>=0&&i<=90?90-i:i>90&&i<=180?360-i+90:90+Math.abs(i),i}function Z(e,t,a){const n=Math.cos(a),i=Math.sin(a),r=[1,0,0,1,0,0],o=r[0]*n+r[2]*i,s=r[1]*n+r[3]*i,l=-r[0]*i+r[2]*n,c=-r[1]*i+r[3]*n;return r[0]=o,r[1]=s,r[2]=l,r[3]=c,[e*r[0]+t*r[2]+r[4],e*r[1]+t*r[3]+r[5]]}const P=e=>e.toArray(),H=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.some((e=>e))};function $(e,t){if(H(0===e.length,e.some((e=>{let{x:t,y:a}=e;return H(null==t,null==a)})),!t.hasZ))throw new Error("Input pixels must have x, y and camera location must have z value")}function j(e,t){if(e.some((e=>null==e.z))||null==t.z)throw new Error("Input points and camera location must have z value")}function q(e){if(9!==e?.length)throw new Error("Rotation matrix is not provided or is not a valid 3x3 matrix")}function W(e,t){return(0,v.K8)(t)?1/Math.cos(Math.PI/2-2*Math.atan(Math.exp(-1*e/m.$O.radius))):1}const K=e=>t=>new f.default(t,e),B=e=>null!=e&&"queryExtent"in e;function G(e,t,a,n){return[[-t,-t],[+t,-t],[+t,+t],[-t,+t]].map((t=>{let[i,r]=t;return _((0,y.a)((0,c.Ul)(),a,[i,r,0]),n,e)}))}function J(e,t){if(null==e)return null;const a=parseFloat(`${e}`);return isNaN(a)?null:a}function Y(e,t,a){const{cameraHeight:n,cameraPitch:i,cameraRoll:r,elevation:o,farDistance:s,horizontalFieldOfView:l,location:c,verticalFieldOfView:u}=e,h=o??(c.z??0)-n;return{...ee(e,t,a),averageElevation:h,cameraPitch:i,cameraRoll:r??0,farDistance:s,horizontalFieldOfView:l,verticalFieldOfView:u}}function Q(e,t,a,n){return se(n)?function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return O(e,D.OPK,t)}([n.omega,n.phi,n.kappa]):le(n)?R([n.heading,n.pitch,n.roll]):R([e,t,a??0])}function X(e,t,a){const{cameraHeading:n,cameraHeight:i,elevation:r,farDistance:o,horizontalFieldOfView:s,location:l,verticalFieldOfView:c}=e;return{averageElevation:r??(l.z??0)-i,cameraLocation:l,cameraHeading:n,farDistance:o,horizontalFieldOfView:s,imageHeight:a,imageWidth:t,verticalFieldOfView:c}}function ee(e,t,a){const{a0:n,a1:i,a2:r,b0:o,b1:s,b2:l,cameraHeading:c,cameraOrientation:u,cameraPitch:h,cameraRoll:d,focalLength:f,horizontalFieldOfView:p,location:m,matrix:v,principalX:y,principalY:g,radial:w,tangential:M,verticalFieldOfView:x}=e,{affines:_,focalLength:A}=function(e,t,a,n){let{a0:i,a1:r,a2:o,b0:s,b1:l,b2:c}=e;const u=[i??t/2-.5,r,o??0,s??a/2-.5,l??0,c].map(J);return null!=n&&function(e){return null!=e[1]&&null!=e[5]}(u)?{affines:u,focalLength:n}:{affines:[t/2-.5,1,0,a/2-.5,0,-1]}}({a0:n,a1:i,a2:r,b0:o,b1:s,b2:l},t,a,f),b=v??Q(c,h,d,u),T=null!=y&&null!=g?[y,g]:void 0;return{affineTransformations:u?.affineTransformations??_,cameraLocation:m.clone(),focalLength:u?.focalLength??A,horizontalFieldOfView:p,imageHeight:a,imageWidth:t,principalOffsetPoint:u?.principalOffsetPoint??T,radialDistortionCoefficients:u?.radialDistortionCoefficients??w,rotationMatrix:b,tangentialDistortionCoefficients:u?.tangentialDistortionCoefficients??M,verticalFieldOfView:x}}const te=e=>null!=e&&"elevationSample"in e&&null!=e.elevationSample,ae=e=>(0,g.jV)(e?.elevationSource)&&null!=e?.extent,ne=async(e,t)=>null!=t&&(te(t)||(e=>(0,g.E1)(e?.elevationSource))(t))?t:ae(t)?{elevationSample:await(0,w.gm)({...i.A.isSerializable(t.elevationSource)?t.elevationSource.toJSON():t.elevationSource,extent:t.extent}),elevationSource:new g.Mr({constantElevation:e})}:{elevationSource:new g.Mr({constantElevation:e})},ie=e=>(0,M.Et)(e?.heading)&&(0,M.Et)(e?.pitch),re=(e,t)=>[[-e,-t],[e,-t],[e,t],[-e,t]];function oe(e){const{cameraLocation:t,farDistance:a,horizontalFieldOfView:n,rotationMatrix:i,scalingFactor:s,verticalFieldOfView:l}=e,h=(0,o.vt)();(0,u.mg)(h,i);const f=2*Math.tan((0,r.kU)(l)/2)*a*s,p=2*Math.tan((0,r.kU)(n)/2)*a*s,m=L([0,0,-1],h),v=T([t.x,t.y,t.z],m,e.farDistance*s,s),y=L([0,1,0],h),g=L([1,0,0],h),w=E(y,f/2,s),M=E(g,p/2,s),x=(0,d.a)((0,c.Ul)(),w,M),_=(0,d.g)((0,c.Ul)(),w,M);return[(0,d.g)((0,c.Ul)(),v,x),(0,d.g)((0,c.Ul)(),v,_),(0,d.a)((0,c.Ul)(),v,x),(0,d.a)((0,c.Ul)(),v,_)]}const se=e=>2===e?.type,le=e=>1===e?.type;function ce(e){const t=e%360;return t<-180?t+360:t}function ue(e,t,a){if("panoramic"===e){const[e,n]=a;return k({x:t.x,y:t.y,z:t.z},e,n)}return{x:t.x+.5,y:.5-t.y}}var he;!function(e){e[e.CLOCKWISE=-1]="CLOCKWISE",e[e.COUNTERCLOCKWISE=1]="COUNTERCLOCKWISE"}(he||(he={}))},67033:(e,t,a)=>{a.d(t,{f:()=>h});var n=a(93800),i=a(48602),r=(a(21265),a(50925),a(14746),a(14800)),o=a(75269),s=a(93321),l=a(4126),c=a(33894),u=a(40278);const h=e=>{let t=class extends e{constructor(){super(...arguments),this.copyright=null,this.minScale=0,this.maxScale=0,this.spatialReference=null,this.tileInfo=null,this.tilemapCache=null}destroy(){this.tilemapCache?.destroy?.()}readMinScale(e,t){return null!=t.minLOD&&null!=t.maxLOD?e:0}readMaxScale(e,t){return null!=t.minLOD&&null!=t.maxLOD?e:0}get supportsBlankTile(){return this.version>=10.2}readTilemapCache(e,t,a){const n=t.capabilities?.includes("Tilemap");let{minLOD:i,maxLOD:r,minScale:o,maxScale:s}=t;if(null==i&&null==r&&(0!==o||0!==s)){const e=e=>Math.round(1e4*e)/1e4;o=e(o||t.tileInfo.lods[0].scale),s=e(s||t.tileInfo.lods[t.tileInfo.lods.length-1].scale);for(const a of t.tileInfo.lods){const t=e(a.scale);i=t>=o?a.level:i,r=t>=s?a.level:r}}if(n)return new u.d({layer:this,minLOD:i,maxLOD:r});if(t.tileInfo){const e=new l.default;return e.read(t.tileInfo,a),new c.A(e,i,r)}return null}};return(0,n._)([(0,i.MZ)({json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),(0,n._)([(0,i.MZ)()],t.prototype,"minScale",void 0),(0,n._)([(0,r.w)("service","minScale")],t.prototype,"readMinScale",null),(0,n._)([(0,i.MZ)()],t.prototype,"maxScale",void 0),(0,n._)([(0,r.w)("service","maxScale")],t.prototype,"readMaxScale",null),(0,n._)([(0,i.MZ)({type:s.default})],t.prototype,"spatialReference",void 0),(0,n._)([(0,i.MZ)({readOnly:!0})],t.prototype,"supportsBlankTile",null),(0,n._)([(0,i.MZ)({type:l.default})],t.prototype,"tileInfo",void 0),(0,n._)([(0,i.MZ)()],t.prototype,"tilemapCache",void 0),(0,n._)([(0,r.w)("service","tilemapCache",["capabilities","tileInfo"])],t.prototype,"readTilemapCache",null),(0,n._)([(0,i.MZ)()],t.prototype,"version",void 0),t=(0,n._)([(0,o.$)("esri.layers.mixins.ArcGISCachedService")],t),t}},68039:(e,t,a)=>{a.d(t,{Q:()=>n});class n{constructor(e,t){this.data=e,this.safeWidth=.99999999*(e.width-1),this.dx=(e.width-1)/(t[2]-t[0]),this.dy=(e.width-1)/(t[3]-t[1]),this.x0=t[0],this.y1=t[3]}}},74125:(e,t,a)=>{a.d(t,{B:()=>l});var n=a(62631),i=a(42198),r=a(50925),o=a(49959),s=a(34037);class l{constructor(e,t,a,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};this._mainMethod=t,this._transferLists=a,this._listeners=[],this._promise=(0,s.ho)(e,{...i,schedule:n}).then((e=>{if(void 0===this._thread){this._thread=e,this._promise=null,i.hasInitialize&&this.broadcast({},"initialize");for(const e of this._listeners)this._connectListener(e)}else e.close()})),this._promise.catch((t=>r.A.getLogger("esri.core.workers.WorkerHandle").error(`Failed to initialize ${e} worker: ${t}`)))}on(e,t){const a={removed:!1,eventName:e,callback:t,threadHandle:null};return this._listeners.push(a),this._connectListener(a),(0,i.hA)((()=>{a.removed=!0,(0,n.TF)(this._listeners,a),this._thread&&null!=a.threadHandle&&a.threadHandle.remove()}))}destroy(){this._thread&&(this._thread.close(),this._thread=null),this._promise=null,this._listeners.length=0,this._transferLists={}}invoke(e,t){return this.invokeMethod(this._mainMethod,e,t)}invokeMethod(e,t,a){if(this._thread){const n=this._transferLists[e],i=n?n(t):[];return this._thread.invoke(e,t,{transferList:i,signal:a})}return this._promise?this._promise.then((()=>((0,o.throwIfAborted)(a),this.invokeMethod(e,t,a)))):Promise.reject(null)}broadcast(e,t){return this._thread?Promise.all(this._thread.broadcast(t,e)).then((()=>{})):this._promise?this._promise.then((()=>this.broadcast(e,t))):Promise.reject()}get promise(){return this._promise}_connectListener(e){this._thread&&this._thread.on(e.eventName,e.callback).then((t=>{e.removed||(e.threadHandle=t)}))}}},74197:(e,t,a)=>{a.d(t,{Ys:()=>M,gm:()=>_,h:()=>x,kV:()=>b});var n,i,r=a(74719),o=a(50925),s=a(49959),l=a(96913),c=a(90772),u=a(52622),h=a(86482),d=(a(32203),a(36447)),f=a(27411),p=a(24795),m=a(84766),v=a(4126),y=a(1283),g=(a(61682),a(20681),a(91706)),w=a(41755);async function M(e,t,a){if(!t.extent||!t.url)throw(0,w.EW)("esri.layer.orientedImagery.transformations",new r.default("update-elevation:missing-property","both extent and url are required to create a sampler",t));const n=await _(t);if(!n)throw(0,w.EW)("esri.layers.orientedImagery.transformations",new r.default("update-elevation:elevation-source","could not create a sampler using provided elevation source",t));return x(e,n,a)}async function x(e,t,a){await(0,s.waitTick)(a);const n=function(e,t){return async a=>{let n=a.clone();const i=a.spatialReference.equals(e.spatialReference)?n:await(0,l.projectWithZConversion)(a,e.spatialReference,t),r=e.queryElevation(i);return r&&(n=a.spatialReference.equals(e.spatialReference)?r.clone():await(0,l.projectWithZConversion)(r,a.spatialReference,t)),n.z=n.z??1,n}}(t,a),i=Array.isArray(e)?e:[e];return await Promise.all(i.map(n))}(i=n||(n={}))[i.DYNAMIC=0]="DYNAMIC",i[i.ELEVATION=1]="ELEVATION",i[i.IMAGE=2]="IMAGE";const _=async(e,t)=>{let a;const{extent:i,rasterFunction:r,url:l,lod:g}=e;try{a=await A(l)}catch(w){if((0,s.isAbortError)(w))return;o.A.getLogger("esri.layers.orientedImagery.transformations").error("updateElevationUsingElevationSource",w)}switch(a){case n.DYNAMIC:return await async function(e,t,a,n){const i=a?new m.default({functionName:a}):void 0,r=new h.default({url:e,rasterFunction:i,format:"lerc"});await r.load(n);let o,s=512,l=512;const u=t.width/t.height;u>1?(l/=u,o=t.height/l):(s*=u,o=t.width/s);const g=await r.fetchImage(t,s,l,n),w=v.default.create({scales:[o],size:512,spatialReference:t.spatialReference}),M=new y.U(null,0,0,0,(0,c.VY)(t)),x=new p.i(g.pixelData.pixelBlock.pixels[0],s,l,0),_=new f.q(M,x);return new d.TileElevationSampler(_,w,void 0)}(l,i,r,t);case n.ELEVATION:return await async function(e,t,a,n){const i=new u.default(e);let r;try{const{tileInfo:e}=await i.load(),o=(a&&e.lodAt(Math.min(e.lods.length-1,a))?.resolution)??"finest-contiguous";r=await i.createElevationSampler(t,{...n,demResolution:o})}catch(w){if((0,s.isAbortError)(w))return;o.A.getLogger(i).error(w)}finally{i.destroy()}return r}(l,i,g,t);default:return}};async function A(e,t){await(0,s.waitTick)(t);const a=await(0,g.V)(e),{tileInfo:i,cacheType:o}=a;if(!a.hasOwnProperty("bandCount")||!a.hasOwnProperty("pixelSizeX"))throw new r.default("elevation-source:invalid-service-url",`ElevationSource URL expects an elevation 3D image service but given ${e}`);return i?"LERC"!==i?.format?.toUpperCase()||o&&"elevation"!==o.toLowerCase()?n.IMAGE:n.ELEVATION:n.DYNAMIC}async function b(e,t,a){return await(0,s.waitTick)(a),e.map((e=>(e.z=t,e)))}},91706:(e,t,a)=>{a.d(t,{V:()=>i});var n=a(23060);async function i(e,t){const{data:a}=await(0,n.default)(e,{responseType:"json",query:{f:"json",...t?.customParameters,token:t?.apiKey}});return a}}}]);