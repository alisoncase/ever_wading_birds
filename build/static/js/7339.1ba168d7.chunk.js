"use strict";(self.webpackChunkever_wading_birds=self.webpackChunkever_wading_birds||[]).push([[3885,7339,26266,71028],{1368:(e,t,i)=>{i.d(t,{v:()=>T});var s=i(24646),r=i(98876),n=i(96236),o=i(96122),a=i(71723),l=i(9215),c=i(85645),h=i(53801),u=i(22131),d=i(19236),p=i(38319),_=i(90623),g=i(93003),v=i(16434),m=i(86836),y=i(92804),f=i(54366),w=i(92156),b=i(12723);_.S;class M extends v.w{constructor(e,t){super(e,t,new g.$(f.C,(()=>i.e(18558).then(i.bind(i,18558)))))}_createPipeline(e,t){const{oitPass:i,output:s,transparent:r,cullFace:o,draped:a,hasOccludees:l,polygonOffset:h,enableOffset:u}=e,d=i===m.Y.NONE,p=i===m.Y.FrontFace;return(0,b.Ey)({blending:(0,n.RN)(s)&&r?(0,c.Yf)(i):null,culling:(0,b.Xt)(o),depthTest:a?null:{func:(0,c.K_)(i)},depthWrite:(0,c.z5)(e),drawBuffers:s===n.V.Depth?{buffers:[w.Hr.NONE]}:(0,c.m6)(i,s),colorWrite:b.kn,stencilWrite:l?y.v0:null,stencilTest:l?t?y.a9:y.qh:null,polygonOffset:d||p?h?R:null:(0,c.aB)(u)})}initializePipeline(e){return this._occludeePipelineState=this._createPipeline(e,!0),this._createPipeline(e,!1)}getPipeline(e){return e?this._occludeePipelineState:super.getPipeline()}}const R={factor:1,units:1};var O=i(93800),A=i(69261),C=i(82606),P=i(21484),S=i(51448);class E extends S.E{constructor(){super(...arguments),this.cullFace=a.s2.None,this.hasVertexColors=!1,this.transparent=!1,this.discardInvisibleFragments=!1,this.polygonOffset=!1,this.enableOffset=!0,this.writeDepth=!0,this.hasOccludees=!1,this.terrainDepthTest=!1,this.cullAboveTerrain=!1,this.objectAndLayerIdColorInstanced=!1,this.vvColor=!1,this.draped=!1,this.textureCoordinateType=A.I.None,this.emissionSource=C.ZX.None,this.occlusionPass=!1,this.hasVvInstancing=!0,this.vvSize=!1,this.vvOpacity=!1}}(0,O._)([(0,P.W)({count:a.s2.COUNT})],E.prototype,"cullFace",void 0),(0,O._)([(0,P.W)()],E.prototype,"hasVertexColors",void 0),(0,O._)([(0,P.W)()],E.prototype,"transparent",void 0),(0,O._)([(0,P.W)()],E.prototype,"discardInvisibleFragments",void 0),(0,O._)([(0,P.W)()],E.prototype,"polygonOffset",void 0),(0,O._)([(0,P.W)()],E.prototype,"enableOffset",void 0),(0,O._)([(0,P.W)()],E.prototype,"writeDepth",void 0),(0,O._)([(0,P.W)()],E.prototype,"hasOccludees",void 0),(0,O._)([(0,P.W)()],E.prototype,"terrainDepthTest",void 0),(0,O._)([(0,P.W)()],E.prototype,"cullAboveTerrain",void 0),(0,O._)([(0,P.W)()],E.prototype,"objectAndLayerIdColorInstanced",void 0),(0,O._)([(0,P.W)()],E.prototype,"vvColor",void 0),(0,O._)([(0,P.W)()],E.prototype,"draped",void 0);var L=i(12621);class T extends p.W{constructor(e){super(e,z),this._configuration=new E,this.supportsEdges=!0,this.produces=new Map([[h.N.OPAQUE_MATERIAL,e=>this._isOpaqueMaterialPass(e)],[h.N.OPAQUE_MATERIAL_WITHOUT_NORMALS,e=>this._isOpaqueNoSSAODepthPass(e)],[h.N.TRANSPARENT_MATERIAL,e=>(0,n.QG)(e)&&this._transparent&&this.parameters.writeDepth],[h.N.TRANSPARENT_MATERIAL_WITHOUT_NORMALS,e=>(0,n.eh)(e)&&this._transparent&&this.parameters.writeDepth],[h.N.TRANSPARENT_MATERIAL_WITHOUT_DEPTH,e=>(0,n.QG)(e)&&this._transparent&&!this.parameters.writeDepth],[h.N.DRAPED_MATERIAL,e=>(0,n.i3)(e)]])}getConfiguration(e,t){return this._configuration.output=e,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasVertexColors=this.parameters.hasVertexColors&&!this.parameters.vvColor,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this._transparent,this._configuration.discardInvisibleFragments=this._transparent&&!this._isOpaquePass(e)&&this.parameters.discardInvisibleFragments,this._configuration.polygonOffset=this.parameters.polygonOffset,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=t.hasOccludees,this._configuration.oitPass=t.oitPass,this._configuration.enableOffset=t.camera.relativeElevation<c.xt,this._configuration.terrainDepthTest=t.terrainDepthTest&&(0,n.RN)(e),this._configuration.cullAboveTerrain=t.cullAboveTerrain,this._configuration.vvColor=!!this.parameters.vvColor,this._configuration.draped=this.parameters.draped,this._configuration}get visible(){return this.parameters.color[3]>=L.Q}get _transparent(){return this.parameters.color[3]<1||this.parameters.forceTransparentMode}_isOpaquePass(e){return this._isOpaqueMaterialPass(e)||this._isOpaqueNoSSAODepthPass(e)}_isOpaqueMaterialPass(e){return e===n.V.Highlight||(0,n.QG)(e)&&!this._transparent}_isOpaqueNoSSAODepthPass(e){return(0,n.eh)(e)&&this.parameters.writeDepth&&!this._transparent}createGLMaterial(e){return new D(e)}createBufferWriter(){const e=(0,r.BP)().vec3f(u.r.POSITION);return(0,o.E)()&&e.vec4u8(u.r.OBJECTANDLAYERIDCOLOR),this.parameters.vvColor?e.f32(u.r.COLORFEATUREATTRIBUTE):e.vec4u8(u.r.COLOR),new d.Z(e)}}class D extends l.A{beginSlot(e){return this.getTechnique(M,e)}}class z extends _.S{constructor(){super(...arguments),this.color=s.uY,this.forceTransparentMode=!1,this.writeDepth=!0,this.hasVertexColors=!1,this.polygonOffset=!1,this.hasSlicePlane=!1,this.cullFace=a.s2.None,this.draped=!1,this.discardInvisibleFragments=!1}}},3241:(e,t,i)=>{i.d(t,{n:()=>M});var s=i(79953),r=i(87752),n=i(10382),o=i(89227),a=i(28473),l=i(60548),c=i(24646),h=i(1696),u=i(62240),d=i(28113),p=i(84654),_=i(65069),g=i(25735),v=i(86580),m=i(60984),y=i(10625),f=i(22131),w=i(1368),b=i(23664);class M extends d.X{constructor(e){super(e),this._maxSize=0,this._position=(0,a.vt)(),this._up=(0,a.vt)(),this._right=(0,a.vt)(),this._renderOccluded=m.m$.OccludeAndTransparent,this._color=(0,c.fA)(1,0,0,1),this._outlineColor=(0,c.fA)(0,0,0,1),this._outlineSize=0,this._size=32,this._outlineRenderOccluded=m.m$.Opaque,this.applyProperties(e)}createObject3DResourceFactory(e){return{view:e,createResources:e=>this._createObject3DResources(e),destroyResources:()=>{},cameraChanged:()=>this._updateTransformObject3D()}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:R}}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateQuadMaterial())}get color(){return this._color}set color(e){(0,l.c)(this._color,e),this._updateQuadMaterial()}get outlineColor(){return this._outlineColor}set outlineColor(e){(0,l.c)(this._outlineColor,e),this._updateOutlineMaterial()}get outlineSize(){return this._outlineSize}set outlineSize(e){const t=0===this._outlineSize!=(0===e);this._outlineSize=e,t?this.recreateGeometry():this._updateOutlineMaterial()}get size(){return this._size}set size(e){e!==this._size&&(this._size=e,this._updateTransform())}get outlineRenderOccluded(){return this._outlineRenderOccluded}set outlineRenderOccluded(e){this._outlineRenderOccluded=e,this._updateOutlineMaterial()}set geometry(e){let{previous:t,center:i,next:s}=e;this._maxSize=Math.min((0,o.j)(i,t),(0,o.j)(i,s))/3,(0,o.n)(this._up,(0,o.d)(this._up,t,i)),(0,o.n)(this._right,(0,o.d)(this._right,s,i)),(0,o.c)(this._position,i),this.recreateGeometry()}_createObject3DResources(e){const t=new w.v(this._quadMaterialParameters),i=0===this._outlineSize?void 0:new b.W(this._outlineMaterialParameters);return this._createObject3DGeometries(e,t,i),{quadMaterial:t,outlineMaterial:i,forEach:e=>{e(t),i&&e(i)}}}_createObject3DGeometries(e,t,i){if((0,o.p)(this._up,a.uY)&&(0,o.p)(this._right,a.uY))return;const s=this._createGeometries(t,i);for(const r of s)e.addGeometry(r);this._updateTransformObject3D(e)}_createDrapedResources(){const e=new w.v(this._quadMaterialParameters),t=0===this._outlineSize?void 0:new b.W(this._outlineMaterialParameters),i=this._createGeometries(e,t).map((e=>new y.$(e)));return this._setTransformDraped(i),{quadMaterial:e,outlineMaterial:t,geometries:i,pixelRatioHandle:(0,s.watch)((()=>this.view.state.contentPixelRatio),(()=>this.drapedResources.recreateGeometry()))}}_createGeometries(e,t){const{up:i,right:s,corner:r}=this._getVertices(),n=function(e,t,i,s){return new g.V(s,[[f.r.POSITION,new _.n([0,0,0,...t,...e,...i],[0,1,2,1,2,3],3,!0)]])}(i,s,r,e);return t?[n,(0,v.Z8)(t,[i,r,s])]:[n]}_getVertices(){let e=this._up,t=this._right;const i=(0,o.g)(h.rq.get(),e,t);return this.isDraped&&(e=(0,o.c)(h.rq.get(),e),t=(0,o.c)(h.rq.get(),t),e[2]=0,t[2]=0,i[2]=0),{up:e,right:t,corner:i}}_updateTransform(){this.isDraped?this.drapedResources.recreateGeometry():this._updateTransformObject3D()}_updateTransformObject3D(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.object3dResources.object;if(!e)return;const t=this.view.state.camera,i=this._size*t.computeScreenPixelSizeAt(this._position),s=Math.min(this._maxSize,i);(0,r.kN)(O,this._position),(0,r.hs)(O,O,[s,s,s]),e.transformation=O}_setTransformDraped(e){if(0===e.length)return;const{view:{basemapTerrain:{overlayManager:t},state:{contentPixelRatio:i}}}=this,{_position:s,_size:n}=this,a=(0,o.c)(h.rq.get(),s);a[2]=p.bi;const l=A;l.spatialReference=t.renderer.spatialReference,l.x=a[0],l.y=a[1];const c=n*(this.view.overlayPixelSizeInMapUnits(l)*i),u=Math.min(this._maxSize,c);(0,r.kN)(O,a),(0,r.hs)(O,O,[u,u,1]);for(const r of e)r.transformation=O}get _quadMaterialParameters(){return{color:this._color,forceTransparentMode:!0,writeDepth:!1,polygonOffset:!0,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateQuadMaterial(){this.object3dResources.resources?.quadMaterial.setParameters(this._quadMaterialParameters),this.drapedResources.resources?.quadMaterial.setParameters(this._quadMaterialParameters)}get _outlineMaterialParameters(){return{color:this._outlineColor,width:this._outlineSize,renderOccluded:this._outlineRenderOccluded,isDecoration:this.isDecoration}}_updateOutlineMaterial(){this.object3dResources.resources?.outlineMaterial?.setParameters(this._outlineMaterialParameters),this.drapedResources.resources?.outlineMaterial?.setParameters(this._outlineMaterialParameters)}}function R(e){e.pixelRatioHandle.remove(),e.geometries=[]}const O=(0,n.vt)(),A=(0,u.T)(0,0,void 0,null)},4477:(e,t,i)=>{i.d(t,{M:()=>u,b:()=>h});var s=i(35490),r=i(94409),n=i(42403),o=i(16878),a=i(22131),l=i(8118),c=i(12621);function h(e){const t=new l.N5,{vertex:i,fragment:h}=t;(0,s.NB)(i,e),i.uniforms.add(new n.m("width",(e=>e.width))),t.attributes.add(a.r.POSITION,"vec3"),t.attributes.add(a.r.NORMAL,"vec3"),t.attributes.add(a.r.UV0,"vec2"),t.attributes.add(a.r.LENGTH,"float"),t.varyings.add("vtc","vec2"),t.varyings.add("vlength","float"),t.varyings.add("vradius","float"),i.main.add(o.H`vec3 bitangent = normal;
vtc = uv0;
vlength = length;
vradius = 0.5 * width;
vec4 pos = view * vec4(position + vradius * bitangent * uv0.y, 1.0);
gl_Position = proj * pos;`),h.uniforms.add(new n.m("outlineSize",(e=>e.outlineSize)),new r.E("outlineColor",(e=>e.outlineColor)),new n.m("stripeLength",(e=>e.stripeLength)),new r.E("stripeEvenColor",(e=>e.stripeEvenColor)),new r.E("stripeOddColor",(e=>e.stripeOddColor)));const u=1/Math.sqrt(2);return h.code.add(o.H`
    const float INV_SQRT2 = ${o.H.float(u)};

    vec4 arrowColor(vec2 tc, float len) {
      float d = INV_SQRT2 * (tc.x - abs(tc.y));
      d = min(d, INV_SQRT2 * (len - tc.x - abs(tc.y)));
      d = min(d, 1.0 - abs(tc.y));

      if (d < 0.0) {
        return vec4(0.0);
      }
      if (d < outlineSize) {
        return outlineColor;
      }
      return fract(0.5 / stripeLength * tc.x * vradius) >= 0.5 ? stripeOddColor : stripeEvenColor;
    }`),h.main.add(o.H`
    vec2 ntc = vec2(vtc.x / vradius, vtc.y);
    vec4 color = arrowColor(ntc, vlength / vradius);
    if (color.a < ${o.H.float(c.Q)}) {
      discard;
    }
    fragColor = color;`),t}const u=Object.freeze(Object.defineProperty({__proto__:null,build:h},Symbol.toStringTag,{value:"Module"}))},13975:(e,t,i)=>{var s,r;i.d(t,{f:()=>r,n:()=>s}),function(e){e[e.None=0]="None",e[e.Direct=1]="Direct",e[e.Triangle=2]="Triangle",e[e.ProjectedGeodesic=3]="ProjectedGeodesic"}(s||(s={})),function(e){e[e.Auto=0]="Auto",e[e.AboveSegment=1]="AboveSegment",e[e.BelowSegment=2]="BelowSegment"}(r||(r={}))},26266:(e,t,i)=>{i.r(t),i.d(t,{InverseGeodeticSolverResult:()=>w,directGeodeticSolver:()=>b,geodesicAreas:()=>m,geodesicCompatibleSpatialReference:()=>A,geodesicDensify:()=>f,geodesicDistance:()=>R,geodesicLengths:()=>y,inverseGeodeticSolver:()=>M,isSupported:()=>v,pointFromDistance:()=>O});var s=i(74719),r=i(84190),n=i(80556),o=i(75400),a=i(65920),l=i(54824),c=i(93321),h=i(64226),u=i(70576);function d(e){if(!e)return null;const t=e.wkid;if(t)return h.uw[t];const i=e.wkt2??e.wkt;return i?function(e){const t=h._f.exec(e);if(!t||2!==t.length)return null;const i=t[1].split(",");if(!i||i.length<3)return null;const s=parseFloat(i[1]),r=parseFloat(i[2]);return isNaN(s)||isNaN(r)?null:{a:s,f:0===r?0:1/r}}(i):null}function p(e){const t=d(e);if(function(e){return null!=e&&"b"in e&&"eSq"in e&&"radius"in e}(t))return t;const i=t.a*(1-t.f);return Object.assign(t,{b:i,eSq:1-(i/t.a)**2,radius:(2*t.a+i)/3,densificationRatio:1e4/((2*t.a+i)/3)})}function _(e){return null!=e&&e<0?e+360:e}function g(e,t,i){const{a:s,eSq:r}=p(i),n=Math.sqrt(r),o=Math.sin(t[1]*h.eh),a=s*t[0]*h.eh;let l;return l=r>0?s*((1-r)*(o/(1-r*(o*o))-1/(2*n)*Math.log((1-n*o)/(1+n*o))))*.5:s*o,e[0]=a,e[1]=l,e}function v(e){return(0,u.EA)(e)&&!!d(e)}function m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"square-meters";if(e.some((e=>!v(e.spatialReference))))throw new s.default("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const i=[];for(let s=0;s<e.length;s++){const t=e[s],r=t.spatialReference,{radius:n,densificationRatio:o}=p(r),a=n*o;i.push(f(t,a))}const n=[],o=[0,0],a=[0,0];for(let s=0;s<i.length;s++){const{rings:e,spatialReference:l}=i[s];let c=0;for(let t=0;t<e.length;t++){const i=e[t];g(o,i[0],l),g(a,i[i.length-1],l);let s=a[0]*o[1]-o[0]*a[1];for(let e=0;e<i.length-1;e++)g(o,i[e+1],l),g(a,i[e],l),s+=a[0]*o[1]-o[0]*a[1];c+=s}c=(0,r.oU)(c,"square-meters",t),n.push(c/-2)}return n}function y(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"meters";if(!e)throw new s.default("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(e.some((e=>!v(e.spatialReference))))throw new s.default("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const i=[];for(let s=0;s<e.length;s++){const n=e[s],{spatialReference:o}=n,a="polyline"===n.type?n.paths:n.rings;let l=0;for(let e=0;e<a.length;e++){const t=a[e];let i=0;for(let e=1;e<t.length;e++){const s=t[e-1][0],r=t[e][0],n=t[e-1][1],a=t[e][1];if(n!==a||s!==r){const e=new w;M(e,[s,n],[r,a],o),i+=e.distance}}l+=i}l=(0,r.oU)(l,"meters",t),i.push(l)}return i}function f(e,t){if("polyline"!==e.type&&"polygon"!==e.type)throw new s.default("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const{spatialReference:i}=e;if(!v(i))throw new s.default("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");const r="polyline"===e.type?e.paths:e.rings,o=[],h=[0,0],u=new w;for(const s of r){const e=[];o.push(e),e.push([s[0][0],s[0][1]]);let r,n,a=s[0][0],l=s[0][1];for(let o=0;o<s.length-1;o++){if(r=s[o+1][0],n=s[o+1][1],a===r&&l===n)continue;const c=[a,l];M(u,[a,l],[r,n],i);const{azimuth:d,distance:p}=u,_=p/t;if(_>1){for(let s=1;s<=_-1;s++)b(h,c,d,s*t,i),e.push(h.slice());b(h,c,d,(p+Math.floor(_-1)*t)/2,i),e.push(h.slice())}b(h,c,d,p,i),e.push(h.slice()),a=h[0],l=h[1]}}const d=(0,n.PZ)(c.default,i);return"polyline"===e.type?new l.default({paths:o,spatialReference:d}):new a.default({rings:o,spatialReference:d})}class w{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;this.distance=e,this.azimuth=t,this.reverseAzimuth=i}}function b(e,t,i,s,r){const n=t[0],o=t[1],a=n*h.eh,l=o*h.eh,c=(i??0)*h.eh,{a:u,b:d,f:_}=p(r),g=Math.sin(c),v=Math.cos(c),m=(1-_)*Math.tan(l),y=1/Math.sqrt(1+m*m),f=m*y,w=Math.atan2(m,v),b=y*g,M=b*b,R=1-M,O=R*(u*u-d*d)/(d*d),A=1+O/16384*(4096+O*(O*(320-175*O)-768)),C=O/1024*(256+O*(O*(74-47*O)-128));let P,S,E,L=s/(d*A),T=2*Math.PI;for(;Math.abs(L-T)>1e-12;)E=Math.cos(2*w+L),P=Math.sin(L),S=Math.cos(L),T=L,L=s/(d*A)+C*P*(E+C/4*(S*(2*E*E-1)-C/6*E*(4*P*P-3)*(4*E*E-3)));const D=f*P-y*S*v,z=Math.atan2(f*S+y*P*v,(1-_)*Math.sqrt(M+D*D)),x=_/16*R*(4+_*(4-3*R)),V=Math.atan2(P*g,y*S-f*P*v)-(1-x)*_*b*(L+x*P*(E+x*S*(2*E*E-1)));return e[0]=(a+V)/h.eh,e[1]=z/h.eh,e}function M(e,t,i,s){const r=t[0]*h.eh,n=t[1]*h.eh,o=i[0]*h.eh,a=i[1]*h.eh,{a:l,b:c,f:u,radius:d}=p(s),_=o-r,g=Math.atan((1-u)*Math.tan(n)),v=Math.atan((1-u)*Math.tan(a)),m=Math.sin(g),y=Math.cos(g),f=Math.sin(v),w=Math.cos(v);let b,M,R,O,A,C,P,S,E,L,T=1e3,D=_;do{if(P=Math.sin(D),S=Math.cos(D),R=Math.sqrt(w*P*(w*P)+(y*f-m*w*S)*(y*f-m*w*S)),0===R)return e.distance=0,e.azimuth=void 0,e.reverseAzimuth=void 0,e;A=m*f+y*w*S,C=Math.atan2(R,A),E=y*w*P/R,M=1-E*E,O=A-2*m*f/M,isNaN(O)&&(O=0),L=u/16*M*(4+u*(4-3*M)),b=D,D=_+(1-L)*u*E*(C+L*R*(O+L*A*(2*O*O-1)))}while(Math.abs(D-b)>1e-12&&--T>0);if(0===T){const t=d,i=Math.acos(Math.sin(n)*Math.sin(a)+Math.cos(n)*Math.cos(a)*Math.cos(o-r))*t,s=o-r,l=Math.sin(s)*Math.cos(a),c=Math.cos(n)*Math.sin(a)-Math.sin(n)*Math.cos(a)*Math.cos(s),u=Math.atan2(l,c);return e.azimuth=u/h.eh,e.distance=i,e.reverseAzimuth=void 0,e}const z=M*(l*l-c*c)/(c*c),x=z/1024*(256+z*(z*(74-47*z)-128)),V=c*(1+z/16384*(4096+z*(z*(320-175*z)-768)))*(C-x*R*(O+x/4*(A*(2*O*O-1)-x/6*O*(4*R*R-3)*(4*O*O-3)))),G=Math.atan2(w*Math.sin(D),y*f-m*w*Math.cos(D)),N=Math.atan2(y*Math.sin(D),y*f*Math.cos(D)-m*w);return e.azimuth=G/h.eh,e.distance=V,e.reverseAzimuth=N/h.eh,e}function R(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"meters";if(!e||!t)throw new s.default("geodesic-distance:missing-parameters","one or both input parameters are missing");if(!e.spatialReference||!t.spatialReference)throw new s.default("geodesic-distance:invalid-parameters","one or both input points do not have a spatial reference");if(!(0,u.aI)(e.spatialReference,t.spatialReference))throw new s.default("geodesic-distance:invalid-parameters","spatial references of input parameters do not match");const{spatialReference:n}=e;if(!v(n))throw new s.default("geodesic-distance:not-supported","input geometry spatial reference is not supported");if(e.x===t.x&&e.y===t.y)return new w(0,0,0);const o=new w;return M(o,[e.x,e.y],[t.x,t.y],n),o.distance=(0,r.oU)(o.distance,"meters",i),o.azimuth=_(o.azimuth),o.reverseAzimuth=_(o.reverseAzimuth),o}function O(e,t,i){if(!e||null==t||null==i)throw new s.default("point-from-distance:missing-parameters","one or more input parameters are missing or undefined");if(i<0||i>360)throw new s.default("point-from-distance:-of-bounds","azimuth is restricted to angles between, and including, 0\xb0 to 360\xb0 degrees");if(!e.spatialReference)throw new s.default("point-from-distance:missing-spatial-reference","the input point must have a spatial reference");const{spatialReference:r}=e;if(!v(r))throw new s.default("geodesic-distance:not-supported","input geometry spatial reference is not supported");const n=[0,0];return b(n,[e.x,e.y],i,t,r),new o.default({x:n[0],y:n[1],spatialReference:r})}function A(e){return v(e)?e:(0,u.K8)(e)?c.default.WGS84:null}},28113:(e,t,i)=>{i.d(t,{X:()=>f});var s=i(93800),r=i(6946),n=i(93633),o=i(48602),a=(i(21265),i(50925),i(14746),i(75269)),l=i(77297),c=i(69473),h=i(71602);class u{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1,this._renderGroup=l.O7.Outline}destroy(){this._destroyResources()}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncGeometriesToRenderer())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}get renderGroup(){return this._renderGroup}set renderGroup(e){this._renderGroup=e;const t=this._resources?.layerView;t&&(t.renderGroup=e)}recreate(){this.attached&&this._createResources()}recreateGeometry(){this._resourceFactory.recreateGeometry?null!=this._resources&&(this._ensureRenderGeometriesRemoved(),this._resourceFactory.recreateGeometry(this._resources.external),this._syncGeometriesToRenderer()):this.recreate()}_createOrDestroyResources(){this._attached?null==this._resources&&this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const e=this._resourceFactory.createResources(),t=new d({view:this._resourceFactory.view,renderGroup:this._renderGroup}),i=this._resourceFactory.view.basemapTerrain?.overlayManager;this._resources={layerView:new d({view:this._resourceFactory.view,renderGroup:this._renderGroup}),external:e,geometriesAdded:!1},i&&(this._resources.drapeSourceRenderer=i.registerGeometryDrapeSource(t)),this._syncGeometriesToRenderer()}_destroyResources(){if(null==this._resources)return;this._ensureRenderGeometriesRemoved();const e=this._resourceFactory.view.basemapTerrain?.overlayManager;e&&e.unregisterDrapeSource(this._resources.layerView),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncGeometriesToRenderer(){this._visible?this._ensureRenderGeometriesAdded():this._ensureRenderGeometriesRemoved()}_ensureRenderGeometriesRemoved(){null!=this._resources?.drapeSourceRenderer&&this._resources.geometriesAdded&&(this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries,c.q.UPDATE),this._resources.geometriesAdded=!1)}_ensureRenderGeometriesAdded(){null!=this._resources?.drapeSourceRenderer&&(this._resources.geometriesAdded||(this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries,c.q.UPDATE),this._resources.geometriesAdded=!0))}}let d=class extends(n.A.IdentifiableMixin(r.default)){constructor(e){super(e),this.drapeSourceType=l.Om.Features,this.updatePolicy=h.q.SYNC,this.renderGroup=l.O7.Outline}};(0,s._)([(0,o.MZ)({constructOnly:!0})],d.prototype,"view",void 0),(0,s._)([(0,o.MZ)({readOnly:!0})],d.prototype,"drapeSourceType",void 0),(0,s._)([(0,o.MZ)()],d.prototype,"renderGroup",void 0),d=(0,s._)([(0,a.$)("esri.views.3d.interactive.visualElements.DrapedVisualElementResources")],d);var p=i(49979),_=i(79953),g=i(69291),v=i(8461),m=i(20196);class y{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1}destroy(){this._destroyResources()}get object(){return null!=this._resources?this._resources.object:null}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncVisible())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}recreate(){this.attached&&this._createResources()}recreateGeometry(){if(!this._resourceFactory.recreateGeometry)return void this.recreate();const e=this._resourceFactory.view._stage;if(null==this._resources||!e)return;const t=this._resources.object;this._resources.external.forEach((t=>{t.type!==g.X.Mesh&&t.type!==g.X.Line&&t.type!==g.X.Point||e.remove(t)})),t.removeAllGeometries(),this._resourceFactory.recreateGeometry(this._resources.external,t,this._resources.layer),this._resources.external.forEach((t=>{t.type!==g.X.Mesh&&t.type!==g.X.Line&&t.type!==g.X.Point||e.add(t)}))}_createOrDestroyResources(){this._attached?this._resources||this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const e=this._resourceFactory,t=e.view,i=t._stage;if(!i)return;const s=new m.x(i,{pickable:!1,updatePolicy:h.q.SYNC}),r=new v.B({castShadow:!1}),n=e.createResources(r,s);n.forEach((e=>{i.add(e),e.type===g.X.Texture&&e.load(i.renderView.renderingContext)})),i.add(r),s.add(r);const o=e.cameraChanged,a=o?(0,_.watch)((()=>t.state.camera),(e=>o(e)),_.initial):null;this._resources={layer:s,object:r,external:n,cameraHandle:a},this._syncVisible()}_destroyResources(){if(null==this._resources)return;const e=this._resourceFactory.view._stage;e&&(e.remove(this._resources.object),this._resources.layer.destroy(),this._resources.external.forEach((t=>{e.remove(t),t.type===g.X.Texture&&t.unload()}))),this._resources.object.dispose(),this._resources.cameraHandle?.remove(),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncVisible(){null!=this._resources&&(this._resources.object.visible=this._visible)}}class f extends p.B{constructor(e){super(e),this._isDraped=!1,this.object3dResources=new y(this.createObject3DResourceFactory(e.view)),this.drapedResources=new u(this.createDrapedResourceFactory(e.view)),this.isDraped=e.isDraped??!1}get isDraped(){return this._isDraped}set isDraped(e){e!==this._isDraped&&(this._isDraped=e,this.object3dResources.attached=this.attached&&!e,this.drapedResources.attached=this.attached&&e)}get renderGroup(){return this.drapedResources.renderGroup}set renderGroup(e){this.drapedResources.renderGroup=e}createResources(){this.object3dResources.attached=!this._isDraped,this.drapedResources.attached=this._isDraped}destroyResources(){this.object3dResources.attached=!1,this.drapedResources.attached=!1}recreate(){this.object3dResources.recreate(),this.drapedResources.recreate()}recreateGeometry(){this.object3dResources.recreateGeometry(),this.drapedResources.recreateGeometry()}destroy(){this.object3dResources.destroy(),this.drapedResources.destroy(),super.destroy()}updateVisibility(e){this.object3dResources.visible=e,this.drapedResources.visible=e}}},40147:(e,t,i)=>{i.d(t,{Q:()=>l,X:()=>c});var s=i(16804),r=i(32006),n=i(89227),o=i(28473),a=i(41317);function l(e,t,i,s){i.projectToRenderScreen(e,u),i.projectToRenderScreen(t,d),(0,r.Re)(s,d,u),(0,r.S8)(s,s)}function c(e,t,i,s){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:(0,o.vt)();const l=(0,n.c)(h,e);return l[2]=(0,a.xS)(s,l,t,i)||0,s.renderCoordsHelper.toRenderCoords(l,t,r),r}const h=(0,o.vt)(),u=(0,s.QG)(),d=(0,s.QG)()},42924:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Le});var s=i(93800),r=i(6946),n=(i(21265),i(17741)),o=i(48602),a=i(50925),l=(i(14746),i(75269)),c=i(75644),h=i(26905),u=i(53737),d=i(92143),p=i(79953),_=i(84190),g=i(66983),v=i(36089),m=i(90968);let y=class extends r.default{constructor(e){super(e)}initialize(){this.addHandles([(0,p.watch)((()=>({viewData:this.viewData,startPoint:this.analysis.startPoint})),(e=>{let{viewData:t,startPoint:i}=e;t.elevationAlignedStartPoint=this._applyProjectionAndElevationAlignment(i)}),p.syncAndInitial),(0,p.watch)((()=>({viewData:this.viewData,endPoint:this.analysis.endPoint})),(e=>{let{viewData:t,endPoint:i}=e;t.elevationAlignedEndPoint=this._applyProjectionAndElevationAlignment(i)}),p.syncAndInitial),(0,p.watch)((()=>({result:this._computedResult,viewData:this.viewData})),(e=>{let{result:t,viewData:i}=e;i.result=t}),p.syncAndInitial)])}_applyProjectionAndElevationAlignment(e){if(null==e)return e;const{spatialReference:t,elevationProvider:i}=this.view;return(0,g.B)(e,t,i)??((0,g.V)(this.analysis,e.spatialReference,a.A.getLogger(this)),null)}get _computedResult(){const{elevationAlignedStartPoint:e,elevationAlignedEndPoint:t,measurementMode:i,unit:s}=this.viewData;if(null==e||null==t)return null;const r=(0,v.NH)(e,t),n=(0,m.Og)(e,t);if(null==r)return null;let o,a;switch(i){case u.G.Auto:a=null!=n?"geodesic":"euclidean",o=n??r.horizontal;break;case u.G.Geodesic:if(null==n)return null;a="geodesic",o=n;break;case u.G.Euclidean:a="euclidean",o=r.horizontal}let l=r.direct,c=r.vertical;const h=(0,_.Vs)(l.value,l.unit,s),p=(0,_.Vs)(o.value,o.unit,s),g=(0,_.jE)(c.value,c.unit,s);return l=(0,d.kM)(l,h),o=(0,d.kM)(o,p),c=(0,d.kM)(c,g),{mode:a,directDistance:l,horizontalDistance:o,verticalDistance:c}}};(0,s._)([(0,o.MZ)()],y.prototype,"view",void 0),(0,s._)([(0,o.MZ)()],y.prototype,"analysis",void 0),(0,s._)([(0,o.MZ)()],y.prototype,"viewData",void 0),(0,s._)([(0,o.MZ)()],y.prototype,"_computedResult",null),y=(0,s._)([(0,l.$)("esri.views.3d.analysis.DirectLineMeasurement.DirectLineMeasurementController")],y);i(88677);var f=i(2925),w=i(64682),b=i(1278),M=i(16804),R=i(32006),O=i(89227),A=i(28473),C=i(13975),P=i(40147),S=i(82321),E=i(20561),L=i(90834),T=i(10382),D=i(60548),z=i(24646),x=i(1696),V=i(75075),G=i(64566),N=i(86767),j=i(86580),I=i(60984),q=i(98876),H=i(96236),Z=i(9215),F=i(53801),k=i(22131),W=i(93003),Q=i(16434),U=i(85645),B=i(4477),$=i(92156),X=i(12723);class Y extends Q.w{constructor(e,t){super(e,t,new W.$(B.M,(()=>i.e(78813).then(i.bind(i,78813)))),J),this.primitiveType=$.WR.TRIANGLE_STRIP}initializePipeline(e){return(0,X.Ey)({blending:e.transparent?(0,U.Yf)(e.oitPass):null,polygonOffset:e.polygonOffsetEnabled?{factor:0,units:-4}:null,depthTest:{func:$.MT.LESS},depthWrite:X.Uy,colorWrite:X.kn})}}const J=new Map([[k.r.POSITION,0],[k.r.NORMAL,1],[k.r.UV0,2],[k.r.LENGTH,3]]);var K=i(21484),ee=i(51448);class te extends ee.E{constructor(){super(...arguments),this.polygonOffsetEnabled=!1,this.transparent=!1}}(0,s._)([(0,K.W)()],te.prototype,"polygonOffsetEnabled",void 0),(0,s._)([(0,K.W)()],te.prototype,"transparent",void 0);var ie=i(12621);class se extends I.im{constructor(e){super(e,ne),this._configuration=new te,this.vertexAttributeLocations=J,this.produces=new Map([[F.N.OPAQUE_MATERIAL,e=>!this._transparent&&(0,H.RN)(e)],[F.N.TRANSPARENT_MATERIAL_WITHOUT_DEPTH,e=>this._transparent&&(0,H.RN)(e)]])}getConfiguration(e,t){return this._configuration.polygonOffsetEnabled=this.parameters.polygonOffset,this._configuration.transparent=this._transparent,this._configuration.oitPass=t.oitPass,this._configuration}get visible(){const{outlineColor:e,stripeEvenColor:t,stripeOddColor:i}=this.parameters;return e[3]>=ie.Q||t[3]>=ie.Q||i[3]>=ie.Q}intersect(){}createGLMaterial(e){return new re(e)}createBufferWriter(){return new de}get _transparent(){const{parameters:e}=this;return e.outlineColor[3]<1||e.stripeEvenColor[3]<1||e.stripeOddColor[3]<1}}class re extends Z.A{beginSlot(e){return this.getTechnique(Y,e)}}class ne extends I.qA{constructor(){super(...arguments),this.width=32,this.outlineSize=.2,this.outlineColor=(0,z.fA)(1,.5,0,1),this.stripeEvenColor=(0,z.fA)(1,1,1,1),this.stripeOddColor=(0,z.fA)(1,.5,0,1),this.stripeLength=1,this.polygonOffset=!1}}const oe=(0,q.BP)().vec3f(k.r.POSITION).vec3f(k.r.NORMAL).vec2f(k.r.UV0).f32(k.r.LENGTH),ae=(0,A.vt)(),le=(0,A.vt)(),ce=(0,A.vt)(),he=(0,A.vt)(),ue=(0,A.vt)();class de{constructor(){this.vertexBufferLayout=oe}elementCount(e){return 2*(e.get(k.r.POSITION).indices.length/2+1)}write(e,t,i,s,r,n){const{data:o,indices:a}=i.get(k.r.POSITION),l=i.get(k.r.NORMAL).data,c=o.length/3;a&&a.length!==2*(c-1)&&console.warn("MeasurementArrowMaterial does not support indices");const h=ae,u=le,d=ce,p=he,_=ue,g=r.position,v=r.normal,m=r.uv0;let y=0;for(let w=0;w<c;++w){const i=3*w;if((0,O.i)(h,o[i],o[i+1],o[i+2]),w<c-1){const e=3*(w+1);(0,O.i)(u,o[e],o[e+1],o[e+2]),(0,O.i)(_,l[e],l[e+1],l[e+2]),(0,O.n)(_,_),(0,O.d)(d,u,h),(0,O.n)(d,d),(0,O.e)(p,_,d),(0,O.n)(p,p)}const s=(0,O.j)(h,u);e&&t&&((0,O.t)(h,h,e),(0,O.t)(u,u,e),(0,O.t)(p,p,t));const r=n+2*w,a=r+1;g.setVec(r,h),g.setVec(a,h),v.setVec(r,p),v.setVec(a,p),m.set(r,0,y),m.set(r,1,-1),m.set(a,0,y),m.set(a,1,1),w<c-1&&(y+=s)}const f=r.length;for(let w=0;w<2*c;++w)f.set(n+w,y)}}class pe extends V.X{constructor(e){super(e),this._arrowWidth=16,this._arrowSubdivisions=128,this._origin=(0,A.vt)(),this._originTransform=(0,T.vt)(),this._arrowCenter=(0,A.vt)(),this._renderOccluded=I.m$.OccludeAndTransparent,this._geometry=null,this._stripeLength=1,this._stripesEnabled=!0,this._color=(0,z.vt)(),this._contrastColor=(0,z.vt)(),this.applyProperties(e)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._arrowMaterial?.setParameters({renderOccluded:e}))}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this._geometryChanged()}get stripeLength(){return this._stripeLength}set stripeLength(e){this._stripeLength=e,this.attached&&this._arrowMaterial.setParameters({stripeLength:this._stripeLength})}get stripesEnabled(){return this._stripesEnabled}set stripesEnabled(e){if(this._stripesEnabled=e,this.attached){const e=this._stripesEnabled?this._contrastColor:this._color;this._arrowMaterial.setParameters({stripeEvenColor:e})}}get color(){return this._color}set color(e){(0,f.we)(e,this._color)||((0,D.c)(this._color,e),this._updateArrowColor())}get contrastColor(){return this._contrastColor}set contrastColor(e){(0,f.we)(e,this._color)||((0,D.c)(this._contrastColor,e),this._updateArrowColor())}createExternalResources(){const e=this._color,t=this._contrastColor,i=this._stripesEnabled?t:e;this._arrowMaterial=new se({outlineColor:e,stripeEvenColor:i,stripeOddColor:e,renderOccluded:this.renderOccluded,polygonOffset:!0,isDecoration:this.isDecoration}),this._handles=new L.default,this._handles.add((0,p.watch)((()=>this.view.state.camera),(()=>{this._viewChanged()})))}destroyExternalResources(){this._arrowMaterial=null,this._handles=(0,n.pR)(this._handles)}forEachExternalMaterial(e){e(this._arrowMaterial)}createGeometries(e){if(null==this._geometry?.startRenderSpace||null==this._geometry.endRenderSpace)return;const t=this._createArrowGeometry(this._geometry.startRenderSpace,this._geometry.endRenderSpace,this._origin,this._geometry);t.transformation=this._originTransform,e.addGeometry(t),this._viewChanged()}_createArrowGeometry(e,t,i,s){const r=this.view,n=r.renderCoordsHelper,o=[],a=[],l=(e,t)=>{const s=x.rq.get();(0,O.d)(s,e,i),o.push(s),a.push(t)};if("euclidean"===s.type){s.eval(.5,this._arrowCenter);const i=x.rq.get();if(n.worldUpAtPosition(this._arrowCenter,i),function(e,t,i){const s=(0,O.a)(_e,t,e),r=(0,O.e)(_e,s,i);return 0===(0,O.H)(r)}(e,t,i)){const{heading:t,tilt:s}=r.camera,{direction:n}=(0,G.ZC)(r,e,t,s,ge);(0,O.c)(i,n)}l(e,i),l(t,i)}else{s.eval(.5,this._arrowCenter);const e=this._arrowSubdivisions+1&-2;for(let t=0;t<e;++t){const i=t/(e-1),r=x.rq.get(),o=x.rq.get();s.eval(i,r),n.worldUpAtPosition(r,o),l(r,o)}}return(0,j.Z8)(this._arrowMaterial,o,a)}_geometryChanged(){this.recreateGeometry()}_viewChanged(){if(this.view.ready&&this.attached&&null!=this._geometry){const e=this.view.state.camera.computeScreenPixelSizeAt(this._arrowCenter);this._arrowMaterial.setParameters({width:this._arrowWidth*e})}}_updateArrowColor(){if(!this.attached)return;const e=this._color,t=this._contrastColor,i=this._stripesEnabled?t:e,s=e,r=e;this._arrowMaterial.setParameters({stripeEvenColor:i,outlineColor:s,stripeOddColor:r})}}const _e=(0,A.vt)(),ge=(0,N.NP)();var ve=i(3241),me=i(30834),ye=i(79678),fe=i(47396),we=i(12711),be=i(53957);let Me=class extends r.default{get _parameters(){const e=this.view.effectiveTheme,{accentColor:t,textColor:i}=e,s=(0,f.QP)(t),r=(0,f.f6)(t,.75),n=(0,f.QP)((0,f.bJ)(t)),o=(0,f.bJ)(i,f.pW.Low);return{accentColor:s,contrastColor:n,translucentAccentColor:r,triangleLineWidth:3,geodesicProjectionLineWidth:2,guideLineWidth:2,guideStippleLengthPixels:3,directLabelFontSize:16,horizontalLabelFontSize:12,verticalLabelFontSize:12,textColor:i,textBackgroundColor:(0,f._L)(o,.6),textCalloutColor:(0,f._L)(o,.5)}}get visible(){return this.analysisView.visible}get viewMode(){const{elevationAlignedStartPoint:e,elevationAlignedEndPoint:t}=this.analysisView;if(null==e||null==t||e.equals(t))return C.n.None;const i=this.analysisView.result;if(null==i)return C.n.Direct;if("geodesic"===this.actualVisualizedMeasurement)return this._requiresGeodesicGuideAt(this._startPosition)||this._requiresGeodesicGuideAt(this._endPosition)?C.n.ProjectedGeodesic:C.n.Direct;const{verticalDistance:s,horizontalDistance:r}=i,n=(0,d.kM)(s,"meters").value,o=(0,d.kM)(r,"meters").value;return Math.min(n/o,o/n)<this.triangleCollapseRatioThreshold?C.n.Direct:C.n.Triangle}get actualVisualizedMeasurement(){const{measurementMode:e,result:t}=this.analysisView;switch(e){case u.G.Auto:return null!=t&&(0,d.kM)(t.horizontalDistance,"meters").value>fe.U7?"geodesic":"euclidean";case u.G.Euclidean:return"euclidean";case u.G.Geodesic:return"geodesic"}}get allowVisualElementsOrientationChange(){return null==this._triangleOrientationOverride}set allowVisualElementsOrientationChange(e){null==this._triangleOrientationOverride!==e&&(null==this._triangleOrientationOverride?this._triangleOrientationOverride=this._actualVisualElementsOrientation:this._triangleOrientationOverride=null)}get labels(){return"geodesic"===this.actualVisualizedMeasurement?{direct:null,horizontal:this._segmentLabel,vertical:this._verticalLabel}:{direct:this._segmentLabel,horizontal:this._horizontalLabel,vertical:this._verticalLabel}}constructor(e){super(e),this._segmentVisualElement=null,this._triangleVisualElement=null,this._rightAngleQuad=null,this._projectedGeodesicLine=null,this._geodesicStartHint=null,this._geodesicEndHint=null,this._segmentLabel=null,this._verticalLabel=null,this._horizontalLabel=null,this._startPosition=(0,A.vt)(),this._endPosition=(0,A.vt)(),this._cornerPosition=(0,A.vt)(),this._startPositionAtSeaLevel=(0,A.vt)(),this._endPositionAtSeaLevel=(0,A.vt)(),this._triangleOrientationOverride=null,this.messages=null,this.loadingMessages=!0,this.visualElementOrientation=C.f.Auto,this.triangleCollapseRatioThreshold=.03}initialize(){const e=this._parameters,t={attached:!0,view:this.view,isDecoration:!0},{guideLineWidth:i,guideStippleLengthPixels:s,triangleLineWidth:r,geodesicProjectionLineWidth:n,directLabelFontSize:o,verticalLabelFontSize:a,horizontalLabelFontSize:l}=e;this._segmentVisualElement=new pe({...t,geometry:null,renderOccluded:I.m$.OccludeAndTransparent}),this._triangleVisualElement=new E.t({...t,width:r,renderOccluded:I.m$.OccludeAndTransparent}),this._rightAngleQuad=new ve.n({...t,renderOccluded:I.m$.OccludeAndTransparent});const c={...t,polygonOffset:!0,renderOccluded:I.m$.OccludeAndTransparent};this._projectedGeodesicLine=new E.t({...c,width:n,stipplePattern:(0,ye.wk)(s)}),this._geodesicStartHint=new E.t({...c,width:i,stipplePattern:(0,ye.wk)(s)}),this._geodesicEndHint=new E.t({...c,width:i,stipplePattern:(0,ye.wk)(s)}),this._segmentLabel=new S.N({...t,fontSize:o}),this._verticalLabel=new S.N({...t,fontSize:a}),this._horizontalLabel=new S.N({...t,fontSize:l}),this.addHandles([(0,p.watch)((()=>{const{elevationAlignedStartPoint:e,elevationAlignedEndPoint:t}=this.analysisView,i=this.view;return{view:i,camera:i.state.camera,viewMode:this.viewMode,elevationAlignedStartPoint:e,elevationAlignedEndPoint:t,orientation:this._actualVisualElementsOrientation,visualizedMeasurement:this.actualVisualizedMeasurement,stripeLength:this._measurementArrowStripeLength}}),(e=>this._updateGeometryAndViewMode(e)),p.syncAndInitial),(0,p.watch)((()=>({visible:this.visible,viewMode:this.viewMode})),(e=>this._updateVisualElementVisibility(e)),p.syncAndInitial),(0,p.watch)((()=>({text:this._labelsText,visualizedMeasurement:this.actualVisualizedMeasurement})),(e=>this._updateLabelText(e)),p.syncAndInitial),(0,p.watch)((()=>({visible:this.visible,viewMode:this.viewMode})),(e=>this._updateLabelVisibility(e)),p.syncAndInitial),(0,p.watch)((()=>this._measurementArrowStripeLength),(e=>this._updateSegmentStripeLength(e)),p.syncAndInitial),(0,we.oQ)((async()=>this._updateMessageBundle())),(0,p.watch)((()=>this._parameters),(e=>{let{textBackgroundColor:t,textCalloutColor:i,textColor:s,translucentAccentColor:r,accentColor:n,contrastColor:o}=e;const{_segmentLabel:a,_verticalLabel:l,_horizontalLabel:c,_triangleVisualElement:h,_rightAngleQuad:u,_projectedGeodesicLine:d,_geodesicStartHint:p,_geodesicEndHint:_,_segmentVisualElement:g}=this;a.backgroundColor=t,a.calloutColor=i,a.textColor=s,l.backgroundColor=t,l.calloutColor=i,l.textColor=s,c.backgroundColor=t,c.calloutColor=i,c.textColor=s,h.color=r,u.color=r,d.color=r,p.color=r,_.color=r,g.color=n,g.contrastColor=o}),p.initial)]),this._updateMessageBundle()}destroy(){this._segmentVisualElement=(0,n.pR)(this._segmentVisualElement),this._triangleVisualElement=(0,n.pR)(this._triangleVisualElement),this._rightAngleQuad=(0,n.pR)(this._rightAngleQuad),this._projectedGeodesicLine=(0,n.pR)(this._projectedGeodesicLine),this._geodesicStartHint=(0,n.pR)(this._geodesicStartHint),this._geodesicEndHint=(0,n.pR)(this._geodesicEndHint),this._segmentLabel=(0,n.pR)(this._segmentLabel),this._verticalLabel=(0,n.pR)(this._verticalLabel),this._horizontalLabel=(0,n.pR)(this._horizontalLabel),this.set("view",null)}_updateVisualElementVisibility(e){let{visible:t,viewMode:i}=e;if(this._segmentVisualElement.visible=!1,this._triangleVisualElement.visible=!1,this._rightAngleQuad.visible=!1,this._projectedGeodesicLine.visible=!1,this._geodesicStartHint.visible=!1,this._geodesicEndHint.visible=!1,t)switch(i){case C.n.None:break;case C.n.Direct:this._segmentVisualElement.visible=!0;break;case C.n.Triangle:this._segmentVisualElement.visible=!0,this._triangleVisualElement.visible=!0,this._rightAngleQuad.visible=!0;break;case C.n.ProjectedGeodesic:this._segmentVisualElement.visible=!0,this._projectedGeodesicLine.visible=!0,this._geodesicStartHint.visible=!0,this._geodesicEndHint.visible=!0}}_updateGeometryAndViewMode(e){let{view:t,camera:i,viewMode:s,elevationAlignedStartPoint:r,elevationAlignedEndPoint:n,orientation:o,visualizedMeasurement:a,stripeLength:l}=e;const c=t.renderCoordsHelper;if(null==c||null==r||null==n||r.equals(n))return;let h=this._startPosition,u=this._endPosition;c.toRenderCoords(r,h),c.toRenderCoords(n,u);const d=o===C.f.AboveSegment?1:-1,p=d*(c.getAltitude(u)-c.getAltitude(h));p<0&&(h=this._endPosition,u=this._startPosition);const _="geodesic"===a?new me.J(this._startPosition,this._endPosition,c.spatialReference):new me.C(this._startPosition,this._endPosition);switch(this._segmentVisualElement.geometry=_,this._updateSegmentStripeLength(l),s){case C.n.Direct:this._updateSegment(_,o);break;case C.n.Triangle:this._updateSegmentAndTriangle({view:t,camera:i,segment:_,orientation:o,startPosition:h,endPosition:u,deltaSign:d,altitudeDelta:p});break;case C.n.ProjectedGeodesic:this._updateSegmentAndProjection({view:t,orientation:o,startPosition:h,endPosition:u})}}_updateSegment(e,t){this._segmentLabel.anchor=t===C.f.AboveSegment?"top":"bottom",this._segmentLabel.geometry={type:"segment",segment:e,sampleLocation:"center"}}_updateSegmentAndTriangle(e){let{view:{renderCoordsHelper:t},camera:i,segment:s,orientation:r,startPosition:n,endPosition:o,deltaSign:a,altitudeDelta:l}=e;const c=this._cornerPosition;t.worldUpAtPosition(n,c),(0,O.h)(c,c,a*Math.abs(l)),(0,O.g)(c,c,n),this._triangleVisualElement.geometry=[[[n[0],n[1],n[2]],[c[0],c[1],c[2]],[o[0],o[1],o[2]]]],this._rightAngleQuad.geometry={previous:n,center:c,next:o};const h=new me.C(n,c),u=new me.C(c,o),d=function(e,t,i,s,r){const n=Oe,o=Ae;r.projectToRenderScreen(i,n),r.projectToRenderScreen(t,o);const a={segment:"bottom",horizontal:"top",vertical:n[0]<o[0]?"left":"right"};{const s=Ce,n=Pe;if((0,P.Q)(e,i,r,s),(0,P.Q)(e,t,r,n),(0,R.Om)(s,n)>=Re){const e=Math.sign(s[1])===Math.sign(n[1]);a.segment=e?(0,S.R)(a.vertical):a.vertical}else{const e=Se;(0,P.Q)(i,t,r,e),(0,R.Om)(e,n)>=Re&&(a.segment=Math.sign(e[0])===Math.sign(n[0])?(0,S.R)(a.horizontal):a.horizontal)}}if(s===C.f.BelowSegment){const e=e=>"top"===e?"bottom":"top";a.segment=e(a.segment),a.horizontal=e(a.horizontal),a.vertical=e(a.vertical)}return a}(n,o,c,r,i);this._segmentLabel.anchor=d.segment,this._segmentLabel.geometry={type:"segment",segment:s,sampleLocation:"center"},this._verticalLabel.geometry={type:"segment",segment:h,sampleLocation:"center"},this._verticalLabel.anchor=d.vertical,this._horizontalLabel.geometry={type:"segment",segment:u,sampleLocation:"center"},this._horizontalLabel.anchor=d.horizontal}_updateSegmentAndProjection(e){let{view:{renderCoordsHelper:t},orientation:i,startPosition:s,endPosition:r}=e;t.setAltitude(this._startPositionAtSeaLevel,0,s),t.setAltitude(this._endPositionAtSeaLevel,0,r);const n=new me.J(this._startPositionAtSeaLevel,this._endPositionAtSeaLevel,t.spatialReference);this._projectedGeodesicLine.setGeometryFromSegment(n),this._geodesicStartHint.setGeometryFromSegment(new me.C(this._startPositionAtSeaLevel,s)),this._geodesicEndHint.setGeometryFromSegment(new me.C(this._endPositionAtSeaLevel,r)),this._segmentLabel.geometry={type:"segment",segment:n,sampleLocation:"center"},this._segmentLabel.anchor=i===C.f.AboveSegment?"top":"bottom"}_updateLabelText(e){let{text:t,visualizedMeasurement:i}=e;null!=t?(this._segmentLabel.text="euclidean"===i?t.directDistance:t.horizontalDistance,this._horizontalLabel.text=t.horizontalDistance,this._verticalLabel.text=t.verticalDistance):(this._segmentLabel.text=null,this._horizontalLabel.text=null,this._verticalLabel.text=null),this.notifyChange("labels")}_updateLabelVisibility(e){let{visible:t,viewMode:i}=e;const s=this._segmentLabel,r=this._horizontalLabel,n=this._verticalLabel;if(s.visible=!1,r.visible=!1,n.visible=!1,t)switch(i){case C.n.Direct:s.visible=!0;break;case C.n.Triangle:s.visible=!0,r.visible=!0,n.visible=!0;break;case C.n.ProjectedGeodesic:s.visible=!0;case C.n.None:}}get _labelsText(){if(this.destroyed)return null;const e=this.messages,t=this.analysisView.result;if(null==t||null==e)return null;const{directDistance:i,horizontalDistance:s,verticalDistance:r}=t,n=this.analysisView.unit,o=e=>({directDistance:"",horizontalDistance:"",verticalDistance:"",...e});switch(n){case"metric":return o({directDistance:i&&(0,b.Ee)(e,i),horizontalDistance:s&&(0,b.Ee)(e,s),verticalDistance:r&&(0,b.W4)(e,r)});case"imperial":return o({directDistance:i&&(0,b.tr)(e,i),horizontalDistance:s&&(0,b.tr)(e,s),verticalDistance:r&&(0,b.t_)(e,r)});default:return o({directDistance:i&&(0,b.zJ)(e,i,n),horizontalDistance:s&&(0,b.zJ)(e,s,n),verticalDistance:r&&(0,b.zJ)(e,r,n)})}}_updateSegmentStripeLength(e){const t=this._segmentVisualElement;null!=e?(t.stripeLength=e,t.stripesEnabled=!0):t.stripesEnabled=!1}get _actualVisualElementsOrientation(){if(null!=this._triangleOrientationOverride)return this._triangleOrientationOverride;const e=this.visualElementOrientation;return e===C.f.Auto?this.view.state.camera.aboveGround?C.f.AboveSegment:C.f.BelowSegment:e}_requiresGeodesicGuideAt(e){const t=this.view;if(!t?.state)return!1;const i=t.state.camera,s=t.renderCoordsHelper;if(!s)return!1;const r=i.computeScreenPixelSizeAt(e);return s.getAltitude(e)/r>=10}get _measurementArrowStripeLength(){const{result:e,unit:t}=this.analysisView;if(null==e)return null;let i=null;const s=e.directDistance;switch(t){case"metric":i=s&&(0,d.kM)(s,"meters");break;case"imperial":i=s&&(0,d.kM)(s,(0,_.OU)(s.value,s.unit));break;default:i=s&&(0,d.kM)(s,t)}return null==i?null:(0,w.Vr)(i.value/30)*(0,_.oU)(1,i.unit,"meters")}_updateMessageBundle(){this.loadingMessages=!0,(0,be.ud)("esri/core/t9n/Units").then((e=>{this.messages=e})).finally((()=>{this.loadingMessages=!1}))}get testData(){}};(0,s._)([(0,o.MZ)()],Me.prototype,"_parameters",null),(0,s._)([(0,o.MZ)()],Me.prototype,"_triangleOrientationOverride",void 0),(0,s._)([(0,o.MZ)()],Me.prototype,"messages",void 0),(0,s._)([(0,o.MZ)()],Me.prototype,"view",void 0),(0,s._)([(0,o.MZ)()],Me.prototype,"analysis",void 0),(0,s._)([(0,o.MZ)()],Me.prototype,"analysisView",void 0),(0,s._)([(0,o.MZ)()],Me.prototype,"loadingMessages",void 0),(0,s._)([(0,o.MZ)()],Me.prototype,"visible",null),(0,s._)([(0,o.MZ)()],Me.prototype,"viewMode",null),(0,s._)([(0,o.MZ)()],Me.prototype,"actualVisualizedMeasurement",null),(0,s._)([(0,o.MZ)()],Me.prototype,"visualElementOrientation",void 0),(0,s._)([(0,o.MZ)()],Me.prototype,"triangleCollapseRatioThreshold",void 0),(0,s._)([(0,o.MZ)()],Me.prototype,"allowVisualElementsOrientationChange",null),(0,s._)([(0,o.MZ)()],Me.prototype,"labels",null),(0,s._)([(0,o.MZ)()],Me.prototype,"_labelsText",null),(0,s._)([(0,o.MZ)()],Me.prototype,"_actualVisualElementsOrientation",null),(0,s._)([(0,o.MZ)()],Me.prototype,"_measurementArrowStripeLength",null),Me=(0,s._)([(0,l.$)("esri.views.3d.analysis.DirectLineMeasurement.DirectLineMeasurementVisualization")],Me);const Re=Math.cos((0,w.kU)(12)),Oe=(0,M.r_)(),Ae=(0,M.r_)(),Ce=(0,M.QG)(),Pe=(0,M.QG)(),Se=(0,M.QG)();let Ee=class extends((0,h.P)(r.default)){constructor(e){super(e),this.type="direct-line-measurement-view-3d",this.analysis=null,this.result=null,this.measurementMode=u.G.Auto,this.elevationAlignedStartPoint=null,this.elevationAlignedEndPoint=null}initialize(){const e=this.view,t=this.analysis;this._analysisVisualization=new Me({view:e,analysis:t,analysisView:this}),this._analysisController=new y({view:e,analysis:t,viewData:this})}destroy(){this._analysisController=(0,n.pR)(this._analysisController),this._analysisVisualization=(0,n.pR)(this._analysisVisualization)}get updating(){return!!this._analysisVisualization?.loadingMessages}get viewMode(){return this._analysisVisualization.viewMode}get actualVisualizedMeasurement(){return this._analysisVisualization.actualVisualizedMeasurement}get visualElementOrientation(){return this._analysisVisualization.visualElementOrientation}set visualElementOrientation(e){this._analysisVisualization.visualElementOrientation=e}get allowVisualElementsOrientationChange(){return this._analysisVisualization.allowVisualElementsOrientationChange}set allowVisualElementsOrientationChange(e){this._analysisVisualization.allowVisualElementsOrientationChange=e}get triangleCollapseRatioThreshold(){return this._analysisVisualization.triangleCollapseRatioThreshold}set triangleCollapseRatioThreshold(e){this._analysisVisualization.triangleCollapseRatioThreshold=e}get directLabelText(){return this._analysisVisualization.labels.direct?.text??""}get horizontalLabelText(){return this._analysisVisualization.labels.horizontal?.text??""}get verticalLabelText(){return this._analysisVisualization.labels.vertical?.text??""}get unit(){return this.analysis.unit??this._defaultUnit}get testData(){}};(0,s._)([(0,o.MZ)()],Ee.prototype,"updating",null),(0,s._)([(0,o.MZ)({readOnly:!0})],Ee.prototype,"type",void 0),(0,s._)([(0,o.MZ)({constructOnly:!0,nonNullable:!0})],Ee.prototype,"analysis",void 0),(0,s._)([(0,o.MZ)()],Ee.prototype,"result",void 0),(0,s._)([(0,o.MZ)()],Ee.prototype,"measurementMode",void 0),(0,s._)([(0,o.MZ)()],Ee.prototype,"elevationAlignedStartPoint",void 0),(0,s._)([(0,o.MZ)()],Ee.prototype,"elevationAlignedEndPoint",void 0),(0,s._)([(0,o.MZ)({readOnly:!0})],Ee.prototype,"viewMode",null),(0,s._)([(0,o.MZ)({readOnly:!0})],Ee.prototype,"actualVisualizedMeasurement",null),(0,s._)([(0,o.MZ)()],Ee.prototype,"visualElementOrientation",null),(0,s._)([(0,o.MZ)()],Ee.prototype,"allowVisualElementsOrientationChange",null),(0,s._)([(0,o.MZ)()],Ee.prototype,"triangleCollapseRatioThreshold",null),(0,s._)([(0,o.MZ)({readOnly:!0})],Ee.prototype,"directLabelText",null),(0,s._)([(0,o.MZ)({readOnly:!0})],Ee.prototype,"horizontalLabelText",null),(0,s._)([(0,o.MZ)({readOnly:!0})],Ee.prototype,"verticalLabelText",null),(0,s._)([(0,o.MZ)()],Ee.prototype,"_analysisVisualization",void 0),(0,s._)([(0,o.MZ)()],Ee.prototype,"_analysisController",void 0),(0,s._)([(0,o.MZ)()],Ee.prototype,"unit",null),(0,s._)([(0,o.MZ)(c.q)],Ee.prototype,"_defaultUnit",void 0),Ee=(0,s._)([(0,l.$)("esri.views.3d.analysis.DirectLineMeasurementAnalysisView3D")],Ee);const Le=Ee},49979:(e,t,i)=>{i.d(t,{B:()=>r});i(21265);var s=i(79953);class r{get isDecoration(){return this._isDecoration}set isDecoration(e){this._isDecoration=e}constructor(e){this._isDecoration=!1,this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=e.view,this._handle=(0,s.watch)((()=>e.view.ready),(e=>{this._resourcesCreated&&(e?this._createResources():this._destroyResources())}))}applyProperties(e){let t=!1;for(const i in e)i in this&&("attached"===i?t=!!e[i]:this[i]=e[i]);this.attached=t}destroy(){this.attached=!1,this._handle.remove()}get attached(){return this._attached}set attached(e){e!==this._attached&&this.view._stage&&(this._attached=e,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources(),this.onAttachedChange(e))}onAttachedChange(e){}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this.attached&&this.updateVisibility(e))}_createResources(){this.createResources(),this._resourcesCreated=!0,this.updateVisibility(this.visible)}_destroyResources(){this.destroyResources(),this._resourcesCreated=!1}}},53737:(e,t,i)=>{var s;i.d(t,{G:()=>s}),function(e){e[e.Auto=0]="Auto",e[e.Euclidean=1]="Euclidean",e[e.Geodesic=2]="Geodesic"}(s||(s={}))},54366:(e,t,i)=>{i.d(t,{C:()=>m,b:()=>v});var s=i(75304),r=i(50366),n=i(78731),o=i(769),a=i(61535),l=i(75762),c=i(66652),h=i(35490),u=i(94409),d=i(16878),p=i(22131),_=i(14480),g=i(8118);function v(e){const t=new g.N5,{vertex:i,fragment:v,attributes:m,varyings:y}=t,{vvColor:f,hasVertexColors:w}=e;return(0,h.NB)(i,e),t.include(r.d,e),t.include(o.c,e),t.include(l.A,e),t.include(n.g,e),v.include(s.HQ,e),t.include(_.z,e),t.include(a.Z,e),m.add(p.r.POSITION,"vec3"),f&&m.add(p.r.COLORFEATUREATTRIBUTE,"float"),w||y.add("vColor","vec4"),y.add("vpos","vec3"),i.uniforms.add(new u.E("uColor",(e=>e.color))),i.main.add(d.H`
      vpos = position;
      forwardNormalizedVertexColor();
      forwardObjectAndLayerIdColor();

      ${w?"vColor *= uColor;":f?"vColor = uColor * interpolateVVColor(colorFeatureAttribute);":"vColor = uColor;"}
      forwardViewPosDepth((view * vec4(vpos, 1.0)).xyz);
      gl_Position = transformPosition(proj, view, vpos);`),v.include(c.a),v.main.add(d.H`discardBySlice(vpos);
discardByTerrainDepth();
outputColorHighlightOID(vColor, vpos);`),t}const m=Object.freeze(Object.defineProperty({__proto__:null,build:v},Symbol.toStringTag,{value:"Module"}))},75075:(e,t,i)=>{i.d(t,{X:()=>c});var s=i(87752),r=i(10382),n=i(49979),o=i(8461),a=i(71602),l=i(20196);class c extends n.B{constructor(e){super(e),this._resources=null,this._transform=(0,r.vt)()}get object(){return null!=this._resources?this._resources.object:null}get transform(){return this._transform}set transform(e){(0,s.C)(this._transform,e),null!=this._resources&&(this._resources.object.transformation=this._transform)}recreate(){this.attached&&this.createResources()}recreateGeometry(){if(null==this._resources)return;const e=this._resources.object,t=this.view._stage;t.removeMany(e.geometries),e.removeAllGeometries(),this.createGeometries(e),e.visible=this.visible,t.addMany(e.geometries)}createResources(){this.destroyResources();const e=this.view._stage;if(!e)return;const t=new l.x(e,{pickable:!1,updatePolicy:a.q.SYNC}),i=new o.B({castShadow:!1});i.transformation=this._transform,this.createExternalResources(),this.createGeometries(i),e.addMany(i.geometries),this.forEachExternalMaterial((t=>e.add(t))),e.add(i),t.add(i),i.visible=this.visible,this._resources={layer:t,object:i}}destroyResources(){const e=this.view._stage;null!=this._resources&&e&&(e.remove(this._resources.object),this._resources.layer.destroy(),this.forEachExternalMaterial((t=>{e.remove(t)})),e.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}updateVisibility(e){null!=this._resources&&(this._resources.object.visible=e)}}},75644:(e,t,i)=>{i.d(t,{q:()=>r});var s=i(56062);const r={readOnly:!0,get(){return(0,s.c)(this.view)}}}}]);