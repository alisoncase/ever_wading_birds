"use strict";(self.webpackChunkever_wading_birds=self.webpackChunkever_wading_birds||[]).push([[1072],{1072:(e,t,n)=>{n.r(t),n.d(t,{describeCoverage:()=>h,getCapabilities:()=>g});var i=n(23060),a=n(74719),s=n(49959),o=n(12560),r=n(48270);function l(e){return e.endsWith("?")?e.slice(0,-1):e}function u(e){return e.filter((e=>{let{coverageSubType:t}=e;return null==t||""===t||/^rectified(grid|dataset)/i.test(t)}))}function m(e){const t={};for(let n=0;n<e.childNodes.length;n++){const i=e.childNodes[n];if(1!==i.nodeType)continue;const a=(0,r.vv)(i).toLowerCase();switch(a){case"title":case"abstract":t[a]=(0,r.mX)(i);break;case"identifier":t.id=(0,r.mX)(i);break;case"wgs84boundingbox":{const e=(0,r.pN)(i,"LowerCorner"),n=(0,r.pN)(i,"UpperCorner");t.lonLatEnvelope=new o.default({xmin:e[0],ymin:e[1],xmax:n[0],ymax:n[1],spatialReference:{wkid:4326}})}break;case"coveragesummary":t.coverageSummaries=t.coverageSummaries||[],t.coverageSummaries.push(m(i))}}return t}function p(e,t){if(e.coverageSummaries)for(let n=0;n<e.coverageSummaries.length;n++)e.coverageSummaries[n].abstract=e.coverageSummaries[n].abstract||e.abstract,e.coverageSummaries[n].lonLatEnvelope=e.coverageSummaries[n].lonLatEnvelope||e.lonLatEnvelope,e.coverageSummaries[n].title=e.coverageSummaries[n].title||e.title,p(e.coverageSummaries[n],t);null!=e.id&&t.push(e)}function c(e){const t=(0,r.V6)(e.querySelector("Operation[name=GetCapabilities]"),"Get")?.getAttribute("xlink:href")||"",n=(0,r.V6)(e.querySelector("Operation[name=DescribeCoverage]"),"Get")?.getAttribute("xlink:href")||"",i=(0,r.V6)(e.querySelector("Operation[name=GetCoverage]"),"Get")?.getAttribute("xlink:href")||"";return{getCapabilities:l(t),describeCoverage:l(n),getCoverage:l(i)}}function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=null;n="string"==typeof e?(new DOMParser).parseFromString(e,"text/xml"):e;let i=n.documentElement.getAttribute("version");"1.0"===i?i="1.0.0":"1.1"===i&&(i="1.1.0");const s=i||t||"1.0.0",d=s.slice(0,3);let f;if("2.0"===d)f=function(e){const t=(0,r.V6)(e,"ServiceIdentification"),n=(0,r.mX)(t,"Title"),i=(0,r.Dy)(t,"ServiceTypeVersion"),a=(0,r.Dy)(t,"Profile"),s=c((0,r.V6)(e,"OperationsMetadata")),l=(0,r.IC)(e,"Contents/CoverageSummary"),m=[];for(let u=0;u<l.length;u++){const e=l[u],t=(0,r.mX)(e,"CoverageId"),n=(0,r.V6)(e,"WGS84BoundingBox");let i;if(n){const e=(0,r.pN)(n,"LowerCorner"),t=(0,r.pN)(n,"UpperCorner");i=new o.default({xmin:e[0],ymin:e[1],xmax:t[0],ymax:t[1],spatialReference:{wkid:4326}})}const a=(0,r.mX)(e,"CoverageSubtype")||"RectifiedGridCoverage";m.push({id:t,lonLatEnvelope:i,coverageSubType:a})}const p=(0,r.V6)(e,"ServiceMetadata");return{name:n,supportedVersions:i,supportedFormats:(0,r.Dy)(p,"formatSupported"),supportedInterpolations:(0,r.Dy)(p,"interpolationSupported").concat((0,r.Dy)(p,"InterpolationSupported")),onlineResources:s,profiles:a,coverages:m,gridCoverages:u(m),version:"2.0.1"}}(n);else if("1.1"===d)f=function(e){const t=(0,r.mX)(e,"ServiceIdentification/Title"),n=(0,r.Dy)(e,"ServiceIdentification/ServiceTypeVersion"),i=c((0,r.V6)(e,"OperationsMetadata")),a=[],s=(0,r.V6)(e,"Contents");for(let l=0;l<s.childNodes.length;l++){const e=s.childNodes[l];1===e.nodeType&&(0,r.g7)(e,"CoverageSummary")&&p(m(e),a)}const o=(0,r.Dy)(s,"SupportedFormat");return{name:t,onlineResources:i,coverages:a,gridCoverages:u(a),supportedVersions:n,supportedFormats:o,version:"1.1.0"}}(n);else{if("1.0"!==d)throw new a.default("wcsraster:parsecapabilities","the capabilities version is not supported");f=function(e){const t=(0,r.mX)(e,"Service/name"),n=(0,r.V6)(e,"Capability"),i=(0,r.V6)(n,"GetCapabilities/Get/OnlineResource")?.getAttribute("xlink:href")??"",a=(0,r.V6)(n,"DescribeCoverage/Get/OnlineResource")?.getAttribute("xlink:href")??"",s=(0,r.V6)(n,"GetCoverage/Get/OnlineResource")?.getAttribute("xlink:href")??"",m={getCapabilities:l(i),describeCoverage:l(a),getCoverage:l(s)},p=(0,r.IC)(e,"CoverageOfferingBrief"),c=[];for(let l=0;l<p.length;l++){const e=p[l],t=(0,r.mX)(e,"name"),n=(0,r.IC)(e,"pos"),i=(0,r.pN)(n[0]),a=(0,r.pN)(n[1]),s=new o.default({xmin:i[0],ymin:i[1],xmax:a[0],ymax:a[1],spatialReference:{wkid:4326}});c.push({id:t,lonLatEnvelope:s})}return{name:t,onlineResources:m,coverages:c,gridCoverages:u(c),supportedVersions:["1.0.0"],version:"1.0.0"}}(n)}return f.version=s,f}var f=n(81071);async function g(e,t){const{version:n,customParameters:o,signal:r}=t??{},l=n?.startsWith("1.0")?"version":"acceptVersions",m={service:"WCS",request:"GetCapabilities",[l]:n,...o};try{let{data:n}=await(0,i.default)(e,{query:m,responseType:"xml",signal:r});return t?.version||function(e){let t=null;t="string"==typeof e?(new DOMParser).parseFromString(e,"text/xml"):e;const n=t.documentElement.getAttribute("version"),i=n?.slice(0,3);return null!=i&&i<"2.1"}(n)||(m[l]="2.0.1",({data:n}=await(0,i.default)(e,{query:m,responseType:"xml",signal:r}))),d(n)}catch(u){if(!(0,s.isAbortError)(u))throw new a.default("wcslayer:open","wcs capabilities is not valid or supported");throw u}}async function h(e,t){const{coverageIds:n,version:o,customParameters:r,signal:l}=t,u=o.slice(0,3),m="1.0"===u?"coverage":"1.1"===u?"identifiers":"coverageId",p={service:"WCS",request:"DescribeCoverage",version:o,[m]:n.join(","),...r};try{const{data:t}=await(0,i.default)(e,{query:p,responseType:"xml",signal:l});return(0,f.p)(t,o)}catch(c){if(!(0,s.isAbortError)(c))throw new a.default("wcslayer:open","wcs coverage description is not valid or supported");throw c}}},63625:(e,t,n)=>{n.d(t,{m:()=>a});const i=[[3819,3819],[3821,3824],[3889,3889],[3906,3906],[4001,4025],[4027,4036],[4039,4047],[4052,4055],[4074,4075],[4080,4081],[4120,4176],[4178,4185],[4188,4216],[4218,4289],[4291,4304],[4306,4319],[4322,4326],[4463,4463],[4470,4470],[4475,4475],[4483,4483],[4490,4490],[4555,4558],[4600,4646],[4657,4765],[4801,4811],[4813,4821],[4823,4824],[4901,4904],[5013,5013],[5132,5132],[5228,5229],[5233,5233],[5246,5246],[5252,5252],[5264,5264],[5324,5340],[5354,5354],[5360,5360],[5365,5365],[5370,5373],[5381,5381],[5393,5393],[5451,5451],[5464,5464],[5467,5467],[5489,5489],[5524,5524],[5527,5527],[5546,5546],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3038,3051],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3150,3151],[3300,3301],[3328,3335],[3346,3346],[3350,3352],[3366,3366],[3389,3390],[3416,3417],[3833,3841],[3844,3850],[3854,3854],[3873,3885],[3907,3910],[4026,4026],[4037,4038],[4417,4417],[4434,4434],[4491,4554],[4839,4839],[5048,5048],[5105,5130],[5253,5259],[5269,5275],[5343,5349],[5479,5482],[5518,5519],[5520,5520],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]];function a(e){return null!=e&&i.some((t=>{let[n,i]=t;return e>=n&&e<=i}))}},81071:(e,t,n)=>{n.d(t,{$:()=>c,p:()=>R});var i=n(12560),a=n(65920),s=n(63625),o=n(4463),r=n(74706),l=n(48270);function u(e){e.variables.forEach((e=>e.dimensions.forEach((e=>e.values??=(0,r.Xg)(e)))))}function m(e){return{requestResponseCRSs:(0,l.Dy)(e,"requestResponseCRSs").map((e=>e.split(":")[1])),nativeCRSs:(0,l.Dy)(e,"nativeCRSs").map((e=>e.split(":")[1]))}}function p(e,t){const n=(0,l.Dy)(e,"1.0.0"===t?"interpolationMethod":"InterpolationMethod"),i="1.0.0"===t?e.getAttribute("default"):(0,l.mX)(e,"InterpolationMethods/Default");return null!=i?[i].concat(n.filter((e=>e.toLowerCase()!==i.toLowerCase()))):n}function c(e){return null==e?["nearest"]:e.map((e=>{const t=e.toLowerCase();return t.includes("nearest")?"nearest":t.includes("linear")?"bilinear":t.includes("cubic")?"cubic":null})).filter((e=>!!e))}function d(e){const t=(0,l.IC)(e,"pos"),n=(0,l.pN)(t[0]),a=(0,l.pN)(t[1]);return new i.default({xmin:n[0],ymin:n[1],xmax:a[0],ymax:a[1],spatialReference:{wkid:4326}})}function f(e,t){const n=(0,l.Dy)(e,t);return n?.length&&""!==n[0]&&!isNaN(Number(n[0]))?n.map((e=>Number(e))):null}function g(e){const t=(0,l.pN)(e,"MinimumValue"),n=(0,l.pN)(e,"MaximumValue");return t.length&&n.length?t.map(((e,t)=>({min:e,max:n[t],avg:-1,stddev:-1}))):null}function h(e){return null==e?null:e.every((t=>t===e[0]))?e[0]:e}function v(e){const t=[],n=(0,l.IC)(e,"RangeSet");let i=[];for(let a=0;a<n.length;a++){const e=(0,l.mX)(n[a],"name"),s=(0,l.mX)(n[a],"label"),o=[],r=f(n[a],"nullValues/singleValue"),u=(0,l.IC)(n[a],"AxisDescription");for(let t=0;t<u.length;t++){const e=(0,l.mX)(u[t],"name"),n=(0,l.mX)(u[t],"label"),a=(0,l.Dy)(u[t],"singleValue");if(0===a.length){const e=(0,l.mX)(u[t],"min"),n=(0,l.mX)(u[t],"max"),i=Number((0,l.mX)(u[t],"res"))||1;if(null!==e&&null!==n)for(let t=parseInt(e,10);t<=parseInt(n,10);t+=i)a.push(t.toString())}"band"===e.toLowerCase()&&(i=a),o.push({name:e,label:n,values:a})}t.push({name:e,label:s,nullValues:r,axis:o})}return{rangeSet:t,bandNames:i}}function b(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!e)return{resolution:null,units:null};let t=e.toUpperCase();const n=["Years","Months","Days","Hours","Minutes","Seconds"];let i,a,s;return t.includes("PT")?(t=t.slice(2),s=["H","M","S"].findIndex((e=>t.includes(e))),i=n[3+s],a=parseFloat(t.slice(0,-1))):(t=t.slice(1),s=["Y","M","D"].findIndex((e=>t.includes(e))),s>-1&&(i=n[s]),a=parseFloat(t.slice(0,-1))),{resolution:a,units:i}}function x(e){const t=(0,l.IC)(e,"timeposition");if(t.length>0){const e=[];for(let n=0;n<t.length;n++)e.push(new Date((0,l.mX)(t[n])));return{begin:e[0],end:e[e.length-1],values:e}}const n=(0,l.V6)(e,"timePeriod")||(0,l.V6)(e,"TimePeriod");return n?{begin:new Date((0,l.mX)(n,"beginPosition")||(0,l.mX)(n,"BeginPosition")),end:new Date((0,l.mX)(n,"endPosition")||(0,l.mX)(n,"EndPosition")),...b((0,l.mX)(n,"timeResolution")||(0,l.mX)(n,"TimeResolution"))}:null}function y(e){const t=(0,l.V6)(e,"spatialDomain"),n=(0,l.V6)(t,"Envelope")||(0,l.V6)(t,"EnvelopeWithTimePeriod"),a=n.getAttribute("srsName").split(":"),s=a[a.length-1],o=(0,l.IC)(n,"pos"),r=(0,l.pN)(o[0]),u=(0,l.pN)(o[1]),m=parseInt(s,10),p=isNaN(m)?null:{wkid:m},c=new i.default({xmin:r[0],ymin:r[1],xmax:u[0],ymax:u[1],spatialReference:p}),d=(0,l.V6)(t,"RectifiedGrid"),f=(0,l.mX)(d,"low").split(" "),g=(0,l.mX)(d,"high").split(" "),h=parseInt(g[0],10)-parseInt(f[0],10)+1,v=parseInt(g[1],10)-parseInt(f[1],10)+1,b=(0,l.pN)(t,"origin/pos"),y=(0,l.IC)(t,"offsetVector"),w={envelope:c,columns:h,rows:v,offset:{x:parseFloat((0,l.mX)(y[0]).split(" ")[0]),y:parseFloat((0,l.mX)(y[1]).split(" ")[1])},origin:{x:b[0],y:b[1]}},C=(0,l.V6)(e,"temporalDomain")||(0,l.V6)(e,"TemporalDomain");return{spatialDomain:w,temporalDomain:C?x(C):null}}function w(e){if(!e.temporalDomain)return null;const{begin:t,end:n,values:i,units:a,resolution:s}=e.temporalDomain,o={variables:[{name:"default",description:"",dimensions:[{name:"StdTime",description:"",unit:"ISO8601",values:i?.map((e=>e.getTime())),hasRegularIntervals:!i,interval:s,intervalUnit:a,extent:[t.getTime(),n.getTime()]}]}]};return u(o),o}function C(e,t){const n=[],i=(0,l.IC)(e,"Field");let a,s=[];for(let o=0;o<i.length;o++){const e=(0,l.mX)(i[o],"Identifier"),r=(0,l.mX)(i[o],"Description"),u=(0,l.mX)(i[o],"Definition"),m=(0,l.mX)(i[o],"Abstract"),c=(0,l.mX)(i[o],"Title"),d=f(i[o],"NullValue"),h=(0,l.V6)(i[o],"AllowedValues"),v=h?g(h):null,b=p(i[o],"1.1.0"),x=[],y=(0,l.IC)(i[o],"Axis");for(let n=0;n<y.length;n++){const e=y[n].getAttribute("identifier"),i=(0,l.mX)(y[n],"UOM"),o=(0,l.mX)(y[n],"DataType"),r=(0,l.Dy)(y[n],"Key");t&&!e.toLowerCase().includes("band")||(s=r,a=d),x.push({identifier:e,uom:i,dataType:o,values:r,bandNoDataValues:a})}n.push({identifier:e,description:r,definition:u,abstract:m,title:c,supportedInterpolations:b,axis:x,nullValues:d,statistics:v})}return{rangeSet:n,bandNames:s,bandNoDataValues:a,statistics:n[0].statistics}}function S(e,t){if(!t.temporalDomain)return null;const n=e.filter((e=>!e.identifier.toLowerCase().includes("field_1")&&!e.axis.some((e=>e.identifier.includes("band"))))),i=[];if(n.length&&n.forEach((e=>{const t=e.axis.map((e=>{const t=e.values.map((t=>"ISO8601"===e.uom?(t=t.trim()).toLowerCase().includes("z")?new Date(t).getTime():new Date(t+"Z").getTime():parseFloat(t.trim()))),n=[Math.min.apply(null,t),Math.max.apply(null,t)];return{name:e.identifier.trim(),description:"",field:e.identifier.trim(),unit:e.uom?e.uom.trim():"",hasRegularIntervals:!1,values:t,extent:n}}));i.push({name:e.identifier.trim(),description:e.description?.trim()??"",unit:"",dimensions:t,statistics:e.statistics})})),t.temporalDomain){const{begin:e,end:n,values:a,units:s,resolution:o}=t.temporalDomain;i.some((e=>e.dimensions.some((e=>"stdtime"===e.name.toLowerCase()))))||i.forEach((t=>{t.dimensions.push({name:"StdTime",description:"",unit:"ISO8601",values:a?.map((e=>e.getTime())),hasRegularIntervals:!a,interval:o,intervalUnit:s,extent:[e.getTime(),n.getTime()]})}))}if(i.length){const e={variables:i};return u(e),e}return null}function D(e){const t=(0,l.V6)(e,"SpatialDomain"),n=(0,l.V6)(t,"GridCRS"),a=(0,l.mX)(n,"GridBaseCRS"),o=(0,l.mX)(n,"GridOrigin"),r=o?.split(" ").map((e=>parseFloat(e)))??[0,0],u=(0,l.pN)(n,"GridOffsets"),m=(0,l.IC)(t,"BoundingBox");let p,c,d,f;for(let s=0;s<m.length;s++){const e=m[s].getAttribute("crs")?.toLowerCase();if(null!=e)if(e.includes("imagecrs")){const e=(0,l.pN)(m[s],"LowerCorner"),t=(0,l.pN)(m[s],"UpperCorner");p=t[0]-e[0]+1,c=t[1]-e[1]+1}else if(e.indexOf("epsg")>0){const t=e.split(":");d=parseInt(t[t.length-1],10);const n=(0,l.pN)(m[s],"LowerCorner"),a=(0,l.pN)(m[s],"UpperCorner");f=new i.default({xmin:n[0],ymin:n[1],xmax:a[0],ymax:a[1],spatialReference:{wkid:d}})}}const g=p>c,h=f.xmax-f.xmin>f.ymax-f.ymin;let v=!1;(0,s.m)(d)&&(g===h?v=!1:(v=!0,f=new i.default({xmin:f.ymin,ymin:f.xmin,xmax:f.ymax,ymax:f.xmax,spatialReference:{wkid:d}})));const b={columns:p,rows:c,origin:{x:r[0],y:r[1]},offset:{x:u[0],y:u[u.length-1]},gridBaseCRS:a,envelope:f,useEPSGAxis:v},y=(0,l.V6)(e,"temporalDomain")||(0,l.V6)(e,"TemporalDomain");return{spatialDomain:b,temporalDomain:y?x(y):null}}function I(e){const t=(0,l.V6)(e,"Envelope")||(0,l.V6)(e,"EnvelopeWithTimePeriod"),n=t.getAttribute("srsName"),a=n.slice(n.lastIndexOf("/")+1),s=t.getAttribute("axisLabels").split(" ").map((e=>e.trim())).filter((e=>""!==e.trim())),o=(0,l.pN)(t,"lowerCorner"),r=(0,l.pN)(t,"upperCorner"),u=!["y","lat","latitude","north","nor","n","b"].includes(s[0].toLowerCase());let m;const p=parseInt(a,10),c=isNaN(p)?null:{wkid:p};m=new i.default(u?{xmin:o[0],ymin:o[1],xmax:r[0],ymax:r[1],spatialReference:c}:{xmin:o[1],ymin:o[0],xmax:r[1],ymax:r[0],spatialReference:c});const d={mins:o,maxs:r},f=t.getAttribute("uomLabels").trim().split(" ");let g,h;if((0,l.g7)(t,"EnvelopeWithTimePeriod")){g=new Date((0,l.mX)(e,"beginPosition")||(0,l.mX)(e,"BeginPosition")),h=new Date((0,l.mX)(e,"endPosition")||(0,l.mX)(e,"EndPosition"));const t=f?.findIndex((e=>"oledatetime"===e?.toLowerCase()));t>-1&&(f[t]="ISO8601")}return{envelope:m,axisLabels:s,uomLabels:f.length?f:null,envelopeAllDims:d,beginPosition:g,endPosition:h,isEastFirst:u}}function V(e,t){const n=[],i=(0,l.IC)(e,"DataRecord"),a=[];let s,o=[];for(let r=0;r<i.length;r++){const e=(0,l.IC)(i[r],"field"),u=[];for(let n=0;n<e.length;n++){const i=e[n].getAttribute("name"),r=(0,l.mX)(e[n],"description")||"",m=(0,l.V6)(e[n],"uom")?.getAttribute("code")||"",p=(0,l.pN)(e[n],"interval"),c=f(e[n],"nilValue")?.[0];t&&!i.toLowerCase().includes("band")||(a.push(i),p?.length&&(s=s||[],s.push({min:p[0],max:p[1],avg:-1,stddev:-1})),o.push(c)),u.push({name:i,description:r,uom:m,allowedValues:p,nilValue:c})}n.push(u)}return o.some((e=>null!=e))||(o=null),{rangeType:n,bandNames:a,bandStats:s,bandNoDataValues:o}}function N(e){let t=1,n="";const i=.01;return Math.abs(e-1/24)<1/24*i?n="Hours":Math.abs(e-1)<1*i?n="Days":e<1?(t=Math.round(24*e),n="Hours"):e>28-i&&e<31+i||Math.round(e/30)<12?n="Months":e>365-i&&e<366+i&&(n="Years"),{interval:t,intervalUnit:n}}function X(e,t,n){if(n.axisLabels.length<=2)return null;const i=[];for(let s=0;s<e.length;s++){const t=e[s];for(let e=0;e<t.length;e++)t[e].name.toLowerCase().includes("band")||i.push(t[e])}const a=[];if(i.length){const e=[];for(let i=2;i<n.axisLabels.length;i++){const a=t.uomLabels?.[i]?.trim()??"",s=n.axisLabels[i].toLowerCase().includes("time")||"iso8601"===a.toLowerCase()||"oledatetime"===a.toLowerCase();let o,l;if(s){const e=N(n.offset[i]);o=e.interval,l=e.intervalUnit}else o=n.offset[i],l=a;const u=[];s?(u.push((0,r.$E)(t.envelopeAllDims.mins[i])),u.push((0,r.$E)(t.envelopeAllDims.maxs[i]))):(u.push(t.envelopeAllDims.mins[i]),u.push(t.envelopeAllDims.maxs[i])),e.push({name:n.axisLabels[i].trim(),description:n.axisLabels[i].trim(),unit:s?"ISO8601":a,hasRegularIntervals:!0,extent:u,interval:o,intervalUnit:l})}if(i.forEach((t=>{const{allowedValues:n}=t,i=2===n?.length?[{min:n[0],max:n[1],avg:-1,stddev:-1}]:null;a.push({name:t.name.trim(),description:t.description?.trim()??"",unit:t.uom.trim(),statistics:i,dimensions:[...e]})})),a.length){const e={variables:a};return u(e),e}}return null}function L(e,t){const n=(0,l.V6)(e,"RectifiedGrid"),i=(0,l.pN)(n,"low"),a=(0,l.pN)(n,"high"),s=[];for(let l=0;l<i.length;l++)s.push(a[l]-i[l]+1);const o=(0,l.mX)(n,"axisLabels").split(" "),r=(0,l.pN)(n,"origin/pos"),u=(0,l.IC)(n,"offsetVector"),m=[];for(let g=0;g<u.length;g++){const e=(0,l.pN)(u[g]),t=e.findIndex((e=>0!==e));m[t]=e[t]}let p=!1;t?.length&&o?.length&&(p=[...t].sort(((e,t)=>e<t?-1:1)).join(",")===[...o].sort(((e,t)=>e<t?-1:1)).join(","));let c,d,f;return["y","lat","latitude","north","nor","n","b"].includes((p?o:t)[0].toLowerCase())?(c=s[1],d=s[0],f={y:Math.abs(m[0]),x:Math.abs(m[1])}):(c=s[0],d=s[1],f={x:Math.abs(m[0]),y:Math.abs(m[1])}),{columns:c,rows:d,origin:r,offset:m,resolution:f,gridSamples:s,axisLabels:o,hasSameAxisLabelsAsBoundedBy:p}}function T(e){const t=(0,l.V6)(e,"EarthObservation");if(!t)return null;const n=(0,l.V6)(t,"phenomenonTime"),i=n?x(n):null,s=(0,l.V6)(t,"phenomenonTime"),o=s?x(s):null,r=(0,l.mX)(t,"featureOfInterest/Footprint/multiExtentOf/MultiSurface/surfaceMembers/Polygon/exterior/LinearRing/posList");let u=null;if(r){const e=r.split(" ").map((e=>e.trim())).filter((e=>null!=e&&""!==e)).map(Number);if(e.length){const t=[];for(let n=0;n<e.length/2;n+=2)t.push(e[n],e[n+1]);u=new a.default({rings:[[t]]})}}return{observation:{phenomenonTime:i,resultTime:o,footprint:u,identifier:(0,l.mX)(e,"metaDataProperty/EarthObservationMetaData/identifier"),acquisitionType:(0,l.mX)(e,"metaDataProperty/EarthObservationMetaData/acquisitionType"),status:(0,l.mX)(e,"metaDataProperty/EarthObservationMetaData/status")}}}function R(e,t){let n=null;if(n="string"==typeof e?(new DOMParser).parseFromString(e,"text/xml"):e,"1.0.0"===t)return(0,l.IC)(n,"CoverageOffering").map((e=>function(e){const t={version:"1.0"};let n,i=[];for(let o=0;o<e.childNodes.length;o++){const a=e.childNodes[o];if(1===a.nodeType)if((0,l.g7)(a,"description"))t.description=(0,l.mX)(a);else if((0,l.g7)(a,"name"))t.name=(0,l.mX)(a);else if((0,l.g7)(a,"label"))t.label=(0,l.mX)(a);else if((0,l.g7)(a,"supportedFormats"))t.supportedFormats=(0,l.Dy)(a,"formats");else if((0,l.g7)(a,"supportedCRSs"))t.supportedCRSs=m(a);else if((0,l.g7)(a,"supportedInterpolations"))t.supportedInterpolations=p(a,"1.0.0");else if((0,l.g7)(a,"lonLatEnvelope"))t.lonLatEnvelope=d(a);else if((0,l.g7)(a,"rangeSet")){const e=v(a);t.rangeSet=e.rangeSet,i=e.bandNames;const s=e.rangeSet[0].nullValues;s?.length&&(n=h(s))}else(0,l.g7)(a,"domainSet")&&(t.domainSet=y(a))}const a=c(t.supportedInterpolations),{name:s,description:r,label:u,lonLatEnvelope:f,supportedFormats:g}=t,{spatialDomain:b}=t.domainSet,x={x:Math.abs(b.offset.x),y:Math.abs(b.offset.y)},C=w(t.domainSet),S=new o.default({width:b.columns,height:b.rows,pixelSize:x,pixelType:"unknown",extent:b.envelope,spatialReference:b.envelope.spatialReference,bandCount:i.length||1,noDataValue:n,multidimensionalInfo:C});return{id:s,title:t.name,description:r||u,lonLatEnvelope:f,rasterInfo:S,bandNames:i,supportedFormats:g,supportedInterpolations:a,coverageDescription:t,version:"1.0.0",useEPSGAxis:!1}}(e)));const i=(0,l.IC)(n,"CoverageDescription");return"1.1.0"===t||"1.1.1"===t||"1.1.2"===t?i.map((e=>function(e,t){const n=[],i=[],a={supportedFormats:n,supportedCRSs:i,version:"1.1"};let s,r,u=[];for(let o=0;o<e.childNodes.length;o++){const t=e.childNodes[o];if(1!==t.nodeType)continue;const m=(0,l.vv)(t).toLowerCase();switch(m){case"title":case"abstract":case"identifier":a[m]=(0,l.mX)(t);break;case"supportedformat":{const e=(0,l.mX)(t);n.includes(e)||n.push(e)}break;case"supportedcrs":{const e=(0,l.mX)(t);i.includes(e)||i.push(e)}break;case"range":{const e=C(t,!!a.domain?.temporalDomain);a.range=e.rangeSet,u=e.bandNames;const{bandNoDataValues:n}=e;n?.length&&(s=h(n)),r=e.statistics}break;case"domain":a.domain=D(t)}}const m=c(a.range[0].supportedInterpolations),{identifier:p,abstract:d,title:f,domain:g,range:v}=a,b={x:Math.abs(g.spatialDomain.offset.x),y:Math.abs(g.spatialDomain.offset.y)},x=S(v,g);x&&(s=v[0].nullValues,1===s?.length&&(s=s[0]));const y=new o.default({width:g.spatialDomain.columns,height:g.spatialDomain.rows,pixelSize:b,pixelType:"unknown",extent:g.spatialDomain.envelope,spatialReference:g.spatialDomain.envelope.spatialReference,bandCount:u.length||1,noDataValue:s,statistics:r,multidimensionalInfo:x});return{id:p,title:a.title,description:d||f,bandNames:u,rasterInfo:y,supportedFormats:n,supportedInterpolations:m,coverageDescription:a,version:t,useEPSGAxis:g.spatialDomain.useEPSGAxis}}(e,t))):i.map((e=>function(e){const t={version:"2.0"};let n,i,a=[];for(let o=0;o<e.childNodes.length;o++){const s=e.childNodes[o];if(1===s.nodeType)if((0,l.g7)(s,"coverageId"))t.coverageId=(0,l.mX)(s);else if((0,l.g7)(s,"ServiceParameters"))t.serviceParameters={supportedFormats:(0,l.Dy)(s,"nativeFormat")};else if((0,l.g7)(s,"boundedBy"))t.boundedBy=I(s);else if((0,l.g7)(s,"rangeType")){const e=V(s,t.boundedBy?.axisLabels.length>2||t.domainSet?.axisLabels.length>2);t.rangeType=e.rangeType,a=e.bandNames,n=e.bandStats;const{bandNoDataValues:o}=e;o?.length&&(i=h(o))}else if((0,l.g7)(s,"domainSet"))t.domainSet=L(s,t.boundedBy?.axisLabels);else if((0,l.g7)(s,"metadata")){const e=(0,l.V6)(s,"EOMetadata");t.eoMetadata=e?T(e):null}}const{coverageId:s,boundedBy:r,domainSet:u,rangeType:m,serviceParameters:p}=t,c=X(m,r,u);return!n&&c&&(n=c?.variables[0].statistics),null!=c&&(i=m[0][0].nilValue),{id:s,title:s,description:s,bandNames:a,rasterInfo:new o.default({width:u.columns,height:u.rows,pixelSize:u.resolution,pixelType:"unknown",extent:r.envelope,spatialReference:r.envelope.spatialReference,bandCount:a.length||1,statistics:n,noDataValue:i,multidimensionalInfo:c}),supportedFormats:p.supportedFormats,coverageDescription:t,version:"2.0.1",useEPSGAxis:!1}}(e)))}}}]);