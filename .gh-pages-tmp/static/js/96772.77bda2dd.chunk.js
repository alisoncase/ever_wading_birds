"use strict";(self.webpackChunkever_wading_birds=self.webpackChunkever_wading_birds||[]).push([[96772],{96772:(t,i,r)=>{r.r(i),r.d(i,{default:()=>h});var o=r(93800),s=r(49959),e=r(48602),a=(r(21265),r(50925),r(14746),r(75269)),n=r(25780);let c=class extends n.A{constructor(t){super(t),this._watchId=void 0,this._trackStartingTimeoutId=void 0,this._settingPosition=null,this._trackController=null,this.error=void 0,this.positionFilterFunction=null}destroy(){this._stopTracking()}get state(){return this._geolocationUsable?this.view&&!this.view.ready?"disabled":this._settingPosition||void 0!==this._trackStartingTimeoutId?"waiting":this.tracking?"tracking":null!=this.error?"error":"ready":"feature-unsupported"}get tracking(){return void 0!==this._watchId}start(){"disabled"!==this.state&&"feature-unsupported"!==this.state&&this._startTracking()}stop(){"disabled"!==this.state&&"feature-unsupported"!==this.state&&this._stopTracking()}_stopWatchingPosition(){void 0!==this._watchId&&(navigator.geolocation.clearWatch(this._watchId),this._watchId=void 0)}_stopTracking(){this._abortTrack(),this._clearWaitingTimer(),this._stopWatchingPosition(),this._clearGraphic()}_startTracking(){this._stopTracking();const t=(0,s.debounce)((async t=>{this._abortTrack();const i=new AbortController;this._trackController=i;const{timestamp:r,coords:o}=t,e={timestamp:r,coords:{...o}};this.error=void 0;try{if("function"==typeof this.positionFilterFunction&&!this.positionFilterFunction.call(null,{position:e}))return;if(await this.updatePosition(t,i),this._trackController!==i)return;this._clearWaitingTimer(),this._addGraphic(),this.emit("track",{position:t}),this._trackController=null}catch(a){if((0,s.isAbortError)(a))return;throw this._trackController=null,this._emitError(a),this._clearWaitingTimer(),a}}),0);this._watchId=navigator.geolocation.watchPosition((i=>{this._settingPosition=t(i).catch(s.ignoreAbortErrors)}),this._handleWatchPositionError.bind(this),this.geolocationOptions??void 0),this._trackStartingTimeoutId=setTimeout((()=>{this._trackStartingTimeoutId=void 0}),15e3)}_handleWatchPositionError(t){t.code===t.PERMISSION_DENIED&&this._stopTracking(),this._emitError(t)}_abortTrack(){this._trackController?.abort(),this._trackController=null}_clearWaitingTimer(){clearTimeout(this._trackStartingTimeoutId),this._trackStartingTimeoutId=void 0,this._settingPosition=null}_emitError(t){this.error=t,this.emit("track-error",{error:t})}};(0,o._)([(0,e.MZ)()],c.prototype,"_watchId",void 0),(0,o._)([(0,e.MZ)()],c.prototype,"_trackStartingTimeoutId",void 0),(0,o._)([(0,e.MZ)()],c.prototype,"_settingPosition",void 0),(0,o._)([(0,e.MZ)()],c.prototype,"error",void 0),(0,o._)([(0,e.MZ)()],c.prototype,"positionFilterFunction",void 0),(0,o._)([(0,e.MZ)({readOnly:!0})],c.prototype,"state",null),(0,o._)([(0,e.MZ)({readOnly:!0})],c.prototype,"tracking",null),(0,o._)([(0,e.MZ)()],c.prototype,"start",null),(0,o._)([(0,e.MZ)()],c.prototype,"stop",null),c=(0,o._)([(0,a.$)("esri.widgets.Track.TrackViewModel")],c);const h=c}}]);