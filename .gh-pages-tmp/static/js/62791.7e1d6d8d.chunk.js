"use strict";(self.webpackChunkever_wading_birds=self.webpackChunkever_wading_birds||[]).push([[59116,62791],{9811:(e,t,n)=>{n.d(t,{X:()=>o});var i=n(72248),s=n(37229),r=n(10252),a=n(65022);class o extends r.w{constructor(e){super({...e,isDraped:!0,constraint:new i.en(e.edgeStart,e.edgeEnd,e.getGroundElevation)})}get hints(){return[new a.c(s.H3.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}}},10252:(e,t,n)=>{n.d(t,{w:()=>r});var i=n(23278),s=n(51990);class r extends s.C{constructor(e){let{targetPoint:t,objectId:n,constraint:s,isDraped:r}=e;super(t,s,r,i.n.FEATURE),this.objectId=n}}},16941:(e,t,n)=>{n.d(t,{B:()=>p});var i=n(89227),s=n(28473),r=n(72248),a=n(49281),o=n(23278),d=n(37229),c=n(51990),h=n(65022),l=n(70755);class p extends c.C{constructor(e){let{referenceLine:t,lineStart:n,targetPoint:d,isDraped:c}=e;const h=(0,s.o8)(n),{left:l,right:p}=t;(0,i.d)(h,(0,i.g)(h,h,p),l),super(d,new r.WG(n,(0,a._7)(h)),c,o.n.SELF),this._referenceLines=[{edge:t,fadeLeft:!0,fadeRight:!0}]}get hints(){return[new h.c(d.H3.TARGET,this.constraint.start,this.targetPoint,this.isDraped,this.domain),new l.r(this.constraint.start,this.targetPoint,this.isDraped,this.domain),...this._referenceLines.map((e=>new h.c(d.H3.REFERENCE,e.edge.left,e.edge.right,this.isDraped,this.domain,e.fadeLeft,e.fadeRight)))]}addReferenceLine(e){const t={edge:e,fadeLeft:!0,fadeRight:!0};this._referenceLines.forEach((n=>{(0,i.p)(e.right,n.edge.left)&&(n.fadeLeft=!1,t.fadeRight=!1),(0,i.p)(e.right,n.edge.right)&&(n.fadeRight=!1,t.fadeRight=!1),(0,i.p)(e.left,n.edge.right)&&(n.fadeRight=!1,t.fadeLeft=!1),(0,i.p)(e.left,n.edge.left)&&(n.fadeLeft=!1,t.fadeLeft=!1)})),this._referenceLines.push(t)}}},18497:(e,t,n)=>{n.d(t,{j:()=>o});var i=n(16804),s=n(28473),r=n(62240),a=n(40147);function o(e,t,n,s){return"2d"===s.type?(d.x=e[0],d.y=e[1],d.spatialReference=t,s.toScreen(d)):((0,a.X)(e,t,n,s,c),s.state.camera.projectToScreen(c,h),(0,i.tc)(h[0],h[1]))}const d=(0,r.T)(0,0,0,null),c=(0,s.vt)(),h=(0,i.gs)()},30296:(e,t,n)=>{n.d(t,{o:()=>d});var i=n(72248),s=n(23278),r=n(37229),a=n(51990),o=n(65022);class d extends a.C{constructor(e){let{lineStart:t,lineEnd:n,targetPoint:a,isDraped:d}=e;super(a,new i.WG(t,n),d,s.n.SELF),this._referenceLineHint=new o.c(r.H3.REFERENCE_EXTENSION,t,n,d,this.domain)}get hints(){return[this._referenceLineHint,new o.c(r.H3.TARGET,this._lineEndClosestToTarget(),this.targetPoint,this.isDraped,this.domain)]}_lineEndClosestToTarget(){return this.constraint.closestEndTo(this.targetPoint)}}},35130:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u});var i=n(93800),s=n(6946),r=n(62631),a=n(89129),o=n(50925),d=n(48602),c=(n(21265),n(75269)),h=n(59116),l=n(34519);let p=class extends s.default{constructor(e){super(e),this.enabled=!1,this.enabledToggled=!1,this.forceDisabled=!1,this.selfEnabled=!0,this.featureEnabled=!0,this.gridEnabled=!1,this.attributeRulesEnabled=!1,this.featureSources=new a.default,this.distance=l.N.distance,this.touchSensitivityMultiplier=l.N.touchSensitivityMultiplier}get effectiveEnabled(){return!this.forceDisabled&&(this.enabledToggled?!this.enabled:this.enabled)}get effectiveGridEnabled(){return this.effectiveEnabled&&this.gridEnabled}get effectiveSelfEnabled(){return this.effectiveEnabled&&this.selfEnabled}get effectiveFeatureEnabled(){return this.effectiveEnabled&&this.featureEnabled}get _effectiveFeatureSources(){const e=this.featureSources;e.some(f)&&o.A.getLogger(this).warnOnce("Do not configure SubtypeGroupLayer sources in SnappingOptions.featureSources directly. Create a FeatureSnappingLayerSource for each SubtypeSublayer.");const t=e.filter(_),n=this._get("_effectiveFeatureSources")?.filter(f)??new a.default;for(const r of t){const e=n.find((e=>e.layer===r.layer.parent));if(e)e.sublayerSources.includes(r)||e.sublayerSources.add(r);else if(r.layer.parent){const e=new h.default({layer:r.layer.parent});e.sublayerSources.add(r),n.add(e)}}for(const r of n){const e=r.sublayerSources.filter((e=>!t.includes(e)));r.sublayerSources.removeMany(e)}n.removeMany(n.filter((e=>0===e.sublayerSources.length)));const i=e.filter(g),s=this._get("_effectiveFeatureSources")??new a.default,{added:d,removed:c}=(0,r.iv)(s.toArray(),[...i,...n]);return s.removeMany(c),s.addMany(d),s}};(0,i._)([(0,d.MZ)()],p.prototype,"enabled",void 0),(0,i._)([(0,d.MZ)()],p.prototype,"enabledToggled",void 0),(0,i._)([(0,d.MZ)()],p.prototype,"forceDisabled",void 0),(0,i._)([(0,d.MZ)()],p.prototype,"selfEnabled",void 0),(0,i._)([(0,d.MZ)()],p.prototype,"featureEnabled",void 0),(0,i._)([(0,d.MZ)()],p.prototype,"gridEnabled",void 0),(0,i._)([(0,d.MZ)()],p.prototype,"attributeRulesEnabled",void 0),(0,i._)([(0,d.MZ)({type:a.default.ofType(h.default)})],p.prototype,"featureSources",void 0),(0,i._)([(0,d.MZ)()],p.prototype,"distance",void 0),(0,i._)([(0,d.MZ)()],p.prototype,"touchSensitivityMultiplier",void 0),(0,i._)([(0,d.MZ)({readOnly:!0})],p.prototype,"effectiveEnabled",null),(0,i._)([(0,d.MZ)({readOnly:!0})],p.prototype,"effectiveGridEnabled",null),(0,i._)([(0,d.MZ)({readOnly:!0})],p.prototype,"effectiveSelfEnabled",null),(0,i._)([(0,d.MZ)({readOnly:!0})],p.prototype,"effectiveFeatureEnabled",null),(0,i._)([(0,d.MZ)({readOnly:!0})],p.prototype,"_effectiveFeatureSources",null),p=(0,i._)([(0,c.$)("esri.views.interactive.snapping.SnappingOptions")],p);const u=p;function f(e){return"subtype-group"===e.layer.type}function g(e){return"subtype-group"!==e.layer.type}function _(e){return"subtype-sublayer"===e.layer.type}},40147:(e,t,n)=>{n.d(t,{Q:()=>d,X:()=>c});var i=n(16804),s=n(32006),r=n(89227),a=n(28473),o=n(41317);function d(e,t,n,i){n.projectToRenderScreen(e,l),n.projectToRenderScreen(t,p),(0,s.Re)(i,p,l),(0,s.S8)(i,i)}function c(e,t,n,i){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:(0,a.vt)();const d=(0,r.c)(h,e);return d[2]=(0,o.xS)(i,d,t,n)||0,i.renderCoordsHelper.toRenderCoords(d,t,s),s}const h=(0,a.vt)(),l=(0,i.QG)(),p=(0,i.QG)()},51990:(e,t,n)=>{n.d(t,{C:()=>i});class i{constructor(e,t,n,i){this.targetPoint=e,this.constraint=t,this.isDraped=n,this.domain=i}}},58373:(e,t,n)=>{n.d(t,{z:()=>o});var i=n(72248),s=n(37229),r=n(10252),a=n(65022);class o extends r.w{constructor(e){super({...e,constraint:new i.Mn(e.edgeStart,e.edgeEnd)})}get hints(){return[new a.c(s.H3.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}}},59116:(e,t,n)=>{n.r(t),n.d(t,{default:()=>c});var i=n(93800),s=n(6946),r=n(89129),a=n(48602),o=(n(21265),n(50925),n(14746),n(75269));let d=class extends s.default{constructor(e){super(e),this.layer=null,this.enabled=!0,this.updating=!1,this.availability=1,this.sublayerSources=new r.default}};(0,i._)([(0,a.MZ)({constructOnly:!0})],d.prototype,"layer",void 0),(0,i._)([(0,a.MZ)()],d.prototype,"enabled",void 0),(0,i._)([(0,a.MZ)()],d.prototype,"updating",void 0),(0,i._)([(0,a.MZ)()],d.prototype,"availability",void 0),(0,i._)([(0,a.MZ)()],d.prototype,"sublayerSources",void 0),d=(0,i._)([(0,o.$)("esri.views.interactive.snapping.FeatureSnappingLayerSource")],d);const c=d},62791:(e,t,n)=>{n.d(t,{g:()=>R});var i=n(93800),s=n(6946),r=n(58828),a=n(58448),o=(n(21265),n(49959)),d=n(79953),c=n(48602),h=(n(50925),n(14746),n(75269)),l=n(96913),p=n(41317),u=n(49281),f=n(34519),g=n(23278),_=n(35130),v=n(37229),y=n(9811),E=n(58373),S=n(94821),w=n(30296),b=n(16941),T=n(69361),C=n(71177),M=n(18497);let R=class extends(a.A.EventedMixin(s.default)){constructor(e){super(e),this.options=new _.default,this._engineCache=new Map,this._loadTask=null,this._engines=[],this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=P.MAIN}initialize(){this.addHandles([(0,d.watch)((()=>{const{distance:e,touchSensitivityMultiplier:t,effectiveSelfEnabled:n,effectiveFeatureEnabled:i,effectiveGridEnabled:s}=this.options;return{selfEnabled:n,featureEnabled:i,gridEnabled:"2d"===this.view.type&&s,viewReady:this.view.ready,viewSpatialReference:this.view.spatialReference,distance:e,touchSensitivityMultiplier:t}}),((e,t)=>{t&&(this.doneSnapping(),this.emit("changed")),this._loadTask?.abort(),this._loadTask=(0,r.UT)((n=>this._updateEngines(e,t,n)))}),d.syncAndInitial),(0,d.watch)((()=>this.options),(e=>{for(const t of this._engines)t.options=e}),d.sync)])}destroy(){this._loadTask?.abort(),this._destroyEngines()}get updating(){return this._engines.some((e=>e.updating))||!this._loadTask?.finished}_destroyEngines(){this._engineCache.forEach((e=>e.destroy())),this._engineCache.clear(),this._engines=[]}async _updateEngines(e,t,n){if(!e.viewReady)return void this._destroyEngines();t?.viewSpatialReference!==e.viewSpatialReference&&this._destroyEngines();const i=this._engineCache,s=await Promise.allSettled([e.featureEnabled&&!i.has("feature")?this._createFeatureSnappingEngine(n):void 0,e.selfEnabled&&!i.has("self")?this._createSelfSnappingEngine(n):void 0,e.gridEnabled&&!i.has("grid")?this._createGridSnappingEngine(n):void 0]);if(n.aborted)for(const r of s)"fulfilled"===r.status&&r.value?.engine.destroy();else{for(const e of s)"fulfilled"===e.status&&e.value&&i.set(e.value.type,e.value.engine);this._engines=Array.from(i.values())}}async _createSelfSnappingEngine(e){const{SelfSnappingEngine:t}=await Promise.all([n.e(31329),n.e(49172)]).then(n.bind(n,15819));return(0,o.throwIfAborted)(e),{type:"self",engine:new t({view:this.view,options:this.options})}}async _createGridSnappingEngine(e){const{view:t}=this;if("2d"!==t.type)return;const{GridSnappingEngine:i}=await n.e(77768).then(n.bind(n,77768));return(0,o.throwIfAborted)(e),{type:"grid",engine:new i({view:t,options:this.options})}}async _createFeatureSnappingEngine(e){const{FeatureSnappingEngine:t}=await n.e(7717).then(n.bind(n,7717));(0,o.throwIfAborted)(e);const{view:i,options:s}=this,{spatialReference:r}=i;return{type:"feature",engine:new t({view:i,options:s,spatialReference:r})}}get _squaredMouseProximityThreshold(){return this.options.distance*this.options.distance}get _squaredTouchProximityThreshold(){const{distance:e,touchSensitivityMultiplier:t}=this.options,n=e*t;return n*n}snap(e){return function(e){return null!=e.scenePoint}(e)?this._snapMultiPoint(e):this._snapSinglePoint(e)}update(e){const{point:t,context:n}=e;this._removeVisualization();const i=this._currentMainCandidate;if(null==i)return t;const s=this._selectUpdateInput(e);if(null==s)return t;const{spatialReference:r}=n,a=(0,l.project)(s,r);if(null==a)return t;const{view:o}=this,{elevationInfo:d,visualizer:c}=n,h=[],p=(0,u.vf)(a,o,d),f=i.constraint.closestTo(p);if(!this._arePointsWithinScreenThreshold(p,f,n)||!N(i,n.drawConstraints))return this._resetSnappingState(),t;i.targetPoint=(0,u.de)(f),h.push(...i.hints);for(const l of this._currentOtherActiveCandidates)N(l,n.drawConstraints)&&(l.targetPoint=(0,u.de)(f),h.push(...l.hints));return null!=c&&this.addHandles(c.draw(h,{spatialReference:r,elevationInfo:L(n),view:o,selfSnappingZ:n.selfSnappingZ}),m),(0,u.xF)(f,o,t,n)}doneSnapping(){this._removeVisualization(),this._resetSnappingState()}_selectUpdateInput(e){let{point:t,scenePoint:n}=e;switch(this._currentSnappedType){case P.MAIN:return t;case P.SCENE:return n}}_resetSnappingState(){this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=P.MAIN}_removeVisualization(){this.removeHandles(m)}async _snapSinglePoint(e){let{point:t,context:n,signal:i}=e;const{view:s}=this,{elevationInfo:r}=n,a=(0,u.vf)(t,s,r),o=await this._fetchCandidates(a,g.n.ALL,n,i);return this._createSnapResult(a,P.MAIN,o,s,t,n,i)}async _snapMultiPoint(e){let{point:t,scenePoint:n,context:i,signal:s}=e;const{view:r}=this,{coordinateHelper:a,elevationInfo:o,spatialReference:d}=i;await(0,l.initializeProjection)(n.spatialReference,d);const c=(0,l.project)(n,d),h=(0,u.vf)(c,r,o),p=await this._fetchCandidates(h,g.n.FEATURE,i,s);if(p.length>0){const e=await this._fetchCandidates(h,g.n.SELF,i,s);return this._createSnapResult(h,P.SCENE,[...p,...e],r,c,i,s)}const f=(0,u.vf)(t,r,o),_=await this._fetchCandidates(f,g.n.SELF,i,s);return this._createSnapResult(f,P.MAIN,_,r,{z:a.hasZ()&&t.hasZ?t.z??0:void 0,m:a.hasM()&&t.hasM?t.m??0:void 0},i,s)}async _fetchCandidates(e,t,n,i){return(await Promise.all(this._engines.map((s=>s.fetchCandidates(e,t,n,i))))).flat()}_createSnapResult(e,t,n,i,s,r,a){return{get valid(){return!(0,o.isAborted)(a)},apply:()=>{const{spatialReference:a}=r,{snappedPoint:o,hints:d}=this._processCandidates(e,t,n,r);return this._removeVisualization(),null!=r.visualizer&&this.addHandles(r.visualizer.draw(d,{spatialReference:a,elevationInfo:p.qt,view:i,selfSnappingZ:r.selfSnappingZ}),m),(0,u.xF)(o,i,s,r)}}}_processCandidates(e,t,n,i){if(n.length<1)return this.doneSnapping(),{snappedPoint:e,hints:[]};this._currentSnappedType!==t&&this._resetSnappingState(),(0,v.xX)(e,n);const s=this._currentMainCandidate;if(null!=s){const r=function(e,t){return e instanceof S.N?Z(t,e.first)>=0&&Z(t,e.second)>=0?0:-1:Z(t,e)}(s,n);if(r>=0){if(!(n[r]instanceof S.N))return this._intersectWithOtherCandidates(r,n,e,t,i);if(this._arePointsWithinScreenThreshold(e,s.targetPoint,i))return this._updateSnappingCandidate(s,t,n,i)}}return this._intersectWithOtherCandidates(0,n,e,t,i)}_intersectWithOtherCandidates(e,t,n,i,s){const{coordinateHelper:r}=s,a=t[e],o=[];for(let d=0;d<t.length;++d){if(d===e)continue;const i=t[d],s=a.constraint.intersect(i.constraint);if(s)for(const e of s.closestPoints(a.targetPoint))o.push([new S.N((0,u.de)(e),a,i,i.isDraped),this._squaredScreenDistance(n,e,r)])}return o.length>0&&(o.sort(((e,t)=>e[1]-t[1])),o[0][1]<this._squaredPointProximityThreshold(s.pointer))?this._updateSnappingCandidate(o[0][0],i,t,s):N(a,s.drawConstraints)?this._updateSnappingCandidate(a,i,t,s):{snappedPoint:n,hints:[]}}_updateSnappingCandidate(e,t,n,i){this.doneSnapping(),this._currentMainCandidate=e,this._currentSnappedType=t;const s=this._currentMainCandidate.targetPoint,r=[];r.push(...e.hints);for(const a of n){if(e instanceof S.N){if(a.constraint.equals(e.first.constraint)||a.constraint.equals(e.second.constraint))continue}else if(a.constraint.equals(e.constraint))continue;const t=a.constraint.closestTo(s);this._squaredScreenDistance(t,s,i.coordinateHelper)<f.N.satisfiesConstraintScreenThreshold*f.N.satisfiesConstraintScreenThreshold&&(a.targetPoint=s,this._currentOtherActiveCandidates.push(a),r.push(...a.hints))}return{snappedPoint:s,hints:r}}_squaredPointProximityThreshold(e){return"touch"===e?this._squaredTouchProximityThreshold:this._squaredMouseProximityThreshold}_arePointsWithinScreenThreshold(e,t,n){return this._squaredScreenDistance(e,t,n.coordinateHelper)<this._squaredPointProximityThreshold(n.pointer)}_squaredScreenDistance(e,t,n){return(0,v.pM)(this._toScreen(e,n),this._toScreen(t,n))}_toScreen(e,t){return(0,M.j)(e,t.spatialReference,p.qt,this.view)}get test(){}};var P,x;(0,i._)([(0,c.MZ)({constructOnly:!0})],R.prototype,"view",void 0),(0,i._)([(0,c.MZ)()],R.prototype,"options",void 0),(0,i._)([(0,c.MZ)({readOnly:!0})],R.prototype,"updating",null),(0,i._)([(0,c.MZ)()],R.prototype,"_loadTask",void 0),(0,i._)([(0,c.MZ)()],R.prototype,"_engines",void 0),(0,i._)([(0,c.MZ)()],R.prototype,"_squaredMouseProximityThreshold",null),(0,i._)([(0,c.MZ)()],R.prototype,"_squaredTouchProximityThreshold",null),R=(0,i._)([(0,h.$)("esri.views.interactive.snapping.SnappingManager")],R),(x=P||(P={}))[x.MAIN=0]="MAIN",x[x.SCENE=1]="SCENE";const m="visualization-handle";function N(e,t){return!t||null==t.direction&&null==t.distance||!(e instanceof y.X||e instanceof E.z||e instanceof w.o||e instanceof b.B||e instanceof C.R)&&(!(e instanceof T.HJ)||null==t.direction&&e.selfSnappingType===T._b.LastVertex)}function Z(e,t){let n=-1;for(let i=0;i<e.length;++i)if(t.constraint.equals(e[i].constraint)){n=i;break}return n}function L(e){let{coordinateHelper:t,elevationInfo:n}=e;return t.hasZ()?p.qt:n}},69361:(e,t,n)=>{n.d(t,{HJ:()=>l,_b:()=>s,pn:()=>i});var i,s,r,a=n(23278),o=n(37229),d=n(51990),c=n(65022),h=n(61073);class l extends d.C{constructor(e){let{targetPoint:t,constraint:n,previousVertex:i,otherVertex:r,otherVertexType:o,isDraped:d,selfSnappingType:c,objectId:h,domain:l}=e;super(t,n,d,l??a.n.SELF),this.previousVertex=i,this.otherVertex=r,this.otherVertexType=o,this.selfSnappingType=c??s.None,this.objectId=h??null}get hints(){const e=this.previousVertex,t=this.otherVertexType===i.CENTER?this.otherVertex:this.targetPoint,n=this.otherVertexType===i.CENTER?this.targetPoint:this.otherVertex;return[new c.c(o.H3.TARGET,t,n,this.isDraped,this.domain),new c.c(o.H3.REFERENCE,e,t,this.isDraped,this.domain),new h.l(this.previousVertex,t,n,this.isDraped,this.domain)]}}(r=i||(i={}))[r.NEXT=0]="NEXT",r[r.CENTER=1]="CENTER",function(e){e[e.None=0]="None",e[e.LastVertex=1]="LastVertex",e[e.FirstVertex=2]="FirstVertex",e[e.ExistingEdge=3]="ExistingEdge"}(s||(s={}))},71177:(e,t,n)=>{n.d(t,{R:()=>u});var i=n(32006),s=n(89227),r=n(28473),a=n(72248),o=n(49281),d=n(23278),c=n(37229),h=n(51990),l=n(65022),p=n(61073);class u extends h.C{constructor(e){let{targetPoint:t,point1:n,point2:c,isDraped:h}=e;super(t,new a.ej((0,o._7)((0,s.m)((0,r.vt)(),n,c,.5)),.5*(0,i.Io)((0,o.Xz)(n),(0,o.Xz)(c))),h,d.n.SELF),this._p1=n,this._p2=c}get hints(){return[new l.c(c.H3.REFERENCE,this.targetPoint,this._p1,this.isDraped,this.domain),new l.c(c.H3.REFERENCE,this.targetPoint,this._p2,this.isDraped,this.domain),new p.l(this._p1,this.targetPoint,this._p2,this.isDraped,this.domain)]}}},94821:(e,t,n)=>{n.d(t,{N:()=>o});var i=n(72248),s=n(23278),r=n(51990),a=n(74309);class o extends r.C{constructor(e,t,n,r){super(e,new i.i7(e),r,s.n.ALL),this.first=t,this.second=n}get hints(){return this.first.targetPoint=this.targetPoint,this.second.targetPoint=this.targetPoint,[...this.first.hints,...this.second.hints,new a.v(this.targetPoint,this.isDraped,this.domain)]}}}}]);