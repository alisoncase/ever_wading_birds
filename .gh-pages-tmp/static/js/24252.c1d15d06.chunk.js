"use strict";(self.webpackChunkever_wading_birds=self.webpackChunkever_wading_birds||[]).push([[24252,56055],{13203:(e,t,i)=>{i.d(t,{DN:()=>o,Sv:()=>s,ZY:()=>a,z8:()=>n});var r=i(12560),l=i(11099);function n(e){switch(e?.type){case"point":return e;case"extent":return e.center;case"polygon":return e.centroid;case"multipoint":case"polyline":return e.extent?.center;default:return null}}async function s(e,t){if(e.hasZ||"2d"===t.type)return e;const i=t.map?.ground;if(!i?.layers.length)return e;const{geometry:r}=await i.queryElevation(e,{cache:t.basemapTerrain?.elevationQueryCache});return r}function o(e,t,i){return u(e.center,t,i)}function a(e,t,i){switch(e?.type){case"extent":return e;case"multipoint":case"polygon":case"polyline":return e.extent;case"point":return u(e,t,i);default:return null}}function u(e,t,i){const n=e.hasZ?e.z:void 0;if(t?.map)return(null!=i?(0,l.eU)(t,i):t.extent).clone().centerAt(e).set({zmax:n,zmin:n});const{x:s,y:o,spatialReference:a}=e;return new r.default({xmin:s-.25,ymin:o-.25,xmax:s+.25,ymax:o+.25,spatialReference:a,zmin:n,zmax:n})}},24252:(e,t,i)=>{i.r(t),i.d(t,{default:()=>V});var r=i(93800),l=i(82301),n=i(48602),s=i(21265),o=i(50925),a=i(75269),u=i(56055),d=(i(88677),i(74719)),c=i(17741),p=i(84190),h=i(65920),f=i(13203),g=i(22576),y=i(99961),m=i(66845);const x=/https?:\/\/services.*\.arcgis\.com/i,v=/(?:\{([^}]+)\})/g,F=()=>o.A.getLogger("esri.widgets.Search.support.layerSearchUtils");function w(e,t){const{exactMatch:i=!1,location:r,maxResults:l,spatialReference:n,source:s,sourceIndex:o,suggestResult:a,view:u}=e,{layer:c,filter:h,zoomScale:f}=s,g=u?.scale,y=b(s,u),m=t?.signal;return M(c).then((()=>{const e=c.popupTemplate;return e?e.getRequiredFields(c.fieldsIndex):null})).then((e=>{const{objectIdField:t,returnZ:x}=c,v=R(s);if(!C(c,v))throw F().error("invalid-field: displayField is invalid."),new d.default("getResults():invalid-field","displayField is invalid.");const w=e?.length?e:[v],S=s.outFields||w,b=_(S);if(S.includes(t)||b||S.push(t),c.floorInfo?.floorField&&S.push(c.floorInfo.floorField),!b&&!L(c,S))throw F().error("invalid-field: outField is invalid."),new d.default("getResults():invalid-field","outField is invalid.");const M=c.createQuery(),{orderByFields:N}=s;if(N&&(M.orderByFields=N),n){M.outSpatialReference=n;const e=1/(0,p.GA)(n);e&&(M.maxAllowableOffset=e)}const z="mesh"===c.geometryType||"multipatch"===c.geometryType,q=c.capabilities?.data?.supportsZ&&!z;if(M.returnZ=q&&!1!==x,M.returnGeometry=!0,M.multipatchOption=z?"xyFootprint":null,S&&(M.outFields=S),r)M.geometry=r;else if(a.key)M.objectIds=[a.key];else{const e=s.searchFields||[v];if(!L(c,e))throw F().error("invalid-field: search field is invalid."),new d.default("getResults():invalid-field","search field is invalid.");I(c)&&(M.num=l),y&&(M.geometry=y);const t=a.text?.trim();if(!t)return[];const r=a.text,{prefix:n="",suffix:o=""}=s,u=A(`${n}${r}${o}`);E(c)&&Z(c,e)&&!i&&r&&(M.fullText=$({text:r,searchFields:e}));const p=j({searchTerm:u,layer:c,searchFields:e,filter:h,exactMatch:i,query:M,type:"search"});if(M.where=p,!T(M))return[]}return c.queryFeatures(M,{signal:m}).then((e=>function(e,t,i,r,l,n,s){return e.features.map((e=>D(e,t,i,r,l,n,s)))}(e,u,s,o,v,g,f)))}))}function S(e,t){const{source:i,spatialReference:r,view:l,suggestTerm:n,maxSuggestions:s,sourceIndex:o,exactMatch:a}=e,{layer:u,filter:c}=i,p=t?.signal,h=b(i,l);return M(u).then((()=>{if(!I(u))return[];const e=R(i),t=i.searchFields||[e],l=[];i.suggestionTemplate?i.suggestionTemplate.replaceAll(v,((e,t)=>(l.push(t),e))):l.push(e);const f=_(l);l.includes(u.objectIdField)||f||l.push(u.objectIdField);const g=C(u,e),y=f||L(u,l),m=L(u,t);if(!g)throw F().error("invalid-field: displayField is invalid."),new d.default("getSuggestions():invalid-field","displayField is invalid.");if(!y)throw F().error("invalid-field: outField is invalid."),new d.default("getSuggestions():invalid-field","outField is invalid.");if(!m)throw F().error("invalid-field: search field is invalid."),new d.default("getSuggestions():invalid-field","search field is invalid.");const x=u.createQuery(),{orderByFields:w}=i;if(w&&(x.orderByFields=w),x.outSpatialReference=r,x.returnGeometry=!1,x.num=s,x.outFields=l,h&&(x.geometry=h),!n.trim())return[];const{prefix:S="",suffix:b=""}=i,M=A(`${S}${n}${b}`);E(u)&&Z(u,t)&&!a&&n&&(x.fullText=$({text:n,searchFields:t}));const N=j({searchTerm:M,layer:u,searchFields:t,filter:c,exactMatch:a,query:x,type:"suggest"});return x.where=N,T(x)?u.queryFeatures(x,{signal:p}).then((t=>function(e,t,i,r){return e.features.map((e=>function(e,t,i,r){const l=e.sourceLayer,{attributes:n}=e,{objectIdField:s}=l,o=s?n[s]:null;return{text:z(e,t.suggestionTemplate,r),key:o,sourceIndex:i}}(e,t,i,r)))}(t,i,o,e))):[]}))}function b(e,t){const{filter:i,withinViewEnabled:r}=e,l=t?.extent,n=i?.geometry;return n??(r&&l?l:void 0)}function _(e){return e&&e.includes("*")}async function M(e){e&&await e.load()}function T(e){return!(!e.fullText&&!e.where)}function Z(e,t){const i=e?.indexes;return!(!i||!t?.length)&&i.filter((e=>"FullText"===e.indexType)).some((e=>{const i=e.fields?.split(",").map((e=>e.trim().toLowerCase()))||[];return t.every((e=>i.includes(e.toLowerCase())))}))}function $(e){let{text:t,searchFields:i}=e;return t.trim().split(" ").filter((e=>!!e.trim())).map((e=>new g.A({onFields:i,searchTerm:e,searchType:"prefix"})))}function E(e){return e?.capabilities?.query?.supportsFullTextSearch??!1}function I(e){return e?.capabilities?.query?.supportsPagination??!1}function R(e){return e.displayField||e.layer.displayField||function(e){return e?.fieldsIndex?.fields?.find((e=>"string"===e.type))?.name??""}(e.layer)}function L(e,t){return!(!e||!t?.length)&&t.every((t=>C(e,t)))}function C(e,t){return!!e.getField(t)}function A(e){return e.replaceAll("'","''")}function N(e,t){const i=t?.where;return i?`(${e}) AND (${i})`:e}function j(e){let{searchTerm:t,layer:i,searchFields:r,filter:l,exactMatch:n,query:o,type:a}=e;const{definitionExpression:u,url:d}=i;let p="";return!o.fullText&&t&&r&&r.forEach((e=>{const r=i.getField(e),o=i.getFieldDomain?.(e,{excludeImpliedDomains:(0,s.A)("esri-widget-legacy-field-domain-calculation")}),u=(o&&"coded-value"===o.type?function(e,t,i){let{codedValues:r}=e;return(0,c.Pb)(r??[],(e=>{const r=e.name,l=i?r:r.toLowerCase();return(i?t:t.toLowerCase())===l?e.code.toString():null}))??null}(o,t,n):null)||t||null;if(null!==u){const e=function(e){let{currentTerm:t,field:i,filter:r,exactMatch:l,url:n,type:s}=e;const o=i?.type,a=i?.name;if("string"===o||"date"===o||"global-id"===o){const e=x.test(n??""),i=e&&function(e){for(let t=0;t<e.length;t++)if(e.charCodeAt(t)>255)return!0;return!1}(t)?"N":"";return N(l&&"search"===s?`${a} = ${i}'${t}'`:e?`${a} LIKE ${i}'${t}%'`:`LOWER(${a}) LIKE ${i}'${t.toLowerCase()}%'`,r)}if("oid"===o||"small-integer"===o||"integer"===o||"single"===o||"double"===o){const e=Number(t);return isNaN(e)?null:N(`${a} = ${e}`,r)}return N(`${a} = ${t}`,r)}({currentTerm:u,field:r,filter:l,exactMatch:n,url:d,type:a});e&&(p+=function(e,t){return e?` OR (${t})`:`(${t})`}(p,e))}})),u&&p?`(${u}) AND (${p})`:u||p}function z(e,t,i){const r=e.sourceLayer,{attributes:l}=e,n=r.getFieldDomain?.(i,{feature:e,excludeImpliedDomains:(0,s.A)("esri-widget-legacy-field-domain-calculation")});if(t)return(0,y.V)(t,l);if(i&&l){const e=r.getField(i),t=function(e,t){return e[t]??e[Object.keys(e).find((e=>e.toLowerCase()===t.toLowerCase()))]}(l,i);return null==t?"":n&&"coded-value"===n.type?function(e,t){let i=null;const{codedValues:r}=e;return r&&r.length&&r.some((e=>e.code===t&&(i=e.name,!0))),i}(n,t)??"":"date"===e?.type?(0,m.Yq)(new Date(t)):"number"==typeof t?t.toString():"string"!=typeof t?"":t.trim()}return""}function D(e,t,i,r,n,s,o){const a=e.clone(),u=e.sourceLayer,d=u?.objectIdField,c=d?e.attributes[d]:null,p=z(e,i.searchTemplate,n);null!=s&&function(e){return null!=e&&null!=e.minScale&&null!=e.maxScale}(u)&&(u.minScale&&u.minScale<s?s=u.minScale:u.maxScale&&u.maxScale>s&&(s=u.maxScale));const g=a.geometry?(0,f.ZY)(a.geometry,t??void 0,s??void 0):void 0,y="number"==typeof o&&g?(0,f.DN)((0,l.clone)(g),t??void 0,o):g,m=e.clone();return null!=y&&(m.geometry=h.default.fromExtent(y)),{extent:y,target:m,feature:a,key:c,name:p,sourceIndex:r}}var q;let k=q=class extends u.default{constructor(e){super(e),this.displayField=null,this.exactMatch=null,this.orderByFields=null,this.searchFields=null,this.searchTemplate=null,this.suggestionTemplate=null,this.getResults=(e,t)=>w({source:this,...e},t),this.getSuggestions=(e,t)=>S({source:this,...e},t)}set layer(e){this._set("layer",e),e&&e.load().catch((()=>{}))}get name(){return this._getLayerTitle()??""}set name(e){this._overrideIfSome("name",e)}clone(){return new q({autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?(0,l.clone)(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,displayField:this.displayField,exactMatch:this.exactMatch,layer:this.layer,searchFields:this.searchFields?(0,l.clone)(this.searchFields):null,suggestionTemplate:this.suggestionTemplate,zoomScale:this.zoomScale})}_getFirstStringField(){return this.layer.fieldsIndex?.fields.find((e=>"string"===e.type))?.name??""}_getDisplayField(){return this.displayField||this.layer.displayField||this._getFirstStringField()}_getSearchFieldsString(){const{layer:e,searchFields:t}=this;return e.loaded?`: ${(t||[this._getDisplayField()]).map((t=>{const i=e.getField(t);return i?.alias||t})).join(", ")}`:""}_getLayerTitle(){const{layer:e}=this;if(!e)return;const{title:t}=e;return t?`${t}${this._getSearchFieldsString()}`:void 0}};(0,r._)([(0,n.MZ)({json:{read:{source:"field.name"},write:{target:"field.name"}}})],k.prototype,"displayField",void 0),(0,r._)([(0,n.MZ)({json:{read:{source:"field.exactMatch"},write:{target:"field.exactMatch"}}})],k.prototype,"exactMatch",void 0),(0,r._)([(0,n.MZ)({value:null})],k.prototype,"layer",null),(0,r._)([(0,n.MZ)()],k.prototype,"name",null),(0,r._)([(0,n.MZ)({type:[String],json:{write:!0}})],k.prototype,"orderByFields",void 0),(0,r._)([(0,n.MZ)()],k.prototype,"searchFields",void 0),(0,r._)([(0,n.MZ)()],k.prototype,"searchTemplate",void 0),(0,r._)([(0,n.MZ)()],k.prototype,"suggestionTemplate",void 0),k=q=(0,r._)([(0,a.$)("esri.widgets.Search.LayerSearchSource")],k);const V=k},56055:(e,t,i)=>{i.r(t),i.d(t,{default:()=>d});var r=i(93800),l=i(35377),n=i(93633),s=i(19455),o=i(48602),a=(i(21265),i(50925),i(14746),i(75269));let u=class extends(n.A.IdentifiableMixin(s.A)){constructor(e){super(e),this.autoNavigate=null,this.filter=null,this.getResults=null,this.getSuggestions=null,this.maxResults=null,this.maxSuggestions=null,this.minSuggestCharacters=null,this.outFields=null,this.placeholder="",this.popupEnabled=null,this.popupTemplate=null,this.prefix="",this.resultGraphicEnabled=null,this.resultSymbol=null,this.suggestionsEnabled=null,this.suffix="",this.withinViewEnabled=!1,this.zoomScale=null}};(0,r._)([(0,o.MZ)()],u.prototype,"autoNavigate",void 0),(0,r._)([(0,o.MZ)()],u.prototype,"filter",void 0),(0,r._)([(0,o.MZ)()],u.prototype,"getResults",void 0),(0,r._)([(0,o.MZ)()],u.prototype,"getSuggestions",void 0),(0,r._)([(0,o.MZ)()],u.prototype,"maxResults",void 0),(0,r._)([(0,o.MZ)()],u.prototype,"maxSuggestions",void 0),(0,r._)([(0,o.MZ)()],u.prototype,"minSuggestCharacters",void 0),(0,r._)([(0,o.MZ)()],u.prototype,"outFields",void 0),(0,r._)([(0,o.MZ)()],u.prototype,"placeholder",void 0),(0,r._)([(0,o.MZ)()],u.prototype,"popupEnabled",void 0),(0,r._)([(0,o.MZ)({type:l.default})],u.prototype,"popupTemplate",void 0),(0,r._)([(0,o.MZ)()],u.prototype,"prefix",void 0),(0,r._)([(0,o.MZ)()],u.prototype,"resultGraphicEnabled",void 0),(0,r._)([(0,o.MZ)()],u.prototype,"resultSymbol",void 0),(0,r._)([(0,o.MZ)()],u.prototype,"suggestionsEnabled",void 0),(0,r._)([(0,o.MZ)()],u.prototype,"suffix",void 0),(0,r._)([(0,o.MZ)()],u.prototype,"withinViewEnabled",void 0),(0,r._)([(0,o.MZ)()],u.prototype,"zoomScale",void 0),u=(0,r._)([(0,a.$)("esri.widgets.Search.SearchSource")],u);const d=u}}]);