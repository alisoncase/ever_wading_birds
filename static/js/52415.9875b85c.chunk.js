"use strict";(self.webpackChunkever_wading_birds=self.webpackChunkever_wading_birds||[]).push([[52415],{4623:(e,t,r)=>{r.d(t,{I:()=>i,k:()=>a});var n=r(28473),o=r(67093);function i(e,t,r){if(null==e||null==r)return!1;let n=!0;return s[0]=null!=e.xmin?e.xmin:0,s[1]=null!=e.ymin?e.ymin:0,s[2]=null!=e.zmin?e.zmin:0,n=n&&(0,o.projectBuffer)(s,e.spatialReference,0,t,r,0),s[0]=null!=e.xmax?e.xmax:0,s[1]=null!=e.ymax?e.ymax:0,s[2]=null!=e.zmax?e.zmax:0,n=n&&(0,o.projectBuffer)(s,e.spatialReference,0,t,r,3),null==e.xmin&&(t[0]=-1/0),null==e.ymin&&(t[1]=-1/0),null==e.zmin&&(t[2]=-1/0),null==e.xmax&&(t[3]=1/0),null==e.ymax&&(t[4]=1/0),null==e.zmax&&(t[5]=1/0),n}function a(e,t,r){if(null==e||null==r)return!1;let n=!0;return s[0]=null!=e.xmin?e.xmin:0,s[1]=null!=e.ymin?e.ymin:0,s[2]=null!=e.zmin?e.zmin:0,n=n&&(0,o.projectBuffer)(s,e.spatialReference,0,s,r,0),t[0]=s[0],t[1]=s[1],s[0]=null!=e.xmax?e.xmax:0,s[1]=null!=e.ymax?e.ymax:0,s[2]=null!=e.zmax?e.zmax:0,n=n&&(0,o.projectBuffer)(s,e.spatialReference,0,s,r,0),t[2]=s[0],t[3]=s[1],null==e.xmin&&(t[0]=-1/0),null==e.ymin&&(t[1]=-1/0),null==e.xmax&&(t[2]=1/0),null==e.ymax&&(t[3]=1/0),n}const s=(0,n.vt)()},6090:(e,t,r)=>{r.d(t,{$:()=>n});class n{constructor(e,t){this.renderer=e,this.symbol=t}}},6513:(e,t,r)=>{r.d(t,{E7:()=>y,gP:()=>n,s0:()=>o,zP:()=>v});var n,o,i=r(88242),a=r(16213),s=r(31500),l=r(42162),c=r(8815),d=r(57554),u=r(16878),h=r(91018),f=r(80203),p=r(38950),m=r(81775),g=r(22131);function y(e,t){const r=e.vertex;r.include(l.W),e.include(a.Y,t);const{silhouette:n,legacy:o,spherical:y}=t;r.uniforms.add(new m.o("componentDataTex",(e=>e.componentDataTexture))),e.attributes.add(g.r.COMPONENTINDEX,"float");r.constants.add("lineWidthFractionFactor","float",8),r.constants.add("extensionLengthOffset","float",128),r.code.add(u.H`
    vec2 _componentTextureCoords(float componentIndex, float fieldOffset) {
      float fieldIndex = ${u.H.float(3)}  * componentIndex + fieldOffset;
      float texSize = float(textureSize(componentDataTex, 0).x);
      float colIndex = mod(fieldIndex, texSize);
      float rowIndex = floor(fieldIndex / texSize);

      return vec2(colIndex, rowIndex) + 0.5;
    }

    struct ComponentData {
      vec4 color;
      vec3 normal;
      vec3 normal2;
      float lineWidth;
      float extensionLength;
      float type;
      float verticalOffset;
    };

    ComponentData readComponentData() {
      vec2 colorIndex = _componentTextureCoords(componentIndex, ${u.H.float(0)});
      vec2 otherIndex = _componentTextureCoords(componentIndex, ${u.H.float(1)});
      vec2 verticalOffsetIndex = _componentTextureCoords(float(componentIndex), ${u.H.float(2)} );
      vec3 normal = normalModel();
      vec3 normal2 = ${n?u.H`decompressNormal(normal2Compressed)`:u.H`normal`};

      vec4 colorValue = texelFetch(componentDataTex, ivec2(colorIndex), 0);
      vec4 otherValue = texelFetch(componentDataTex, ivec2(otherIndex), 0);
      float verticalOffset = uninterpolatedRGBAToFloat(texelFetch(componentDataTex, ivec2(verticalOffsetIndex), 0)) * ${u.H.float(i.Hi)};

      return ComponentData(
        vec4(colorValue.rgb, colorValue.a * otherValue.w), // otherValue.w stores separate opacity
        normal, normal2,
        otherValue.x * (255.0 / ${u.H.float(8)} ),
        otherValue.y * 255.0 - ${u.H.float(128)},
        -(otherValue.z * 255.0) + 0.5, // SOLID (=0/255) needs to be > 0.0, SKETCHY (=1/255) needs to be <= 0;
        verticalOffset
      );
    }
  `),o?r.code.add(u.H`vec3 _modelToWorldNormal(vec3 normal) {
return (model * vec4(normal, 0.0)).xyz;
}
vec3 _modelToViewNormal(vec3 normal) {
return (localView * model * vec4(normal, 0.0)).xyz;
}`):(r.uniforms.add(new h.h("transformNormalGlobalFromModel",(e=>e.transformNormalGlobalFromModel))),r.code.add(u.H`vec3 _modelToWorldNormal(vec3 normal) {
return transformNormalGlobalFromModel * normal;
}`)),n?(e.attributes.add(g.r.NORMAL2COMPRESSED,"vec2"),r.code.add(u.H`vec3 worldNormal(ComponentData data) {
return _modelToWorldNormal(normalize(data.normal + data.normal2));
}`)):r.code.add(u.H`vec3 worldNormal(ComponentData data) {
return _modelToWorldNormal(data.normal);
}`),o?r.code.add(u.H`void worldAndViewFromModelPosition(vec3 modelPos, float verticalOffset, out vec3 worldPos, out vec3 viewPos) {
worldPos = (model * vec4(modelPos, 1.0)).xyz;
viewPos = (localView * vec4(worldPos, 1.0)).xyz;
}`):(r.include(s.u,t),r.uniforms.add(new f.k("transformViewFromCameraRelativeRS",(e=>e.transformViewFromCameraRelativeRS)),new h.h("transformWorldFromModelRS",(e=>e.transformWorldFromModelRS)),new c.W("transformWorldFromModelTL",(e=>e.transformWorldFromModelTL)),new c.W("transformWorldFromModelTH",(e=>e.transformWorldFromModelTH)),new d.t("transformWorldFromViewTL",(e=>e.transformWorldFromViewTL)),new d.t("transformWorldFromViewTH",(e=>e.transformWorldFromViewTH))),r.code.add(u.H`
      void worldAndViewFromModelPosition(vec3 modelPos, float verticalOffset, out vec3 worldPos, out vec3 viewPos) {
        vec3 rotatedModelPosition = transformWorldFromModelRS * modelPos;

        vec3 transformCameraRelativeFromModel = dpAdd(
          transformWorldFromModelTL,
          transformWorldFromModelTH,
          -transformWorldFromViewTL,
          -transformWorldFromViewTH
        );

        worldPos = transformCameraRelativeFromModel + rotatedModelPosition;

        if (verticalOffset != 0.0) {
          vec3 vUp = ${y?"normalize(transformWorldFromModelTL + rotatedModelPosition);":"vec3(0.0, 0.0, 1.0);"}
          worldPos += verticalOffset * vUp;
        }

        viewPos = transformViewFromCameraRelativeRS * worldPos;
      }
    `)),r.uniforms.add(new p.F("transformProjFromView",(e=>e.camera.projectionMatrix))).code.add(u.H`vec4 projFromViewPosition(vec3 position) {
return transformProjFromView * vec4(position, 1.0);
}`),r.code.add(u.H`float calculateExtensionLength(float extensionLength, float lineLength) {
return extensionLength / (log2(max(1.0, 256.0 / lineLength)) * 0.2 + 1.0);
}`)}function v(e){return e===n.Sketch||e===n.Mixed}!function(e){e[e.Solid=0]="Solid",e[e.Sketch=1]="Sketch",e[e.Mixed=2]="Mixed",e[e.COUNT=3]="COUNT"}(n||(n={})),function(e){e[e.REGULAR=0]="REGULAR",e[e.SILHOUETTE=1]="SILHOUETTE"}(o||(o={}))},7757:(e,t,r)=>{var n;r.d(t,{x:()=>n}),function(e){e[e.TRANSPARENT=0]="TRANSPARENT",e[e.OPAQUE=1]="OPAQUE"}(n||(n={}))},8245:(e,t,r)=>{var n,o;r.d(t,{Z:()=>n,u:()=>o}),function(e){e[e.USER=1]="USER",e[e.SCALE_RANGE=2]="SCALE_RANGE",e[e.FILTER=4]="FILTER",e[e.DECONFLICTION=8]="DECONFLICTION",e[e.ALL_GRAPHIC=15]="ALL_GRAPHIC",e[e.ALL_LABEL=255]="ALL_LABEL"}(n||(n={})),function(e){e[e.GRAPHIC=1]="GRAPHIC",e[e.LABEL=16]="LABEL"}(o||(o={}))},10667:(e,t,r)=>{r.d(t,{Z:()=>n});class n{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.labelText=t,this.elevationOffset=e??0}}},11137:(e,t,r)=>{r.d(t,{H:()=>a});var n=r(33273),o=r(16878),i=r(73712);function a(e){e.include(n.E),e.uniforms.add(new i.x("geometryDepthTexture",(e=>e.geometryDepth?.attachment))),e.code.add(o.H`bool geometryDepthTest(vec2 pos, float elementDepth) {
float geometryDepth = linearDepthFromTexture(geometryDepthTexture, pos);
return (elementDepth < (geometryDepth - 1.0));
}`)}},11336:(e,t,r)=>{r.d(t,{Z:()=>T});var n=r(62631),o=r(58828),i=(r(21265),r(49959)),a=r(45998),s=r(42080),l=r(42672),c=r(32006),d=r(98080),u=r(89227),h=r(28473),f=r(65920),p=r(69681),m=r(4309),g=r(90772),y=r(70576),v=r(21899),b=r(81765),x=r(8245),S=r(71750);const O=new l.A(Array,(e=>(0,m.hZ)(e,m.v_)),null,10,5),_=(0,g.vt)();class E{get labelLayers(){return this._labelLayers||n.tR}get extent(){return this._extent}get isElevationSource(){return this.layers.some((e=>e?.isElevationSource))}constructor(e,t,r,n,o){this.graphic=e,this.graphics3DSymbol=t,this.layers=r,this._visibleFlags=x.Z.ALL_LABEL,this.deconflictionPriority=0,++t.referenced,this._featureExpressionFeature=o?(0,S.VG)(o,e,n):null}initialize(e){this._layer=e,this._forEachSymbolLayerGraphic((t=>{t.initialize(e),t.setVisibility(this.isVisible())}))}destroy(){this._forEachSymbolLayerGraphic((e=>e.destroy())),this._calloutLayer=null,--this.graphics3DSymbol.referenced,this.graphics3DSymbol=null}get destroyed(){return null==this.layers}clearLabelGraphics(){this._forEachLabelGraphic((e=>e.destroy())),this._labelLayers=null}addLabelGraphic(e,t){this._labelLayers||(this._labelLayers=new Array),this._labelLayers.push(e),e.initialize(t),e.setVisibility(this.isVisible(x.u.LABEL))}setCalloutGraphic(e){this._calloutLayer=e,this._layer&&(e.initialize(this._layer),e.setVisibility(this.isVisible()))}get calloutLayer(){return this._calloutLayer}get isDraped(){let e=!1;return this._forEachSymbolLayerGraphic((t=>{"draped"===t.type&&(e=!0)})),e}isVisible(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x.u.GRAPHIC,t=arguments.length>1?arguments[1]:void 0;const r=t?this._visibleFlags|t|x.u.LABEL*t:this._visibleFlags;return e===x.u.GRAPHIC?(r&x.Z.ALL_GRAPHIC)===x.Z.ALL_GRAPHIC:(r&x.Z.ALL_LABEL)===x.Z.ALL_LABEL}setVisibilityFlag(e,t,r){const n=this.isVisible(e);r?this._visibleFlags|=e*t:this._visibleFlags&=~(e*t);const o=this.isVisible(e);if(n===o)return!1;if(e===x.u.LABEL)this._forEachLabelGraphic((e=>e.setVisibility(o)));else{this._forEachSymbolLayerGraphic((e=>e.setVisibility(o)));const e=this.isVisible(x.u.LABEL);this._forEachLabelGraphic((t=>t.setVisibility(e)))}return!0}getVisibilityFlag(e,t){return!!(this._visibleFlags&e*t)}computeExtent(e){if(!this._extent){const t=this.graphic.geometry;if(null==t)return!1;this._extent=(0,g.vt)(),(0,v.iQ)(t,this._extent);const r=t.spatialReference;if(!(0,y.aI)(r,e)&&!(0,p.S)(this._extent,r,this._extent,e))return this._extent=null,!1}return!0}getAsOptimizedGeometry(e,t){return this._optimizedGeometry||(this._optimizedGeometry=this._convertGraphicToOptimizedGeometry(this.graphic,e,t)),this._optimizedGeometry}_convertGraphicToOptimizedGeometry(e,t,r){let n=e.geometry;return"mesh"!==n.type&&"extent"!==n.type||(n=f.default.fromExtent("mesh"===n.type?n.extent:n)),(0,b.Ux)(n,t,r)}get usedMemory(){let e=(0,s.lM)(this.graphic.attributes);return this._forEachSymbolLayerGraphic((t=>e+=t.graphics3DSymbolLayer.usedMemory)),e}computeAttachmentOrigin(){const e={render:{origin:(0,h.vt)(),num:0},draped:{origin:(0,d.vt)(),num:0}};for(const t of this.layers)null!=t&&t.computeAttachmentOrigin(e);return e.render.num>1&&(0,u.h)(e.render.origin,e.render.origin,1/e.render.num),e.draped.num>1&&(0,c.hs)(e.draped.origin,e.draped.origin,1/e.draped.num),e}async getProjectedBoundingBox(e,t,r,n,i){return i||(i={boundingBox:null,requiresDrapedElevation:!1,screenSpaceObjects:[]}),i.boundingBox?(0,m.Ie)(i.boundingBox):i.boundingBox=(0,m.Ie)(),i.requiresDrapedElevation=!1,await(0,o.jJ)(this.layers,(async o=>{if(null==o)return;const a="draped"===o.type?t:e,s=O.acquire(),l=await o.getProjectedBoundingBox(a,r,i.screenSpaceObjects,n,s);isFinite(l[2])&&isFinite(l[5])||(i.requiresDrapedElevation=!0),l&&(0,m.RF)(i.boundingBox,s),O.release(s)})),(0,m.vQ)(i.boundingBox)||(0,g.vQ)((0,m.ES)(i.boundingBox,_))?i:null}needsElevationUpdates(){for(const e of this.layers)if(null!=e&&("object3d"===e.type||"lod-instance"===e.type)&&e.needsElevationUpdates)return!0;return this._labelLayers?.some((e=>e?.needsElevationUpdates??!1))??!1}alignWithElevation(e,t,r){this._forEachRenderedGraphic((n=>{"object3d"!==n.type&&"lod-instance"!==n.type||n.alignWithElevation(e,t,this._featureExpressionFeature,r)}))}alignWithAbsoluteElevation(e,t,r){this._forEachRenderedGraphic((n=>{"object3d"===n.type&&n.alignWithAbsoluteElevation(e,t,r)}))}addObjectStateSet(e){this._forEachSymbolLayerGraphic((t=>t.addObjectState(e)))}removeObjectState(e){this._forEachSymbolLayerGraphic((t=>t.removeObjectState(e)))}updateHighlights(e){this._forEachSymbolLayerGraphic((t=>t.updateHighlights(e)))}_forEachGraphicList(e,t){e?.forEach((e=>e&&t(e)))}_forEachSymbolLayerGraphic(e){this._forEachGraphicList(this.layers,e),this._calloutLayer&&e(this._calloutLayer)}_forEachLabelGraphic(e){this._forEachGraphicList(this.labelLayers,e)}_forEachRenderedGraphic(e){this._forEachSymbolLayerGraphic(e),this._forEachLabelGraphic(e)}get test(){}}var P=r(26324),w=r(21501),C=r(23543),L=r(63651),A=r(89852);class T extends L.x{set symbol(e){this._symbol=e,e.symbolLayers.forEach(((t,r)=>{const n=this.symbolLayers[r];null!=n&&(n.symbol=e,n.symbolLayer=t)}))}get symbol(){return this._symbol}constructor(e,t,r){super(t.schedule),this._symbol=e,this._context=t,this._backgroundLayers=r,this._destroyed=!1,this.symbolLayers=new Array,this.referenced=0,this._extentPadding=0}async doLoad(e){let t=this._symbol.symbolLayers;this._extentPadding=0,this._backgroundLayers&&(t=this._backgroundLayers.concat(t));const n=t.length;for(;this.symbolLayers.length<t.length;)this.symbolLayers.push(null);this.symbolLayers.length=t.length;const a=[],{make:s}=await Promise.all([r.e(39441),r.e(88116),r.e(83607),r.e(50948),r.e(36705),r.e(35539),r.e(25999),r.e(75117),r.e(14020),r.e(78226)]).then(r.bind(r,98415));for(let r=0;r<n;r++){const o=t.at(r);if(!1===o.enabled)continue;I.renderPriority=1-(1+r)/n,I.renderPriorityStep=1/n,I.ignoreDrivers=o.ignoreDrivers;const l=s(this.symbol,o,this._context,I),c=(0,i.onAbortOrThrow)(e,(()=>{this.symbolLayers[r]=null,l.destroy()}));c&&a.push(c),this.symbolLayers[r]=l}if(await(0,o.jJ)(this.symbolLayers,(async(e,t)=>{if(null!=e)try{await e.load(),this._extentPadding+=Math.max(this._extentPadding,e.extentPadding)}catch{this.symbolLayers[t]=null}})),a.forEach((e=>e.remove())),(0,i.throwIfAborted)(e),this.symbolLayers.length&&!this.symbolLayers.some((e=>!!e)))throw new Error}getSymbolLayerSize(e){const t=this.symbolLayers[e];return null!=t?t.getCachedSize():null}get extentPadding(){return this._extentPadding}get symbologySnappingSupported(){return this.symbolLayers.some((e=>e?.queryForSnapping))}updateFocus(e,t){this.symbolLayers.forEach((r=>r?.updateFocus(e,t)))}createGraphics3DGraphic(e,t){const r=e.graphic,n=this.symbolLayers.map((t=>t?.createGraphics3DGraphic(e)??null)),o=this._context.arcade||this._context.featureExpressionInfoContext?.arcade?.modules||null;return new E(r,t||this,n,e.layer,o)}get complexity(){return(0,a.Tf)(this.symbolLayers.map((e=>null!=e?e.complexity:null)))}globalPropertyChanged(e,t){const r=this.symbolLayers.length;for(let n=0;n<r;n++){const r=this.symbolLayers[n],o=e=>{const t=e.layers[n];return t instanceof P.Y?t:null};if(null!=r&&!r.globalPropertyChanged(e,t,o))return!1}return!0}applyRendererDiff(e,t){return this.loadStatus!==L.P.LOADED?C.w.RecreateSymbol:this.symbolLayers.reduce(((r,n)=>r!==C.w.RecreateSymbol&&null!=n?Math.min(r,n.applyRendererDiff(e,t)):r),C.w.FastUpdate)}prepareSymbolPatch(e){if(this.loadStatus===L.P.FAILED)return;if("partial"!==e.diff.type)return;const t=e.diff.diff;if(!t.symbolLayers||"partial"!==t.symbolLayers.type)return;const r=t.symbolLayers.diff;this.symbolLayers.forEach(((t,n)=>{if(null==t)return;const o=r[n];if(o){const r={diff:o,graphics3DGraphicPatches:[],symbolLayerStatePatches:[]};t.prepareSymbolLayerPatch(r),e.symbolStatePatches.push(...r.symbolLayerStatePatches),r.graphics3DGraphicPatches.length&&e.graphics3DGraphicPatches.push(((e,t)=>{const o=e.layers[n];null!=o&&r.graphics3DGraphicPatches.forEach((e=>e(o,t)))}))}}))}updateGeometry(e,t){return this._updateGeometryOrTransform(e,((e,r)=>e.updateGeometry(r,t)))}updateTransform(e,t,r,n){return this._updateGeometryOrTransform(e,((e,o)=>e.updateTransform(o,t,r,n)))}_updateGeometryOrTransform(e,t){for(let r=0;r<this.symbolLayers.length;r++){const n=this.symbolLayers[r];if(null==n)continue;const o=e.layers[r];if(!o||!t(n,o))return!1}return!0}onRemoveGraphic(e){for(let t=0;t<this.symbolLayers.length;t++){const r=this.symbolLayers[t];if(null==r)continue;const n=e.layers[t];null!=n&&r.onRemoveGraphic(n)}}getFastUpdateStatus(){let e=!1,t=!1;for(const r of this.symbolLayers)if(null!=r){if(r.loadStatus===L.P.LOADING)return C.G.Loading;r.isFastUpdatesEnabled()?t=!0:e=!0}return t?e?C.G.Mixed:C.G.Fast:e?C.G.Slow:C.G.Undefined}async queryForSnapping(e,t,r,o){const a=this.symbolLayers.filter(n.Ru).filter((e=>null!=e.queryForSnapping)).map((n=>n.queryForSnapping(e,t,r,o))),s=await Promise.all(a);return(0,i.throwIfAborted)(o),s.flat()}destroy(){if(!this.destroyed){super.destroy();for(const e of this.symbolLayers)null!=e&&e.destroy();this.symbolLayers.length=0,this._destroyed=!0}}get destroyed(){return this._destroyed}get cachedMemory(){return(0,A.h)(this)}}const I=new w.S},13366:(e,t,r)=>{r.d(t,{VN:()=>a,qD:()=>o,r4:()=>i});var n=r(24646);const o=1.2,i=n.uY,a=4},14960:(e,t,r)=>{r.d(t,{G:()=>n,Q:()=>o});const n={stableRendering:!1},o={rootOrigin:null}},16347:(e,t,r)=>{r.d(t,{MT:()=>i,a8:()=>a,hk:()=>o,i3:()=>s,rz:()=>n});class n{constructor(e){this.estimated=!1,this.verticesPerFeature=e.verticesPerFeature??0,this.verticesPerCoordinate=e.verticesPerCoordinate??0,this.drawCallsPerFeature=e.drawCallsPerFeature??0,this.memory=e.memory??new s}}class o extends n{constructor(e){super(e),this.estimated=!0}}class i extends n{constructor(e,t){super(t),this.numComplexities=e}}class a extends o{constructor(e,t){super(t),this.numComplexities=e}}class s{constructor(){this.bytesPerFeature=0,this.bytesPerFeatureLabel=0,this.resourceBytes=0,this.draped={bytesPerFeature:0,bytesPerFeatureLabel:0}}}},19983:(e,t,r)=>{r.d(t,{E5:()=>s,JU:()=>a,Of:()=>o,Uk:()=>i,WK:()=>l,g7:()=>c,lO:()=>d,lQ:()=>u});var n=r(74719);function o(e){return e&&"function"==typeof e.highlight}function i(e){return e&&"function"==typeof e.maskOccludee}function a(e,t,r){return null==e||e>=r&&(0===t||e<=t)}function s(e,t){if(t&&e){const{minScale:r,maxScale:n}=e;if(l(r,n))return a(t,r,n)}return!0}function l(e,t){return null!=e&&e>0||null!=t&&t>0}function c(e){return!e?.minScale||!e.maxScale||e.minScale>=e.maxScale}function d(e){return null!=e&&"object"==typeof e&&"createQuery"in e&&"queryFeatures"in e&&"layer"in e&&"view"in e}function u(e,t,r){return new n.default("layerview:spatial-reference-incompatible",`The spatial reference of this ${e}${t?`(wkid:${t})`:""} is incompatible with the spatial reference of the view${r?`(wkid:${r})`:""}.`,{})}},21501:(e,t,r)=>{r.d(t,{$:()=>o,S:()=>i});var n=r(51064);class o{constructor(e,t){this.scheduler=e,this.schedule=t,this.sharedResources=null,this.streamDataRequester=null,this.elevationProvider=null,this.renderer=null,this.stage=null,this.clippingExtent=null,this.renderCoordsHelper=null,this.overlaySR=null,this.layer=null,this.drapeSourceRenderer=null,this.graphicsCoreOwner=null,this.localOriginFactory=null,this.featureExpressionInfoContext=null,this.screenSizePerspectiveEnabled=!0,this.slicePlaneEnabled=!1,this.physicalBasedRenderingEnabled=!1,this.skipHighSymbolLods=!1,this.isAsync=!1}get spherical(){return this.stage.view.state.viewingMode===n.RT.Global}get doublePrecisionRequiresObfuscation(){return this.stage.renderView.renderingContext.driverTest.doublePrecisionRequiresObfuscation.result}}class i{constructor(){this.renderPriority=0,this.renderPriorityStep=1,this.ignoreDrivers=!1}}},21540:(e,t,r)=>{r.d(t,{U:()=>y});var n=r(88102),o=(r(21265),r(50925)),i=r(28473),a=r(24646),s=r(53053),l=r(45998),c=r(50190),d=r(72249),u=r(71750),h=r(12770),f=r(23543),p=r(63651),m=r(82501);const g=()=>o.A.getLogger("esri.views.3d.layers.graphics.Graphics3DSymbolLayer");class y extends p.x{constructor(e,t,r,n){super(r.schedule),this.symbol=e,this.symbolLayer=t,this._context=r,this.ignoreDrivers=!1,this._drivenProperties={color:!1,opacity:!1,opacityAlwaysOpaque:!0,size:!1,rotation:!1},this._materials=[],this.logger=g(),this._elevationOptions={supportsOffsetAdjustment:!1,supportsOnTheGround:!0},this.skipHighSymbolLodsChanged=!0,this._renderPriority=n.renderPriority,this._renderPriorityStep=n.renderPriorityStep,this._elevationContext=new d.F,this.complexity=this.computeComplexity(),this.ignoreDrivers=n.ignoreDrivers,this.ignoreDrivers||(this._drivenProperties=v(this._context.renderer)),this._updateElevationContext()}getCachedSize(){return null}get extentPadding(){return 0}get materials(){return this._materials}get usedMemory(){const e=this.complexity;return null==e?0:(this.draped?e.memory.draped:e.memory).bytesPerFeature}_drivenPropertiesChanged(e){if(this.ignoreDrivers)return!1;const t=this._drivenProperties,r=v(e);return r.color!==t.color||r.opacity!==t.opacity||r.opacityAlwaysOpaque!==t.opacityAlwaysOpaque||r.size!==t.size||r.rotation!==t.rotation}get needsDrivenTransparentPass(){return this._drivenProperties.opacity&&!this._drivenProperties.opacityAlwaysOpaque}_logGeometryCreationWarnings(e,t,r,n){const o=e.projectionSuccess,i="polygons"in e?e.polygons:null,a=`${n} geometry failed to be created`;o?!this._logGeometryValidationWarnings(t,r,n)&&i&&0===i.length&&"rings"===r&&t.length>0&&t[0].length>2&&g().warnOncePerTick(`${a} (filled rings should use clockwise winding - try reversing the order of vertices)`):g().warnOncePerTick(`${a} (failed to project geometry to view spatial reference)`)}updateFocus(e,t){}_logGeometryValidationWarnings(e,t,r){const n=`${r} geometry failed to be created`;return!e.length||1===e.length&&!e[0].length?(g().warnOncePerTick(`${n} (no ${t} were defined)`),!0):(!Array.isArray(e)||!Array.isArray(e[0]))&&(g().warnOncePerTick(`${n} (${t} should be defined as a 2D array)`),!0)}_validateGeometry(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(null!=t&&!t.includes(e.type))return this.logger.warn("unsupported geometry type for "+r+` symbol: ${e.type}`),!1;switch(e.type){case"point":{const t=e;if(!isFinite(t.x)||!isFinite(t.y))return g().warn("point coordinate is not a valid number, graphic skipped"),!1;break}case"polygon":(0,s.m3)(e)&&g().warnOnce("Fixed a non-closed polygon ring.")}return!0}_defaultElevationInfoNoZ(){return b}_defaultElevationInfoZ(){return x}_updateElevationContext(){null!=this._elevationInfoOverride?(this._elevationContext.setFromElevationInfo(this._elevationInfoOverride),this._elevationContext.updateFeatureExpressionInfoContext(null)):this._context.layer.elevationInfo?(this._elevationContext.setFromElevationInfo(this._context.layer.elevationInfo),this._elevationContext.updateFeatureExpressionInfoContext(this._context.featureExpressionInfoContext)):this._elevationContext.reset()}getDefaultElevationInfo(e){return e.hasZ?this._defaultElevationInfoZ():this._defaultElevationInfoNoZ()}getGeometryElevationMode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getDefaultElevationInfo(e);return this._elevationContext.mode||t.mode}setElevationInfoOverride(e){this._elevationInfoOverride=e,this._updateElevationContext()}setGraphicElevationContext(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new d.F;const r=e.geometry,n=this.getDefaultElevationInfo(r);t.unit=null!=this._elevationContext.unit?this._elevationContext.unit:n.unit,t.mode=this.getGeometryElevationMode(r,n),t.offsetMeters=this._elevationContext.meterUnitOffset??n.offset??0;const o=!this._elevationOptions.supportsOnTheGround&&"on-the-ground"===t.mode;o&&(t.mode="relative-to-ground",t.offsetMeters=0);const i=o?u.KF:this._elevationContext.featureExpressionInfoContext;return t.updateFeatureExpressionInfoContext(i,e,this._context.layer),t}prepareSymbolLayerPatch(e){}updateGeometry(e,t){return!1}updateTransform(e,t,r,n){return!1}onRemoveGraphic(e){}_getLayerOpacity(){if(this._context.graphicsCoreOwner&&"fullOpacity"in this._context.graphicsCoreOwner)return this._context.graphicsCoreOwner.fullOpacity??0;return this._context.layer.opacity??1}_getCombinedOpacity(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:S;const r=this.draped?1:this._getLayerOpacity();return this._drivenProperties.opacity?r:e?r*e.a:t.hasIntrinsicColor?r:0}_getCombinedOpacityAndColor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:S;const r=this._getCombinedOpacity(e,t);if(this._drivenProperties.color)return(0,h.$C)(null,r);const o=null!=e?n.default.toUnitRGB(e):i.Un;return(0,h.$C)(o,r)}_getVertexOpacityAndColor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const r=this._drivenProperties.color?e.color:null,n=this._drivenProperties.opacity?e.opacity:null,o=(0,h.$C)(r,n);return t&&(o[0]*=t,o[1]*=t,o[2]*=t,o[3]*=t),o}isFastUpdatesEnabled(){return null!=this._fastUpdates}computeComplexity(){return(0,l.JV)(this.symbol,this.symbolLayer)}globalPropertyChanged(e,t,r){switch(e){case"opacity":return this.layerOpacityChanged(t,r),!0;case"elevationInfo":{const e=this._elevationContext.mode;return this._updateElevationContext(),this.layerElevationInfoChanged(t,r,e)!==c.uw.RECREATE}case"slicePlaneEnabled":return this.slicePlaneEnabledChanged(t,r);case"physicalBasedRenderingEnabled":return this.physicalBasedRenderingChanged();case"pixelRatio":return this.pixelRatioChanged;case"skipHighSymbolLods":return this.skipHighSymbolLodsChanged;default:return!1}}get pixelRatioChanged(){return!0}updateGraphics3DGraphicElevationInfo(e,t,r){let n=c.uw.UPDATE;return e.forEach((e=>{const o=t(e);if(null!=o){const t=e.graphic;this.setGraphicElevationContext(t,o.elevationContext),o.needsElevationUpdates=r(o.elevationContext.mode)}else n=c.uw.RECREATE})),n}applyRendererDiff(e,t){return f.w.RecreateSymbol}getFastUpdateAttrValues(e){if(!this._fastUpdates)return null;const t=this._fastUpdates.visualVariables,r=t.size?(0,m.ul)(t.size.field,e):0,n=t.color?(0,m.ul)(t.color.field,e):0,o=t.opacity?(0,m.ul)(t.opacity.field,e):0;return(0,a.fA)(r,n,o,0)}get draped(){return this._draped}ensureDrapedStatus(e){return null==this._draped?(this._draped=e,!0):(e!==this.draped&&g().warnOnce("A symbol can only produce either draped or non-draped visualizations. Use two separate symbol instances for draped and non-draped graphics if necessary."),!1)}test(){return{drivenProperties:this._drivenProperties,getVisVarFields:()=>({size:this._fastUpdates?.visualVariables.size?.field??null,color:this._fastUpdates?.visualVariables.color?.field??null,opacity:this._fastUpdates?.visualVariables.opacity?.field??null,rotation:this._fastUpdates?.visualVariables.rotation?.field??null})}}}function v(e){const t={color:!1,opacity:!1,opacityAlwaysOpaque:!0,size:!1,rotation:!1};return e&&"visualVariables"in e&&e.visualVariables&&e.visualVariables.forEach((e=>{switch(e.type){case"color":if(t.color=!0,e.stops)for(let r=0;r<e.stops.length;r++){const n=e.stops[r].color;n&&(t.opacity=!0,n.a<1&&(t.opacityAlwaysOpaque=!1))}break;case"opacity":t.opacity=!0,t.opacityAlwaysOpaque=!1;break;case"size":t.size=!0;break;case"rotation":t.rotation=!0}})),t}const b={mode:"on-the-ground",offset:0,unit:"meters"},x={mode:"absolute-height",offset:0,unit:"meters"},S={hasIntrinsicColor:!1}},23543:(e,t,r)=>{var n,o;r.d(t,{G:()=>o,w:()=>n}),function(e){e[e.RecreateSymbol=0]="RecreateSymbol",e[e.RecreateGraphics=1]="RecreateGraphics",e[e.FastUpdate=2]="FastUpdate"}(n||(n={})),function(e){e[e.Slow=0]="Slow",e[e.Fast=1]="Fast",e[e.Mixed=2]="Mixed",e[e.Loading=3]="Loading",e[e.Undefined=4]="Undefined"}(o||(o={}))},23795:(e,t,r)=>{r.d(t,{Fe:()=>p,Rn:()=>c,dI:()=>d,hr:()=>f,iC:()=>h});var n=r(62631),o=r(42080),i=r(8609),a=r(92453),s=r(22131),l=r(99855);class c{constructor(e,t,r,n){this.material=e,this.bufferWriter=e.createBufferWriter(),this.vertexBufferLayout=this.bufferWriter.vertexBufferLayout,this.buffer=t,this.elementCount=r,this.boundingInfo=n}get numTriangles(){return this.elementCount/3}get numVertices(){return this.elementCount}computeUsedMemory(){return this.buffer.byteLength+o.i5}getRenderGeometry(){return this}intersect(e,t,r,n,o,i,a,s){const l=this.bufferWriter,c=this.buffer;l.intersect(c,e,r,n,((r,n,l,c,d)=>u(r,n,l,d,e,t,i,a,o,s)))}}class d{constructor(e){this.engineGeometry=e}get material(){return this.engineGeometry.material}get numVertices(){return this.engineGeometry.attributes.get(s.r.POSITION).indices.length}get numTriangles(){return this.engineGeometry.indexCount/3}get boundingInfo(){return this.engineGeometry.boundingInfo}computeUsedMemory(){return Array.from(this.engineGeometry.attributes.values()).reduce(((e,t)=>e+(0,o.Qf)(t.data,t.indices)),0)}getRenderGeometry(){const e=this.material,t=this.engineGeometry,r=t.attributes,n=t.boundingInfo,o=e.createBufferWriter(),i=o.vertexBufferLayout,a=o.elementCount(r),s=i.createBuffer(a);return o.write(null,null,r,null,s,0),new c(e,s.buffer,a,n)}intersect(e,t,r,n,o,i,a,s){const l=this.engineGeometry;this.material.intersect(l,e.transform.transform,e,r,n,((r,n,l,c,d)=>u(r,n,l,d,e,t,i,a,o,s)))}}function u(e,t,r,n,o,s,c,d,u,h){if(e<0)return;if(s&&!s(o.rayBegin,o.rayEnd,e))return;const f=new l.h(c.layerUid,c.graphicUid(u),r,d,h);if((null==o.results.min.drapedLayerOrder||n>=o.results.min.drapedLayerOrder)&&(null==o.results.min.dist||e<o.results.min.dist)&&o.results.min.set(a.dz.LOD,f,e,t,o.transform.transform,n),o.options.store!==a.oH.MIN&&(null==o.results.max.drapedLayerOrder||n>=o.results.max.drapedLayerOrder)&&(null==o.results.max.dist||e>o.results.max.dist)&&o.results.max.set(a.dz.LOD,f,e,t,o.transform.transform,n),o.options.store===a.oH.ALL){const r=(0,i.G7)(o.results.min.ray);r.set(a.dz.LOD,f,e,t,o.transform.transform,n),o.results.all.push(r)}}class h{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.geometry=e,this.textures=t}get material(){return this.geometry.material}get numTriangles(){return this.geometry.numTriangles}}class f{constructor(e,t,r){this.components=e,this.minScreenSpaceRadius=t,this.pivotOffset=r;const o=(0,n.Am)(this.components.map((e=>e.geometry)));this.numVertices=o.reduce(((e,t)=>e+t.numVertices),0)}}class p{constructor(e){this.levels=e,this.levels.sort(((e,t)=>e.minScreenSpaceRadius===t.minScreenSpaceRadius?e.numVertices-t.numVertices:e.minScreenSpaceRadius-t.minScreenSpaceRadius))}getMaterials(){const e=[];return this.levels.forEach((t=>t.components.forEach((t=>e.push(t.geometry.material))))),(0,n.Am)(e)}getTextures(){const e=new Array;return this.levels.forEach((t=>t.components.forEach((t=>{null!=t.textures&&e.push(...t.textures)})))),(0,n.Am)(e)}getGeometries(){const e=new Array;return this.levels.forEach((t=>t.components.forEach((t=>{e.push(t.geometry)})))),(0,n.Am)(e)}getEngineGeometries(){return this.getGeometries().map((e=>e.engineGeometry)).filter((e=>null!=e))}computeUsedMemory(){const e=this.getGeometries(),t=this.getTextures(),r=e.reduce(((e,t)=>e+t.computeUsedMemory()),0);return t.reduce(((e,t)=>e+t.memoryEstimate),0)+r}}},24040:(e,t,r)=>{r.d(t,{R$:()=>g,SZ:()=>u,ZX:()=>m,d2:()=>p,hS:()=>h});var n=r(28473),o=r(31183),i=r(4309),a=r(53053),s=r(62240),l=r(50190),c=r(12770),d=r(8461);function u(e,t,r,n,o){if(f(e,t))return null;r.localOrigin=g(e,t);const i=new d.B({geometries:[r],castShadow:!1,layerUid:e.layer.uid,graphicUid:o,usesVerticalDistanceToGround:!0});return{object:i,sampledElevation:(0,l.fe)(i,t,e.elevationProvider,e.renderCoordsHelper,n)}}function h(e,t,r,n){return f(t,r)?null:(0,l.fe)(e,r,t.elevationProvider,t.renderCoordsHelper,n)}function f(e,t){const r=e.clippingExtent;return!!r&&((0,o.g)(t,y,e.elevationProvider.spatialReference),!(0,i.Uc)(r,y))}function p(e,t,r){const n=e.elevationContext,i=r.spatialReference;(0,o.g)(t,y,i),n.centerPointInElevationSR=(0,s.T)(y[0],y[1],t.hasZ?y[2]:0,null!=i?i:null)}function m(e){switch(e.type){case"point":return e;case"polygon":case"extent":return(0,c.W$)(e);case"polyline":{const t=e.paths[0];if(!t||0===t.length)return null;const r=(0,a.$H)(t,(0,a.Yl)(t)/2);return(0,s.T)(r[0],r[1],r[2],e.spatialReference)}case"mesh":return e.extent.center}return null}function g(e,t){return(0,o.g)(t,y,e.renderCoordsHelper.spatialReference),e.localOriginFactory.getOrigin(y)}const y=(0,n.vt)()},26324:(e,t,r)=>{r.d(t,{H:()=>h,Y:()=>f});var n=r(89227),o=r(28473),i=r(4309),a=r(89476),s=r(50190),l=r(71750),c=r(12770),d=r(71723),u=r(7757);class h{constructor(e,t,r){this.baseMaterial=e,this.edgeMaterial=t,this.hasSlicePlane=r}}class f{get isElevationSource(){return!!this.stageObject.lastValidElevationBB}constructor(e,t,r,n,o,i,a){let s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.graphics3DSymbolLayer=e,this.stageObject=t,this._uniqueGeometries=r,this._uniqueMaterials=n,this._sharedResource=o,this.elevationAligner=i,this.elevationContext=a,this._edgeState=s,this.type="object3d",this._stageLayer=null,this._visible=!1,this._addedToStage=!1,this.alignedSampledElevation=0,this.needsElevationUpdates=!1,this.useObjectOriginAsAttachmentOrigin=!1}initialize(e){this._stageLayer=e;const t=e.stage;t.addMany(this._uniqueMaterials),t.addMany(this._uniqueGeometries),t.add(this.stageObject)}destroy(){if(!this._stageLayer)return;const e=this._stageLayer.stage;e.removeMany(this._uniqueMaterials),e.removeMany(this._uniqueGeometries),e.remove(this.stageObject),this._addedToStage&&(this._stageLayer.remove(this.stageObject),this._addedToStage=!1),e.renderer.edgeView?.removeObject(this.stageObject),this.stageObject.dispose(),this._sharedResource?.release(),this._visible=!1,this._stageLayer=null}layerOpacityChanged(e,t){const{stageObject:r,_edgeState:n,_stageLayer:o}=this;if(null==n)return;const i=p(n.baseMaterial);n.edgeMaterial.objectTransparency!==i&&(n.edgeMaterial.objectTransparency=i,this.resetEdgeObject(t)),o.stage.renderer.withEdgeView((t=>t.updateAllComponentOpacities(r,[e])))}updateHighlights(e){}slicePlaneEnabledChanged(e,t){const{stageObject:r,_edgeState:n,_stageLayer:o}=this;null!=n&&o.stage.renderer.withEdgeView((o=>{o.updateAllComponentMaterials(r,n.edgeMaterial,e,!t),n.hasSlicePlane=e}))}setVisibility(e){const{_edgeState:t,stageObject:r,_stageLayer:n}=this;null!=n&&this.visible!==e&&(this._visible=e,r.visible=e,e&&!this._addedToStage&&(n.add(r),this._addedToStage=!0),null!=t&&n.stage.renderer.withEdgeView((n=>{n.hasObject(r)?n.updateObjectVisibility(r,e):e&&this._addOrUpdateEdgeObject(t,n,!1)})))}get visible(){return this._visible}alignWithElevation(e,t,r,n){if(null==this.elevationAligner)return;null!=r&&(0,l.gf)(this.elevationContext.featureExpressionInfoContext,r);this.alignedSampledElevation=this.elevationAligner(this,this.elevationContext,e.spatialReference,((r,n)=>(0,s.sE)(r,e,this.elevationContext,t,n)),t),this.resetEdgeObject(n)}alignWithAbsoluteElevation(e,t,r){this.alignedSampledElevation=this.elevationAligner(this,this.elevationContext,null,((t,r)=>{r.sampledElevation=e,r.verticalDistanceToGround=0,r.z=e}),t),this.resetEdgeObject(r)}getCenterObjectSpace(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,o.vt)();return(0,n.c)(e,(0,a.a)(this.stageObject.boundingVolumeObjectSpace.bounds))}getBoundingBoxObjectSpace(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.vt)();const t=this.stageObject.boundingVolumeObjectSpace;return(0,i.Ne)(e,t.min),(0,i.vI)(e,t.max),e}computeAttachmentOrigin(e){const t=this.stageObject.effectiveTransformation;if(this.useObjectOriginAsAttachmentOrigin)e.render.origin[0]+=t[12],e.render.origin[1]+=t[13],e.render.origin[2]+=t[14],e.render.num++;else for(const r of this.stageObject.geometries)r.computeAttachmentOrigin(y)&&((0,n.t)(y,y,t),(0,n.g)(e.render.origin,e.render.origin,y),e.render.num++)}async getProjectedBoundingBox(e,t,r,o,a){const s=this.getBoundingBoxObjectSpace(a),l=v,d=(0,i.fT)(s)?1:l.length;for(let i=0;i<d;i++){const e=l[i];g[0]=s[e[0]],g[1]=s[e[1]],g[2]=s[e[2]],(0,n.t)(g,g,this.stageObject.transformation),m[3*i]=g[0],m[3*i+1]=g[1],m[3*i+2]=g[2]}if(!e(m,0,d))return null;(0,i.Ie)(s);let u=null;this.calculateRelativeScreenBounds&&(u=this.calculateRelativeScreenBounds());for(let n=0;n<3*d;n+=3){for(let e=0;e<3;e++)s[e]=Math.min(s[e],m[n+e]),s[e+3]=Math.max(s[e+3],m[n+e]);u&&r.push({location:m.slice(n,n+3),screenSpaceBoundingRect:u})}if(t?.service&&"absolute-height"!==this.elevationContext.mode){(0,i.gX)(s,y);const e="relative-to-scene"===this.elevationContext.mode?"scene":"ground";let r=0;if(t.useViewElevation)r=t.service.getElevation(y[0],y[1],e)??0;else try{const n=(0,c.vY)(s,t.service.spatialReference,t);r=await t.service.queryElevation(y[0],y[1],o,n,e)??0}catch(h){}(0,i.cY)(s,0,0,-this.alignedSampledElevation+r)}return s}addObjectState(e){e.stateType===d.Mg.Highlight&&e.addObject(this.stageObject,this.stageObject.highlight(e.highlightName)),e.stateType===d.Mg.MaskOccludee&&e.addObject(this.stageObject,this.stageObject.maskOccludee())}removeObjectState(e){e.removeByObject(this.stageObject)}resetEdgeObject(e){const{_edgeState:t,stageObject:r,_stageLayer:n,_visible:o}=this;null!=t&&n.stage.renderer.withEdgeView((n=>{o?this._addOrUpdateEdgeObject(t,n,e):n.removeObject(r)}))}_addOrUpdateEdgeObject(e,t,r){const n=p(e.baseMaterial);e.edgeMaterial.objectTransparency=n,t.addOrUpdateObject3D(this.stageObject,e.edgeMaterial,e.hasSlicePlane,!r).then((()=>this._stageLayer?.sync()))}}function p(e){return e.parameters.transparent?u.x.TRANSPARENT:u.x.OPAQUE}const m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],g=(0,o.vt)(),y=(0,o.vt)(),v=[[0,1,2],[3,1,2],[0,4,2],[3,4,2],[0,1,5],[3,1,5],[0,4,5],[3,4,5]]},28606:(e,t,r)=>{r.d(t,{L:()=>o});var n=r(90772);class o{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"scene";this.context=e,this.extent=(0,n.Ie)()}}},30262:(e,t,r)=>{r.d(t,{I:()=>l,p:()=>s});var n=r(62631),o=(r(21265),r(49959)),i=r(76493),a=r(19565);class s{constructor(e,t){this.spatialReference=e,this._view=t}getElevation(e,t,r){return this._view.elevationProvider.getElevation(e,t,0,this.spatialReference,r)}async queryElevation(e,t,r,n,o){return this._view.elevationProvider.queryElevation(e,t,0,this.spatialReference,o,r,n)}}class l{constructor(e,t,r,n){this.spatialReference=t,this._getElevationQueryProvider=r,this._queries=new Array,this._queryOptions={...n,ignoreInvisibleLayers:!0},this._frameTask=e.registerTask(a.W6.ELEVATION_QUERY,this)}destroy(){let{completeTasks:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{completeTasks:!1};if(this._frameTask.remove(),this.running)if(e)this.runTask(a.Bb);else for(const t of this._queries)t.result.reject((0,o.createAbortError)())}queryElevation(e,t,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const a=(0,o.createResolver)(),s={x:e,y:t,minDemResolution:i,result:a,signal:r};return this._queries.push(s),(0,o.onAbort)(r,(()=>{(0,n.TF)(this._queries,s),a.reject((0,o.createAbortError)())})),a.promise}get running(){return this._queries.length>0}runTask(e){const t=this._queries;this._queries=[];const r=this._getElevationQueryProvider();if(!r)return t.forEach((e=>e.result.reject())),void e.madeProgress();const n=t.map((e=>[e.x,e.y])),a=t.reduce(((e,t)=>Math.min(e,t.minDemResolution)),1/0),s=new i.default({points:n,spatialReference:this.spatialReference}),l=t.length>1&&t.some((e=>!!e.signal))?new AbortController:null,c=null!=l?l.signal:t[0].signal;if(null!=l){let e=0;t.forEach((r=>(0,o.onAbort)(r.signal,(()=>{e++,r.result.reject((0,o.createAbortError)()),e===t.length&&l.abort()}))))}const d={...this._queryOptions,minDemResolution:a,signal:c};r.queryElevation(s,d).then((e=>{t.forEach(((t,r)=>{null!=t.signal&&t.signal.aborted?t.result.reject((0,o.createAbortError)()):t.result.resolve(e.geometry.points[r][2])}))})).catch((e=>{t.forEach((t=>t.result.reject(e)))})),e.madeProgress()}get test(){}}},37255:(e,t,r)=>{r.d(t,{P:()=>n,T:()=>o});class n{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;this.usedMemory=e,this.displayedFeatures=t,this.totalFeatures=r,this.maximumFeatures=n,this.nodes=o,this.core=i}}function o(e){return"performanceInfo"in e}},43208:(e,t,r)=>{r.d(t,{f:()=>i});var n=r(28473);class o{constructor(e,t){this.vec3=e,this.id=t}}function i(e,t,r,i){return new o((0,n.fA)(e,t,r),i)}},44e3:(e,t,r)=>{r.d(t,{g:()=>y});r(21265);var n=r(31923),o=r(89227),i=r(28473),a=r(24646),s=r(67093),l=r(65069),c=r(69291),d=r(25735),u=r(43208),h=r(8461),f=r(14960),p=r(22131),m=r(20196),g=r(23664);class y{constructor(e){this._originSR=e,this._rootOriginId="root/"+(0,n.c)(),this._origins=new Map,this._objects=new Map,this._gridSize=5e5}getOrigin(e){const t=this._origins.get(this._rootOriginId);if(null==t){const t=f.Q.rootOrigin;if(null!=t)return this._origins.set(this._rootOriginId,(0,u.f)(t[0],t[1],t[2],this._rootOriginId)),this.getOrigin(e);const r=(0,u.f)(e[0]+Math.random()-.5,e[1]+Math.random()-.5,e[2]+Math.random()-.5,this._rootOriginId);return this._origins.set(this._rootOriginId,r),r}const r=this._gridSize,n=Math.round(e[0]/r),i=Math.round(e[1]/r),a=Math.round(e[2]/r),s=`${n}/${i}/${a}`;let l=this._origins.get(s);const c=.5*r;if((0,o.d)(v,e,t.vec3),v[0]=Math.abs(v[0]),v[1]=Math.abs(v[1]),v[2]=Math.abs(v[2]),v[0]<c&&v[1]<c&&v[2]<c){if(l){const t=Math.max(...v);if((0,o.d)(v,e,l.vec3),v[0]=Math.abs(v[0]),v[1]=Math.abs(v[1]),v[2]=Math.abs(v[2]),Math.max(...v)<t)return l}return t}return l||(l=(0,u.f)(n*r,i*r,a*r,s),this._origins.set(s,l)),l}_drawOriginBox(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,a.fA)(1,1,0,1);const r=window.view,n=r._stage,o=t.toString();if(!this._objects.has(o)){this._material=new g.W({width:2,color:t}),n.add(this._material);const e=new m.x(n,{pickable:!1}),r=new h.B({castShadow:!1});n.add(r),e.add(r),this._objects.set(o,r)}const i=this._objects.get(o),u=[0,1,5,4,0,2,1,7,6,2,0,1,3,7,5,4,6,2,0],f=u.length,y=new Array(3*f),v=new Array,b=.5*this._gridSize;for(let a=0;a<f;a++)y[3*a]=e[0]+(1&u[a]?b:-b),y[3*a+1]=e[1]+(2&u[a]?b:-b),y[3*a+2]=e[2]+(4&u[a]?b:-b),a>0&&v.push(a-1,a);(0,s.projectBuffer)(y,this._originSR,0,y,r.renderSpatialReference,0,f);const x=new d.V(this._material,[[p.r.POSITION,new l.n(y,v,3,!0)]],null,c.X.Line);n.add(x),i.addGeometry(x)}get test(){}}const v=(0,i.vt)()},45998:(e,t,r)=>{r.d(t,{Eg:()=>u,GI:()=>g,JV:()=>m,Tf:()=>h,k9:()=>f,pg:()=>v,uD:()=>d});var n=r(7951),o=r(36730),i=r(83412),a=r(73296),s=r(16347),l=r(77520),c=r(9789);const d=new s.hk({});function u(e){return"web-style"===e.type?d:h(e.symbolLayers.toArray().map((t=>m(e,t))))}function h(e){let t=0,r=0,n=0,o=!1,i=0;const a=new s.i3;for(const s of e)null!=s&&(t+=s.verticesPerFeature,r+=s.verticesPerCoordinate,n+=s.drawCallsPerFeature,a.bytesPerFeature+=s.memory.bytesPerFeature,a.bytesPerFeatureLabel+=s.memory.bytesPerFeatureLabel,a.resourceBytes+=s.memory.resourceBytes,a.draped.bytesPerFeature+=s.memory.bytesPerFeature,a.draped.bytesPerFeatureLabel+=s.memory.bytesPerFeatureLabel,o=o||s.estimated,++i);return o?new s.a8(i,{verticesPerFeature:t,verticesPerCoordinate:r,drawCallsPerFeature:n,memory:a}):new s.MT(i,{verticesPerFeature:t,verticesPerCoordinate:r,drawCallsPerFeature:n,memory:a})}function f(e){const t=h(e);return t.numComplexities>0&&(t.verticesPerFeature/=t.numComplexities,t.verticesPerCoordinate/=t.numComplexities,t.drawCallsPerFeature/=t.numComplexities,t.memory.bytesPerFeature/=t.numComplexities,t.memory.bytesPerFeatureLabel/=t.numComplexities,t.memory.resourceBytes/=t.numComplexities,t.memory.draped.bytesPerFeature/=t.numComplexities,t.memory.draped.bytesPerFeatureLabel/=t.numComplexities),t}const p={};function m(e,t){const r=g(e,t),a=(0,l.RF)(t)?2:0;switch(t.type){case"extrude":return new s.rz({verticesPerFeature:-12,verticesPerCoordinate:12,drawCallsPerFeature:a,memory:r});case"fill":if("mesh-3d"===e.type)return new s.rz({drawCallsPerFeature:a,memory:r});if(null!=t.outline&&t.outline.size>0)return new s.rz({verticesPerFeature:-12,verticesPerCoordinate:9,memory:r});case"water":return new s.rz({verticesPerFeature:-6,verticesPerCoordinate:3,memory:r});case"line":return new s.rz({verticesPerFeature:-6,verticesPerCoordinate:6,memory:r});case"object":return t.resource?.href?new s.hk({verticesPerFeature:100,memory:r}):{...y(t.resource?.primitive??o.r),memory:r};case"path":{let e=0,o=0;switch(t.profile){case"circle":e=i.ZC;break;case"quad":e=4;break;default:return void(0,n.Xb)(t.profile)}switch(t.join){case"round":o=i.kf;break;case"miter":case"bevel":o=1;break;default:return}const a=2*e,l=e*o*2,c=l+a;let d=-2*l-a;switch(t.cap){case"none":break;case"butt":case"square":d+=2*(e-1);break;case"round":d+=2*(e*(i.RL-1)*2+e);break;default:return}return new s.rz({verticesPerFeature:d,verticesPerCoordinate:c,memory:r})}case"text":case"icon":return new s.rz({verticesPerFeature:6,memory:r});default:return}}function g(e,t){const r="point-3d"===e.type;switch(t.type){case"extrude":return t.edges&&t.edges.size>0?b.EXTRUDE_EDGES:b.EXTRUDE;case"fill":return null!=t.outline&&t.outline.size>0?b.FILL_OUTLINE:b.FILL;case"water":return b.FILL;case"line":return"round"===t.join?b.LINE_ROUND:b.LINE_MITER;case"path":switch(t.join){case"round":switch(t.profile){case"circle":return b.PATH_ROUND_CIRCLE;case"quad":return b.PATH_ROUND_QUAD;default:return void(0,n.Xb)(t.profile)}case"miter":case"bevel":switch(t.profile){case"circle":return b.PATH_MITER_CIRCLE;case"quad":return b.PATH_MITER_QUAD;default:return void(0,n.Xb)(t.profile)}default:return}case"object":return r?b.OBJECT_POINT:b.OBJECT_POLYGON;case"icon":case"text":return r?b.ICON_POINT:b.ICON_POLYGON;default:return}}function y(e){const t=p[e];if(t)return t;const r=v((0,a._)(e,new c.$U({},{spherical:!0,doublePrecisionRequiresObfuscation:!0})).levels);return p[e]=new s.rz({verticesPerFeature:r}),p[e]}function v(e){return e.reduce(((e,t,r)=>e+t.numVertices*(1/10**r)),0)/e.reduce(((e,t,r)=>e+1/10**r),0)}const b={ICON_POINT:{bytesPerFeature:2346.460896195398,bytesPerFeatureLabel:3484.7516349999996,resourceBytes:0,draped:{bytesPerFeature:2007.3528529826217,bytesPerFeatureLabel:3522.702025}},ICON_POLYGON:{bytesPerFeature:3677.214053765355,bytesPerFeatureLabel:3502.5355950000003,resourceBytes:0,draped:{bytesPerFeature:3030.3700096053935,bytesPerFeatureLabel:3550.247175}},OBJECT_POINT:{bytesPerFeature:569.2092700798497,bytesPerFeatureLabel:3183.0256999999992,resourceBytes:0,draped:{bytesPerFeature:569.2092700798497,bytesPerFeatureLabel:3183.0256999999992}},OBJECT_POLYGON:{bytesPerFeature:1252.202280530861,bytesPerFeatureLabel:3125.853350000001,resourceBytes:0,draped:{bytesPerFeature:1252.202280530861,bytesPerFeatureLabel:3125.853350000001}},LINE_MITER:{bytesPerFeature:3252.89170349711,bytesPerFeatureLabel:3554.3931949999997,resourceBytes:0,draped:{bytesPerFeature:2843.5793737736867,bytesPerFeatureLabel:3538.2547083333334}},LINE_ROUND:{bytesPerFeature:3384.080501909172,bytesPerFeatureLabel:3522.6055950000004,resourceBytes:0,draped:{bytesPerFeature:2833.1897218657587,bytesPerFeatureLabel:3532.0680950000005}},PATH_MITER_CIRCLE:{bytesPerFeature:38490.63544346431,bytesPerFeatureLabel:3660.7835999999998,resourceBytes:0,draped:{bytesPerFeature:38490.63544346431,bytesPerFeatureLabel:3660.7835999999998}},PATH_ROUND_CIRCLE:{bytesPerFeature:42934.88589895749,bytesPerFeatureLabel:3729.49955,resourceBytes:0,draped:{bytesPerFeature:42934.88589895749,bytesPerFeatureLabel:3729.49955}},PATH_MITER_QUAD:{bytesPerFeature:25392.923576583788,bytesPerFeatureLabel:3647.05925,resourceBytes:0,draped:{bytesPerFeature:25392.923576583788,bytesPerFeatureLabel:3647.05925}},PATH_ROUND_QUAD:{bytesPerFeature:40448.297252606244,bytesPerFeatureLabel:3646.8303499999997,resourceBytes:0,draped:{bytesPerFeature:40448.297252606244,bytesPerFeatureLabel:3646.8303499999997}},FILL:{bytesPerFeature:3419.9079008788176,bytesPerFeatureLabel:3564.2132483333335,resourceBytes:0,draped:{bytesPerFeature:2910.096178654882,bytesPerFeatureLabel:3554.8655816666665}},FILL_OUTLINE:{bytesPerFeature:5018.088812445781,bytesPerFeatureLabel:3524.8219616666665,resourceBytes:0,draped:{bytesPerFeature:4278.49006198517,bytesPerFeatureLabel:3532.068368333334}},EXTRUDE:{bytesPerFeature:7963.8889768932695,bytesPerFeatureLabel:3628.5106350000005,resourceBytes:0,draped:{bytesPerFeature:7963.8889768932695,bytesPerFeatureLabel:3628.5106350000005}},EXTRUDE_EDGES:{bytesPerFeature:3111.7648563053044,bytesPerFeatureLabel:2658.4350683333337,resourceBytes:0,draped:{bytesPerFeature:3111.7648563053044,bytesPerFeatureLabel:2658.4350683333337}}}},46383:(e,t,r)=>{r.d(t,{p:()=>n});r(25735);function n(e){return null!=e.mapPositions}},48845:(e,t,r)=>{r.d(t,{LO:()=>s,kg:()=>l,or:()=>c,vl:()=>a});var n=r(88102),o=r(6090),i=r(71237);function a(e,t){const r=function(e,t){if(null!=e.symbol)return e.symbol;const r=t?.renderer;return null!=r&&"dot-density"!==r.type?r.getSymbol(e,t):null}(e,t);if(null==r)return null;const n=t?.renderer,a=new o.$(n,r);if(null==n||!("visualVariables"in n)||!n.visualVariables)return a;const s=(0,i.getVisualVariableValues)(n,e,t)??[],l=["proportional","proportional","proportional"];for(const{variable:o,value:i}of s)switch(o.type){case"color":a.color=i.toRgba();break;case"size":if("outline"===o.target)a.outlineSize=i;else{const e=o.axis,t=o.useSymbolValue?"symbol-value":i;switch(e){case"width":l[0]=t;break;case"depth":l[1]=t;break;case"height":l[2]=t;break;case"width-and-depth":l[0]=l[1]=t;break;default:l[0]=l[1]=l[2]=t}}break;case"opacity":a.opacity=i;break;case"rotation":switch(o.axis){case"tilt":a.tilt=i;break;case"roll":a.roll=i;break;default:a.heading=i}}return"proportional"===l[0]&&"proportional"===l[1]&&"proportional"===l[2]||(a.size=l),a}async function s(e,t){const r=await async function(e,t){return null!=e.symbol?e.symbol:t?.renderer?.getSymbolAsync(e,t)??null}(e,t);if(!r)return null;const a=t?.renderer,s=new o.$(a,r);if(!a||!("visualVariables"in a)||!a.visualVariables)return s;const l=(0,i.getVisualVariableValues)(a,e,t)??[],c=["proportional","proportional","proportional"];for(const{variable:o,value:i}of l)if("color"===o.type)s.color=n.default.toUnitRGBA(i);else if("size"===o.type)if("outline"===o.target)s.outlineSize=i;else{const e=o.axis,t=o.useSymbolValue?"symbol-value":i;"width"===e?c[0]=t:"depth"===e?c[1]=t:"height"===e?c[2]=t:c[0]=c[1]="width-and-depth"===e?t:c[2]=t}else"opacity"===o.type?s.opacity=i:"rotation"===o.type&&"tilt"===o.axis?s.tilt=i:"rotation"===o.type&&"roll"===o.axis?s.roll=i:"rotation"===o.type&&(s.heading=i);return(isFinite(c[0])||isFinite(c[1])||isFinite(c[2]))&&(s.size=c),s}function l(e){const t=e[arguments.length>1&&void 0!==arguments[1]?arguments[1]:0];return"number"==typeof t&&isFinite(t)?t:null}function c(e){for(let t=0;t<3;t++){const r=e[t];if("number"==typeof r)return isFinite(r)?r:0}return 0}},50190:(e,t,r)=>{r.d(t,{I2:()=>g,Kf:()=>v,Uk:()=>S,ai:()=>x,au:()=>f,fe:()=>b,nG:()=>m,nu:()=>y,sE:()=>p,uw:()=>n});var n,o,i=r(87752),a=r(10382),s=r(28473),l=r(42276),c=r(67093),d=r(49807),u=r(96504),h=r(22131);function f(e,t,r,n,o,i,a,s,l,d,u){const h=O[u.mode];let f,p,m=0;if((0,c.projectBuffer)(e,t,r,n,l.spatialReference,o,s))return h?.requiresAlignment(u)?(m=h.applyElevationAlignmentBuffer(n,o,i,a,s,l,d,u),f=i,p=a):(f=n,p=o),(0,c.projectBuffer)(f,l.spatialReference,p,i,d.spatialReference,a,s)?m:void 0}function p(e,t,r,n,o){const i=((0,d.v)(e)?e.z:(0,u.cN)(e)?e.array[e.offset+2]:e[2])||0;switch(r.mode){case"on-the-ground":{const r=(0,u.R1)(t,e,"ground")??0;return o.verticalDistanceToGround=0,o.sampledElevation=r,void(o.z=r)}case"relative-to-ground":{const a=(0,u.R1)(t,e,"ground")??0,s=r.geometryZWithOffset(i,n);return o.verticalDistanceToGround=s,o.sampledElevation=a,void(o.z=s+a)}case"relative-to-scene":{const a=(0,u.R1)(t,e,"scene")??0,s=r.geometryZWithOffset(i,n);return o.verticalDistanceToGround=s,o.sampledElevation=a,void(o.z=s+a)}case"absolute-height":{const a=r.geometryZWithOffset(i,n),s=(0,u.R1)(t,e,"ground")??0;return o.verticalDistanceToGround=a-s,o.sampledElevation=s,void(o.z=a)}default:return void(o.z=0)}}function m(e,t,r,n){return p(e,t,r,n,E),E.z}function g(e,t,r){return"on-the-ground"===t&&"on-the-ground"===r?e.staysOnTheGround:t===r||"on-the-ground"!==t&&"on-the-ground"!==r?null==t||null==r?e.definedChanged:n.UPDATE:e.onTheGroundChanged}function y(e){return"relative-to-ground"===e||"relative-to-scene"===e}function v(e){return"absolute-height"!==e}function b(e,t,r,n,o){p(t,r,o,n,E),x(e,E.verticalDistanceToGround);const a=E.sampledElevation,s=(0,i.C)(_,e.transformation);return P[0]=t.x,P[1]=t.y,P[2]=E.z,(0,l.l)(t.spatialReference,P,s,n.spatialReference)?e.transformation=s:console.warn("Could not locate symbol object properly, it might be misplaced"),a}function x(e,t){for(let r=0;r<e.geometries.length;++r){const n=e.geometries[r].getMutableAttribute(h.r.CENTEROFFSETANDDISTANCE);n&&n.data[3]!==t&&(n.data[3]=t,e.geometryVertexAttributeUpdated(e.geometries[r],h.r.CENTEROFFSETANDDISTANCE))}}class S{constructor(){this.verticalDistanceToGround=0,this.sampledElevation=0,this.z=0}}(o=n||(n={}))[o.NONE=0]="NONE",o[o.UPDATE=1]="UPDATE",o[o.RECREATE=2]="RECREATE";const O={"absolute-height":{applyElevationAlignmentBuffer:function(e,t,r,n,o,i,a,s){const l=s.calculateOffsetRenderUnits(a),c=s.featureExpressionInfoContext;t*=3,n*=3;for(let d=0;d<o;++d){const o=e[t],i=e[t+1],a=e[t+2];r[n]=o,r[n+1]=i,r[n+2]=null==c?a+l:l,t+=3,n+=3}return 0},requiresAlignment:function(e){const t=e.meterUnitOffset,r=e.featureExpressionInfoContext;return 0!==t||null!=r}},"on-the-ground":{applyElevationAlignmentBuffer:function(e,t,r,n,o,i){let a=0;const s=i.spatialReference;t*=3,n*=3;for(let l=0;l<o;++l){const o=e[t],l=e[t+1],c=e[t+2],d=i.getElevation(o,l,c,s,"ground")??0;a+=d,r[n]=o,r[n+1]=l,r[n+2]=d,t+=3,n+=3}return a/o},requiresAlignment:()=>!0},"relative-to-ground":{applyElevationAlignmentBuffer:function(e,t,r,n,o,i,a,s){let l=0;const c=s.calculateOffsetRenderUnits(a),d=s.featureExpressionInfoContext,u=i.spatialReference;t*=3,n*=3;for(let h=0;h<o;++h){const o=e[t],a=e[t+1],s=e[t+2],h=i.getElevation(o,a,s,u,"ground")??0;l+=h,r[n]=o,r[n+1]=a,r[n+2]=null==d?s+h+c:h+c,t+=3,n+=3}return l/o},requiresAlignment:()=>!0},"relative-to-scene":{applyElevationAlignmentBuffer:function(e,t,r,n,o,i,a,s){let l=0;const c=s.calculateOffsetRenderUnits(a),d=s.featureExpressionInfoContext,u=i.spatialReference;t*=3,n*=3;for(let h=0;h<o;++h){const o=e[t],a=e[t+1],s=e[t+2],h=i.getElevation(o,a,s,u,"scene")??0;l+=h,r[n]=o,r[n+1]=a,r[n+2]=null==d?s+h+c:h+c,t+=3,n+=3}return l/o},requiresAlignment:()=>!0}},_=(0,a.vt)(),E=new S,P=(0,s.vt)()},57392:(e,t,r)=>{r.d(t,{L:()=>s});var n=r(50925),o=r(65860),i=r(79462);const a=()=>n.A.getLogger("esri.views.3d.layers.graphics.Graphics3DCalloutSymbolLayerFactory");function s(e,t){if(!(0,o.YX)(e))return a().error("Graphics3DCalloutSymbolLayerFactory#make",`symbol of type '${e.type}' does not support callouts`),null;if(!e.callout)return null;const r=l[e.callout.type];return r?new r(e,t):(a().error("Graphics3DCalloutSymbolLayerFactory#make",`unknown or unsupported callout type ${e.callout.type}`),null)}const l={line:i.Ws}},62374:(e,t,r)=>{r.d(t,{L:()=>O,b:()=>x});var n=r(32006),o=r(98080),i=r(24646),a=r(75304),s=r(67095),l=r(66195),c=r(89659),d=r(11137),u=r(95206),h=r(15025),f=r(61315),p=r(34927),m=r(94409),g=r(42403),y=r(16878),v=r(22131),b=r(8118);function x(e){const t=new b.N5,{vertex:r,fragment:o}=t,{terrainDepthTest:x}=e;return r.include(s.K),t.include(l.Q,e),t.vertex.include(a.rA,e),t.attributes.add(v.r.UV0,"vec2"),r.uniforms.add(new p.I("viewport",(e=>e.camera.fullViewport)),new g.m("lineSize",((e,t)=>e.size>0?Math.max(1,e.size)*t.camera.pixelRatio:0)),new h.E("pixelToNDC",(e=>(0,n.hZ)(S,2/e.camera.fullViewport[2],2/e.camera.fullViewport[3]))),new g.m("borderSize",((e,t)=>e.borderColor?t.camera.pixelRatio:0)),new f.G("screenOffset",((e,t)=>(0,n.hZ)(S,e.horizontalScreenOffset*t.camera.pixelRatio,0)))),t.varyings.add("coverageSampling","vec4"),t.varyings.add("lineSizes","vec2"),x&&t.varyings.add("depth","float"),e.occlusionTestEnabled&&t.include(c.y),e.hasScreenSizePerspective&&(0,u.OH)(r),r.main.add(y.H`
    ProjectHUDAux projectAux;
    vec4 endPoint = projectPositionHUD(projectAux);

    vec3 vpos = projectAux.posModel;
    if (rejectBySlice(vpos)) {
      gl_Position = vec4(1e38, 1e38, 1e38, 1.0);
      return;
    }
    ${(0,y.If)(e.occlusionTestEnabled,y.H`if (!testHUDVisibility(endPoint)) {
             gl_Position = vec4(1e38, 1e38, 1e38, 1.0);
             return;
           }`)}

    ${e.hasScreenSizePerspective?y.H`vec3 perspectiveFactor = screenSizePerspectiveScaleFactor(projectAux.absCosAngle, projectAux.distanceToCamera, screenSizePerspectiveAlignment);
               vec2 screenOffsetScaled = applyScreenSizePerspectiveScaleFactorVec2(screenOffset, perspectiveFactor);`:"vec2 screenOffsetScaled = screenOffset;"}
    // Add view dependent polygon offset to get exact same original starting point. This is mostly used to get the
    // correct depth value
    vec3 posView = (view * vec4(position, 1.0)).xyz;
    ${(0,y.If)(x,"depth = posView.z;")}

    applyHUDViewDependentPolygonOffset(centerOffsetAndDistance.w, projectAux.absCosAngle, posView);
    vec4 startPoint = proj * vec4(posView, 1.0);

    // Apply screen offset to both start and end point
    vec2 screenOffsetNorm = screenOffsetScaled * 2.0 / viewport.zw;
    startPoint.xy += screenOffsetNorm * startPoint.w;
    endPoint.xy += screenOffsetNorm * endPoint.w;

    // Align start and end to pixel origin
    vec4 startAligned = alignToPixelOrigin(startPoint, viewport.zw);
    vec4 endAligned = alignToPixelOrigin(endPoint, viewport.zw);
    ${(0,y.If)(e.hudDepth,e.hudDepthAlignStart?"endAligned = vec4(endAligned.xy / endAligned.w * startAligned.w, startAligned.zw);":"startAligned = vec4(startAligned.xy / startAligned.w * endAligned.w, endAligned.zw);")}
    vec4 projectedPosition = mix(startAligned, endAligned, uv0.y);

    // The direction of the line in screen space
    vec2 screenSpaceDirection = normalize(endAligned.xy / endAligned.w - startAligned.xy / startAligned.w);
    vec2 perpendicularScreenSpaceDirection = vec2(screenSpaceDirection.y, -screenSpaceDirection.x);
    ${e.hasScreenSizePerspective?y.H`float lineSizeScaled = applyScreenSizePerspectiveScaleFactorFloat(lineSize, perspectiveFactor);
               float borderSizeScaled = applyScreenSizePerspectiveScaleFactorFloat(borderSize, perspectiveFactor);`:y.H`float lineSizeScaled = lineSize;
               float borderSizeScaled = borderSize;`}
    float halfPixelSize = lineSizeScaled * 0.5;

    // Compute full ndc offset, adding 1px padding for doing anti-aliasing and the border size
    float padding = 1.0 + borderSizeScaled;
    vec2 ndcOffset = (-halfPixelSize - padding + uv0.x * (lineSizeScaled + padding + padding)) * pixelToNDC;

    // Offset x/y from the center of the line in screen space
    projectedPosition.xy += perpendicularScreenSpaceDirection * ndcOffset * projectedPosition.w;

    // Compute a coverage varying which we can use in the fragment shader to determine
    // how much a pixel is actually covered by the line (i.e. to anti alias the line).
    // This works by computing two coordinates that can be linearly interpolated and then
    // subtracted to find out how far away from the line edge we are.
    float edgeDirection = (uv0.x * 2.0 - 1.0);

    float halfBorderSize = 0.5 * borderSizeScaled;
    float halfPixelSizeAndBorder = halfPixelSize + halfBorderSize;
    float outerEdgeCoverageSampler = edgeDirection * (halfPixelSizeAndBorder + halfBorderSize + 1.0);

    float isOneSided = float(lineSizeScaled < 2.0 && borderSize < 2.0);

    coverageSampling = vec4(
      // Edge coordinate
      outerEdgeCoverageSampler,

      // Border edge coordinate
      outerEdgeCoverageSampler - halfPixelSizeAndBorder * isOneSided,

      // Line offset
      halfPixelSize - 0.5,

      // Border offset
      halfBorderSize - 0.5 + halfPixelSizeAndBorder * (1.0 - isOneSided)
    );

    lineSizes = vec2(lineSizeScaled, borderSizeScaled);
    gl_Position = projectedPosition;`),o.uniforms.add(new m.E("uColor",(e=>e.color??i.uY)),new m.E("borderColor",(e=>e.borderColor??i.uY))),x&&(o.include(d.H,e),o.uniforms.add(new h.E("inverseViewport",(e=>e.inverseViewport)))),o.main.add(y.H`
    ${(0,y.If)(x,"if( geometryDepthTest(gl_FragCoord.xy * inverseViewport, depth) ){ discard; }")}

    vec2 coverage = min(1.0 - clamp(abs(coverageSampling.xy) - coverageSampling.zw, 0.0, 1.0), lineSizes);

    float borderAlpha = uColor.a * borderColor.a * coverage.y;
    float colorAlpha = uColor.a * coverage.x;

    float finalAlpha = mix(borderAlpha, 1.0, colorAlpha);
    ${(0,y.If)(!e.hudDepth,y.H`vec3 finalRgb = mix(borderColor.rgb * borderAlpha, uColor.rgb, colorAlpha);
           fragColor = vec4(finalRgb, finalAlpha);`)}`),t}const S=(0,o.vt)(),O=Object.freeze(Object.defineProperty({__proto__:null,build:x},Symbol.toStringTag,{value:"Module"}))},62441:(e,t,r)=>{r.d(t,{x:()=>n});class n{constructor(e,t,r){this.graphic=e,this.renderingInfo=t,this.layer=r}}},62647:(e,t,r)=>{r.d(t,{B6:()=>p,G8:()=>m,Jf:()=>y,Zd:()=>v});var n=r(87752),o=r(10382),i=r(89227),a=r(28473),s=r(42276),l=r(67093),c=r(50190),d=r(4794),u=r(96504),h=r(46383),f=r(22131);function p(e,t,r,n,o){const i=e.stageObject,a=i.geometries;let s=0;for(const l of a){if(!(0,h.p)(l))continue;const{update:e,averageGeometrySampledElevation:a}=w(l,t,r,n,o);s+=a,e&&i.geometryVertexAttributeUpdated(l,f.r.POSITION)}return s/a.length}function m(e,t,r,o,a,l){const u=e.stageObject,h=t.centerPointInElevationSR;let f=0;u.usesVerticalDistanceToGround?(o(h,P),(0,c.ai)(u,P.verticalDistanceToGround),f=P.sampledElevation):(o(h,P),"absolute-height"!==t.mode&&(f=P.sampledElevation));const p=(0,n.C)(g,l??u.transformation),m=(0,i.i)(E,p[12],p[13],p[14]);d.b.TESTS_DISABLE_OPTIMIZATIONS?(x[0]=h.x,x[1]=h.y,x[2]=P.z,(0,s.l)(h.spatialReference,x,p,a.spatialReference)&&(l?(0,n.C)(l,p):u.transformation=p)):a.setAltitudeOfTransformation(P.z,p);const y=b/a.unitInMeters;return(Math.abs(p[12]-m[0])>=y||Math.abs(p[13]-m[1])>=y||Math.abs(p[14]-m[2])>=y)&&(l?(0,n.C)(l,p):u.transformation=p),f}const g=(0,o.vt)();function y(e,t,r,n,o){const a=e.graphics3DSymbolLayer.lodRenderer;if(null==a)return 0;const l=t.centerPointInElevationSR;n(l,P);const c="absolute-height"!==t.mode?P.sampledElevation:0,u=a.instanceData,h=e.instanceIndex,f=_;u.getGlobalTransform(h,f);const p=(0,i.i)(E,f[12],f[13],f[14]);d.b.TESTS_DISABLE_OPTIMIZATIONS?(x[0]=l.x,x[1]=l.y,x[2]=P.z,(0,s.l)(l.spatialReference,x,f,o.spatialReference)&&u.setGlobalTransform(h,f)):o.setAltitudeOfTransformation(P.z,f);const m=b/o.unitInMeters;return(d.b.TESTS_DISABLE_OPTIMIZATIONS||Math.abs(f[12]-p[0])>=m||Math.abs(f[13]-p[1])>=m||Math.abs(f[14]-p[2])>=m)&&u.setGlobalTransform(h,f),c}function v(e,t,r,n,o){const i=e.stageObject,a=i.geometries;if(0===a.length)return 0;let s=0,l=null,c=0,d=!1;for(const u of a){if(!(0,h.p)(u))continue;const e=u.attributes.get(f.r.POSITION);if(e!==l){const{update:i,averageGeometrySampledElevation:a}=w(u,t,r,n,o);c=a,l=e,d=i}d&&i.geometryVertexAttributeUpdated(u,f.r.POSITION),s+=c}return s/a.length}const b=.01,x=(0,a.vt)(),S=(0,a.vt)(),O=(0,a.vt)(),_=(0,o.vt)(),E=(0,a.vt)(),P=new c.Uk;function w(e,t,r,n,o){let i=!1;const a=e.transformation,s=t.requiresSampledElevationInfo;S[0]=a[12],S[1]=a[13],S[2]=a[14],e.invalidateBoundingInfo();const c=e.getMutableAttribute(f.r.POSITION),h=c.data,p=c.size,m=h.length/p,g=new u.aY(e.mapPositions,r);let y=0,v=0;for(let u=0;u<m;u++){if(O[0]=h[y],O[1]=h[y+1],O[2]=h[y+2],n(g,P),s&&(v+=P.sampledElevation),d.b.TESTS_DISABLE_OPTIMIZATIONS)h[y]=g.array[g.offset],h[y+1]=g.array[g.offset+1],h[y+2]=P.z,(0,l.projectBuffer)(h,r,y,h,o.spatialReference,y,1),h[y]-=S[0],h[y+1]-=S[1],h[y+2]-=S[2],i=!0;else{x[0]=h[y]+S[0],x[1]=h[y+1]+S[1],x[2]=h[y+2]+S[2],o.setAltitude(x,P.z),h[y]=x[0]-S[0],h[y+1]=x[1]-S[1],h[y+2]=x[2]-S[2];const e=b/o.unitInMeters;(Math.abs(O[0]-h[y])>=e||Math.abs(O[1]-h[y+1])>=e||Math.abs(O[2]-h[y+2])>=e)&&(i=!0)}y+=p,g.offset+=3}return v/=m,{update:i,averageGeometrySampledElevation:v}}},63651:(e,t,r)=>{r.d(t,{P:()=>n,x:()=>s});var n,o,i=r(17741),a=r(49959);class s{constructor(e){this.schedule=e,this._abortController=null,this._loadStatus=n.LOADING,this._loadError=null,this._loader=null,this.logger=null}destroy(){this.abortLoad()}get loadStatus(){return this._loadStatus}load(e,t){return this._loadStatus===n.LOADED?(e&&e(),this._loader??Promise.resolve()):this._loadStatus===n.FAILED?(t&&t(this._loadError),this._loader??Promise.resolve()):(null==this._loader&&(this._abortController=new AbortController,this._loader=this.doLoad(this._abortController.signal).then((()=>{this._abortController=null,this._loadStatus=n.LOADED}),(e=>{throw this._loadError=e,this._abortController=null,this._loadStatus=n.FAILED,!(0,a.isAbortError)(e)&&this.logger&&e.message&&this.logger.warn(e.message),e}))),this._loader.then(e,t).catch((()=>{})),this._loader)}abortLoad(){null!=this._abortController?this._abortController=(0,i.DC)(this._abortController):this._loadStatus===n.LOADING&&(this._loadStatus=n.FAILED),this._loader=null}}(o=n||(n={}))[o.LOADING=0]="LOADING",o[o.LOADED=1]="LOADED",o[o.FAILED=2]="FAILED"},66195:(e,t,r)=>{r.d(t,{Q:()=>h,R:()=>u});var n=r(7815),o=r(95206),i=r(35490),a=r(34927),s=r(4241),l=r(42403),c=r(16878),d=r(22131);const u=.5;function h(e,t){e.include(o.Y6),e.attributes.add(d.r.POSITION,"vec3"),e.attributes.add(d.r.NORMAL,"vec3"),e.attributes.add(d.r.CENTEROFFSETANDDISTANCE,"vec4");const r=e.vertex;(0,i.NB)(r,t),(0,i.yu)(r,t),r.uniforms.add(new a.I("viewport",(e=>e.camera.fullViewport)),new l.m("polygonOffset",(e=>e.shaderPolygonOffset)),new s.U("cameraGroundRelative",(e=>e.camera.aboveGround?1:-1))),t.hasVerticalOffset&&(0,n.V)(r),r.constants.add("smallOffsetAngle","float",.984807753012208),r.code.add(c.H`struct ProjectHUDAux {
vec3 posModel;
vec3 posView;
vec3 vnormal;
float distanceToCamera;
float absCosAngle;
};`),r.code.add(c.H`
    float applyHUDViewDependentPolygonOffset(float pointGroundDistance, float absCosAngle, inout vec3 posView) {
      float pointGroundSign = ${t.terrainDepthTest?c.H.float(0):c.H`sign(pointGroundDistance)`};
      if (pointGroundSign == 0.0) {
        pointGroundSign = cameraGroundRelative;
      }

      // cameraGroundRelative is -1 if camera is below ground, 1 if above ground
      // groundRelative is 1 if both camera and symbol are on the same side of the ground, -1 otherwise
      float groundRelative = cameraGroundRelative * pointGroundSign;

      // view angle dependent part of polygon offset emulation: we take the absolute value because the sign that is
      // dropped is instead introduced using the ground-relative position of the symbol and the camera
      if (polygonOffset > .0) {
        float cosAlpha = clamp(absCosAngle, 0.01, 1.0);
        float tanAlpha = sqrt(1.0 - cosAlpha * cosAlpha) / cosAlpha;
        float factor = (1.0 - tanAlpha / viewport[2]);

        // same side of the terrain
        if (groundRelative > 0.0) {
          posView *= factor;
        }
        // opposite sides of the terrain
        else {
          posView /= factor;
        }
      }

      return groundRelative;
    }
  `),t.draped&&!t.hasVerticalOffset||(0,i.S7)(r),t.draped||(r.uniforms.add(new s.U("perDistancePixelRatio",(e=>Math.tan(e.camera.fovY/2)/(e.camera.fullViewport[2]/2)))),r.code.add(c.H`
    void applyHUDVerticalGroundOffset(vec3 normalModel, inout vec3 posModel, inout vec3 posView) {
      float distanceToCamera = length(posView);

      // Compute offset in world units for a half pixel shift
      float pixelOffset = distanceToCamera * perDistancePixelRatio * ${c.H.float(u)};

      // Apply offset along normal in the direction away from the ground surface
      vec3 modelOffset = normalModel * cameraGroundRelative * pixelOffset;

      // Apply the same offset also on the view space position
      vec3 viewOffset = (viewNormal * vec4(modelOffset, 1.0)).xyz;

      posModel += modelOffset;
      posView += viewOffset;
    }
  `)),t.screenCenterOffsetUnitsEnabled&&(0,i.Nz)(r),t.hasScreenSizePerspective&&(0,o.OH)(r),r.code.add(c.H`
    vec4 projectPositionHUD(out ProjectHUDAux aux) {
      vec3 centerOffset = centerOffsetAndDistance.xyz;
      float pointGroundDistance = centerOffsetAndDistance.w;

      aux.posModel = position;
      aux.posView = (view * vec4(aux.posModel, 1.0)).xyz;
      aux.vnormal = normal;
      ${t.draped?"":"applyHUDVerticalGroundOffset(aux.vnormal, aux.posModel, aux.posView);"}

      // Screen sized offset in world space, used for example for line callouts
      // Note: keep this implementation in sync with the CPU implementation, see
      //   - MaterialUtil.verticalOffsetAtDistance
      //   - HUDMaterial.applyVerticalOffsetTransformation

      aux.distanceToCamera = length(aux.posView);

      vec3 viewDirObjSpace = normalize(cameraPosition - aux.posModel);
      float cosAngle = dot(aux.vnormal, viewDirObjSpace);

      aux.absCosAngle = abs(cosAngle);

      ${t.hasScreenSizePerspective&&(t.hasVerticalOffset||t.screenCenterOffsetUnitsEnabled)?"vec3 perspectiveFactor = screenSizePerspectiveScaleFactor(aux.absCosAngle, aux.distanceToCamera, screenSizePerspectiveAlignment);":""}

      ${t.hasVerticalOffset?t.hasScreenSizePerspective?"float verticalOffsetScreenHeight = applyScreenSizePerspectiveScaleFactorFloat(verticalOffset.x, perspectiveFactor);":"float verticalOffsetScreenHeight = verticalOffset.x;":""}

      ${t.hasVerticalOffset?c.H`
            float worldOffset = clamp(verticalOffsetScreenHeight * verticalOffset.y * aux.distanceToCamera, verticalOffset.z, verticalOffset.w);
            vec3 modelOffset = aux.vnormal * worldOffset;
            aux.posModel += modelOffset;
            vec3 viewOffset = (viewNormal * vec4(modelOffset, 1.0)).xyz;
            aux.posView += viewOffset;
            // Since we elevate the object, we need to take that into account
            // in the distance to ground
            pointGroundDistance += worldOffset;`:""}

      float groundRelative = applyHUDViewDependentPolygonOffset(pointGroundDistance, aux.absCosAngle, aux.posView);

      ${t.screenCenterOffsetUnitsEnabled?"":c.H`
            // Apply x/y in view space, but z in screen space (i.e. along posView direction)
            aux.posView += vec3(centerOffset.x, centerOffset.y, 0.0);

            // Same material all have same z != 0.0 condition so should not lead to
            // branch fragmentation and will save a normalization if it's not needed
            if (centerOffset.z != 0.0) {
              aux.posView -= normalize(aux.posView) * centerOffset.z;
            }
          `}

      vec4 posProj = proj * vec4(aux.posView, 1.0);

      ${t.screenCenterOffsetUnitsEnabled?t.hasScreenSizePerspective?"float centerOffsetY = applyScreenSizePerspectiveScaleFactorFloat(centerOffset.y, perspectiveFactor);":"float centerOffsetY = centerOffset.y;":""}

      ${t.screenCenterOffsetUnitsEnabled?"posProj.xy += vec2(centerOffset.x, centerOffsetY) * pixelRatio * 2.0 / viewport.zw * posProj.w;":""}

      // constant part of polygon offset emulation
      posProj.z -= groundRelative * polygonOffset * posProj.w;
      return posProj;
    }
  `)}},67095:(e,t,r)=>{r.d(t,{K:()=>i});var n=r(59139),o=r(16878);function i(e){e.uniforms.add(new n.o("alignPixelEnabled",(e=>e.alignPixelEnabled))),e.code.add(o.H`vec4 alignToPixelCenter(vec4 clipCoord, vec2 widthHeight) {
if (!alignPixelEnabled)
return clipCoord;
vec2 xy = vec2(0.500123) + 0.5 * clipCoord.xy / clipCoord.w;
vec2 pixelSz = vec2(1.0) / widthHeight;
vec2 ij = (floor(xy * widthHeight) + vec2(0.5)) * pixelSz;
vec2 result = (ij * 2.0 - vec2(1.0)) * clipCoord.w;
return vec4(result, clipCoord.zw);
}`),e.code.add(o.H`vec4 alignToPixelOrigin(vec4 clipCoord, vec2 widthHeight) {
if (!alignPixelEnabled)
return clipCoord;
vec2 xy = vec2(0.5) + 0.5 * clipCoord.xy / clipCoord.w;
vec2 pixelSz = vec2(1.0) / widthHeight;
vec2 ij = floor((xy + 0.5 * pixelSz) * widthHeight) * pixelSz;
vec2 result = (ij * 2.0 - vec2(1.0)) * clipCoord.w;
return vec4(result, clipCoord.zw);
}`)}},67297:(e,t,r)=>{r.d(t,{t:()=>n});const n=["web-gltf","web","cim"]},67350:(e,t,r)=>{r.d(t,{Q:()=>l});var n=r(67297),o=r(45998),i=r(23543),a=r(63651),s=r(89852);class l extends a.x{constructor(e,t,r){super(t),this.symbol=e,this._convert=r,this.symbologySnappingSupported=!1,this.graphics3DSymbol=null,this.referenced=0}getSymbolLayerSize(e){return null!=this.graphics3DSymbol?this.graphics3DSymbol.getSymbolLayerSize(e):null}get symbolLayers(){return null!=this.graphics3DSymbol?this.graphics3DSymbol.symbolLayers:[]}get extentPadding(){return null!=this.graphics3DSymbol?this.graphics3DSymbol.extentPadding:0}async doLoad(e){const t=await this.symbol.fetchSymbol({signal:e,acceptedFormats:n.t});t.id=this.symbol.id,this.graphics3DSymbol=this._convert(t),null!=this.graphics3DSymbol&&await this.graphics3DSymbol.load()}createGraphics3DGraphic(e){return null!=this.graphics3DSymbol?this.graphics3DSymbol.createGraphics3DGraphic(e,this):null}get complexity(){return null!=this.graphics3DSymbol?this.graphics3DSymbol.complexity:o.uD}globalPropertyChanged(e,t){return null!=this.graphics3DSymbol&&this.graphics3DSymbol.globalPropertyChanged(e,t)}applyRendererDiff(e,t){return null!=this.graphics3DSymbol?this.graphics3DSymbol.applyRendererDiff(e,t):i.w.RecreateSymbol}prepareSymbolPatch(e){null!=this.graphics3DSymbol&&this.graphics3DSymbol.prepareSymbolPatch(e)}updateGeometry(e,t){return null!=this.graphics3DSymbol&&this.graphics3DSymbol.updateGeometry(e,t)}updateTransform(e,t,r,n){return this.graphics3DSymbol?.updateTransform(e,t,r,n)??!1}onRemoveGraphic(){}updateFocus(e,t){}getFastUpdateStatus(){return this.graphics3DSymbol?.getFastUpdateStatus()??i.G.Loading}destroy(){null!=this.graphics3DSymbol&&this.graphics3DSymbol.destroy(),this.graphics3DSymbol=void 0,super.destroy()}get destroyed(){return void 0===this.graphics3DSymbol}get cachedMemory(){return(0,s.h)(this)}}},68388:(e,t,r)=>{r.d(t,{Rg:()=>l,Sc:()=>s});var n=r(98080),o=r(89227),i=r(28473),a=r(10872);function s(e,t,r,n){return h(e,t,r,d(n,t,r,!0))}function l(e,t,r,n){const i=(0,o.f)(r,(0,o.d)(e,n,t));return(0,o.g)(e,t,(0,o.h)(e,r,i))}const c={dir:(0,i.vt)(),len:0,clip:(0,n.vt)()};function d(e,t,r,n){const i=c;return e?(r&&n&&(i.len=(0,o.j)(t,r)),(0,o.c)(i.dir,e)):n?(i.len=(0,o.j)(t,r),(0,o.d)(i.dir,r,t),(0,o.h)(i.dir,i.dir,1/i.len)):((0,o.d)(i.dir,r,t),(0,o.n)(i.dir,i.dir)),i}function u(e,t,r){const n=(0,o.f)((0,a.Qj)(e),r.dir),i=-(0,a.mN)(e,t);if(i<0&&n>=0)return!1;if(n>-1e-6&&n<1e-6)return i>0;if((i<0||n<0)&&!(i<0&&n<0))return!0;const s=i/n;return n>0?s<r.clip[1]&&(r.clip[1]=s):s>r.clip[0]&&(r.clip[0]=s),r.clip[0]<=r.clip[1]}function h(e,t,r,n){n.clip[0]=0,n.clip[1]=r?n.len:Number.MAX_VALUE;for(let o=0;o<e.length;o++)if(!u(e[o],t,n))return!1;return!0}},69436:(e,t,r)=>{var n;r.d(t,{D:()=>n}),function(e){e[e.Occluded=0]="Occluded",e[e.NotOccluded=1]="NotOccluded",e[e.Both=2]="Both",e[e.COUNT=3]="COUNT"}(n||(n={}))},69681:(e,t,r)=>{r.d(t,{S:()=>s});var n=r(28473),o=r(67093),i=r(90772),a=r(70576);function s(e,t,r,n){return null!=e&&((0,a.aI)(t,n)?((0,i.C)(r,e),!0):(l[0]=e[0],l[1]=e[1],l[2]=0,!!(0,o.projectBuffer)(l,t,0,l,n,0)&&(r[0]=l[0],r[1]=l[1],l[0]=e[2],l[1]=e[3],l[2]=0,!!(0,o.projectBuffer)(l,t,0,l,n,0)&&(r[2]=l[0],r[3]=l[1],!0))))}const l=(0,n.vt)()},71750:(e,t,r)=>{r.d(t,{KF:()=>m,MF:()=>p,VG:()=>u,g7:()=>f,gf:()=>h,hI:()=>c,o8:()=>l,q6:()=>d});var n=r(50925),o=r(49959),i=r(34156),a=r(96247);const s=()=>n.A.getLogger("esri.views.3d.layers.graphics.featureExpressionInfoUtils");function l(e){return{cachedResult:e.cachedResult,arcade:e.arcade?{func:e.arcade.func,context:e.arcade.modules.arcadeUtils.createExecContext(null,{sr:e.arcade.context.spatialReference}),modules:e.arcade.modules}:null}}function c(e){const t=e?.expression;if("string"==typeof t){const e=y(t);if(null!=e)return{cachedResult:e}}return null}async function d(e,t,r,n){const i=e?.expression;if("string"!=typeof i)return null;const s=y(i);if(null!=s)return{cachedResult:s};const l=await(0,a.lw)();(0,o.throwIfAborted)(r);const c=l.arcadeUtils,d=c.createSyntaxTree(i);return c.dependsOnView(d)?(null!=n&&n.error("Expressions containing '$view' are not supported on ElevationInfo"),{cachedResult:0}):{arcade:{func:c.createFunction(d),context:c.createExecContext(null,{sr:t}),modules:l}}}function u(e,t,r){return e.arcadeUtils.createFeature(t.attributes,t.geometry,r)}function h(e,t){if(null!=e&&!g(e)){if(!t||!e.arcade)return void s().errorOncePerTick("Arcade support required but not provided");const r=t;r._geometry&&(r._geometry=(0,i.wZ)(r._geometry)),e.arcade.modules.arcadeUtils.updateExecContext(e.arcade.context,t)}}function f(e){if(null!=e){if(g(e))return e.cachedResult;const t=e.arcade;let r=t?.modules.arcadeUtils.executeFunction(t.func,t.context);return"number"!=typeof r&&(e.cachedResult=0,r=0),r}return 0}function p(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e?.featureExpressionInfo;const n=r?.expression;return t||"0"===n||(r=null),r??null}const m={cachedResult:0};function g(e){return null!=e.cachedResult}function y(e){return"0"===e?0:null}},72249:(e,t,r)=>{r.d(t,{F:()=>i});var n=r(34308),o=r(71750);class i{constructor(){this._meterUnitOffset=0,this._renderUnitOffset=0,this._unit="meters",this._metersPerElevationInfoUnit=1,this._featureExpressionInfoContext=null,this.centerPointInElevationSR=null,this.mode=null}get featureExpressionInfoContext(){return this._featureExpressionInfoContext}get meterUnitOffset(){return this._meterUnitOffset}get unit(){return this._unit}set unit(e){this._unit=e,this._metersPerElevationInfoUnit=(0,n.Ao)(e)}get requiresSampledElevationInfo(){return"absolute-height"!==this.mode}reset(){this.mode=null,this._meterUnitOffset=0,this._renderUnitOffset=0,this._featureExpressionInfoContext=null,this.unit="meters"}set offsetMeters(e){this._meterUnitOffset=e,this._renderUnitOffset=0}set offsetElevationInfoUnits(e){this._meterUnitOffset=e*this._metersPerElevationInfoUnit,this._renderUnitOffset=0}addOffsetRenderUnits(e){this._renderUnitOffset+=e}geometryZWithOffset(e,t){const r=this.calculateOffsetRenderUnits(t);return null!=this.featureExpressionInfoContext?r:e+r}calculateOffsetRenderUnits(e){let t=this._meterUnitOffset;const r=this.featureExpressionInfoContext;return null!=r&&(t+=(0,o.g7)(r)*this._metersPerElevationInfoUnit),t/e.unitInMeters+this._renderUnitOffset}setFromElevationInfo(e){this.mode=e.mode,this.unit=(0,n.Tg)(e.unit)?e.unit:"meters",this.offsetElevationInfoUnits=e.offset??0}updateFeatureExpressionInfoContext(e,t,r){if(null==e)return void(this._featureExpressionInfoContext=null);const n=e?.arcade;n&&null!=t&&null!=r?(this._featureExpressionInfoContext=(0,o.o8)(e),(0,o.gf)(this._featureExpressionInfoContext,(0,o.VG)(n.modules,t,r))):this._featureExpressionInfoContext=e}static fromElevationInfo(e){const t=new i;return null!=e&&t.setFromElevationInfo(e),t}}},73296:(e,t,r)=>{r.d(t,{_:()=>a,k:()=>i});r(21265);var n=r(86580),o=r(23795);function i(e){switch(e){case"sphere":case"cube":case"diamond":case"cylinder":case"cone":case"inverted-cone":case"tetrahedron":return!0}return!1}function a(e,t){const r=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new o.Fe(e.map((e=>{const i=t(e.tesselation);return r&&(0,n.zC)(i),new o.hr([new o.iC(new o.dI(i))],e.minScreenSpaceRadius)})))};switch(e){case"sphere":return r([{tesselation:0,minScreenSpaceRadius:0},{tesselation:1,minScreenSpaceRadius:8},{tesselation:2,minScreenSpaceRadius:16},{tesselation:3,minScreenSpaceRadius:50},{tesselation:4,minScreenSpaceRadius:250}],(e=>(0,n.uX)(t,.5,e,!0)));case"cube":return r([{tesselation:0,minScreenSpaceRadius:0}],(()=>(0,n.C1)(t,1)));case"cone":return r(s,(e=>(0,n.EE)(t,1,.5,e,!1)),!0);case"inverted-cone":return r(s,(e=>(0,n.EE)(t,1,.5,e,!0)),!0);case"cylinder":return r(s,(e=>(0,n.nW)(t,1,.5,e,[0,0,1],[0,0,.5])));case"tetrahedron":return r([{tesselation:0,minScreenSpaceRadius:0}],(()=>(0,n.Ho)(t,1)),!0);case"diamond":return r([{tesselation:0,minScreenSpaceRadius:0}],(()=>(0,n.td)(t,1)),!0);default:return}}const s=[{tesselation:6,minScreenSpaceRadius:0},{tesselation:18,minScreenSpaceRadius:7},{tesselation:64,minScreenSpaceRadius:65}]},77297:(e,t,r)=>{var n,o,i;r.d(t,{O7:()=>o,Om:()=>n,sv:()=>i}),function(e){e[e.RasterImage=0]="RasterImage",e[e.Features=1]="Features"}(n||(n={})),function(e){e[e.MapLayer=0]="MapLayer",e[e.ViewLayer=1]="ViewLayer",e[e.Outline=2]="Outline",e[e.SnappingHint=3]="SnappingHint"}(o||(o={})),function(e){e[e.WithRasterImage=0]="WithRasterImage",e[e.WithoutRasterImage=1]="WithoutRasterImage"}(i||(i={}))},77520:(e,t,r)=>{r.d(t,{Cc:()=>c,Qo:()=>d,CC:()=>u,RF:()=>l});var n=r(88102),o=(r(21265),r(16804)),i=r(24646);var a=r(7757),s=r(6513);function l(e){return e&&e.enabled&&(function(e){return"extrude"===e.type}(e)||function(e){return"fill"===e.type}(e))&&null!=e.edges}function c(e,t){return d(function(e){return e&&e.enabled&&e.edges||null}(e),t)}function d(e,t){if(null==e)return null;const r=null!=e.color?(0,i.ci)(n.default.toUnitRGBA(e.color)):(0,i.fA)(0,0,0,0),a=(0,o.Lz)(e.size),l=(0,o.Lz)(e.extensionLength);switch(e.type){case"solid":return u({color:r,size:a,extensionLength:l,...t});case"sketch":return c={color:r,size:a,extensionLength:l,...t},{...f,...c,type:s.gP.Sketch};default:return}var c}function u(e){return{...h,...e,type:s.gP.Solid}}const h={color:(0,i.fA)(0,0,0,.2),size:1,extensionLength:0,opacity:1,objectTransparency:a.x.OPAQUE,hasSlicePlane:!1},f={color:(0,i.fA)(0,0,0,.2),size:1,extensionLength:0,opacity:1,objectTransparency:a.x.OPAQUE,hasSlicePlane:!1}},79462:(e,t,r)=>{r.d(t,{Ws:()=>Y,Rj:()=>te,AG:()=>ee});var n=r(88102),o=r(21265),i=r(16804),a=r(28473),s=r(24646),l=r(6090),c=r(65860),d=r(62647),u=r(50190),h=r(72249),f=r(62441),p=r(26324),m=r(10667),g=r(21540),y=r(12770),v=r(24040),b=r(16347),x=r(65069),S=r(69291),O=r(25735),_=r(22131),E=r(56612),P=r(74715),w=r(98876),C=r(96236),L=r(9215),A=r(60984),T=r(53801),I=r(33050),F=r(93003),D=r(16434),R=r(62374),z=r(92156),U=r(12723);class G extends D.w{constructor(e,t){super(e,t,new F.$(R.L,(()=>r.e(25510).then(r.bind(r,25510)))))}initializePipeline(e){const{hudDepth:t,terrainDepthTest:r}=e,n={func:r?z.MT.ALWAYS:z.MT.LESS};return(0,U.Ey)(t?{depthTest:n,depthWrite:U.Uy}:{blending:(0,U.p3)(z.dn.ONE,z.dn.SRC_ALPHA,z.dn.ONE_MINUS_SRC_ALPHA,z.dn.ONE_MINUS_SRC_ALPHA),depthTest:n,colorWrite:U.kn})}}var M=r(93800),V=r(21484),j=r(51448);class N extends j.E{constructor(e){super(),this.spherical=e,this.screenCenterOffsetUnitsEnabled=!1,this.occlusionTestEnabled=!0,this.hasVerticalOffset=!1,this.hasScreenSizePerspective=!1,this.hudDepth=!1,this.hudDepthAlignStart=!1,this.terrainDepthTest=!1,this.draped=!1}}(0,M._)([(0,V.W)()],N.prototype,"screenCenterOffsetUnitsEnabled",void 0),(0,M._)([(0,V.W)()],N.prototype,"occlusionTestEnabled",void 0),(0,M._)([(0,V.W)()],N.prototype,"hasVerticalOffset",void 0),(0,M._)([(0,V.W)()],N.prototype,"hasScreenSizePerspective",void 0),(0,M._)([(0,V.W)()],N.prototype,"hudDepth",void 0),(0,M._)([(0,V.W)()],N.prototype,"hudDepthAlignStart",void 0),(0,M._)([(0,V.W)()],N.prototype,"terrainDepthTest",void 0);var H=r(12621);class B extends A.im{constructor(e,t){super(e,W),this.produces=new Map([[T.N.LINE_CALLOUTS,e=>(0,C.RN)(e)],[T.N.LINE_CALLOUTS_HUD_DEPTH,e=>(0,C.RN)(e)]]),this._configuration=new N(t),this._uniqueMaterialIdentifier=k(this.parameters)}passParameters(){return this.parameters}getConfiguration(e,t){const r=t.slot===T.N.LINE_CALLOUTS_HUD_DEPTH;return this._configuration.occlusionTestEnabled=this.parameters.occlusionTest,this._configuration.hasVerticalOffset=null!=this.parameters.verticalOffset,this._configuration.hasScreenSizePerspective=null!=this.parameters.screenSizePerspective,this._configuration.hudDepth=r,this._configuration.hudDepthAlignStart=!!this.parameters.hudDepthAlignStart,this._configuration.screenCenterOffsetUnitsEnabled="screen"===this.parameters.centerOffsetUnits,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.terrainDepthTest=t.terrainDepthTest,this._configuration}get visible(){return this.parameters.color[3]>=H.Q||(this.parameters.borderColor?.[3]??0)>=H.Q}intersect(){}createGLMaterial(e){return new $(e)}createBufferWriter(){return new Q}validateParameters(e){this._uniqueMaterialIdentifier=k(e)}get uniqueMaterialIdentifier(){return this._uniqueMaterialIdentifier}}function k(e){let{renderOccluded:t,isDecoration:r,horizontalScreenOffset:n,color:o,size:i,occlusionTest:a,shaderPolygonOffset:s,hudDepthAlignStart:l,centerOffsetUnits:c,hasSlicePlane:d,screenSizePerspective:u,verticalOffset:h,borderColor:f}=e;return E.ML`${t}:${r}:${n}:[${o}]:${i}:${a}:${s}:${l}:${c}:${d}:${null!=u}:{${h.screenLength}:${h.minWorldLength}:${h.maxWorldLength}}:[${f}]`}class $ extends L.A{beginSlot(e){return this.getTechnique(G,e)}}class W extends A.qA{constructor(){super(...arguments),this.horizontalScreenOffset=0,this.color=(0,s.fA)(0,0,0,1),this.size=1,this.occlusionTest=!1,this.shaderPolygonOffset=1e-5,this.hudDepthAlignStart=!1,this.centerOffsetUnits="world",this.hasSlicePlane=!1}}const q=(0,w.BP)().vec3f(_.r.POSITION).vec3f(_.r.NORMAL).vec2f(_.r.UV0).vec4f(_.r.CENTEROFFSETANDDISTANCE),Z=[(0,P.fA)(0,0),(0,P.fA)(1,0),(0,P.fA)(0,1),(0,P.fA)(1,0),(0,P.fA)(1,1),(0,P.fA)(0,1)];class Q{constructor(){this.vertexBufferLayout=q}elementCount(e){return 6*e.get(_.r.POSITION).indices.length}write(e,t,r,n,o,i){(0,I.Hk)(r.get(_.r.POSITION),e,o.position,i,6),(0,I.p1)(r.get(_.r.NORMAL),t,o.normal,i,6),(0,I.Ut)(r.get(_.r.CENTEROFFSETANDDISTANCE),o.centerOffsetAndDistance,i,6);for(let a=0;a<Z.length;++a)o.uv0.setVec(i+a,Z[a])}}class Y extends g.U{constructor(e,t){super(e,null,t,K),this._elevationOptions={supportsOffsetAdjustment:!0,supportsOnTheGround:!1},this.ensureDrapedStatus(!1)}async doLoad(){this._materials[0]=new B(this._materialParameters,this._context.spherical),this._context.stage.add(this._materials[0])}destroy(){super.destroy(),this._context.stage.remove(this._materials[0]),this._materials.length=0}_perInstanceMaterialParameters(e){const t=this._materialParameters;return t.horizontalScreenOffset=e.horizontalScreenOffset??0,t.centerOffsetUnits=e.centerOffsetUnits||"world",t}get _materialParameters(){const e=new W,t=this.symbol,r=t.callout;if(r.color){const t=n.default.toUnitRGBA(r.color);t[3]*=this._getLayerOpacity(),e.color=t}else e.color=s.uY;if(e.size=(0,i.Lz)(r.size||0),t.verticalOffset){const{screenLength:r,minWorldLength:n,maxWorldLength:o}=t.verticalOffset;e.verticalOffset={screenLength:(0,i.Lz)(r),minWorldLength:n||0,maxWorldLength:null!=o?o:1/0}}e.borderColor=null!=r.border?.color?n.default.toUnitRGBA(r.border.color):null;const a="object"===t.symbolLayers.at(0).type,l="label-3d"===t.type;return e.occlusionTest=!a&&!(0,o.A)("enable-feature:non-occluded-hud"),a&&(e.shaderPolygonOffset=0),e.hudDepthAlignStart=l,e.hasSlicePlane=this._context.slicePlaneEnabled,e.screenSizePerspective=this._context.screenSizePerspectiveEnabled?this._context.sharedResources.screenSizePerspectiveSettings:null,e}_defaultElevationInfoNoZ(){return J}createGraphics3DGraphic(e){const t=e.renderingInfo,r=e.graphic,n=this.setGraphicElevationContext(r,new h.F,t.elevationOffset||0),o=t.symbol,i="on-the-ground"===this._elevationContext.mode&&("cim"===o.type||!o.symbolLayers.some((e=>"object"===e.type||"text"===e.type)));if("label-3d"!==o.type&&i)return null;if("point-3d"===o.type&&o.symbolLayers.every((e=>"text"===e.type&&!(0,c.Ie)(e))))return null;const a=(0,y.W$)(r.geometry);return null==a?null:this._createAs3DShape(a,n,t,r.uid)}layerOpacityChanged(){this._materials[0]?.setParameters(this._materialParameters)}layerElevationInfoChanged(e,t,r){const n=this._elevationContext.mode,o=(0,u.I2)(Y.elevationModeChangeTypes,r,n);return o!==u.uw.UPDATE||e.forEach((e=>{const r=t(e);null!=r&&this.updateGraphicElevationContext(e.graphic,r)})),o}slicePlaneEnabledChanged(){return this._materials[0]?.setParameters({hasSlicePlane:this._context.slicePlaneEnabled}),!0}physicalBasedRenderingChanged(){return!0}setGraphicElevationContext(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return super.setGraphicElevationContext(e,t),t.addOffsetRenderUnits(r),t}updateGraphicElevationContext(e,t){const{elevationContext:r,metadata:n}=t;this.setGraphicElevationContext(e,r,n?.elevationOffset??0),t.needsElevationUpdates=(0,u.nu)(r.mode)}computeComplexity(){return new b.rz({verticesPerFeature:6})}_getOrCreateMaterial(e){const t=this._perInstanceMaterialParameters(e),r=k(t);if(r===this._materials[0]?.uniqueMaterialIdentifier)return{material:this._materials[0],isUnique:!1};if(null!=e.materialCollection){let n=e.materialCollection.get(r);return null==n&&(n=new B(t,this._context.spherical),e.materialCollection.add(r,n)),{material:n,isUnique:!1}}return{material:new B(t,this._context.spherical),isUnique:!0}}_createAs3DShape(e,t,r,n){const o=this._context.layer.uid,i=this._context.stage.renderView.getObjectAndLayerIdColor({graphicUid:n,layerUid:o}),a=this._getOrCreateMaterial(r),s=new O.V(a.material,function(e){const{translation:t,centerOffset:r}=e,n=new x.n(t?[t[0],t[1],t[2]]:[0,0,0],X,3,!0),o=new x.n(r?[r[0],r[1],r[2],r[3]]:[0,0,0,1],X,4,!0);return[[_.r.POSITION,n],[_.r.NORMAL,new x.n([0,0,1],X,3,!0)],[_.r.CENTEROFFSETANDDISTANCE,o]]}(r),null,S.X.Point,i),l=(0,v.SZ)(this._context,e,s,t,n);if(null==l)return null;const c=new p.Y(this,l.object,[s],a.isUnique?[a.material]:null,null,d.G8,t);return c.metadata=new m.Z(r.elevationOffset),c.alignedSampledElevation=l.sampledElevation,c.needsElevationUpdates=(0,u.nu)(t.mode),(0,v.d2)(c,e,this._context.elevationProvider),c}}Y.elevationModeChangeTypes={definedChanged:u.uw.UPDATE,staysOnTheGround:u.uw.UPDATE,onTheGroundChanged:u.uw.RECREATE};const X=[0],J={mode:"relative-to-ground",offset:0},K={ignoreDrivers:!0,renderPriority:0,renderPriorityStep:1};class ee extends l.${constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(0,a.vt)(),n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:(0,s.vt)(),o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"world",l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;super(e,t),this.translation=r,this.centerOffset=n,this.horizontalScreenOffset=o,this.centerOffsetUnits=i,this.elevationOffset=l,this.materialCollection=c}}class te extends f.x{}},83412:(e,t,r)=>{r.d(t,{RL:()=>o,ZC:()=>i,kf:()=>n});const n=3,o=3,i=10},88242:(e,t,r)=>{r.d(t,{cz:()=>b,Sg:()=>f,B:()=>v,Hi:()=>y});var n=r(7951),o=r(15173),i=r(18498),a=r(96236),s=r(42162),l=r(21152),c=r(16878),d=r(73031),u=r(826);class h extends u.n{constructor(e,t){super(e,"int",d.c.Draw,((r,n,o)=>r.setUniform1i(e,t(n,o))))}}var f,p=r(81775),m=r(96122),g=r(22131);!function(e){e[e.Uniform=0]="Uniform",e[e.Varying=1]="Varying",e[e.COUNT=2]="COUNT"}(f||(f={}));const y=429496.7296;function v(e,t){(0,o.U)(e/y*.5+.5,t)}function b(e,t){switch(t.componentData){case f.Varying:return function(e,t){const{vertex:r,fragment:n}=e;r.include(s.W),r.uniforms.add(new p.o("componentColorTex",(e=>e.componentParameters.texture.texture))),e.attributes.add(g.r.COMPONENTINDEX,"float"),e.varyings.add("vExternalColorMixMode","mediump float"),e.varyings.add("vExternalColor","vec4");const o=t.output===a.V.ObjectAndLayerIdColor;o&&e.varyings.add("vObjectAndLayerIdColor","vec4"),e.include(i.A),r.constants.add("stride","float",(0,m.E)()?3:2),r.code.add(c.H`vec2 getComponentTextureCoordinates(float componentIndex, float typeOffset) {
float index = componentIndex * stride + typeOffset;
float texSize = float(textureSize(componentColorTex, 0).x);
float coordX = mod(index, texSize);
float coordY = floor(index / texSize);
return vec2(coordX, coordY) + 0.5;
}`),r.code.add(c.H`
  vec4 _readComponentColor() {
    vec2 textureCoordinates = getComponentTextureCoordinates(componentIndex, 0.0);
    return texelFetch(componentColorTex, ivec2(textureCoordinates), 0);
   }

  float readElevationOffset() {
    vec2 textureCoordinates = getComponentTextureCoordinates(componentIndex, 1.0);
    vec4 encodedElevation = texelFetch(componentColorTex, ivec2(textureCoordinates), 0);
    return uninterpolatedRGBAToFloat(encodedElevation) * ${c.H.float(y)};
  }

  ${o?c.H`
          void forwardObjectAndLayerIdColor() {
            vec2 textureCoordinates = getComponentTextureCoordinates(componentIndex, 2.0);
            vObjectAndLayerIdColor = texelFetch(componentColorTex, ivec2(textureCoordinates), 0);
          }`:c.H`void forwardObjectAndLayerIdColor() {}`}

  vec4 forwardExternalColor(out bool castShadows) {
    vec4 componentColor = _readComponentColor() * 255.0;

    float shadowFlag = mod(componentColor.b * 255.0, 2.0);
    componentColor.b -= shadowFlag;
    castShadows = shadowFlag >= 1.0;

    int decodedColorMixMode;
    vExternalColor = decodeSymbolColor(componentColor, decodedColorMixMode) * 0.003921568627451; // = 1/255;
    vExternalColorMixMode = float(decodedColorMixMode) + 0.5; // add 0.5 to avoid interpolation artifacts

    return vExternalColor;
  }
`),n.code.add(c.H`
  void readExternalColor(out vec4 externalColor, out int externalColorMixMode) {
    externalColor = vExternalColor;
    externalColorMixMode = int(vExternalColorMixMode);
  }

  void outputObjectAndLayerIdColor() {
     ${o?c.H`fragColor = vObjectAndLayerIdColor;`:""}
  }
`)}(e,t);case f.Uniform:return function(e,t){const{vertex:r,fragment:n}=e;e.varyings.add("vExternalColor","vec4"),r.uniforms.add(new l.V("externalColor",(e=>e.componentParameters.externalColor))).code.add(c.H`float readElevationOffset() {
return 0.0;
}
void forwardObjectAndLayerIdColor() {}
vec4 forwardExternalColor(out bool castShadows) {
vExternalColor = externalColor;
castShadows = true;
return externalColor;
}`);const o=t.output===a.V.ObjectAndLayerIdColor;n.uniforms.add(new h("externalColorMixMode",(e=>e.componentParameters.externalColorMixMode))).code.add(c.H`
    void readExternalColor(out vec4 color, out int colorMixMode) {
      color = vExternalColor;
      colorMixMode = externalColorMixMode;
    }

    void outputObjectAndLayerIdColor() {
      ${(0,c.If)(o,"fragColor = vec4(0, 0, 0, 0);")}
    }
  `)}(e,t);case f.COUNT:return;default:(0,n.Xb)(t.componentData)}}},89659:(e,t,r)=>{r.d(t,{y:()=>c});var n=r(67095),o=r(69436),i=r(34927),a=r(4241),s=r(16878),l=r(73712);function c(e){e.vertex.uniforms.add(new a.U("renderTransparentlyOccludedHUD",(e=>e.hudRenderStyle===o.D.Occluded?1:e.hudRenderStyle===o.D.NotOccluded?0:.75)),new i.I("viewport",(e=>e.camera.fullViewport)),new l.x("hudVisibilityTexture",(e=>e.hudVisibility?.getTexture()))),e.vertex.include(n.K),e.vertex.code.add(s.H`bool testHUDVisibility(vec4 posProj) {
vec4 posProjCenter = alignToPixelCenter(posProj, viewport.zw);
vec4 occlusionPixel = texture(hudVisibilityTexture, .5 + .5 * posProjCenter.xy / posProjCenter.w);
if (renderTransparentlyOccludedHUD > 0.5) {
return occlusionPixel.r * occlusionPixel.g > 0.0 && occlusionPixel.g * renderTransparentlyOccludedHUD < 1.0;
}
return occlusionPixel.r * occlusionPixel.g > 0.0 && occlusionPixel.g == 1.0;
}`)}},89852:(e,t,r)=>{r.d(t,{h:()=>i});const n=2216,o=4096;function i(e){return n+o*e.symbolLayers.length+e.complexity.memory.resourceBytes}},99855:(e,t,r)=>{r.d(t,{H:()=>s,h:()=>a});var n=r(92453),o=r(15828),i=r(27464);class a extends o.R6{constructor(e,t,r,n,o){super(e,t),this.layerUid=e,this.graphicUid=t,this.triangleNr=r,this.baseBoundingSphere=n,this.numLodLevels=o}}function s(e){return(0,i.i3)(e)&&e.intersector===n.dz.LOD&&!!e.target}}}]);