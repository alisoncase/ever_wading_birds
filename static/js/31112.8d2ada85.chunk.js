"use strict";(self.webpackChunkever_wading_birds=self.webpackChunkever_wading_birds||[]).push([[8731,31112,40663,63044],{6115:(e,r,a)=>{a.r(r),a.d(r,{cloneScheme:()=>g,getSchemeByName:()=>y,getSchemes:()=>h,getSchemesByTag:()=>b,getThemes:()=>m});var n=a(88102),t=a(62631),i=a(2925),l=a(2020),o=a(43073),s=a(28245);const u="#aaaaaa",c="25px",d={light:{color:[153,153,153,.25],width:"1px"},dark:{color:[153,153,153,.25],width:"1px"},darker:{color:[26,26,26,.25],width:"1px"}},p=["vibrant-rainbow","cat-dark","predominant-v2","predominant-v5","predominance-race","desert-blooms","tropical-bliss","under-the-sea","ocean-bay","cat-light","predominant-v4","predominance-money","predominant-v3","predominance-race-ethnic","pastel-chalk","predominance-rainbow","predominance-sequence","cat-popup-olympic-sunset"],f=(0,s.bG)({themeDictionary:{default:{name:"default",label:"Default",description:"Default theme for visualizing features using a pie chart of categories.",schemes:{point:{light:{primary:"predominant-v1",secondary:p,common:{outline:d.light,colorForOthersCategory:u,size:c}},dark:{primary:"predominant-v2",secondary:p.map((e=>"predominant-v2"===e?"predominant-v1":e)),common:{outline:d.darker,colorForOthersCategory:u,size:c}}},polygon:{light:{primary:"predominant-v1",secondary:p,common:{colorForOthersCategory:u,outline:d.light,size:c}},dark:{primary:"predominant-v2",secondary:p.map((e=>"predominant-v2"===e?"predominant-v1":e)),common:{colorForOthersCategory:u,outline:d.dark,size:c}}}}}}});function m(e){return(0,s.vt)(f,e)}function h(e){const r=(0,s.Fq)({basemap:e.basemap,basemapTheme:e.basemapTheme,geometryType:e.geometryType,theme:f.get("default")});if(!r)return;const{schemesInfo:a,basemapId:n,basemapTheme:i}=r,o=a.common,u=e.numColors,c=(0,l.getSchemes)({basemap:e.basemap,geometryType:e.geometryType}),d=c?.primaryScheme;return{primaryScheme:w(a.primary,o,u,d),secondarySchemes:a.secondary.map((e=>w(e,o,u,d))).filter(t.Ru),basemapId:n,basemapTheme:i}}function y(e){return(0,s.Ty)(e.name,h(e))}function b(e){return(0,s.YJ)(e.includedTags,e.excludedTags,h(e))}function g(e){if(!e)return;const r={...e};return r.tags=[...r.tags],r.colors&&(r.colors=r.colors.map((e=>new n.default(e)))),r.colorForOthersCategory&&(r.colorForOthersCategory=new n.default(r.colorForOthersCategory)),r.outline&&(r.outline={color:r.outline.color&&new n.default(r.outline.color),width:r.outline.width}),"sizeScheme"in r&&r.sizeScheme&&(r.sizeScheme=(0,l.cloneScheme)(r.sizeScheme)),r}function w(e,r,a,t){const l=o.A[e];if(l)return function(e){return{name:e.name,tags:[...e.tags],colors:e.colors.map((e=>new n.default(e))),colorForOthersCategory:new n.default(e.colorForOthersCategory),outline:{color:new n.default(e.outline.color),width:e.outline.width},size:e.size,sizeScheme:e.sizeScheme}}({name:l.name,tags:l.tags,colors:l[a]||(0,i.Iy)(l.stops,a),colorForOthersCategory:r.colorForOthersCategory,outline:r.outline,size:r.size,sizeScheme:t})}},31112:(e,r,a)=>{a.r(r),a.d(r,{createRenderer:()=>q,createRendererForClustering:()=>_,regenerateRenderer:()=>B});var n=a(88102),t=a(62631),i=a(2925),l=a(74719),o=a(16804),s=a(53957),u=a(54543),c=a(68672),d=a(30429),p=a(30495),f=a(25971),m=a(37382),h=a(70183),y=a(66787),b=a(39186),g=a(40663),w=a(39569),v=a(76118),z=a(70934),S=a(85151),E=a(79538),V=a(2938),x=a(6115),C=a(99071),k=a(44827);const T=[V.mb.CSVLayer,V.mb.FeatureLayer,V.mb.GeoJSONLayer,V.mb.KnowledgeGraphSublayer,V.mb.OGCFeatureLayer,V.mb.OrientedImageryLayer,V.mb.ParquetLayer,V.mb.StreamLayer,V.mb.WFSLayer];async function I(e){if(!(e?.layer&&e.view&&e.attributes?.length))throw new l.default("pie-chart-renderer:missing-parameters","'layer', 'view' and 'attributes' parameters are required");if(e.attributes.length>10)throw new l.default("pie-chart-renderer:invalid-parameters","PieChart renderer does not support more than 10 attributes");e.forBinning&&(0,S.p)(e,"pie-chart-renderer");const r={...e,layer:e.layer,view:e.view,attributes:e.attributes};r.shape=r.shape||"pie",r.othersCategoryEnabled??=!0,r.includeSizeVariable=e.includeSizeVariable||!1;const a=e.forBinning?V.Mi:T,n=(0,V.Jg)(r.layer,a,e.forBinning);if(!n)throw new l.default("pie-chart-renderer:invalid-parameters","'layer' must be one of these types: "+(0,V.Ho)(a).join(", "));const t=null!=r.signal?{signal:r.signal}:null;await Promise.all([e.view.when(),n.load(t)]);const i=n.geometryType,o="polygon"===i,s="point"===i||"multipoint"===i||o;if(r.outlineOptimizationEnabled=!!o&&r.outlineOptimizationEnabled,r.sizeOptimizationEnabled=!!s&&r.sizeOptimizationEnabled,!s)throw new l.default("pie-chart-renderer:not-supported","PieChart renderer is only supported for point and polygon layers");const u=[],c=r.attributes;for(const l of c){const e=await(0,E.EG)({field:l.field,valueExpression:l.valueExpression});u.push(...e)}const d=(0,w.MH)(n,u.filter(Boolean),"pie-chart-renderer:invalid-parameters");if(d)throw d;return{...r,layer:n}}async function O(e){let r=e.pieChartScheme,a=null,n=null;const t=await(0,w.Ib)(e.basemap,e.view);if(a=null!=t.basemapId?t.basemapId:null,n=null!=t.basemapTheme?t.basemapTheme:null,r)return{scheme:(0,x.cloneScheme)(r),basemapId:a,basemapTheme:n};const i=(0,x.getSchemes)({numColors:e.attributes.length,geometryType:e.layer.geometryType,basemapTheme:n});return i&&(r=i.primaryScheme,a=i.basemapId,n=i.basemapTheme),{scheme:r,basemapId:a,basemapTheme:n}}async function $(e,r){const{valueExpression:a,sqlExpression:n,sqlWhere:t}=(0,z.D9)(e.attributes),i=await(0,s.ud)("esri/smartMapping/t9n/smartMapping");return(0,b.createVisualVariables)({layer:e.layer,basemap:e.basemap,valueExpression:a,sqlExpression:n,sqlWhere:t,sizeScheme:r,sizeOptimizationEnabled:e.sizeOptimizationEnabled,legendOptions:{title:i.sumOfCategories},view:e.view,signal:e.signal})}async function q(e){const[r,a]=await Promise.all([I(e),(0,s.ud)("esri/smartMapping/t9n/smartMapping")]),n=await O(r),u=n?.scheme;if(!u)throw new l.default("pie-chart-renderer:insufficient-info","Unable to find pie-chart scheme");const{layer:c,includeSizeVariable:b,sizeOptimizationEnabled:g,outlineOptimizationEnabled:z,view:S,signal:E,filter:V}=r,k=u.sizeScheme,T=r.attributes,q=T.map((e=>e.field)).filter(t.Ru),[B,R,P,L]=await Promise.all([q.length>1?(0,v.default)({layer:c,fields:q,view:S,signal:E,filter:V}):null,b?$(r,k):null,!b&&g?(0,y.default)({layer:c,view:S,signal:E,filter:V}).catch(w.ou):null,z?(0,h.A)({layer:c,view:S,signal:E,filter:V}).catch(w.ou):null]),M=B?.predominantCategoryInfos?{uniqueValueInfos:B.predominantCategoryInfos}:{uniqueValueInfos:q.map((e=>({value:e,count:0})))},_=(0,i.Iy)(u.colors,T.length),j=T.map(((e,r)=>new p.default({field:e.field,valueExpression:e.valueExpression,label:e.label,valueExpressionTitle:e.valueExpressionTitle,color:_[r]}))),J=c.geometryType,H=null!=k&&"background"in k&&k.background,W=new d.default({attributes:j,othersCategory:new f.i({label:a.other,color:r.othersCategoryEnabled?u.colorForOthersCategory:null,threshold:.04}),holePercentage:"donut"===r.shape?.45:0,backgroundFillSymbol:H?(0,w.v5)(J,{type:"2d",color:H.color,outline:(0,w.qc)(H,J,L?.opacity)}):null,size:(0,o.cr)(u.size),outline:new C.default((0,w.qc)(u,"point",L?.opacity)),legendOptions:m.A.from(r.legendOptions)});if(R&&(F(R,g,J),W.authoringInfo=R.authoringInfo.clone(),W.visualVariables=R.visualVariables?.map((e=>e.clone()))),L?.visualVariables?.length){const e=L.visualVariables.map((e=>e.clone())).filter((e=>"color"!==e.type&&"rotation"!==e.type));W.visualVariables?W.visualVariables.push(...e):W.visualVariables=e}return P?.minSize&&(A(P,J),W.visualVariables?W.visualVariables.push(P.minSize):W.visualVariables=[P.minSize]),{renderer:W,pieChartScheme:(0,x.cloneScheme)(u),size:R,basemapId:n.basemapId,basemapTheme:n.basemapTheme,statistics:M}}async function B(e){const{creatorParameters:r,view:a,signal:n,filter:t,renderer:i}=await async function(e){const r="regenerate-pie-chart-renderer";await(0,g.AC)(e,r);const a=await(0,g.mE)(e);if("pie-chart"!==(0,g.UJ)(a))throw new l.default(`${r}:invalid-parameters`,"Renderer is invalid");const{visualVariables:n}=a,{layer:t,forBinning:i,filter:o,view:s,signal:u}=e,c=(0,g.DW)(a),d=(0,g.Rv)(a),p=n?.some(g.OW),f=a.attributes.map((e=>({field:e.field,label:e.label,valueExpression:e.valueExpression,valueExpressionTitle:e.valueExpressionTitle}))),m=await I({layer:t,attributes:f,outlineOptimizationEnabled:c,sizeOptimizationEnabled:d,includeSizeVariable:p,forBinning:i,filter:o,view:s,signal:u});return{...e,creatorParameters:m,renderer:a}}(e),{layer:o,outlineOptimizationEnabled:s,includeSizeVariable:u,sizeOptimizationEnabled:c}=r,d=await O(r),p=d?.scheme?.sizeScheme,[f,m,b]=await Promise.all([s?(0,h.A)({layer:o,view:a,signal:n,filter:t}).catch(w.ou):null,u?$(r,p):null,!u&&c?(0,y.default)({layer:o,view:a,signal:n,filter:t}).catch(w.ou):null]),v=o.geometryType;if(m&&(F(m,c,v),(0,g.ke)(i,m?.visualVariables,g.Jy),(0,g.Hj)(i,m?.authoringInfo,"size")),f?.visualVariables?.length){const e=f.visualVariables.map((e=>e.clone())).filter((e=>"color"!==e.type&&"rotation"!==e.type));(0,g.ke)(i,e,g._i)}return b?.minSize&&(A(b,v),(0,g.ke)(i,b?.minSize,g.kc)),{renderer:i}}function F(e,r,a){r||e.visualVariables.forEach((e=>{"number"==typeof e.minSize&&"number"==typeof e.maxSize&&(e.minSize*=2.5,e.maxSize*=1.8)})),r&&"point"===a&&e.visualVariables.forEach((e=>{e?.minSize&&"object"==typeof e.minSize&&e.minSize?.stops?.forEach((e=>{e.size*=1.8}))}))}function A(e,r){"point"===r&&e.minSize.stops?.forEach((e=>{e.size*=2.5})),"polygon"===r&&e.minSize.stops?.forEach((e=>{e.size*=1.8}))}const R=new Set(["unique-value","class-breaks"]),P=new n.default("#aaaaaa"),L=new n.default("#5c5c5c"),M=[new n.default("#e60049"),new n.default("#0bb4ff"),new n.default("#50e991"),new n.default("#e6d800"),new n.default("#9b19f5"),new n.default("#ffa300"),new n.default("#dc0ab4"),new n.default("#b3d4ff"),new n.default("#00bfa0"),new n.default("#f0cccc")];async function _(e){const r=await async function(e){if(!e||!e.layer)throw new l.default("pie-chart-cluster-renderer:missing-parameters","'layer' parameter is required");const r={...e};r.shape=r.shape||"pie",r.defaultSymbolEnabled??=!0;const a=e.layer;if(!(0,V.nn)(T).includes(a.type))throw new l.default("pie-chart-cluster-renderer:invalid-parameters","'layer' must be one of these types: "+(0,V.Ho)(T).join(", "));const n=null!=r.signal?{signal:r.signal}:null;if(await a.load(n),"point"!==a.geometryType)throw new l.default("pie-chart-cluster-renderer:invalid-parameters","Cluster renderers are only supported for point layers");const t="renderer"in a?a.renderer:void 0;if(!t)throw new l.default("pie-chart-cluster-renderer:invalid-parameters","input layer does not have a renderer.");if(!R.has(t.type))throw new l.default("pie-chart-cluster-renderer:invalid-parameters",`Cannot create a pie chart renderer for clusters based on a ${t.type} renderer.`);if("valueExpression"in t&&t.valueExpression)throw new l.default("pie-chart-cluster-renderer:invalid-parameters","Cannot create a pie chart renderer for clusters from a layer whose renderer contains a valueExpression.");if("unique-value"===t.type){if(t.field2)throw new l.default("pie-chart-cluster-renderer:invalid-parameters","Cannot create a pie chart renderer for clusters from a UniqueValueRenderer using more than one field.");if(null!=t.uniqueValueInfos&&t.uniqueValueInfos.length>10)throw new l.default("pie-chart-cluster-renderer:invalid-parameters","PieChart cluster renderer cannot be created from a UniqueValueRenderer with more than 10 unique value infos.")}if("class-breaks"===t.type){if(t.classBreakInfos.length<2)throw new l.default("pie-chart-cluster-renderer:invalid-parameters","Cannot create a pie chart renderer for clusters from a layer renderer with a continuous color or size gradient.");if(t.classBreakInfos.length>10)throw new l.default("pie-chart-cluster-renderer:invalid-parameters","PieChart cluster renderer can not be created from a ClassBreaksRenderer with more than 10 class break infos.");if("class-breaks-size"===t?.authoringInfo?.type)throw new l.default("pie-chart-cluster-renderer:invalid-parameters","PieChart cluster renderer can not be created from a ClassBreaksRenderer with breaks varied by size instead of color.")}return r}(e),{layer:a,shape:n,defaultSymbolEnabled:t,legendOptions:o}=r,f="renderer"in a?a.renderer:void 0,h=(await(0,s.ud)("esri/smartMapping/t9n/smartMapping")).other;let y=[];"unique-value"===f?.type&&(y=function(e){const{renderer:r,defaultSymbolEnabled:a,defaultLabelBackup:n}=e,{field:t,defaultSymbol:l,defaultLabel:o}=r,s=r.uniqueValueInfos??[],d=l&&a,p=d?9:10,f=(0,i.Iy)(M,p),m=(t?s.slice(0,p).map(((e,r)=>{const a=e.label,n=f[r];return{field:new u.default({name:j(e.value?.toString()),alias:a,onStatisticExpression:new c.default({title:`Field definition - ${a}`,expression:H(t,e),returnType:"number"}),statisticType:"sum"}),color:J(e.symbol,n)}})):null)??[];if(d){const e="cluster_default",r=o||n;m.push({field:new u.default({name:j(e),alias:r,onStatisticExpression:new c.default({title:`Field definition - ${r}`,expression:W(t,s),returnType:"number"}),statisticType:"sum"}),color:J(l,L)})}return m}({renderer:f,defaultSymbolEnabled:t,defaultLabelBackup:h})),"class-breaks"===f?.type&&(y=function(e){const{renderer:r,defaultSymbolEnabled:a,defaultLabelBackup:n}=e,{field:t,classBreakInfos:l,defaultSymbol:o,defaultLabel:s}=r,d=o&&a,p=d?9:10,f=(0,i.Iy)(M,p),m=l.slice(0,p).map(((e,r)=>{const a=e.label||`${e.minValue} - ${e.maxValue}`,n=f[r];return{field:new u.default({name:j(a),alias:a,onStatisticExpression:new c.default({title:`Field definition - ${a}`,expression:D(t,e),returnType:"number"}),statisticType:"sum"}),color:J(e.symbol,n)}}));if(d){const e="cluster_default",r=s||n;m.push({field:new u.default({name:j(e),alias:r,onStatisticExpression:new c.default({title:`Field definition - ${r}`,expression:G(t,l),returnType:"number"}),statisticType:"sum"}),color:J(o,L)})}return m}({renderer:f,defaultSymbolEnabled:t,defaultLabelBackup:h}));const b=[],g=[];for(const i of y){const{field:e,color:r}=i;b.push(e),g.push(new p.default({color:r,field:e.name,label:e.alias}))}return{fields:b,renderer:new d.default({attributes:g,legendOptions:m.A.from(o),holePercentage:"donut"===n?.45:0,outline:null,size:9,othersCategory:null})}}function j(e){return"SUM_"+(e+"").replaceAll(/[^a-zA-Z0-9_]/g,"_")}function J(e,r){if("simple-marker"===e?.type&&e.color)return e.color.clone();if("cim"===e?.type){const r=(0,k.getCIMSymbolColor)(e);if(r)return r.clone()}return r?r.clone():P.clone()}function H(e,r){return`Number(Text($feature["${e}"]) == "${r.value+""}")`}function W(e,r){return`Number(!(${r.map((r=>`(Text($feature["${e}"]) == "${r.value+""}")`)).join(" || ")}))`}function D(e,r){return`Number($feature["${e}"] >= ${r.minValue} && $feature["${e}"] < ${r.maxValue})`}function G(e,r){return`Number(!(${r.map((r=>`($feature["${e}"] >= ${r.minValue} && $feature["${e}"] < ${r.maxValue})`)).join(" || ")}))`}},40663:(e,r,a)=>{a.d(r,{AC:()=>t,DW:()=>s,Hj:()=>z,Ih:()=>h,Jy:()=>d,OW:()=>b,Rv:()=>u,UJ:()=>o,_i:()=>c,d8:()=>f,fs:()=>p,kc:()=>m,ke:()=>v,mE:()=>i,wx:()=>l});var n=a(74719);async function t(e,r){const{layer:a,view:t,forBinning:i,filter:l}=e;if(!a||!t)throw new n.default(`${r}:missing-parameters`,"'layer' and 'view' parameters are required");await a.load();const o="featureReduction"in a?a.featureReduction:null;if(i){if("binning"!==o?.type)throw new n.default(`${r}:invalid-parameters`,"'layer' must have 'featureReduction' property defined with 'binning' type when 'forBinning' parameter is true");if(l)throw new n.default(`${r}:invalid-parameters`,"'filter' parameter is not supported when 'forBinning' parameter is true")}return e}async function i(e){const{layer:r,forBinning:a,renderer:t}=e;await r.load();const i="featureReduction"in r?r.featureReduction:null,l=t?.clone()??(a&&"binning"===i?.type?i?.renderer?.clone():"renderer"in r?r.renderer?.clone():null);if(!l)throw new n.default("get-renderer-to-update:invalid-parameters","renderer not available");return l}function l(e,r,a){const n=e?.authoringInfo?.visualVariables;return n?.find((e=>"reference-size"===a?e.type===r&&"reference-size"===e.theme:e.type===r))}function o(e){if(!e)return null;const r=e.type,a="visualVariables"in e?e.visualVariables:null,n=a?.find(h),t=a?.find(b),i=e.authoringInfo,o=l(e,"color"),s=l(e,"size"),u=l(e,"size","reference-size");if("class-breaks"===r){if("univariate-color-size"===i?.type)return"univariate-color-size";if(n)return t?s?.units?"color-size-age":o?.units?"color-age-size":"color-size":o?.units?"color-age":u?"color-size":"color-continuous";if(t)return s?.units?"size-age":"size-continuous";if(e.classBreakInfos.length>1)return"class-breaks-color"===i?.type?"color-class-breaks":"class-breaks-size"===i?.type?"size-class-breaks":null;if(u)return"size-continuous"}return"unique-value"===r?e.valueExpression?"predominance"===i?.type?"predominance":"relationship"===i?.type?t||u?"relationship-size":"relationship":t||u?"type-size":"type":t?s?.units?"type-size-age":"type-size":u?"type-size":"type":"pie-chart"===r?"pie-chart":"dot-density"===r?"dot-density":null}function s(e){return!!e.visualVariables?.some(g)}function u(e){return!!e.visualVariables?.some(w)}function c(e){return e?.findIndex(g)??-1}function d(e){return e?.findIndex(b)??-1}function p(e){return e?.findIndex(h)??-1}function f(e){return e?.findIndex(y)??-1}function m(e){return e?.findIndex(w)??-1}function h(e){return"color"===e.type}function y(e){return"opacity"===e.type}function b(e){return"size"===e.type&&"outline"!==e.target&&"$view.scale"!==e.valueExpression}function g(e){return"size"===e.type&&"outline"===e.target}function w(e){return"size"===e.type&&"$view.scale"===e.valueExpression&&"outline"!==e.target&&Array.isArray(e.stops)}function v(e,r,a){const n=e.visualVariables,t=a(n);if(!r||Array.isArray(r)&&!r.length)return;Array.isArray(r)||(r=[r]);const i=r.map((e=>e.clone()));n?t>-1?n.splice(t,1,...i):n.push(...i):e.visualVariables=i}function z(e,r,a){const n=r?.visualVariables.find((e=>e.type===a)),t=l(e,a);t&&n&&(t.minSliderValue=n.minSliderValue,t.maxSliderValue=n.maxSliderValue,"size"===a&&"reference-size"===t.theme&&(t.sizeStops=n.sizeStops?.map((e=>e.clone())),t.referenceSizeScale=n.referenceSizeScale))}},76118:(e,r,a)=>{a.r(r),a.d(r,{default:()=>o});var n=a(74719),t=a(70934),i=a(85151),l=a(2938);async function o(e){const{layerAdapter:r,...a}=await async function(e){if(!(e&&e.layer&&e.view&&e.fields))throw new n.default("predominant-categories:missing-parameters","'layer', 'view' and 'fields' parameters are required");e.forBinning&&(0,i.p)(e,"predominant-categories");const{layer:r,...a}=e,o=e.forBinning?l.Mi:l.G3,s=(0,l.Jg)(r,o,e.forBinning);if(!s)throw new n.default("predominant-categories:invalid-parameters","'layer' must be one of these types: "+(0,l.Ho)(o).join(", "));const u={layerAdapter:s,...a};await Promise.all([u.view.when(),s.load({signal:u.signal})]);const c=(0,t.MH)(s,u.fields,"predominant-categories:invalid-parameters");if(c)throw c;return u}(e);return r.predominantCategories(a)}}}]);