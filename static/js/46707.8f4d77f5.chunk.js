"use strict";(self.webpackChunkever_wading_birds=self.webpackChunkever_wading_birds||[]).push([[26463,46707],{46707:(e,t,s)=>{s.r(t),s.d(t,{default:()=>L});var a=s(93800),r=s(32195),i=s(13248),n=s(23060),l=s(62631),o=s(74719),d=s(93633),u=s(19455),p=s(82301),c=s(81933),y=s(49959),f=s(48602),h=(s(21265),s(50925),s(14800)),m=s(75269),b=s(48844),g=s(93321),v=s(44486),I=s(78865),w=s(62652),_=s(78308),S=s(78076),E=s(31072),T=s(34587),A=s(85866),M=s(88272),F=s(10193),R=s(96059),V=s(43103);function C(e){return Array.isArray(e)?e.join(","):""}var D=s(74331),O=s(29757);function Z(e,t){const s=t.id;return{id:s,name:t.name,url:`${e}/${s}`,type:t.type||"Table"}}function k(e){return{isDataVersioned:(0,D.Vf)(e,"hasVersionedData",!1),isDataBranchVersioned:(0,D.Vf)(e,"hasBranchVersionedData",!1)}}function P(e,t){const s=e?e.toLowerCase().split(",").map((e=>e.trim())):[],a=s.includes("query"),r=s.includes("editing")&&!t.datesInUnknownTimezone;let i=r&&s.includes("create"),n=r&&s.includes("delete"),l=r&&s.includes("update");return r&&!(i||n||l)&&(i=n=l=!0),{supportsAdd:i,supportsDelete:n,supportsEditing:r,supportsChangeTracking:s.includes("changetracking"),supportsQuery:a,supportsQueryDataElements:(0,D.Vf)(t,"supportsQueryDataElements",!1),supportsQueryDomains:(0,D.Vf)(t,"supportsQueryDomains",!1),supportsQueryContingentValues:(0,D.Vf)(t,"supportsQueryContingentValues",!1),supportsSync:s.includes("sync"),supportsUpdate:l}}function U(e){return{maxRecordCountFactor:(0,D.kz)(e,"maxRecordCountFactor",void 0),maxRecordCount:(0,D.kz)(e,"maxRecordCount",void 0)}}function j(e){const t=e?.advancedEditingCapabilities;return{supportsAsyncApplyEdits:(0,D.Vf)(t,"supportsAsyncApplyEdits",!1),supportsGlobalId:(0,D.Vf)(e,"supportsApplyEditsWithGlobalIds",!1),supportsReturnServiceEditsInSourceSpatialReference:(0,D.Vf)(t,"supportsReturnServiceEditsInSourceSR",!1),supportsSharedTemplates:(0,D.Vf)(e,"hasSharedTemplates",!1),supportsSplit:(0,D.Vf)(t,"supportsSplit",!1)}}function q(e){const t=e?.syncCapabilities,s=t?.supportedSyncDataOptions;return{supportsAsync:(0,D.Vf)(t,"supportsAsync",!1),supportedSyncDataOptions:{annotations:!(1&~s),dimensions:!(2&~s),contingentValues:!(4&~s),attributeRules:!(8&~s),utilityNetworkSystem:!(16&~s),annotationFullModel:!(32&~s),include3DObjects:!(64&~s),utilityNetworkMissingLayers:!(128&~s),preserveTrueCurves:!(256&~s)}}}let N=class extends(u.A.JSONSupportMixin(d.A.IdentifiableMixin(c.A))){constructor(e){super(e),this.url=null,this.sourceJSON=null,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1,this.userTypeExtensions=[],this.layerInfos=null,this.tableInfos=null,this.capabilities=null}read(e,t){this.sourceJSON=e,super.read(e,t)}get utilityNetworkUrl(){if(this.sourceJSON)for(const e of this.sourceJSON.layers)if("Utility Network Layer"===e.type)return`${this.url}/${e.id}`;return null}get versionManagementServiceUrl(){return this.sourceJSON?.hasBranchVersionedData&&!(0,M.$E)(this.url)?this.url.replace(/\/FeatureServer/i,"/VersionManagementServer"):null}readLayerInfos(e,t){return(t.layers||[]).map((e=>{const{type:t,geometryType:s}=e;return{...Z(this.url,e),type:t||"Feature Layer",geometryType:s}}))}readTableInfos(e,t){return(t.tables||[]).map((e=>Z(this.url,e)))}readCapabilities(e,t){return function(e){return{data:k(e),sync:q(e),operations:P(e.capabilities,e),query:U(e),editing:j(e)}}(t)}get effectiveCapabilities(){const e=this.capabilities;if(!e)return null;const t=(0,p.clone)(e),{operations:s}=t;return this.userHasUpdateItemPrivileges?(s.supportsAdd=s.supportsDelete=s.supportsEditing=s.supportsQuery=s.supportsUpdate=!0,t):(this.userHasFullEditingPrivileges&&s.supportsEditing&&(s.supportsAdd=s.supportsDelete=s.supportsUpdate=!0),t)}load(e){return this.addResolvingPromise(this._fetchService(this.url,e).then((()=>this._setUserPrivileges(e)))),Promise.resolve(this)}async fetchAllLayersAndTables(e){return await this.load(e),this._fetchLayersAndTablesPromise||=this._fetchLayersAndTables(this.url),(0,y.throwIfAborted)(e),this._fetchLayersAndTablesPromise}async applyEdits(e,t){let s=null;try{const{results:a,edits:r,editedFeatures:i}=await this._internalApplyEdits(e,t),n=e=>e.filter((e=>!e.error)).map(p.clone);let l=0;return a.map((e=>{s=(0,w.Zk)(this.url,e.id,t?.gdbVersion,!0);const a={edits:r[l],addedFeatures:n(e.addFeatureResults),updatedFeatures:n(e.updateFeatureResults),deletedFeatures:n(e.deleteFeatureResults),addedAttachments:n(e.addAttachmentResults),updatedAttachments:n(e.updateAttachmentResults),deletedAttachments:n(e.deleteAttachmentResults),exceededTransferLimit:!1,historicMoment:e.editMoment?new Date(e.editMoment):null};l+=1,i.length>0&&(a.editedFeatures=i),s.resolve(a),s=null})),a}catch(a){throw s&&s.reject(a),a}}async querySharedTemplates(e){const t={...e?.query};return null==t.layers&&null==t.templateIds&&(t.layers=this.layerInfos.map((e=>e.id))),(await async function(e){let{serviceUrl:t,query:s,requestOptions:a={}}=e;if(null==s.layers&&null==s.templateIds)throw new o.default("query-shared-templates:invalid-parameters","Must supply a value for either the 'layers' or the 'templateIds' parameters");const r=(0,V.join)(t,"sharedTemplates","query"),i={f:"json",...a.query,...s};i.layers&&(i.layers=C(i.layers)),i.templateIds&&(i.templateIds=C(i.templateIds)),i.tags&&(i.tags=C(i.tags));const l={...a,responseType:"json",query:i};return(await(0,n.default)(r,l)).data.templates}({serviceUrl:this.url,query:t,requestOptions:e?.requestOptions})).map((e=>{const t=b.default.fromJSON(e);return t.featureService=this,t}))}async _setUserPrivileges(e){if(r.default.userPrivilegesApplied)try{const{features:{fullEdit:t},content:{updateItem:s}}=await this._fetchUserPrivileges(this.sourceJSON.serviceItemId,e);this._set("userHasFullEditingPrivileges",t),this._set("userHasUpdateItemPrivileges",s)}catch(t){(0,y.throwIfAbortError)(t)}}async _fetchUserPrivileges(e,t){const s=!0,a=!1,r=!1;if(!e)return{features:{edit:s,fullEdit:a},content:{updateItem:r}};let n,l,o;try{n=await(0,S.wI)(this.url,t)}catch(d){(0,y.throwIfAbortError)(d)}try{const e=null!=t?t.signal:null;l=await(i.id?.getCredential(`${n}/sharing`,{prompt:!1,signal:e}))}catch(d){(0,y.throwIfAbortError)(d)}if(!l)return{features:{edit:s,fullEdit:a},content:{updateItem:r}};try{if(o=new T.default({id:e,portal:{url:n}}),await o.load(t),o.portal.user)return(0,A.It)(o)}catch(d){(0,y.throwIfAbortError)(d)}return{features:{edit:s,fullEdit:a},content:{updateItem:r}}}async _internalApplyEdits(e,t){await(0,_.W1)(this.url);const s=t?.globalIdUsed??!1,a=g.default.fromJSON(this.sourceJSON.spatialReference),{edits:r,options:i}=await this._processApplyEditsParams(e,t),o=await Promise.all(r.map((async e=>{const t=e.addFeatures?.map((e=>(0,v.jR)({spatialReference:a},e,null)))??[],r=(await Promise.all(t)).filter(l.Ru),i=r.length>0?r:null,n=e.updateFeatures?.map((e=>(0,v.jR)({spatialReference:a},e,null)))??[],o=(await Promise.all(n)).filter(l.Ru),d=o.length>0?o:null,u=(0,v.TG)(e.identifierFields,e.deleteFeatures,s),p=u.length>0?u:null;(0,R.u)(i,d,a);const c=await(0,v.ZI)(e.identifierFields,e);let y=null;return c&&(y={adds:c.adds.length>0?c.adds:void 0,updates:c.updates.length>0?c.updates:void 0,deletes:c.deletes.length>0?c.deletes:void 0}),{id:e.id,adds:i,updates:d,deletes:p,attachments:y}}))),d={gdbVersion:i?.gdbVersion,rollbackOnFailure:!0,useGlobalIds:s,returnEditMoment:!0,honorSequenceOfEdits:i?.honorSequenceOfEdits,usePreviousEditMoment:i?.usePreviousEditMoment,returnServiceEditsInSourceSR:!1,returnServiceEditsOption:"originalAndCurrentFeatures",async:!1};await(0,O.ZJ)(this.url,t?.gdbVersion,!0);const u=(0,O.w5)(this.url,t?.gdbVersion||null);d.edits=JSON.stringify(o);const p=(0,F.Dl)(this.url),c=(0,F.jV)(p.query,{query:(0,F.lF)({...d,f:"json"}),method:"post"});let y;u&&(c.authMode="immediate",c.query.sessionId=O.TA);try{y=await(0,n.default)(this.url+"/applyEdits",c)}catch(f){if(!(0,v.F0)(f))throw f;c.authMode="immediate",y=await(0,n.default)(this.url+"/applyEdits",c)}return{...J(y),edits:r}}async _processApplyEditsParams(e,t){const s={...t,usingFeatureServiceEndpoint:!0};return{edits:await Promise.all(e.map((async e=>{const t=this.effectiveCapabilities,a=e&&(e.addFeatures||e.updateFeatures||e.deleteFeatures),r=e&&(e.addAttachments||e.updateAttachments||e.deleteAttachments);if((0,I.pz)(e,t,s,!!a,!!r,"feature-service"),!t.data.isDataVersioned&&s?.gdbVersion)throw new o.default("feature-service:invalid-parameter","'gdbVersion' is applicable only if the layer supports versioned data. See: 'capabilities.data.isDataVersioned'");const i=(0,I.Tj)(e,t,"feature-service");return{...await(0,I.Gm)(i),id:e.id,identifierFields:e.identifierFields}}))),options:s}}async _fetchService(e,t){if(this.sourceJSON)return void this.read(this.sourceJSON,{url:(0,F.Dl)(e)});const s=await(0,n.default)(e,{responseType:"json",query:{f:"json"},...t});this.read(s.data,{url:(0,F.Dl)(e)})}async _fetchLayersAndTables(e){const t=`${e}/layers`,s=await(0,n.default)(t,{responseType:"json",query:{f:"json"}});return{layers:s.data.layers.map((e=>{const{type:t,geometryType:s}=e,a=Z(this.url,e),r=(0,E.S)(e,a.url);return{...a,type:t||"Feature Layer",geometryType:s,capabilities:r}})),tables:s.data.tables.map((e=>{const t=Z(this.url,e),s=(0,E.S)(e,t.url);return{...t,capabilities:s}}))}}};function J(e){const t=e.data,s=[];return{results:t.map((e=>{const t={addResults:e.addResults??[],updateResults:e.updateResults??[],deleteResults:e.deleteResults??[],attachments:e.attachments,editMoment:e.editMoment},a=(0,v.mP)(t),r=e.editedFeatures,i=r?.spatialReference?new g.default({wkid:r?.spatialReference.wkid,wkt:r?.spatialReference.wkt,latestWkid:r?.spatialReference.latestWkid,latestVcsWkid:r?.spatialReference.latestVcsWkid,vcsWkid:r?.spatialReference.vcsWkid}):null,n=r?(0,v.pX)(r,i):null;return n&&s.push({layerId:e.id,editedFeatures:n}),{id:e.id,editedFeatures:n,...a}})),editedFeatures:s}}(0,a._)([(0,f.MZ)()],N.prototype,"url",void 0),(0,a._)([(0,f.MZ)()],N.prototype,"sourceJSON",void 0),(0,a._)([(0,f.MZ)()],N.prototype,"userHasFullEditingPrivileges",void 0),(0,a._)([(0,f.MZ)()],N.prototype,"userHasUpdateItemPrivileges",void 0),(0,a._)([(0,f.MZ)({readOnly:!0})],N.prototype,"utilityNetworkUrl",null),(0,a._)([(0,f.MZ)({readOnly:!0})],N.prototype,"versionManagementServiceUrl",null),(0,a._)([(0,f.MZ)()],N.prototype,"userTypeExtensions",void 0),(0,a._)([(0,f.MZ)({json:{read:{source:["layers"]}}})],N.prototype,"layerInfos",void 0),(0,a._)([(0,h.w)("layerInfos",["layers"])],N.prototype,"readLayerInfos",null),(0,a._)([(0,f.MZ)({json:{read:{source:["tables"]}}})],N.prototype,"tableInfos",void 0),(0,a._)([(0,h.w)("tableInfos",["tables"])],N.prototype,"readTableInfos",null),(0,a._)([(0,f.MZ)({readOnly:!0,json:{read:{source:["hasVersionedData","hasSharedTemplates","hasBranchVersionedData","capabilities","supportsQueryDataElements","supportsQueryDomains","supportsQueryContingentValues","maxRecordCountFactor","maxRecordCount","advancedEditingCapabilities","supportsApplyEditsWithGlobalIds","syncCapabilities","datesInUnknownTimezone"]}}})],N.prototype,"capabilities",void 0),(0,a._)([(0,h.w)("capabilities",["hasVersionedData","hasSharedTemplates","hasBranchVersionedData","capabilities","supportsQueryDataElements","supportsQueryDomains","supportsQueryContingentValues","maxRecordCountFactor","maxRecordCount","advancedEditingCapabilities","supportsApplyEditsWithGlobalIds","syncCapabilities","datesInUnknownTimezone"])],N.prototype,"readCapabilities",null),(0,a._)([(0,f.MZ)({readOnly:!0})],N.prototype,"effectiveCapabilities",null),N=(0,a._)([(0,m.$)("esri.rest.featureService.FeatureService")],N);const L=N},48844:(e,t,s)=>{s.r(t),s.d(t,{default:()=>u});var a=s(93800),r=s(19455),i=s(48602),n=(s(21265),s(50925),s(14746),s(14800)),l=s(75269),o=s(78067);let d=class extends r.A{constructor(e){super(e),this.type="feature",this.templateId=null,this.defaultTool=null,this.description=null,this.globalId="",this.hash="",this.layerIds=[],this.name="",this.subtypeCode=null,this.status=null,this.userIdentity=null,this.tags=[],this.visible=!0}readThumbnail(e){return null==e||""===e?null:{contentType:"png",imageData:e,height:64,width:64}}readDefaultTool(e){return null==e?null:o.T.fromJSON(e.toLowerCase())}readLayerIds(e,t){return null!=t.layerIds?t.layerIds.split(",").map((e=>parseInt(e.trim(),10))):null!=t.layerId?[t.layerId]:[]}readTags(e,t){const s=t.tag;return null==s?[]:s.split(";").map((e=>e.trim()))}};(0,a._)([(0,i.MZ)()],d.prototype,"type",void 0),(0,a._)([(0,i.MZ)({json:{read:!1,write:!1}})],d.prototype,"featureService",void 0),(0,a._)([(0,i.MZ)()],d.prototype,"thumbnail",void 0),(0,a._)([(0,n.w)("thumbnail")],d.prototype,"readThumbnail",null),(0,a._)([(0,i.MZ)()],d.prototype,"templateId",void 0),(0,a._)([(0,i.MZ)()],d.prototype,"defaultTool",void 0),(0,a._)([(0,n.w)("defaultTool")],d.prototype,"readDefaultTool",null),(0,a._)([(0,i.MZ)()],d.prototype,"description",void 0),(0,a._)([(0,i.MZ)()],d.prototype,"globalId",void 0),(0,a._)([(0,i.MZ)()],d.prototype,"hash",void 0),(0,a._)([(0,i.MZ)()],d.prototype,"layerIds",void 0),(0,a._)([(0,n.w)("layerIds",["layerIds","layerId"])],d.prototype,"readLayerIds",null),(0,a._)([(0,i.MZ)()],d.prototype,"name",void 0),(0,a._)([(0,i.MZ)({json:{name:"subtype"}})],d.prototype,"subtypeCode",void 0),(0,a._)([(0,i.MZ)()],d.prototype,"status",void 0),(0,a._)([(0,i.MZ)()],d.prototype,"userIdentity",void 0),(0,a._)([(0,i.MZ)()],d.prototype,"tags",void 0),(0,a._)([(0,n.w)("tags",["tag"])],d.prototype,"readTags",null),(0,a._)([(0,i.MZ)()],d.prototype,"visible",void 0),d=(0,a._)([(0,l.$)("esri.editing.sharedTemplates.SharedTemplateMetadata")],d);const u=d},78067:(e,t,s)=>{s.d(t,{T:()=>a});const a=new(s(42761).J)({"{acd53634-cbc7-44d5-bde9-692fa8d45850}":"autocomplete-freehand-polygons","{6f5fc612-d1ef-4d32-a2e1-18a1cb22331c}":"autocomplete-polygons","{09c6f589-a3ce-48ab-81bc-46965c58f264}":"circle","{bccf295a-9c64-4adc-903e-62d827c10ef7}":"create-points-along-line","{756cadf6-91e6-04b1-2938-e172a97af51c}":"create-structures","{ddbe4c0c-063f-8b60-b2da-b349a1e42e84}":"difference-polygon","{a5f4db5f-4a6b-29bd-1f32-9d81bf262c76}":"elevation-point-from-contour","{285ec4bb-60a8-7184-2088-5bee2149f2a4}":"elevation-point-from-dem","{28c04532-3daf-4d3d-b7be-a589c9c9a03e}":"ellipse","{0a7c16b9-1cfd-467f-8ece-6ba376192431}":"freehand","{af2dbf8f-280e-44db-8860-e399d0b30cf1}":"line","{bc485127-2ea2-4c8b-85ef-e8237959eb64}":"multipoint","{d304243a-5c3a-4ccc-b98b-93684b15fd83}":"parcel-seed","{2a8b3331-5238-4025-972e-452a69535b06}":"point","{d376f8e5-69e0-4273-9478-724e9e0d81ac}":"point-and-rotation","{93ce7077-f09e-455e-ade7-b7413cddc393}":"point-at-end-of-line","{8f79967b-66a0-4a1c-b884-f44bc7e26921}":"polygon","{a947ba80-1c29-4bcd-8672-1963b7b9dde0}":"radial-line","{6f0ed2cc-c099-4895-bd7e-beec2f78adbf}":"rectangle","{a281e635-0f22-47d4-a438-e4d29b920e22}":"regular-polygon","{5664cae4-c7de-432a-9933-9586bc15ed39}":"regular-polyline","{c5c42e29-44da-4a1c-8688-e02c07535bc3}":"right-angle-line","{ee16991b-6303-4a8a-9143-1914b2010c1a}":"right-angle-polygon","{7d3e17cf-30dd-4593-9bd8-0b2b8770f52a}":"split","{e00209dd-05c5-4424-be62-51581f9f811d}":"stream-line","{6c6970a7-5ca9-448c-9c7d-0d716cd2ac64}":"stream-polygon","{e22f7d98-007d-427c-8282-13704f7c84c3}":"trace","{6cf59352-8e14-402c-8f4c-ed72647f5e42}":"two-point-line"})}}]);