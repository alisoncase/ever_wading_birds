"use strict";(self.webpackChunkever_wading_birds=self.webpackChunkever_wading_birds||[]).push([[71716],{14406:(e,t,l)=>{l.d(t,{A:()=>p});var s=l(93800),n=l(6946),r=l(62631),i=l(89129),a=l(40736),o=l(49959),u=l(48602),d=(l(21265),l(50925),l(75269)),h=l(87321),c=l(59072);let f=class extends n.default{constructor(e){super(e),this.state="disabled",this._valueBeforeReady=null,this._domainInfo=(0,c.$m)([]),this._loadLayers=(0,h.P)(),this.layers=new i.default}initialize(){this.addHandles(this.layers.on("change",(()=>this._onLayersChange()))),this._onLayersChange()}destroy(){this._set("state","disabled")}get enabled(){return this.allowedValues.length>0&&this._get("enabled")}set enabled(e){e!==this.enabled&&this.allowedValues.length>0&&this._set("enabled",e)}get value(){return("ready"===this.state?this._get("value"):this._valueBeforeReady)??0}set value(e){if("ready"!==this.state)return void(this._valueBeforeReady=e);if(e===this.value)return;const t=(0,c.IM)(e,this);null!=t&&this._set("value",t)}get min(){return(0,c.pg)(this.allowedValues)}get max(){return(0,c.Lu)(this.allowedValues)}get allowedValues(){return this._domainInfo.allowedValues}set allowedValues(e){null==e?this._clearOverride("allowedValues"):this._override("allowedValues",e);const t=(0,c.IM)(this.value,this);null!=t&&(this.value=t)}get hasNext(){if(!this.enabled)return!0;const e=this._valueIndex;return e>=0&&e<this.allowedValues.length-1}get hasPrevious(){return!this.enabled||this._valueIndex>0}set layers(e){const t=this._get("layers");this._set("layers",(0,a.V)(e,t))}get filterExpressions(){return{solid:null,xRay:null}}get _valueIndex(){return(0,r.FQ)(this.allowedValues,this.value)}select(e){"ready"===this.state?null!=(0,c.IM)(e,this)&&(this.enabled=!0,this.value=e):this._valueBeforeReady=e}clear(){"ready"===this.state?this.enabled=!1:this._valueBeforeReady=null}next(){const{state:e,allowedValues:t,enabled:l,hasNext:s,_valueIndex:n}=this;if("ready"===e||null==this._valueBeforeReady){if(0!==t.length)return l?void(s&&(this.value=t[n+1])):(this.enabled=!0,void(this.value=t[0]))}else this._valueBeforeReady++}previous(){const{state:e,allowedValues:t,enabled:l,hasPrevious:s,_valueIndex:n}=this;if("ready"===e||null==this._valueBeforeReady){if(0!==t.length)return l?void(s&&(this.value=t[n-1])):(this.enabled=!0,void(this.value=t[t.length-1]))}else this._valueBeforeReady++}getValueLabel(e){return 0===this.layers.length?null:this._domainInfo.fieldValueMap.get(e)??null}async _onLayersChange(){if(this._set("state","loading"),this._domainInfo=(0,c.$m)([]),0!==this.layers.length)try{await this._loadLayers(this.layers),this._setup()}catch(e){(0,o.isAbortError)(e)||this._set("state","failed")}}};(0,s._)([(0,u.MZ)({value:!1,nonNullable:!0})],f.prototype,"enabled",null),(0,s._)([(0,u.MZ)({nonNullable:!0})],f.prototype,"value",null),(0,s._)([(0,u.MZ)({readOnly:!0})],f.prototype,"min",null),(0,s._)([(0,u.MZ)({readOnly:!0})],f.prototype,"max",null),(0,s._)([(0,u.MZ)()],f.prototype,"allowedValues",null),(0,s._)([(0,u.MZ)({readOnly:!0})],f.prototype,"hasNext",null),(0,s._)([(0,u.MZ)({readOnly:!0})],f.prototype,"hasPrevious",null),(0,s._)([(0,u.MZ)({type:i.default,nonNullable:!0})],f.prototype,"layers",null),(0,s._)([(0,u.MZ)({nonNullable:!0})],f.prototype,"state",void 0),(0,s._)([(0,u.MZ)()],f.prototype,"_valueBeforeReady",void 0),(0,s._)([(0,u.MZ)({readOnly:!0})],f.prototype,"_valueIndex",null),(0,s._)([(0,u.MZ)()],f.prototype,"_domainInfo",void 0),f=(0,s._)([(0,d.$)("esri.widgets.BuildingExplorer.BuildingNumericFilterViewModel")],f);const p=f},19033:(e,t,l)=>{l.d(t,{BJ:()=>a,Cb:()=>i,tV:()=>n});const s=e=>t=>{const l=e.toLowerCase();return t.sublayers.find((e=>e.modelName?.toLowerCase()===l))??null},n=s("fullmodel"),r=s("overview");function i(e){const t=n(e);null!=t&&(t.visible=!0);const l=r(e);null!=l&&(l.visible=!1)}function a(e,t){const l=function(e,t){const l=e.summaryStatistics?.fields??[],s=t.toLowerCase();return l.find((e=>e.modelName?.toLowerCase()===s))??null}(e,t);if(null==l)return null;const s=l.fieldName;if(null==s||!s)return null;const n=function(e,t){for(const l of e.allSublayers.items){const e="building-component"===l.type?l.getFieldDomain?.(t):null;if(e&&"coded-value"===e.type)return e}return null}(e,s),r=new Map;for(const i of l.mostFrequentValues??[])"number"==typeof i&&r.set(i,null!=n?n.getName(i):String(i));return{fieldName:s,fieldValueMap:r}}},20461:(e,t,l)=>{l.d(t,{A:()=>m});var s,n=l(93800),r=l(19455),i=l(82301),a=l(48602),o=(l(21265),l(50925),l(75269)),u=l(38387),d=l(97720),h=l(47332),c=l(54811);let f=s=class extends u.A{constructor(){super(...arguments),this.type="wire-frame",this.edges=null}clone(){return new s({edges:(0,i.clone)(this.edges)})}};(0,n._)([(0,h.e)({wireFrame:"wire-frame"})],f.prototype,"type",void 0),(0,n._)([(0,a.MZ)(c.J)],f.prototype,"edges",void 0),f=s=(0,n._)([(0,o.$)("esri.layers.support.BuildingFilterModeWireFrame")],f);const p=f;var y,_=l(45687);const v={nonNullable:!0,types:{key:"type",base:u.A,typeMap:{solid:d.A,"wire-frame":p,"x-ray":_.A}},json:{read:e=>{switch(e?.type){case"solid":return d.A.fromJSON(e);case"wireFrame":return p.fromJSON(e);case"x-ray":return _.A.fromJSON(e);default:return}},write:{enabled:!0,isRequired:!0}}};let g=y=class extends r.A{constructor(){super(...arguments),this.filterExpression=null,this.filterMode=new d.A,this.title=""}clone(){return new y({filterExpression:this.filterExpression,filterMode:(0,i.clone)(this.filterMode),title:this.title})}};(0,n._)([(0,a.MZ)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],g.prototype,"filterExpression",void 0),(0,n._)([(0,a.MZ)(v)],g.prototype,"filterMode",void 0),(0,n._)([(0,a.MZ)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],g.prototype,"title",void 0),g=y=(0,n._)([(0,o.$)("esri.layers.support.BuildingFilterBlock")],g);const m=g},38387:(e,t,l)=>{l.d(t,{A:()=>o});var s=l(93800),n=l(19455),r=l(48602),i=(l(21265),l(50925),l(14746),l(75269));let a=class extends n.A{};(0,s._)([(0,r.MZ)({readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],a.prototype,"type",void 0),a=(0,s._)([(0,i.$)("esri.layers.support.BuildingFilterMode")],a);const o=a},45687:(e,t,l)=>{l.d(t,{A:()=>u});var s,n=l(93800),r=l(48602),i=(l(21265),l(50925),l(14746),l(75269)),a=l(38387);let o=s=class extends a.A{constructor(){super(...arguments),this.type="x-ray"}clone(){return new s}};(0,n._)([(0,r.MZ)({type:["x-ray"],readOnly:!0,json:{write:{isRequired:!0}}})],o.prototype,"type",void 0),o=s=(0,n._)([(0,i.$)("esri.layers.support.BuildingFilterModeXRay")],o);const u=o},45732:(e,t,l)=>{l.d(t,{PE:()=>d,Z4:()=>o,gK:()=>h,r$:()=>f,wI:()=>c});var s=l(12130),n=l(20461),r=l(97720),i=l(45687);const a="__BUILDING_EXPLORER_FILTER__";function o(){return`${(0,s.lk)()}${a}`}function u(e){const t="string"==typeof e?e:e.id;return!!t&&t.includes(a)}function d(e,t){for(const l of e.items)for(const e of l.filters.items){if(!u(e))continue;const l=t(e);if(null!=l)return l}return null}function h(e,t){e.forEach((e=>{const l=e.filters.filter((e=>!u(e)));null!=t&&l.push(t),function(e,t){const l=t.length;if(null==e||e.length!==l)return!1;for(let s=0;s<l;++s){const l=t.at(s).toJSON(),n=e.at(s).toJSON();if(l.id="",n.id="",JSON.stringify(l)!==JSON.stringify(n))return!1}return!0}(e.filters,l)||(e.filters=l);const s=e.filters.find((e=>u(e)));e.activeFilterId=null!=s?s.id:null}))}function c(e){const t=p(e);return t?new n.A({filterExpression:t,filterMode:new i.A}):null}function f(e){const t=p(e);return t?new n.A({filterExpression:t,filterMode:new r.A}):null}function p(e){return e.filter((e=>!!e)).map((e=>`(${e})`)).join(" AND ")}},59072:(e,t,l)=>{function s(e){const t={fieldValueMap:new Map,allowedValues:[]};for(const l of e){const e=l.fieldValueMap,s=t.fieldValueMap;e.forEach(((e,l)=>{s.has(l)||(s.set(l,e),t.allowedValues.push(l))}))}return t.allowedValues.sort(((e,t)=>e-t)),t}function n(e){let t=null;for(const l of e)t=null!=t?Math.min(t,l):l;return t}function r(e){let t=null;for(const l of e)t=null!=t?Math.max(t,l):l;return t}function i(e,t){return t.allowedValues.length>0?function(e,t){if(0===t.length)return e;if(e===1/0)return t[t.length-1];if(e===-1/0)return t[0];let l=t[0],s=Math.abs(l-e);for(const n of t){const t=Math.abs(n-e);t<s&&(l=n,s=t)}return l}(e,t.allowedValues):null}l.d(t,{$m:()=>s,IM:()=>i,Lu:()=>r,pg:()=>n})},71716:(e,t,l)=>{l.r(t),l.d(t,{default:()=>h});var s=l(93800),n=l(48602),r=(l(21265),l(50925),l(14746),l(75269)),i=l(14406),a=l(19033),o=l(45732),u=l(59072);let d=class extends i.A{constructor(e){super(e),this._createdPhaseFieldName=null,this._demolishedPhaseFieldName=null,this._parseValueFromFilter=e=>{const t=this._createdPhaseFieldName,l=new RegExp(`${t}\\s*<=\\s*(\\d+)\\s*OR\\s*${t}\\s*IS\\s*NULL`,"gi"),s=this._demolishedPhaseFieldName,n=new RegExp(`${s}\\s*>\\s*(\\d+)\\s*OR\\s*${s}\\s*IS\\s*NULL`,"gi");for(const{filterExpression:r}of e.filterBlocks?.items??[]){const e=r?l.exec(r)??n.exec(r):null;if(e)return parseInt(e[1],10)}return null}}get filterExpressions(){if(!this.enabled)return{solid:null,xRay:null};const e=[],t=this._createdPhaseFieldName;t&&e.push(`(${t} <= ${this.value} OR ${t} IS NULL)`);const l=this._demolishedPhaseFieldName;l&&e.push(`(${l} > ${this.value} OR ${l} IS NULL)`);const s=e.join(" AND ");return{solid:s,xRay:s}}get _lastValue(){const e=this.allowedValues;return e.length>0?e[e.length-1]:0}_setup(){const e=[];this.layers.forEach((t=>{const l=(0,a.BJ)(t,"createdphase");null!=l&&(this._createdPhaseFieldName=l.fieldName,e.push(l));const s=(0,a.BJ)(t,"demolishedphase");null!=s&&(this._demolishedPhaseFieldName=s.fieldName,e.push(s))})),this._domainInfo=(0,u.$m)(e);const t=this._valueBeforeReady;if(this._set("state","ready"),this._valueBeforeReady=null,this.allowedValues.length>0){const e=t??(0,o.PE)(this.layers,this._parseValueFromFilter);this.select(e??this._lastValue)}else this.clear()}};(0,s._)([(0,n.MZ)({readOnly:!0})],d.prototype,"filterExpressions",null),(0,s._)([(0,n.MZ)()],d.prototype,"_createdPhaseFieldName",void 0),(0,s._)([(0,n.MZ)()],d.prototype,"_demolishedPhaseFieldName",void 0),(0,s._)([(0,n.MZ)({readOnly:!0})],d.prototype,"_lastValue",null),d=(0,s._)([(0,r.$)("esri.widgets.BuildingExplorer.BuildingPhase")],d);const h=d},87321:(e,t,l)=>{l.d(t,{P:()=>n});var s=l(49959);function n(){let e=new AbortController;return async t=>{e.abort(),e=new AbortController;const l={signal:e.signal},n=t.toArray().map((e=>async function(e,t){await e.load(t),await e.loadAll(),(0,s.throwIfAborted)(t),e.summaryStatistics&&await e.summaryStatistics.load(t)}(e,l)));await Promise.all(n),(0,s.throwIfAborted)(l)}}},97720:(e,t,l)=>{l.d(t,{A:()=>u});var s,n=l(93800),r=l(48602),i=(l(21265),l(50925),l(14746),l(75269)),a=l(38387);let o=s=class extends a.A{constructor(){super(...arguments),this.type="solid"}clone(){return new s}};(0,n._)([(0,r.MZ)({type:["solid"],readOnly:!0,json:{write:{isRequired:!0}}})],o.prototype,"type",void 0),o=s=(0,n._)([(0,i.$)("esri.layers.support.BuildingFilterModeSolid")],o);const u=o}}]);