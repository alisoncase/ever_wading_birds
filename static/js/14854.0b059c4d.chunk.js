"use strict";(self.webpackChunkever_wading_birds=self.webpackChunkever_wading_birds||[]).push([[14854,75204],{826:(e,t,o)=>{o.d(t,{n:()=>n});o(21265);var r=o(73031);class n{constructor(e,t,o,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(this.name=e,this.type=t,this.arraySize=i,this.bind={[r.c.Bind]:null,[r.c.Pass]:null,[r.c.Draw]:null},n)switch(o){case void 0:break;case r.c.Bind:this.bind[r.c.Bind]=n;break;case r.c.Pass:this.bind[r.c.Pass]=n;break;case r.c.Draw:this.bind[r.c.Draw]=n}}equals(e){return this.type===e.type&&this.name===e.name&&this.arraySize===e.arraySize}}},6513:(e,t,o)=>{o.d(t,{E7:()=>g,gP:()=>r,s0:()=>n,zP:()=>x});var r,n,i,s=o(88242),a=o(16213),l=o(31500),d=o(42162),u=o(8815),c=o(57554),p=o(16878),f=o(91018),y=o(80203),h=o(38950),m=o(81775),v=o(22131);function g(e,t){const o=e.vertex;o.include(d.W),e.include(a.Y,t);const{silhouette:r,legacy:n,spherical:i}=t;o.uniforms.add(new m.o("componentDataTex",(e=>e.componentDataTexture))),e.attributes.add(v.r.COMPONENTINDEX,"float");o.constants.add("lineWidthFractionFactor","float",8),o.constants.add("extensionLengthOffset","float",128),o.code.add(p.H`
    vec2 _componentTextureCoords(float componentIndex, float fieldOffset) {
      float fieldIndex = ${p.H.float(3)}  * componentIndex + fieldOffset;
      float texSize = float(textureSize(componentDataTex, 0).x);
      float colIndex = mod(fieldIndex, texSize);
      float rowIndex = floor(fieldIndex / texSize);

      return vec2(colIndex, rowIndex) + 0.5;
    }

    struct ComponentData {
      vec4 color;
      vec3 normal;
      vec3 normal2;
      float lineWidth;
      float extensionLength;
      float type;
      float verticalOffset;
    };

    ComponentData readComponentData() {
      vec2 colorIndex = _componentTextureCoords(componentIndex, ${p.H.float(0)});
      vec2 otherIndex = _componentTextureCoords(componentIndex, ${p.H.float(1)});
      vec2 verticalOffsetIndex = _componentTextureCoords(float(componentIndex), ${p.H.float(2)} );
      vec3 normal = normalModel();
      vec3 normal2 = ${r?p.H`decompressNormal(normal2Compressed)`:p.H`normal`};

      vec4 colorValue = texelFetch(componentDataTex, ivec2(colorIndex), 0);
      vec4 otherValue = texelFetch(componentDataTex, ivec2(otherIndex), 0);
      float verticalOffset = uninterpolatedRGBAToFloat(texelFetch(componentDataTex, ivec2(verticalOffsetIndex), 0)) * ${p.H.float(s.Hi)};

      return ComponentData(
        vec4(colorValue.rgb, colorValue.a * otherValue.w), // otherValue.w stores separate opacity
        normal, normal2,
        otherValue.x * (255.0 / ${p.H.float(8)} ),
        otherValue.y * 255.0 - ${p.H.float(128)},
        -(otherValue.z * 255.0) + 0.5, // SOLID (=0/255) needs to be > 0.0, SKETCHY (=1/255) needs to be <= 0;
        verticalOffset
      );
    }
  `),n?o.code.add(p.H`vec3 _modelToWorldNormal(vec3 normal) {
return (model * vec4(normal, 0.0)).xyz;
}
vec3 _modelToViewNormal(vec3 normal) {
return (localView * model * vec4(normal, 0.0)).xyz;
}`):(o.uniforms.add(new f.h("transformNormalGlobalFromModel",(e=>e.transformNormalGlobalFromModel))),o.code.add(p.H`vec3 _modelToWorldNormal(vec3 normal) {
return transformNormalGlobalFromModel * normal;
}`)),r?(e.attributes.add(v.r.NORMAL2COMPRESSED,"vec2"),o.code.add(p.H`vec3 worldNormal(ComponentData data) {
return _modelToWorldNormal(normalize(data.normal + data.normal2));
}`)):o.code.add(p.H`vec3 worldNormal(ComponentData data) {
return _modelToWorldNormal(data.normal);
}`),n?o.code.add(p.H`void worldAndViewFromModelPosition(vec3 modelPos, float verticalOffset, out vec3 worldPos, out vec3 viewPos) {
worldPos = (model * vec4(modelPos, 1.0)).xyz;
viewPos = (localView * vec4(worldPos, 1.0)).xyz;
}`):(o.include(l.u,t),o.uniforms.add(new y.k("transformViewFromCameraRelativeRS",(e=>e.transformViewFromCameraRelativeRS)),new f.h("transformWorldFromModelRS",(e=>e.transformWorldFromModelRS)),new u.W("transformWorldFromModelTL",(e=>e.transformWorldFromModelTL)),new u.W("transformWorldFromModelTH",(e=>e.transformWorldFromModelTH)),new c.t("transformWorldFromViewTL",(e=>e.transformWorldFromViewTL)),new c.t("transformWorldFromViewTH",(e=>e.transformWorldFromViewTH))),o.code.add(p.H`
      void worldAndViewFromModelPosition(vec3 modelPos, float verticalOffset, out vec3 worldPos, out vec3 viewPos) {
        vec3 rotatedModelPosition = transformWorldFromModelRS * modelPos;

        vec3 transformCameraRelativeFromModel = dpAdd(
          transformWorldFromModelTL,
          transformWorldFromModelTH,
          -transformWorldFromViewTL,
          -transformWorldFromViewTH
        );

        worldPos = transformCameraRelativeFromModel + rotatedModelPosition;

        if (verticalOffset != 0.0) {
          vec3 vUp = ${i?"normalize(transformWorldFromModelTL + rotatedModelPosition);":"vec3(0.0, 0.0, 1.0);"}
          worldPos += verticalOffset * vUp;
        }

        viewPos = transformViewFromCameraRelativeRS * worldPos;
      }
    `)),o.uniforms.add(new h.F("transformProjFromView",(e=>e.camera.projectionMatrix))).code.add(p.H`vec4 projFromViewPosition(vec3 position) {
return transformProjFromView * vec4(position, 1.0);
}`),o.code.add(p.H`float calculateExtensionLength(float extensionLength, float lineLength) {
return extensionLength / (log2(max(1.0, 256.0 / lineLength)) * 0.2 + 1.0);
}`)}function x(e){return e===r.Sketch||e===r.Mixed}(i=r||(r={}))[i.Solid=0]="Solid",i[i.Sketch=1]="Sketch",i[i.Mixed=2]="Mixed",i[i.COUNT=3]="COUNT",function(e){e[e.REGULAR=0]="REGULAR",e[e.SILHOUETTE=1]="SILHOUETTE"}(n||(n={}))},7757:(e,t,o)=>{var r;o.d(t,{x:()=>r}),function(e){e[e.TRANSPARENT=0]="TRANSPARENT",e[e.OPAQUE=1]="OPAQUE"}(r||(r={}))},8815:(e,t,o)=>{o.d(t,{W:()=>i});var r=o(73031),n=o(826);class i extends n.n{constructor(e,t){super(e,"vec3",r.c.Draw,((o,r,n,i)=>o.setUniform3fv(e,t(r,n,i))))}}},13473:(e,t,o)=>{function r(){return[1,0,0,0,1,0,0,0,1]}function n(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]}function i(e,t,o,r,n,i,s,a,l){return[e,t,o,r,n,i,s,a,l]}o.d(t,{fA:()=>i,o8:()=>n,vt:()=>r,zK:()=>s});const s=[1,0,0,0,1,0,0,0,1];Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:s,clone:n,create:r,createView:function(e,t){return new Float64Array(e,t,9)},fromValues:i},Symbol.toStringTag,{value:"Module"}))},15173:(e,t,o)=>{o.d(t,{T:()=>i,U:()=>n});var r=o(64682);function n(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const n=(0,r.qE)(e,0,l);for(let r=0;r<4;r++)t[o+r]=Math.floor(256*d(n*s[r]))}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=0;for(let r=0;r<4;r++)o+=e[t+r]*a[r];return o}const s=[1,256,65536,16777216],a=[1/256,1/65536,1/16777216,1/4294967296],l=i(new Uint8ClampedArray([255,255,255,255]));function d(e){return e-Math.floor(e)}},16213:(e,t,o)=>{o.d(t,{W:()=>r,Y:()=>l});var r,n,i=o(7951),s=o(16878),a=o(22131);function l(e,t){switch(t.normalType){case r.Compressed:e.attributes.add(a.r.NORMALCOMPRESSED,"vec2"),e.vertex.code.add(s.H`vec3 decompressNormal(vec2 normal) {
float z = 1.0 - abs(normal.x) - abs(normal.y);
return vec3(normal + sign(normal) * min(z, 0.0), z);
}
vec3 normalModel() {
return decompressNormal(normalCompressed);
}`);break;case r.Attribute:e.attributes.add(a.r.NORMAL,"vec3"),e.vertex.code.add(s.H`vec3 normalModel() {
return normal;
}`);break;case r.ScreenDerivative:e.fragment.code.add(s.H`vec3 screenDerivativeNormal(vec3 positionView) {
return normalize(cross(dFdx(positionView), dFdy(positionView)));
}`);break;default:(0,i.Xb)(t.normalType);case r.COUNT:}}(n=r||(r={}))[n.Attribute=0]="Attribute",n[n.Compressed=1]="Compressed",n[n.ScreenDerivative=2]="ScreenDerivative",n[n.COUNT=3]="COUNT"},16878:(e,t,o)=>{function r(e){let t="";for(let o=0;o<(arguments.length<=1?0:arguments.length-1);o++)t+=e[o]+(o+1<1||arguments.length<=o+1?void 0:arguments[o+1]);return t+=e[e.length-1],t}function n(e,t){return e?t:arguments.length>2&&void 0!==arguments[2]?arguments[2]:""}o.d(t,{H:()=>r,If:()=>n}),function(e){e.int=function(e){return Math.round(e).toString()},e.float=function(e){return e.toPrecision(8)}}(r)},18162:(e,t,o)=>{o.d(t,{F:()=>i});o(96913);var r=o(93321),n=o(31183);function i(e,t,o,r,i){return!(null==t||null==r||e.length<2)&&(s.x=e[0],s.y=e[1],s.z=e[2],s.spatialReference=t,(0,n.g)(s,o,r,i))}const s=(0,o(62240).T)(0,0,0,r.default.WGS84)},18444:(e,t,o)=>{o.d(t,{L0:()=>v,Ot:()=>f,W4:()=>l,uV:()=>c});var r=o(93800),n=o(19455),i=o(48602),s=(o(21265),o(50925),o(14746),o(47332)),a=o(75269);let l=class extends n.A{constructor(){super(...arguments),this.nodesPerPage=null,this.rootIndex=0,this.lodSelectionMetricType=null}};(0,r._)([(0,i.MZ)({type:Number})],l.prototype,"nodesPerPage",void 0),(0,r._)([(0,i.MZ)({type:Number})],l.prototype,"rootIndex",void 0),(0,r._)([(0,i.MZ)({type:String})],l.prototype,"lodSelectionMetricType",void 0),l=(0,r._)([(0,a.$)("esri.layers.support.I3SLayerDefinitions.I3SNodePageDefinition")],l);let d=class extends n.A{constructor(){super(...arguments),this.factor=1}};(0,r._)([(0,i.MZ)({type:Number,json:{read:{source:"textureSetDefinitionId"}}})],d.prototype,"id",void 0),(0,r._)([(0,i.MZ)({type:Number})],d.prototype,"factor",void 0),d=(0,r._)([(0,a.$)("esri.layers.support.I3SLayerDefinitions.I3SMaterialTexture")],d);let u=class extends n.A{constructor(){super(...arguments),this.baseColorFactor=[1,1,1,1],this.baseColorTexture=null,this.metallicRoughnessTexture=null,this.metallicFactor=1,this.roughnessFactor=1}};(0,r._)([(0,i.MZ)({type:[Number]})],u.prototype,"baseColorFactor",void 0),(0,r._)([(0,i.MZ)({type:d})],u.prototype,"baseColorTexture",void 0),(0,r._)([(0,i.MZ)({type:d})],u.prototype,"metallicRoughnessTexture",void 0),(0,r._)([(0,i.MZ)({type:Number})],u.prototype,"metallicFactor",void 0),(0,r._)([(0,i.MZ)({type:Number})],u.prototype,"roughnessFactor",void 0),u=(0,r._)([(0,a.$)("esri.layers.support.I3SLayerDefinitions.I3SMaterialPBRMetallicRoughness")],u);let c=class extends n.A{constructor(){super(...arguments),this.alphaMode="opaque",this.alphaCutoff=.25,this.doubleSided=!1,this.cullFace="none",this.normalTexture=null,this.occlusionTexture=null,this.emissiveTexture=null,this.emissiveFactor=null,this.pbrMetallicRoughness=null}};(0,r._)([(0,s.e)({opaque:"opaque",mask:"mask",blend:"blend"})],c.prototype,"alphaMode",void 0),(0,r._)([(0,i.MZ)({type:Number})],c.prototype,"alphaCutoff",void 0),(0,r._)([(0,i.MZ)({type:Boolean})],c.prototype,"doubleSided",void 0),(0,r._)([(0,s.e)({none:"none",back:"back",front:"front"})],c.prototype,"cullFace",void 0),(0,r._)([(0,i.MZ)({type:d})],c.prototype,"normalTexture",void 0),(0,r._)([(0,i.MZ)({type:d})],c.prototype,"occlusionTexture",void 0),(0,r._)([(0,i.MZ)({type:d})],c.prototype,"emissiveTexture",void 0),(0,r._)([(0,i.MZ)({type:[Number]})],c.prototype,"emissiveFactor",void 0),(0,r._)([(0,i.MZ)({type:u})],c.prototype,"pbrMetallicRoughness",void 0),c=(0,r._)([(0,a.$)("esri.layers.support.I3SLayerDefinitions.I3SMaterialDefinition")],c);let p=class extends n.A{};(0,r._)([(0,i.MZ)({type:String,json:{read:{source:["name","index"],reader:(e,t)=>null!=e?e:`${t.index}`}}})],p.prototype,"name",void 0),(0,r._)([(0,s.e)({jpg:"jpg",png:"png",dds:"dds","ktx-etc2":"ktx-etc2",ktx2:"ktx2",basis:"basis"})],p.prototype,"format",void 0),p=(0,r._)([(0,a.$)("esri.layers.support.I3SLayerDefinitions.I3STextureFormat")],p);let f=class extends n.A{constructor(){super(...arguments),this.atlas=!1}};(0,r._)([(0,i.MZ)({type:[p]})],f.prototype,"formats",void 0),(0,r._)([(0,i.MZ)({type:Boolean})],f.prototype,"atlas",void 0),f=(0,r._)([(0,a.$)("esri.layers.support.I3SLayerDefinitions.I3STextureSetDefinition")],f);let y=class extends n.A{};(0,r._)([(0,s.e)({Float32:"Float32",UInt64:"UInt64",UInt32:"UInt32",UInt16:"UInt16",UInt8:"UInt8"})],y.prototype,"type",void 0),(0,r._)([(0,i.MZ)({type:Number})],y.prototype,"component",void 0),y=(0,r._)([(0,a.$)("esri.layers.support.I3SLayerDefinitions.I3SGeometryAttribute")],y);let h=class extends n.A{};(0,r._)([(0,s.e)({draco:"draco"})],h.prototype,"encoding",void 0),(0,r._)([(0,i.MZ)({type:[String]})],h.prototype,"attributes",void 0),h=(0,r._)([(0,a.$)("esri.layers.support.I3SLayerDefinitions.I3SGeometryCompressedAttributes")],h);let m=class extends n.A{constructor(){super(...arguments),this.offset=0}};(0,r._)([(0,i.MZ)({type:Number})],m.prototype,"offset",void 0),(0,r._)([(0,i.MZ)({type:y})],m.prototype,"position",void 0),(0,r._)([(0,i.MZ)({type:y})],m.prototype,"normal",void 0),(0,r._)([(0,i.MZ)({type:y})],m.prototype,"uv0",void 0),(0,r._)([(0,i.MZ)({type:y})],m.prototype,"color",void 0),(0,r._)([(0,i.MZ)({type:y})],m.prototype,"uvRegion",void 0),(0,r._)([(0,i.MZ)({type:y})],m.prototype,"featureId",void 0),(0,r._)([(0,i.MZ)({type:y})],m.prototype,"faceRange",void 0),(0,r._)([(0,i.MZ)({type:h})],m.prototype,"compressedAttributes",void 0),m=(0,r._)([(0,a.$)("esri.layers.support.I3SLayerDefinitions.I3SGeometryBuffer")],m);let v=class extends n.A{};(0,r._)([(0,s.e)({triangle:"triangle"})],v.prototype,"topology",void 0),(0,r._)([(0,i.MZ)()],v.prototype,"geometryBuffers",void 0),v=(0,r._)([(0,a.$)("esri.layers.support.I3SLayerDefinitions.I3SGeometryDefinition")],v)},18498:(e,t,o)=>{o.d(t,{A:()=>i});var r=o(44873),n=o(16878);function i(e){e.vertex.code.add(n.H`
    vec4 decodeSymbolColor(vec4 symbolColor, out int colorMixMode) {
      float symbolAlpha = 0.0;

      const float maxTint = 85.0;
      const float maxReplace = 170.0;
      const float scaleAlpha = 3.0;

      if (symbolColor.a > maxReplace) {
        colorMixMode = ${n.H.int(r.k5.Multiply)};
        symbolAlpha = scaleAlpha * (symbolColor.a - maxReplace);
      } else if (symbolColor.a > maxTint) {
        colorMixMode = ${n.H.int(r.k5.Replace)};
        symbolAlpha = scaleAlpha * (symbolColor.a - maxTint);
      } else if (symbolColor.a > 0.0) {
        colorMixMode = ${n.H.int(r.k5.Tint)};
        symbolAlpha = scaleAlpha * symbolColor.a;
      } else {
        colorMixMode = ${n.H.int(r.k5.Multiply)};
        symbolAlpha = 0.0;
      }

      return vec4(symbolColor.r, symbolColor.g, symbolColor.b, symbolAlpha);
    }
  `)}},19983:(e,t,o)=>{o.d(t,{E5:()=>a,JU:()=>s,Of:()=>n,Uk:()=>i,WK:()=>l,g7:()=>d,lO:()=>u,lQ:()=>c});var r=o(74719);function n(e){return e&&"function"==typeof e.highlight}function i(e){return e&&"function"==typeof e.maskOccludee}function s(e,t,o){return null==e||e>=o&&(0===t||e<=t)}function a(e,t){if(t&&e){const{minScale:o,maxScale:r}=e;if(l(o,r))return s(t,o,r)}return!0}function l(e,t){return null!=e&&e>0||null!=t&&t>0}function d(e){return!e?.minScale||!e.maxScale||e.minScale>=e.maxScale}function u(e){return null!=e&&"object"==typeof e&&"createQuery"in e&&"queryFeatures"in e&&"layer"in e&&"view"in e}function c(e,t,o){return new r.default("layerview:spatial-reference-incompatible",`The spatial reference of this ${e}${t?`(wkid:${t})`:""} is incompatible with the spatial reference of the view${o?`(wkid:${o})`:""}.`,{})}},21152:(e,t,o)=>{o.d(t,{V:()=>i});var r=o(73031),n=o(826);class i extends n.n{constructor(e,t){super(e,"vec4",r.c.Draw,((o,r,n)=>o.setUniform4fv(e,t(r,n))))}}},21465:(e,t,o)=>{o.d(t,{$I:()=>v,AU:()=>y,Cr:()=>c,g7:()=>m,i4:()=>u,ui:()=>p,up:()=>x,vt:()=>d,yo:()=>h});var r=o(64682),n=o(87752),i=o(21369),s=o(66509),a=o(89227),l=o(28473);function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x;return[e[0],e[1],e[2],e[3]]}function u(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d();return(0,a.c)(o,e),o[3]=t,o}function c(e,t,o){return(0,a.e)(o,e,t),(0,a.n)(o,o),o[3]=-(0,a.r)(e,t),o}function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d();const o=(0,n.l)(b,e);return g(t,(0,r.KJ)((0,i.Xd)(t,o))),t}function f(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d();return(0,i.x8)(b,e,v(e)),(0,i.x8)(w,t,v(t)),(0,i.lw)(b,w,b),g(o,(0,r.KJ)((0,i.Xd)(o,b)))}function y(e,t,o){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:d();return u(l.Cw,e,I),u(l.JP,t,T),u(l.Cb,o,S),f(I,T,I),f(I,S,r),r}function h(e){return e}function m(e){return e[3]}function v(e){return(0,r.kU)(e[3])}function g(e,t){return e[3]=t,e}const x=[0,0,1,0],b=(0,s.vt)(),w=(0,s.vt)(),I=(d(),d()),T=d(),S=d()},22131:(e,t,o)=>{var r;function n(e){return e===r.POSITION}o.d(t,{b:()=>n,r:()=>r}),function(e){e.POSITION="position",e.NORMAL="normal",e.NORMALCOMPRESSED="normalCompressed",e.UV0="uv0",e.COLOR="color",e.SYMBOLCOLOR="symbolColor",e.SIZE="size",e.ROTATION="rotation",e.TANGENT="tangent",e.OFFSET="offset",e.PERSPECTIVEDIVIDE="perspectiveDivide",e.CENTEROFFSETANDDISTANCE="centerOffsetAndDistance",e.LENGTH="length",e.PREVPOSITION="prevPosition",e.NEXTPOSITION="nextPosition",e.SUBDIVISIONFACTOR="subdivisionFactor",e.COLORFEATUREATTRIBUTE="colorFeatureAttribute",e.SIZEFEATUREATTRIBUTE="sizeFeatureAttribute",e.OPACITYFEATUREATTRIBUTE="opacityFeatureAttribute",e.DISTANCETOSTART="distanceToStart",e.UVMAPSPACE="uvMapSpace",e.BOUNDINGRECT="boundingRect",e.UVREGION="uvRegion",e.PROFILERIGHT="profileRight",e.PROFILEUP="profileUp",e.PROFILEVERTEXANDNORMAL="profileVertexAndNormal",e.FEATUREVALUE="featureValue",e.INSTANCEMODELORIGINHI="instanceModelOriginHi",e.INSTANCEMODELORIGINLO="instanceModelOriginLo",e.INSTANCEMODEL="instanceModel",e.INSTANCEMODELNORMAL="instanceModelNormal",e.INSTANCECOLOR="instanceColor",e.INSTANCEFEATUREATTRIBUTE="instanceFeatureAttribute",e.LOCALTRANSFORM="localTransform",e.GLOBALTRANSFORM="globalTransform",e.BOUNDINGSPHERE="boundingSphere",e.MODELORIGIN="modelOrigin",e.MODELSCALEFACTORS="modelScaleFactors",e.FEATUREATTRIBUTE="featureAttribute",e.STATE="state",e.LODLEVEL="lodLevel",e.POSITION0="position0",e.POSITION1="position1",e.NORMAL2COMPRESSED="normal2Compressed",e.COMPONENTINDEX="componentIndex",e.VARIANTOFFSET="variantOffset",e.VARIANTSTROKE="variantStroke",e.VARIANTEXTENSION="variantExtension",e.SIDENESS="sideness",e.START="start",e.END="end",e.UP="up",e.START_UP="startUp",e.END_UP="endUp",e.EXTRUDE="extrude",e.OBJECTANDLAYERIDCOLOR="objectAndLayerIdColor",e.INSTANCEOBJECTANDLAYERIDCOLOR="instanceObjectAndLayerIdColor"}(r||(r={}))},24589:(e,t,o)=>{o.d(t,{n:()=>n});var r=o(43103);function n(e){return i[function(e){return"json"===e.type?"application/json":"blob"===e.type?e.blob.type:function(e){const t=(0,r.getPathExtension)(e);return l[t]||s}(e.url)}(e)]||a}const i={},s="text/plain",a=i[s],l={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip","bin.gz":"application/octet-stream"};for(const d in l)i[l[d]]=d},31183:(e,t,o)=>{o.d(t,{W:()=>a,g:()=>s});var r=o(28473),n=o(96913),i=o(67093);function s(e,t,o,r){if((0,n.canProjectWithoutEngine)(e.spatialReference,o)){l[0]=e.x,l[1]=e.y;const n=e.z;return l[2]=n??r??0,(0,i.projectBuffer)(l,e.spatialReference,0,t,o,0)}const s=(0,n.tryProjectWithZConversion)(e,o);return!!s&&(t[0]=s?.x,t[1]=s?.y,t[2]=s?.z??r??0,!0)}async function a(e,t,o,r,i){return await(0,n.initializeProjection)(e.spatialReference,o,null,i),s(e,t,o,r)}const l=(0,r.vt)()},31500:(e,t,o)=>{o.d(t,{u:()=>n});var r=o(16878);function n(e,t){let{code:o}=e;t.doublePrecisionRequiresObfuscation?o.add(r.H`vec3 dpPlusFrc(vec3 a, vec3 b) {
return mix(a, a + b, vec3(notEqual(b, vec3(0))));
}
vec3 dpMinusFrc(vec3 a, vec3 b) {
return mix(vec3(0), a - b, vec3(notEqual(a, b)));
}
vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {
vec3 t1 = dpPlusFrc(hiA, hiB);
vec3 e = dpMinusFrc(t1, hiA);
vec3 t2 = dpMinusFrc(hiB, e) + dpMinusFrc(hiA, dpMinusFrc(t1, e)) + loA + loB;
return t1 + t2;
}`):o.add(r.H`vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {
vec3 t1 = hiA + hiB;
vec3 e = t1 - hiA;
vec3 t2 = ((hiB - e) + (hiA - (t1 - e))) + loA + loB;
return t1 + t2;
}`)}},38950:(e,t,o)=>{o.d(t,{F:()=>i});var r=o(73031),n=o(826);class i extends n.n{constructor(e,t){super(e,"mat4",r.c.Bind,((o,r)=>o.setUniformMatrix4fv(e,t(r))))}}},41317:(e,t,o)=>{o.d(t,{$7:()=>A,B:()=>S,Fo:()=>w,M7:()=>E,NN:()=>p,Q5:()=>I,Tq:()=>O,Up:()=>T,XF:()=>F,Ze:()=>v,bK:()=>a,bh:()=>c,id:()=>g,ky:()=>u,qt:()=>_,tW:()=>M,v9:()=>f,w7:()=>l,wF:()=>s,wS:()=>x,wz:()=>h,x:()=>y,xS:()=>b,ze:()=>d});var r=o(84190),n=o(34308);function i(e){return e?_:O}function s(e,t){return t?.mode?t.mode:i(e).mode}function a(e,t){return null!=t?t:i(e)}function l(e,t){return s(null==e||(e.hasZ??!1),t)}function d(e,t){return a(null==e||(e.hasZ??!1),t)}function u(e){const t=m(e);return l(e.geometry,t)}function c(e){const t=m(e),o=l(e.geometry,t),r=null!=t&&"on-the-ground"!==o?E(t):0,n=t?.featureExpressionInfo;return{mode:o,offset:r,featureExpressionInfo:n}}function p(e){return h(c(e))}function f(e){return h(e)||y(e)}function y(e){return"0"===e?.featureExpressionInfo?.expression}function h(e){if(!e)return!1;if("on-the-ground"===e.mode)return!1;const t=e?.featureExpressionInfo?e.featureExpressionInfo.expression:null;return!(!t||"0"===t)}function m(e){return e.layer&&"elevationInfo"in e.layer?e.layer.elevationInfo:null}function v(e,t){if(!e?.offset)return 0;const{offset:o,unit:n}=e;if("decimal-degrees"===n)return 0;const i="unknown"!==n&&n?n:"meters",s=(0,r.mq)(t);return s?(0,r.oU)(o,i,s):0}function g(e,t,o){if(!o?.mode)return;const r=e.hasZ?e.z:0,n=v(o,e.spatialReference);switch(o.mode){case"absolute-height":return r-n;case"on-the-ground":return 0;case"relative-to-ground":return r-((t.elevationProvider.getElevation(e.x,e.y,r,e.spatialReference,"ground")??0)+n);case"relative-to-scene":return r-((t.elevationProvider.getElevation(e.x,e.y,r,e.spatialReference,"scene")??0)+n)}}function x(e,t,o){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return w(e,t.x,t.y,t.hasZ?t.z:0,t.spatialReference,o,r)}function b(e,t,o,r){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return w(e,t[0],t[1],t.length>2?t[2]:0,o,r,n)}function w(e,t,o,r,n,i){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if(null==i)return;const a=null!=s?s.mode:"absolute-height";if("on-the-ground"===a)return 0;const{absoluteZ:l}=I(t,o,r,n,e,i);return function(e,t,o,r,n,i,s,a){const l=v(s,n);switch(a){case"absolute-height":return e-l;case"relative-to-ground":return e-((i.elevationProvider.getElevation(t,o,r,n,"ground")??0)+l);case"relative-to-scene":return e-((i.elevationProvider.getElevation(t,o,r,n,"scene")??0)+l)}}(l,t,o,r,n,e,s,a)}function I(e,t,o,r,n,i){const s=v(i,r);switch(i.mode){case"absolute-height":return{absoluteZ:o+s,elevation:0};case"on-the-ground":{const o=n.elevationProvider.getElevation(e,t,0,r,"ground")??0;return{absoluteZ:o,elevation:o}}case"relative-to-ground":{const i=n.elevationProvider.getElevation(e,t,o,r,"ground")??0;return{absoluteZ:o+i+s,elevation:i}}case"relative-to-scene":{const i=n.elevationProvider.getElevation(e,t,o,r,"scene")??0;return{absoluteZ:o+i+s,elevation:i}}}}function T(e,t){if(null==t)return!1;const{mode:o}=t;return null!=o&&("scene"===e&&"relative-to-scene"===o||"ground"===e&&"absolute-height"!==o)}function S(e,t,o){return o&&o.mode!==t?`${e} only support ${t} elevation mode`:null}function A(e,t,o){return o?.mode===t?`${e} do not support ${t} elevation mode`:null}function M(e,t){return null!=t?.featureExpressionInfo&&"0"!==t.featureExpressionInfo.expression?`${e} do not support featureExpressionInfo`:null}function F(e,t){t&&e.warn(".elevationInfo=",t)}function E(e){return(e?.offset??0)*(0,n.Ao)(e?.unit)}const _={mode:"absolute-height",offset:0},O={mode:"on-the-ground",offset:null}},42162:(e,t,o)=>{o.d(t,{W:()=>n});var r=o(16878);function n(e){e.code.add(r.H`const float MAX_RGBA_FLOAT =
255.0 / 256.0 +
255.0 / 256.0 / 256.0 +
255.0 / 256.0 / 256.0 / 256.0 +
255.0 / 256.0 / 256.0 / 256.0 / 256.0;
const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);
vec4 float2rgba(const float value) {
float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);
vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);
const float toU8AsFloat = 1.0 / 255.0;
return fixedPointU8 * toU8AsFloat;
}`),e.code.add(r.H`const vec4 RGBA_TO_FLOAT_FACTORS = vec4(
255.0 / (256.0),
255.0 / (256.0 * 256.0),
255.0 / (256.0 * 256.0 * 256.0),
255.0 / (256.0 * 256.0 * 256.0 * 256.0)
);
float rgbaTofloat(vec4 rgba) {
return dot(rgba, RGBA_TO_FLOAT_FACTORS);
}`),e.code.add(r.H`const vec4 uninterpolatedRGBAToFloatFactors = vec4(
1.0 / 256.0,
1.0 / 256.0 / 256.0,
1.0 / 256.0 / 256.0 / 256.0,
1.0 / 256.0 / 256.0 / 256.0 / 256.0
);
float uninterpolatedRGBAToFloat(vec4 rgba) {
return (dot(round(rgba * 255.0), uninterpolatedRGBAToFloatFactors) - 0.5) * 2.0;
}`)}},44873:(e,t,o)=>{o.d(t,{Eb:()=>s,_j:()=>a,k5:()=>r});var r,n,i=o(64682);function s(e){switch(e){case"multiply":default:return r.Multiply;case"ignore":return r.Ignore;case"replace":return r.Replace;case"tint":return r.Tint}}function a(e,t,o){if(null==e||t===r.Ignore)return o[0]=255,o[1]=255,o[2]=255,void(o[3]=255);const n=(0,i.qE)(Math.round(e[3]*d),0,d),s=0===n||t===r.Tint?0:t===r.Replace?u:c;o[0]=(0,i.qE)(Math.round(e[0]*l),0,l),o[1]=(0,i.qE)(Math.round(e[1]*l),0,l),o[2]=(0,i.qE)(Math.round(e[2]*l),0,l),o[3]=n+s}(n=r||(r={}))[n.Multiply=1]="Multiply",n[n.Ignore=2]="Ignore",n[n.Replace=3]="Replace",n[n.Tint=4]="Tint";const l=255,d=85,u=d,c=2*d},46751:(e,t,o)=>{o.d(t,{P:()=>f});var r=o(74719),n=o(99521),i=o(10876),s=o(43103),a=o(12130),l=o(54391),d=o(70605),u=o(48602),c=o(24589),p=o(85042);function f(e){const t=e?.origins??[void 0];return(o,r)=>{const n=function(e,t,o){if("resource"===e?.type)return function(e,t,o){const r=(0,l.z4)(t,o);return{type:String,read:(e,t,o)=>{const n=(0,p.r)(e,t,o);return r.type===String?n:"function"==typeof r.type?new r.type({url:n}):void 0},write:{isRequired:r.json?.write?.isRequired,writer(t,n,a,l){if(!l?.resources)return"string"==typeof t?void(n[a]=(0,p.t)(t,l)):void(n[a]=t.write({},l));const u=function(e){return null==e?null:"string"==typeof e?e:e.url}(t),f=(0,p.t)(u,{...l,verifyItemRelativeUrls:l?.verifyItemRelativeUrls?{writtenUrls:l.verifyItemRelativeUrls.writtenUrls,rootPath:void 0}:void 0},p.M.NO),v=r.type!==String&&(!(0,i.H)(this)||l?.origin&&this.originIdOf(o)>(0,d.aB)(l.origin)),g={object:this,propertyName:o,value:t,targetUrl:f,dest:n,targetPropertyName:a,context:l,params:e};l?.portalItem&&f&&!(0,s.isAbsolute)(f)?v&&e?.contentAddressed?y(g):v?function(e){const{context:t,targetUrl:o,params:r,value:n,dest:i,targetPropertyName:a}=e;if(!t.portalItem)return;const l=t.portalItem.resourceFromPath(o),d=m(n,o,t),u=(0,c.n)(d),p=(0,s.getPathExtension)(l.path),f=r?.compress??!1;u===p?(t.resources&&h({...e,resource:l,content:d,compress:f,updates:t.resources.toUpdate}),i[a]=o):y(e)}(g):function(e){let{context:t,targetUrl:o,dest:r,targetPropertyName:n}=e;t.portalItem&&t.resources&&(t.resources.toKeep.push({resource:t.portalItem.resourceFromPath(o),compress:!1}),r[n]=o)}(g):l?.portalItem&&(null==f||null!=(0,p.i)(f)||(0,s.isBlobProtocol)(f)||v)?y(g):n[a]=f}}}}(e,t,o);switch(e?.type??"other"){case"other":return{read:!0,write:!0};case"url":{const{read:e,write:t}=p.b;return{read:e,write:t}}}}(e,o,r);for(const e of t){const t=(0,u.rM)(o,e,r);for(const e in n)t[e]=n[e]}}}function y(e){const{targetUrl:t,params:o,value:i,context:l,dest:d,targetPropertyName:u}=e;if(!l.portalItem)return;const f=(0,p.p)(t),y=m(i,t,l);if(o?.contentAddressed&&"json"!==y.type)return void l.messages?.push(new r.default("persistable:contentAddressingUnsupported",`Property "${u}" is trying to serializing a resource with content of type ${y.type} with content addressing. Content addressing is only supported for json resources.`,{content:y}));const v=o?.contentAddressed&&"json"===y.type?(0,n.d)(y.jsonString):f?.filename??(0,a.lk)(),g=(0,s.join)(o?.prefix??f?.prefix,v),x=`${g}.${(0,c.n)(y)}`;if(o?.contentAddressed&&l.resources&&"json"===y.type){const e=l.resources.toKeep.find((e=>{let{resource:t}=e;return t.path===x}))??l.resources.toAdd.find((e=>{let{resource:t}=e;return t.path===x}));if(e)return void(d[u]=e.resource.itemRelativeUrl)}const b=l.portalItem.resourceFromPath(x);(0,s.isBlobProtocol)(t)&&l.resources&&l.resources.pendingOperations.push((0,s.blobUrlToBlob)(t).then((e=>{b.path=`${g}.${(0,c.n)({type:"blob",blob:e})}`,d[u]=b.itemRelativeUrl})).catch((()=>{})));const w=o?.compress??!1;l.resources&&h({...e,resource:b,content:y,compress:w,updates:l.resources.toAdd}),d[u]=b.itemRelativeUrl}function h(e){let{object:t,propertyName:o,updates:r,resource:n,content:i,compress:s}=e;r.push({resource:n,content:i,compress:s,finish:e=>{!function(e,t,o){"string"==typeof e[t]?e[t]=o.url:e[t].url=o.url}(t,o,e)}})}function m(e,t,o){return"string"==typeof e?{type:"url",url:t}:{type:"json",jsonString:JSON.stringify(e.toJSON(o))}}},49996:(e,t,o)=>{o.d(t,{D8:()=>i,TO:()=>n,d0:()=>s});var r=o(95011);async function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.popupTemplate;if(null==t)return[];const o=await t.getRequiredFields(e.fieldsIndex),{lastEditInfoEnabled:n}=t,{objectIdField:i,typeIdField:s,globalIdField:a,relationships:l}=e;if(o.includes("*"))return["*"];const d=n?(0,r.getFeatureEditFields)(e):[],u=(0,r.fixFields)(e.fieldsIndex,[...o,...d]);return s&&u.push(s),u&&i&&e.fieldsIndex?.has(i)&&!u.includes(i)&&u.push(i),u&&a&&e.fieldsIndex?.has(a)&&!u.includes(a)&&u.push(a),l&&l.forEach((t=>{const{keyField:o}=t;u&&o&&e.fieldsIndex?.has(o)&&!u.includes(o)&&u.push(o)})),u}function i(e,t){return e.popupTemplate?e.popupTemplate:null!=t&&t.defaultPopupTemplateEnabled&&null!=e.defaultPopupTemplate?e.defaultPopupTemplate:null}function s(e,t){return null!=i(e,{defaultPopupTemplateEnabled:t})}},53409:(e,t,o)=>{o.r(t),o.d(t,{default:()=>m});var r,n=o(93800),i=o(19455),s=o(48602),a=(o(21265),o(50925),o(14746),o(75269)),l=o(87752),d=o(10382),u=o(21369),c=o(66509),p=o(28473),f=o(21465);let y=r=class extends i.A{constructor(e){super(e),this.translation=(0,p.vt)(),this.rotationAxis=(0,p.ci)(f.up),this.rotationAngle=0,this.scale=(0,p.fA)(1,1,1)}get rotation(){return(0,f.i4)(this.rotationAxis,this.rotationAngle)}set rotation(e){this.rotationAxis=(0,p.o8)((0,f.yo)(e)),this.rotationAngle=(0,f.g7)(e)}get localMatrix(){const e=(0,d.vt)();return(0,u.x8)(h,(0,f.yo)(this.rotation),(0,f.$I)(this.rotation)),(0,l.o1)(e,h,this.translation,this.scale),e}get localMatrixInverse(){return(0,l.B8)((0,d.vt)(),this.localMatrix)}equals(e){return this===e||null!=e&&(0,l.t2)(this.localMatrix,e.localMatrix)}clone(){const e={translation:(0,p.o8)(this.translation),rotationAxis:(0,p.o8)(this.rotationAxis),rotationAngle:this.rotationAngle,scale:(0,p.o8)(this.scale)};return new r(e)}};(0,n._)([(0,s.MZ)({type:[Number],nonNullable:!0,json:{write:!0}})],y.prototype,"translation",void 0),(0,n._)([(0,s.MZ)({type:[Number],nonNullable:!0,json:{write:!0}})],y.prototype,"rotationAxis",void 0),(0,n._)([(0,s.MZ)({type:Number,nonNullable:!0,json:{write:!0}})],y.prototype,"rotationAngle",void 0),(0,n._)([(0,s.MZ)({type:[Number],nonNullable:!0,json:{write:!0}})],y.prototype,"scale",void 0),(0,n._)([(0,s.MZ)()],y.prototype,"rotation",null),(0,n._)([(0,s.MZ)()],y.prototype,"localMatrix",null),(0,n._)([(0,s.MZ)()],y.prototype,"localMatrixInverse",null),y=r=(0,n._)([(0,a.$)("esri.geometry.support.MeshTransform")],y);const h=(0,c.vt)(),m=y},57554:(e,t,o)=>{o.d(t,{t:()=>i});var r=o(73031),n=o(826);class i extends n.n{constructor(e,t){super(e,"vec3",r.c.Pass,((o,r,n)=>o.setUniform3fv(e,t(r,n))))}}},58873:(e,t,o)=>{o.r(t),o.d(t,{default:()=>I});var r,n=o(93800),i=o(23060),s=o(19455),a=o(82301),l=o(79953),d=o(48602),u=(o(21265),o(50925),o(14800)),c=o(75269),p=o(46751),f=o(89129),y=o(21965),h=(o(14746),o(74719),o(65920)),m=o(96913);let v=r=class extends(s.A.JSONSupportMixin(f.default.ofType(h.default))){constructor(e){super(e)}clone(){return new r(this.items.map((e=>e.clone())))}write(e,t){return this.toJSON(t)}toJSON(e){const t=e?.layer?.spatialReference;return t?this.toArray().map((o=>{if(!t.equals(o.spatialReference)){if(!(0,m.canProjectWithoutEngine)(o.spatialReference,t))return e?.messages?.push(new y.A("scenefilter:unsupported","Scene filters with incompatible spatial references are not supported",{modification:this,spatialReference:e.layer.spatialReference,context:e})),null;const r=new h.default;(0,m.projectPolygon)(o,r,t),o=r}const r=o.toJSON(e);return delete r.spatialReference,r})).filter((e=>null!=e)):(e?.messages?.push(new y.A("scenefilter:unsupported","Writing Scene filters without context layer is not supported",{modification:this,spatialReference:e.layer.spatialReference,context:e})),this.toArray().map((t=>t.toJSON(e))))}static fromJSON(e,t){const o=new r;return e.forEach((e=>o.add(h.default.fromJSON(e,t)))),o}};v=r=(0,n._)([(0,c.$)("esri.layers.support.PolygonCollection")],v);const g=v;var x,b=o(85042);let w=x=class extends s.A{constructor(e){super(e),this.spatialRelationship="disjoint",this.geometries=new g,this._geometriesSource=null}initialize(){this.addHandles((0,l.on)((()=>this.geometries),"after-changes",(()=>this.geometries=this.geometries),l.sync))}readGeometries(e,t,o){Array.isArray(e)?this.geometries=g.fromJSON(e,o):this._geometriesSource={url:(0,b.f)(e,o),context:o}}async loadGeometries(e,t){if(null==this._geometriesSource)return;const{url:o,context:r}=this._geometriesSource,n=await(0,i.default)(o,{responseType:"json",signal:t?.signal}),s=e.toJSON(),a=n.data.map((e=>({...e,spatialReference:s})));this.geometries=g.fromJSON(a,r),this._geometriesSource=null}clone(){const e=new x({geometries:(0,a.clone)(this.geometries),spatialRelationship:this.spatialRelationship});return e._geometriesSource=this._geometriesSource,e}};(0,n._)([(0,d.MZ)({type:["disjoint","contains"],nonNullable:!0,json:{write:{isRequired:!0}}})],w.prototype,"spatialRelationship",void 0),(0,n._)([(0,d.MZ)({type:g,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}}),(0,p.P)({origins:["web-scene","portal-item"],type:"resource",prefix:"geometries",contentAddressed:!0})],w.prototype,"geometries",void 0),(0,n._)([(0,u.w)(["web-scene","portal-item"],"geometries")],w.prototype,"readGeometries",null),w=x=(0,n._)([(0,c.$)("esri.layers.support.SceneFilter")],w);const I=w},62240:(e,t,o)=>{function r(e,t,o,r){return{x:e,y:t,z:o,hasZ:null!=o,hasM:!1,spatialReference:r,type:"point"}}function n(e,t,o,r,n){e.x=t,e.y=o,e.z=r,e.hasZ=null!=r,e.spatialReference=n}o.d(t,{J:()=>n,T:()=>r})},65477:(e,t,o)=>{o.d(t,{Z:()=>i});var r=o(84190),n=o(53409);function i(e){const t=1/(0,r.GA)(e,1);return 1!==t?new n.default({scale:[t,t,t]}):void 0}},65877:(e,t,o)=>{o.d(t,{F:()=>i});var r=o(23060),n=o(74719);async function i(e,t,o,i,s,a,l){let d=null;if(null!=o){const t=`${e}/nodepages/`,n=t+Math.floor(o.rootIndex/o.nodesPerPage);try{return{type:"page",rootPage:(await(0,r.default)(n,{query:{f:"json",...i,token:s},responseType:"json",signal:l})).data,rootIndex:o.rootIndex,pageSize:o.nodesPerPage,lodMetric:o.lodSelectionMetricType,urlPrefix:t}}catch(f){null!=a&&a.warn("#fetchIndexInfo()","Failed to load root node page. Falling back to node documents.",n,f),d=f}}if(!t)return null;const u=t?.split("/").pop(),c=`${e}/nodes/`,p=c+u;try{return{type:"node",rootNode:(await(0,r.default)(p,{query:{f:"json",...i,token:s},responseType:"json",signal:l})).data,urlPrefix:c}}catch(f){throw new n.default("sceneservice:root-node-missing","Root node missing.",{pageError:d,nodeError:f,url:p})}}},73031:(e,t,o)=>{var r;o.d(t,{c:()=>r}),function(e){e[e.Bind=0]="Bind",e[e.Pass=1]="Pass",e[e.Draw=2]="Draw"}(r||(r={}))},74048:(e,t,o)=>{o.d(t,{$:()=>r,P:()=>n});const r={supportsDate:!1,supportsFixedInterval:!1,supportsAutoInterval:!1,supportsFixedBoundaries:!1,supportsStackBy:!1,supportsSplitBy:!1,supportsSnapToData:!1,supportsReturnFullIntervalBin:!1,supportsFirstDayOfWeek:!1,supportsNormalization:!1,supportedStatistics:void 0,supportedNormalizationTypes:void 0},n={analytics:{supportsCacheHint:!1},attachment:{supportsContentType:!1,supportsExifInfo:!1,supportsKeywords:!1,supportsName:!1,supportsSize:!1,supportsCacheHint:!1,supportsOrderByFields:!1,supportsResize:!1},data:{isVersioned:!1,isBranchVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:!1},editing:{supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsGeometryUpdate:!1,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsAsyncApplyEdits:!1,zDefault:void 0},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:!1,supportsDelete:!1,supportsEditing:!1,supportsChangeTracking:!1,supportsQuery:!1,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryBins:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:!1,supportsExceedsLimitStatistics:!1,supportsAsyncConvert3D:!1},queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},queryAttributeBins:r,query:{maxRecordCount:0,maxRecordCountFactor:0,standardMaxRecordCount:0,supportsCacheHint:!1,supportsCentroid:!1,supportsCompactGeometry:!1,supportsCurrentUser:!1,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsDisjointSpatialRelationship:!1,supportsDistance:!1,supportsDistinct:!1,supportsExtent:!1,supportsFormatPBF:!1,supportsGeometryProperties:!1,supportsHavingClause:!1,supportsHistoricMoment:!1,supportsMaxRecordCountFactor:!1,supportsOrderBy:!1,supportsPagination:!1,supportsPercentileStatistics:!1,supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryByAnonymous:!1,supportsQueryByOthers:!1,supportsQueryGeometry:!1,supportsResultType:!1,supportsReturnMesh:!1,supportsSqlExpression:!1,supportsStandardizedQueriesOnly:!1,supportsTopFeaturesQuery:!1,supportsTrueCurve:!1,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsStatistics:!1,tileMaxRecordCount:0}}},74217:(e,t,o)=>{o.d(t,{$1:()=>d,H2:()=>f,MT:()=>y,VP:()=>h,WF:()=>u,Wt:()=>s,XQ:()=>m,hK:()=>p,nS:()=>c,uh:()=>a,xY:()=>l});var r=o(74719);const n="upload-assets",i=()=>new Error;class s extends r.default{constructor(){super(`${n}:unsupported`,"Layer does not support asset uploads.",i())}}class a extends r.default{constructor(){super(`${n}:no-glb-support`,"Layer does not support glb.",i())}}class l extends r.default{constructor(){super(`${n}:no-supported-source`,"No supported external source found",i())}}class d extends r.default{constructor(){super(`${n}:not-base-64`,"Expected gltf data in base64 format after conversion.",i())}}class u extends r.default{constructor(){super(`${n}:unable-to-prepare-options`,"Unable to prepare uploadAsset request options.",i())}}class c extends r.default{constructor(e,t){super(`${n}:bad-response`,`Bad response. Uploaded ${e} items and received ${t} results.`,i())}}class p extends r.default{constructor(e,t){super(`${n}-layer:upload-failed`,`Failed to upload mesh file ${e}. Error code: ${t?.code??"-1"}. Error message: ${t?.messages??"unknown"}`,i())}}class f extends r.default{constructor(e){super(`${n}-layer:unsupported-format`,`The service allowed us to upload an asset of FormatID ${e}, but it does not list it in its supported formats.`,i())}}class y extends r.default{constructor(){super(`${n}:convert3D-failed`,"convert3D failed.")}}class h extends r.default{constructor(){super("invalid-input:no-model","No supported model found")}}class m extends r.default{constructor(){super("invalid-input:multiple-models","Multiple supported models found")}}},75918:(e,t,o)=>{o.r(t),o.d(t,{default:()=>be});var r=o(93800),n=o(79625),i=o(35377),s=o(85715),a=o(89129),l=o(74719),d=o(50925),u=o(17741),c=o(59321),p=o(49959),f=o(79953),y=o(48602),h=(o(21265),o(14746),o(83497)),m=o(14800),v=o(75269),g=o(70605),x=o(75400),b=o(57457),w=o(74217),I=o(33979),T=o(9171),S=o(53367),A=o(62652),M=o(8592),F=o(30528),E=o(75215),_=o(34787),O=o(39936),C=o(19455),L=o(95011);function R(e){let{associatedLayer:t,serviceUpdateTimeStamp:o}=e;const r=t?.editingInfo?.lastEditDate,n=t?.serverGens,i=null!=r,s=null!=o,a=i&&s&&o.lastUpdate!==r.getTime();return i&&(a||!s&&n?.minServerGen!==n?.serverGen)}var P=o(89243),N=o(32474),D=o(61695);const U=e=>{let t=class extends e{constructor(){super(...arguments),this.serviceTimeInfo=null}get timeInfo(){const e=this.associatedLayer?.timeInfo;if(null==e)return null;const t=e.clone();return(0,L.fixTimeInfoFields)(t,this.fieldsIndex),t}set timeInfo(e){(0,L.fixTimeInfoFields)(e,this.fieldsIndex),this._override("timeInfo",e)}get timeExtent(){return this.associatedLayer?.timeExtent}set timeExtent(e){this._override("timeExtent",e)}get timeOffset(){return this.associatedLayer?.timeOffset}set timeOffset(e){this._override("timeOffset",e)}get datesInUnknownTimezone(){return this.associatedLayer?.datesInUnknownTimezone??!1}set datesInUnknownTimezone(e){this._override("datesInUnknownTimezone",e)}async loadTimeInfoFromService(e){const{serviceTimeInfo:t}=this;if(null==t)return;const{startTimeField:o,endTimeField:r}=t;if(null==o&&null==r)return;if(R({associatedLayer:this.associatedLayer,serviceUpdateTimeStamp:this.serviceUpdateTimeStamp}))return;const n=async t=>{let r=null;try{const o=await(this.fetchStatistics?.(t,e));r=o?.stats}catch{}if(null==r)return null;const{minTimeStr:n,min:i,maxTimeStr:s,max:a}=r,l=t===o?n??i:s??a;return null!=l?new Date(l):null},[i,s]=await Promise.all([n(o),n(r)]);if(null!=o&&null==i||null!=r&&null==s)return;const a=new N.default({start:i,end:s});this.setAtOrigin("timeInfo",new P.default({endField:r,startField:o,fullTimeExtent:a}),"service")}};return(0,r._)([(0,y.MZ)({type:P.default,json:{read:!1,write:!1}})],t.prototype,"timeInfo",null),(0,r._)([(0,y.MZ)({type:N.default,json:{read:!1,write:!1}})],t.prototype,"timeExtent",null),(0,r._)([(0,y.MZ)({type:D.default,json:{read:!1,write:!1}})],t.prototype,"timeOffset",null),(0,r._)([(0,y.MZ)({type:Boolean,nonNullable:!0,json:{read:!1,write:!1}})],t.prototype,"datesInUnknownTimezone",null),(0,r._)([(0,y.MZ)({type:j,readOnly:!0,json:{read:{source:"timeInfo"}}})],t.prototype,"serviceTimeInfo",void 0),t=(0,r._)([(0,v.$)("esri.layers.mixins.TemporalSceneLayer")],t),t};let j=class extends C.A{constructor(){super(...arguments),this.endTimeField=null,this.startTimeField=null}};(0,r._)([(0,y.MZ)({type:String})],j.prototype,"endTimeField",void 0),(0,r._)([(0,y.MZ)({type:String})],j.prototype,"startTimeField",void 0),j=(0,r._)([(0,v.$)("esri.layers.mixins.TemporalSceneLayer.SceneServiceTimeInfo")],j);var Z=o(65073),$=o(39960),V=o(74048),H=o(75238),z=o(78308),B=o(91809),q=o(86391),k=o(14365),G=o(76747),W=o(18444),Q=o(26936),X=o(56808),J=o(51496),K=o(91551),Y=o(90596),ee=o(65477);let te=class extends C.A{constructor(){super(...arguments),this.name=null,this.field=null,this.currentRangeExtent=null,this.fullRangeExtent=null,this.type="rangeInfo"}};(0,r._)([(0,y.MZ)({type:String,json:{read:!0,write:{isRequired:!0}}})],te.prototype,"name",void 0),(0,r._)([(0,y.MZ)({type:String,json:{read:!0,write:{isRequired:!0}}})],te.prototype,"field",void 0),(0,r._)([(0,y.MZ)({type:[Number],json:{read:!0,write:!0}})],te.prototype,"currentRangeExtent",void 0),(0,r._)([(0,y.MZ)({type:[Number],json:{read:!0,write:!0}})],te.prototype,"fullRangeExtent",void 0),(0,r._)([(0,y.MZ)({type:["rangeInfo"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],te.prototype,"type",void 0),te=(0,r._)([(0,v.$)("esri.layers.support.RangeInfo")],te);var oe=o(58873),re=o(23060),ne=o(43103);var ie=o(52178),se=o(86899),ae=o(53512),le=o(41317),de=o(1802);async function ue(e){const t=[];for(const o of e)o.name.toLowerCase().endsWith(".zip")?t.push(ce(o)):t.push(Promise.resolve(o));return(await Promise.all(t)).flat()}async function ce(e){const{BlobReader:t,ZipReader:r,BlobWriter:n}=await o.e(72806).then(o.bind(o,72806)),i=[],s=new r(new t(e));return(await s.getEntries()).forEach((e=>{if(e.directory||/^__MACOS/i.test(e.filename))return;const t=new n,o=e.getData?.(t).then((t=>new File([t],e.filename)));o&&i.push(o)})),Promise.all(i)}var pe=o(69270),fe=o(49996),ye=o(62906);const he=new Set(["3DObject","Point"]),me=(0,k.p)();let ve=class extends(U((0,A.w6)((0,_.w6)((0,T.b)((0,M.q)((0,F.A)((0,E.j)((0,c.P)((0,S.d)((0,I.p)(s.A.ClonableMixin(b.default)))))))))))){constructor(){super(...arguments),this.featureReduction=null,this.rangeInfos=null,this.operationalLayerType="ArcGISSceneServiceLayer",this.type="scene",this.fields=null,this.floorInfo=null,this.outFields=null,this.nodePages=null,this.materialDefinitions=null,this.textureSetDefinitions=null,this.geometryDefinitions=null,this.serviceUpdateTimeStamp=null,this.excludeObjectIds=new a.default,this.definitionExpression=null,this.filter=null,this.path=null,this.labelsVisible=!0,this.labelingInfo=null,this.legendEnabled=!0,this.priority=null,this.semantic=null,this.cachedDrawingInfo={color:!1},this.popupEnabled=!0,this.popupTemplate=null,this.objectIdField=null,this.globalIdField=null,this._fieldUsageInfo={},this.screenSizePerspectiveEnabled=!0,this.serviceItemId=void 0}normalizeCtorArgs(e,t){return"string"==typeof e?{url:e,...t}:e}destroy(){this._set("renderer",null),this.associatedLayer=(0,u.pR)(this.associatedLayer)}getField(e){return this.fieldsIndex.get(e)}getFieldDomain(e,t){const o=this.getField(e)?.domain??null;return this.associatedLayer?(0,z.Vq)(this.associatedLayer,e,t,o):o}getFeatureType(e){return e&&this.associatedLayer?this.associatedLayer.getFeatureType(e):null}get types(){return this.associatedLayer?.types??[]}get typeIdField(){return this.associatedLayer?.typeIdField??null}get templates(){return this.associatedLayer?.templates??null}get formTemplate(){return this.associatedLayer?.formTemplate??null}get attributeTableTemplate(){return this.associatedLayer?.attributeTableTemplate??null}get fieldsIndex(){return new G.default(this.fields)}readNodePages(e,t,o){return"Point"===t.layerType&&(e=t.pointNodePages),null==e||"object"!=typeof e?null:W.W4.fromJSON(e,o)}set elevationInfo(e){this._set("elevationInfo",e),this.loaded&&this._validateElevationInfo()}get effectiveCapabilities(){return this._capabilitiesFromAssociatedFeatureLayer(this.associatedLayer?.effectiveCapabilities)}get effectiveEditingEnabled(){return null!=this.associatedLayer&&(0,z.C$)(this.associatedLayer)}get geometryType(){return xe[this.profile]||"mesh"}set renderer(e){(0,L.fixRendererFields)(e,this.fieldsIndex),this._set("renderer",e)}readCachedDrawingInfo(e){return null!=e&&"object"==typeof e||(e={}),null==e.color&&(e.color=!1),e}get capabilities(){return this._capabilitiesFromAssociatedFeatureLayer(this.associatedLayer?.capabilities)}_capabilitiesFromAssociatedFeatureLayer(e){e=null!=e?e:V.P;const{query:t,queryRelated:o,editing:{supportsGlobalId:r,supportsRollbackOnFailure:n,supportsUploadWithItemId:i,supportsGeometryUpdate:s,supportsReturnServiceEditsInSourceSpatialReference:a},data:{supportsZ:l,supportsM:d,isVersioned:u,supportsAttachment:c},operations:{supportsEditing:p,supportsAdd:f,supportsUpdate:y,supportsDelete:h,supportsQuery:m,supportsQueryAttachments:v,supportsAsyncConvert3D:g}}=e,x=e.operations.supportsChangeTracking,b=!!this.associatedLayer?.infoFor3D;return{query:t,queryRelated:o,editing:{supportsGlobalId:r,supportsReturnServiceEditsInSourceSpatialReference:a,supportsRollbackOnFailure:n,supportsGeometryUpdate:b&&s,supportsUploadWithItemId:i},data:{supportsAttachment:c,supportsZ:l,supportsM:d,isVersioned:u},operations:{supportsQuery:m,supportsQueryAttachments:v,supportsEditing:p&&x,supportsAdd:b&&f&&x,supportsDelete:b&&h&&x,supportsUpdate:y&&x,supportsAsyncConvert3D:g}}}get editingEnabled(){return this._isOverridden("editingEnabled")?this._get("editingEnabled"):this.associatedLayer?.editingEnabled??!1}set editingEnabled(e){this._overrideIfSome("editingEnabled",e)}get infoFor3D(){return this.associatedLayer?.infoFor3D??null}get relationships(){return this.associatedLayer?.relationships}get defaultPopupTemplate(){return this.associatedLayer||this.attributeStorageInfo?this.createPopupTemplate():null}readObjectIdField(e,t){return!e&&t.fields&&t.fields.some((t=>("esriFieldTypeOID"===t.type&&(e=t.name),!!e))),e||void 0}readGlobalIdField(e,t){return!e&&t.fields&&t.fields.some((t=>("esriFieldTypeGlobalID"===t.type&&(e=t.name),!!e))),e||void 0}get displayField(){return this.associatedLayer?.displayField??null}readProfile(e,t){const o=t.store.profile;return null!=o&&ge[o]?ge[o]:(d.A.getLogger(this).error("Unknown or missing profile",{profile:o,layer:this}),"mesh-pyramids")}get useViewTime(){return this.associatedLayer?.useViewTime??!0}set useViewTime(e){this._override("useViewTime",e)}load(e){return this.addResolvingPromise(this._load(e)),Promise.resolve(this)}async _load(e){const t=null!=e?e.signal:null;await this.loadFromPortal({supportedTypes:["Scene Service"]},e).catch(p.throwIfAbortError),await this._fetchService(t),await Promise.all([this._fetchIndexAndUpdateExtent(this.nodePages,t),this._setAssociatedFeatureLayer(t),this._loadFilterGeometries()]),this._validateElevationInfo(),this._applyAssociatedLayerOverrides(),this._populateFieldUsageInfo(),await this.loadTimeInfoFromService(e),await(0,ie.L)(this,{origin:"service"},t),(0,L.fixRendererFields)(this.renderer,this.fieldsIndex),await this.finishLoadEditablePortalLayer(e)}async beforeSave(){null!=this.filter&&(this.filter=this.filter.clone(),await this.load())}async _loadFilterGeometries(){if(this.filter)try{await this.filter.loadGeometries(this.spatialReference)}catch(e){d.A.getLogger(this).error("#_loadFilterGeometries()",this,"Failed to load filter geometries. Geometry filter will not be applied for this layer.",{error:e}),this.filter=null}}createQuery(){const e=new ae.default;return"mesh"===this.geometryType?this.capabilities.query.supportsReturnMesh&&(e.returnGeometry=!0):(e.returnGeometry=!0,e.returnZ=!0),e.where=this.definitionExpression||"1=1",e.sqlFormat="standard",e.outFields=["*"],e}queryExtent(e,t){return this._getAssociatedLayerForQuery().then((o=>o.queryExtent(e||this.createQuery(),t)))}queryFeatureCount(e,t){return this._getAssociatedLayerForQuery().then((o=>o.queryFeatureCount(e||this.createQuery(),t)))}queryFeatures(e,t){return this._getAssociatedLayerForQuery().then((o=>o.queryFeatures(e||this.createQuery(),t))).then((e=>{if(e?.features)for(const t of e.features)t.layer=this,t.sourceLayer=this;return e}))}async queryRelatedFeatures(e,t){if(await this.load(),!this.associatedLayer)throw new l.default("scenelayer:query-not-available","SceneLayer queries are not available without an associated feature layer",{layer:this});return this.associatedLayer.queryRelatedFeatures(e,t)}async queryRelatedFeaturesCount(e,t){if(await this.load(),!this.associatedLayer)throw new l.default("scenelayer:query-not-available","SceneLayer queries are not available without an associated feature layer",{layer:this});return this.associatedLayer.queryRelatedFeaturesCount(e,t)}async queryCachedAttributes(e,t){const o=(0,L.unpackFieldNames)(this.fieldsIndex,await(0,fe.TO)(this,(0,fe.D8)(this)));return(0,pe.s1)(this.parsedUrl?.path??"",this.attributeStorageInfo??[],e,t,o,this.apiKey,this.customParameters)}async queryCachedFeature(e,t){const o=await this.queryCachedAttributes(e,[t]);if(!o||0===o.length)throw new l.default("scenelayer:feature-not-in-cached-data","Feature not found in cached data");const r=new n.default;return r.attributes=o[0],r.layer=this,r.sourceLayer=this,r}queryObjectIds(e,t){return this._getAssociatedLayerForQuery().then((o=>o.queryObjectIds(e||this.createQuery(),t)))}queryAttachments(e,t){return this._getAssociatedLayerForQuery().then((o=>o.queryAttachments(e,t)))}getFieldUsageInfo(e){const t={supportsLabelingInfo:!1,supportsRenderer:!1,supportsPopupTemplate:!1,supportsLayerQuery:!1};return this.loaded?this._fieldUsageInfo[e]||t:(d.A.getLogger(this).error("#getFieldUsageInfo()","Unavailable until layer is loaded"),t)}createPopupTemplate(e){return(0,de.createPopupTemplate)(this,e)}_getAssociatedLayerForQuery(){const e=this.associatedLayer;return e?.loaded?Promise.resolve(e):this._loadAssociatedLayerForQuery()}async _loadAssociatedLayerForQuery(){if(await this.load(),!this.associatedLayer)throw new l.default("scenelayer:query-not-available","SceneLayer queries are not available without an associated feature layer",{layer:this});try{await this.associatedLayer.load()}catch(e){throw new l.default("scenelayer:query-not-available","SceneLayer associated feature layer could not be loaded",{layer:this,error:e})}return this.associatedLayer}hasCachedStatistics(e){return null!=this.statisticsInfo&&this.statisticsInfo.some((t=>t.name===e))}async queryCachedStatistics(e,t){return await this.load(t),await this.fetchStatistics(e,t)}async saveAs(e,t){return this._debouncedSaveOperations(_.Xh.SAVE_AS,{...t,getTypeKeywords:()=>this._getTypeKeywords(),portalItemLayerType:"scene"},e)}async save(){const e={getTypeKeywords:()=>this._getTypeKeywords(),portalItemLayerType:"scene"};return this._debouncedSaveOperations(_.Xh.SAVE,e)}async applyEdits(e,t){const{applyEdits:r}=await o.e(78865).then(o.bind(o,78865));let n=t;await this.load();const i=this.associatedLayer;if(!i)throw new l.default(`${this.type}-layer:not-editable`,"Service is not editable");await i.load();const{globalIdField:s}=i,a=!!i.infoFor3D,d=n?.globalIdUsed??!0;if(a&&null==s)throw new l.default(`${this.type}-layer:not-editable`,"Valid globalIdField expected on editable SceneLayer");if(a&&!d)throw new l.default(`${this.type}-layer:globalid-required`,"globalIdUsed must not be false for SceneLayer editing as globalIds are required.");return(0,Z.Wo)(i.url)&&a&&null!=e.deleteFeatures&&null!=s&&(n={...n,globalIdToObjectId:await(0,z.GA)(i,e.deleteFeatures,s)}),r(this,i.source,e,n)}async uploadAssets(e,t){if(await this.load(),null==this.associatedLayer)throw new l.default(`${this.type}-layer:not-editable`,"Service is not editable");return await this.associatedLayer.load(),this.associatedLayer.uploadAssets(e,t)}on(e,t){return super.on(e,t)}async convertMesh(e,t){t??={};const r=e=>{throw d.A.getLogger(this).error(".convertMesh()",e.message),e};await this.load(),this.infoFor3D||r(new l.default("invalid:layer","SceneLayer has no capability for mesh conversion"));const n=await this.extractAndFilterFiles(e),i=n.reduce(((e,t)=>(0,Q.oF)(this.infoFor3D,t)?e+1:e),0);0===i&&r(new w.VP),i>1&&r(new w.XQ);const s=this.spatialReference,a=t.location??new x.default({x:0,y:0,z:0,spatialReference:s}),u=a.spatialReference.isGeographic?"local":"georeferenced",{default:c}=await Promise.all([o.e(76517),o.e(26848),o.e(6539)]).then(o.bind(o,26848)),p=c.createWithExternalSource(a,n,{vertexSpace:u,transform:(0,ee.Z)(a.spatialReference),unitConversionDisabled:!0}),[f]=await this.uploadAssets([p],{...t,useAssetOrigin:!t.location});return f}async extractAndFilterFiles(e){await this.load();const t=this.infoFor3D;return t?(await ue(e)).filter((e=>(0,Q.fu)(t,e))):e}validateLayer(e){if(e.layerType&&!he.has(e.layerType))throw new l.default("scenelayer:layer-type-not-supported","SceneLayer does not support this layer type",{layerType:e.layerType});if(isNaN(this.version.major)||isNaN(this.version.minor))throw new l.default("layer:service-version-not-supported","Service version is not supported.",{serviceVersion:this.version.versionString,supportedVersions:"1.x, 2.x"});if(this.version.major>2)throw new l.default("layer:service-version-too-new","Service version is too new.",{serviceVersion:this.version.versionString,supportedVersions:"1.x, 2.x"});!function(e,t){let o=!1,r=!1;if(null==e)o=!0,r=!0;else{const n=t&&t.isGeographic;switch(e){case"east-north-up":case"earth-centered":o=!0,r=n;break;case"vertex-reference-frame":o=!0,r=!n;break;default:o=!1}}if(!o)throw new l.default("scenelayer:unsupported-normal-reference-frame","Normal reference frame is invalid.");if(!r)throw new l.default("scenelayer:incompatible-normal-reference-frame","Normal reference frame is incompatible with layer spatial reference.")}(this.normalReferenceFrame,this.spatialReference)}_getTypeKeywords(){const e=[];if("points"===this.profile)e.push("Point");else{if("mesh-pyramids"!==this.profile)throw new l.default("scenelayer:unknown-profile","SceneLayer:save() encountered an unknown SceneLayer profile: "+this.profile);e.push("3DObject")}return e}_populateFieldUsageInfo(){if(this._fieldUsageInfo={},this.fields)for(const e of this.fields){const t=!!this.attributeStorageInfo?.some((t=>t.name===e.name)),o=!!this.associatedLayer?.fields?.some((t=>t&&e.name===t.name)),r={supportsLabelingInfo:t,supportsRenderer:t,supportsPopupTemplate:t||o,supportsLayerQuery:o};this._fieldUsageInfo[e.name]=r}}_applyAssociatedLayerOverrides(){this._applyAssociatedLayerFieldsOverrides(),this._applyAssociatedLayerPopupOverrides(),this._applyAssociatedLayerExtentOverride(),this._applyAssociatedLayerPrivileges()}_applyAssociatedLayerFieldsOverrides(){if(!this.associatedLayer?.fields)return;let e=null;for(const t of this.associatedLayer.fields){const o=this.getField(t.name);o?(!o.domain&&t.domain&&(o.domain=t.domain.clone()),o.editable=t.editable,o.nullable=t.nullable,o.length=t.length):(e||(e=this.fields?this.fields.slice():[]),e.push(t.clone()))}e&&this._set("fields",e)}_applyAssociatedLayerPopupOverrides(){if(!this.associatedLayer)return;const e=["popupTemplate","popupEnabled"],t=(0,h.oY)(this);for(let o=0;o<e.length;o++){const r=e[o],n=this.originIdOf(r),i=this.associatedLayer.originIdOf(r);n<i&&(i===g.Gr.SERVICE||i===g.Gr.PORTAL_ITEM)&&t.setAtOrigin(r,this.associatedLayer[r],i)}}_applyAssociatedLayerExtentOverride(){const e=this.associatedLayer?.getAtOrigin("fullExtent","service");null!=this.associatedLayer?.infoFor3D&&e&&(0,Z.Wo)(this.associatedLayer?.url)&&R(this)&&(0,h.oY)(this).setAtOrigin("fullExtent",e.clone(),g.Gr.SERVICE)}_applyAssociatedLayerPrivileges(){const e=this.associatedLayer;e&&(this._set("userHasEditingPrivileges",e.userHasEditingPrivileges),this._set("userHasFullEditingPrivileges",e.userHasFullEditingPrivileges),this._set("userHasUpdateItemPrivileges",e.userHasUpdateItemPrivileges))}async _setAssociatedFeatureLayer(e){if(["mesh-pyramids","points"].includes(this.profile))try{const{serverUrl:t,layerId:o,portalItem:r}=await(0,$.L)(`${this.url}/layers/${this.layerId}`,{sceneLayerItem:this.portalItem,customParameters:this.customParameters,apiKey:this.apiKey,signal:e}),n=await Y.S.FeatureLayer();this.associatedLayer=new n({url:t,customParameters:this.customParameters,layerId:o,portalItem:r}),await this.associatedLayer.load()}catch(ce){(0,p.isAbortError)(ce)||this._logWarningOnPopupEnabled()}}async _logWarningOnPopupEnabled(){await(0,f.whenOnce)((()=>this.popupEnabled&&null!=this.popupTemplate));const e=`this SceneLayer: ${this.title}`;null==this.attributeStorageInfo?d.A.getLogger(this).warn(`Associated FeatureLayer could not be loaded and no binary attributes found. Popups will not work on ${e}`):d.A.getLogger(this).info(`Associated FeatureLayer could not be loaded. Falling back to binary attributes for Popups on ${e}`)}_validateElevationInfo(){const e=this.elevationInfo;"mesh-pyramids"===this.profile&&(0,le.XF)(d.A.getLogger(this),(0,le.$7)("Mesh scene layers","relative-to-scene",e)),(0,le.XF)(d.A.getLogger(this),(0,le.tW)("Scene layers",e))}async fetchStatistics(e,t){return await async function(e){let{fieldName:t,statisticsInfo:o,errorContext:r,fieldsIndex:n,path:i,customParameters:s,apiKey:a,signal:d}=e;if(null==o)throw new l.default(`${r}:no-cached-statistics`,"Cached statistics are not available for this layer");const u=n.get(t);if(null==u)throw new l.default(`${r}:field-unexisting`,`Field '${t}' does not exist on the layer`);const c=o.find((e=>e.name===u.name));if(null==c)throw new l.default(`${r}:no-cached-statistics`,"Cached statistics for this attribute are not available");const p=(0,ne.join)(i,c.href),{data:f}=await(0,re.default)(p,{query:{f:"json",...s,token:a},responseType:"json",signal:d});return f}({fieldName:e,statisticsInfo:this.statisticsInfo,errorContext:"scenelayer",fieldsIndex:this.fieldsIndex,path:this.parsedUrl?.path??"",customParameters:this.customParameters,apiKey:this.apiKey,signal:t?.signal})}};(0,r._)([(0,y.MZ)({types:{key:"type",base:B.c,typeMap:{selection:q.default}},json:{origins:{"web-scene":{name:"layerDefinition.featureReduction",write:!0},"portal-item":{name:"layerDefinition.featureReduction",write:!0}}}})],ve.prototype,"featureReduction",void 0),(0,r._)([(0,y.MZ)({type:[te],json:{read:!1,origins:{"web-scene":{name:"layerDefinition.rangeInfos",write:!0},"portal-item":{name:"layerDefinition.rangeInfos",write:!0}}}})],ve.prototype,"rangeInfos",void 0),(0,r._)([(0,y.MZ)({json:{read:!1}})],ve.prototype,"associatedLayer",void 0),(0,r._)([(0,y.MZ)({type:["show","hide"]})],ve.prototype,"listMode",void 0),(0,r._)([(0,y.MZ)({type:["ArcGISSceneServiceLayer"]})],ve.prototype,"operationalLayerType",void 0),(0,r._)([(0,y.MZ)({json:{read:!1},readOnly:!0})],ve.prototype,"type",void 0),(0,r._)([(0,y.MZ)({...me.fields,readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],ve.prototype,"fields",void 0),(0,r._)([(0,y.MZ)()],ve.prototype,"types",null),(0,r._)([(0,y.MZ)()],ve.prototype,"typeIdField",null),(0,r._)([(0,y.MZ)()],ve.prototype,"templates",null),(0,r._)([(0,y.MZ)()],ve.prototype,"formTemplate",null),(0,r._)([(0,y.MZ)()],ve.prototype,"attributeTableTemplate",null),(0,r._)([(0,y.MZ)({readOnly:!0,clonable:!1})],ve.prototype,"fieldsIndex",null),(0,r._)([(0,y.MZ)({type:K.default,json:{read:{source:"layerDefinition.floorInfo"},write:{target:"layerDefinition.floorInfo"}}})],ve.prototype,"floorInfo",void 0),(0,r._)([(0,y.MZ)(me.outFields)],ve.prototype,"outFields",void 0),(0,r._)([(0,y.MZ)({type:W.W4,readOnly:!0,json:{read:!1}})],ve.prototype,"nodePages",void 0),(0,r._)([(0,m.w)("service","nodePages",["nodePages","pointNodePages"])],ve.prototype,"readNodePages",null),(0,r._)([(0,y.MZ)({type:[W.uV],readOnly:!0})],ve.prototype,"materialDefinitions",void 0),(0,r._)([(0,y.MZ)({type:[W.Ot],readOnly:!0})],ve.prototype,"textureSetDefinitions",void 0),(0,r._)([(0,y.MZ)({type:[W.L0],readOnly:!0})],ve.prototype,"geometryDefinitions",void 0),(0,r._)([(0,y.MZ)({readOnly:!0})],ve.prototype,"serviceUpdateTimeStamp",void 0),(0,r._)([(0,y.MZ)({readOnly:!0})],ve.prototype,"attributeStorageInfo",void 0),(0,r._)([(0,y.MZ)({readOnly:!0})],ve.prototype,"statisticsInfo",void 0),(0,r._)([(0,y.MZ)({type:a.default.ofType(Number),nonNullable:!0,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.excludeObjectIds",write:{enabled:!0}}})],ve.prototype,"excludeObjectIds",void 0),(0,r._)([(0,y.MZ)({type:String,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],ve.prototype,"definitionExpression",void 0),(0,r._)([(0,y.MZ)({type:oe.default,json:{name:"layerDefinition.polygonFilter",write:{enabled:!0,allowNull:!0},origins:{service:{read:!1,write:!1}}}})],ve.prototype,"filter",void 0),(0,r._)([(0,y.MZ)({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],ve.prototype,"path",void 0),(0,r._)([(0,y.MZ)(H.Yj)],ve.prototype,"elevationInfo",null),(0,r._)([(0,y.MZ)({readOnly:!0,json:{read:!1}})],ve.prototype,"effectiveCapabilities",null),(0,r._)([(0,y.MZ)({readOnly:!0})],ve.prototype,"effectiveEditingEnabled",null),(0,r._)([(0,y.MZ)({type:String})],ve.prototype,"geometryType",null),(0,r._)([(0,y.MZ)(H.kF)],ve.prototype,"labelsVisible",void 0),(0,r._)([(0,y.MZ)({type:[X.default],json:{origins:{service:{name:"drawingInfo.labelingInfo",read:{reader:J.w},write:!1}},name:"layerDefinition.drawingInfo.labelingInfo",read:{reader:J.w},write:!0}})],ve.prototype,"labelingInfo",void 0),(0,r._)([(0,y.MZ)(H.fV)],ve.prototype,"legendEnabled",void 0),(0,r._)([(0,y.MZ)({type:Number,json:{origins:{"web-document":{default:1,write:{enabled:!0,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}},read:{source:["opacity","layerDefinition.drawingInfo.transparency"],reader(e,t){if("number"==typeof e&&e>=0&&e<=1)return e;const o=t.layerDefinition?.drawingInfo?.transparency;return void 0!==o?(0,ye.D)(o):void 0}}},"portal-item":{write:!0},service:{read:!1}}}})],ve.prototype,"opacity",void 0),(0,r._)([(0,y.MZ)({type:["Low","High"],readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],ve.prototype,"priority",void 0),(0,r._)([(0,y.MZ)({type:["Labels"],readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],ve.prototype,"semantic",void 0),(0,r._)([(0,y.MZ)({types:se.XJ,json:{origins:{service:{read:{source:"drawingInfo.renderer"}}},name:"layerDefinition.drawingInfo.renderer",write:!0},value:null})],ve.prototype,"renderer",null),(0,r._)([(0,y.MZ)({json:{read:!1}})],ve.prototype,"cachedDrawingInfo",void 0),(0,r._)([(0,m.w)("service","cachedDrawingInfo")],ve.prototype,"readCachedDrawingInfo",null),(0,r._)([(0,y.MZ)({readOnly:!0,json:{read:!1}})],ve.prototype,"capabilities",null),(0,r._)([(0,y.MZ)({type:Boolean,json:{read:!1}})],ve.prototype,"editingEnabled",null),(0,r._)([(0,y.MZ)({readOnly:!0,json:{write:!1,read:!1}})],ve.prototype,"infoFor3D",null),(0,r._)([(0,y.MZ)({readOnly:!0,json:{write:!1,read:!1}})],ve.prototype,"relationships",null),(0,r._)([(0,y.MZ)(H.M6)],ve.prototype,"popupEnabled",void 0),(0,r._)([(0,y.MZ)({type:i.default,json:{name:"popupInfo",write:!0}})],ve.prototype,"popupTemplate",void 0),(0,r._)([(0,y.MZ)({readOnly:!0,json:{read:!1}})],ve.prototype,"defaultPopupTemplate",null),(0,r._)([(0,y.MZ)({type:String,json:{read:!1}})],ve.prototype,"objectIdField",void 0),(0,r._)([(0,m.w)("service","objectIdField",["objectIdField","fields"])],ve.prototype,"readObjectIdField",null),(0,r._)([(0,y.MZ)({type:String,json:{read:!1}})],ve.prototype,"globalIdField",void 0),(0,r._)([(0,m.w)("service","globalIdField",["globalIdField","fields"])],ve.prototype,"readGlobalIdField",null),(0,r._)([(0,y.MZ)({readOnly:!0,type:String,json:{read:!1}})],ve.prototype,"displayField",null),(0,r._)([(0,y.MZ)({type:String,json:{read:!1}})],ve.prototype,"profile",void 0),(0,r._)([(0,m.w)("service","profile",["store.profile"])],ve.prototype,"readProfile",null),(0,r._)([(0,y.MZ)({readOnly:!0,type:String,json:{origins:{service:{read:{source:"store.normalReferenceFrame"}}},read:!1}})],ve.prototype,"normalReferenceFrame",void 0),(0,r._)([(0,y.MZ)(H.PY)],ve.prototype,"screenSizePerspectiveEnabled",void 0),(0,r._)([(0,y.MZ)({json:{read:!1,origins:{service:{read:!0}}}})],ve.prototype,"serviceItemId",void 0),(0,r._)([(0,y.MZ)(O.B)],ve.prototype,"useViewTime",null),ve=(0,r._)([(0,v.$)("esri.layers.SceneLayer")],ve);const ge={"mesh-pyramids":"mesh-pyramids",meshpyramids:"mesh-pyramids","features-meshes":"mesh-pyramids",points:"points","features-points":"points",lines:"lines","features-lines":"lines",polygons:"polygons","features-polygons":"polygons"},xe={"mesh-pyramids":"mesh",points:"point"},be=ve},77520:(e,t,o)=>{o.d(t,{Cc:()=>d,Qo:()=>u,CC:()=>c,RF:()=>l});var r=o(88102),n=(o(21265),o(16804)),i=o(24646);var s=o(7757),a=o(6513);function l(e){return e&&e.enabled&&(function(e){return"extrude"===e.type}(e)||function(e){return"fill"===e.type}(e))&&null!=e.edges}function d(e,t){return u(function(e){return e&&e.enabled&&e.edges||null}(e),t)}function u(e,t){if(null==e)return null;const o=null!=e.color?(0,i.ci)(r.default.toUnitRGBA(e.color)):(0,i.fA)(0,0,0,0),s=(0,n.Lz)(e.size),l=(0,n.Lz)(e.extensionLength);switch(e.type){case"solid":return c({color:o,size:s,extensionLength:l,...t});case"sketch":return d={color:o,size:s,extensionLength:l,...t},{...f,...d,type:a.gP.Sketch};default:return}var d}function c(e){return{...p,...e,type:a.gP.Solid}}const p={color:(0,i.fA)(0,0,0,.2),size:1,extensionLength:0,opacity:1,objectTransparency:s.x.OPAQUE,hasSlicePlane:!1},f={color:(0,i.fA)(0,0,0,.2),size:1,extensionLength:0,opacity:1,objectTransparency:s.x.OPAQUE,hasSlicePlane:!1}},80203:(e,t,o)=>{o.d(t,{k:()=>i});var r=o(73031),n=o(826);class i extends n.n{constructor(e,t){super(e,"mat3",r.c.Pass,((o,r,n)=>o.setUniformMatrix3fv(e,t(r,n))))}}},81775:(e,t,o)=>{o.d(t,{o:()=>i});var r=o(73031),n=o(826);class i extends n.n{constructor(e,t){super(e,"sampler2D",r.c.Draw,((o,r,n)=>o.bindTexture(e,t(r,n))))}}},88242:(e,t,o)=>{o.d(t,{cz:()=>b,Sg:()=>f,B:()=>x,Hi:()=>g});var r=o(7951),n=o(15173),i=o(18498),s=o(96236),a=o(42162),l=o(21152),d=o(16878),u=o(73031),c=o(826);class p extends c.n{constructor(e,t){super(e,"int",u.c.Draw,((o,r,n)=>o.setUniform1i(e,t(r,n))))}}var f,y,h=o(81775),m=o(96122),v=o(22131);(y=f||(f={}))[y.Uniform=0]="Uniform",y[y.Varying=1]="Varying",y[y.COUNT=2]="COUNT";const g=429496.7296;function x(e,t){(0,n.U)(e/g*.5+.5,t)}function b(e,t){switch(t.componentData){case f.Varying:return function(e,t){const{vertex:o,fragment:r}=e;o.include(a.W),o.uniforms.add(new h.o("componentColorTex",(e=>e.componentParameters.texture.texture))),e.attributes.add(v.r.COMPONENTINDEX,"float"),e.varyings.add("vExternalColorMixMode","mediump float"),e.varyings.add("vExternalColor","vec4");const n=t.output===s.V.ObjectAndLayerIdColor;n&&e.varyings.add("vObjectAndLayerIdColor","vec4"),e.include(i.A),o.constants.add("stride","float",(0,m.E)()?3:2),o.code.add(d.H`vec2 getComponentTextureCoordinates(float componentIndex, float typeOffset) {
float index = componentIndex * stride + typeOffset;
float texSize = float(textureSize(componentColorTex, 0).x);
float coordX = mod(index, texSize);
float coordY = floor(index / texSize);
return vec2(coordX, coordY) + 0.5;
}`),o.code.add(d.H`
  vec4 _readComponentColor() {
    vec2 textureCoordinates = getComponentTextureCoordinates(componentIndex, 0.0);
    return texelFetch(componentColorTex, ivec2(textureCoordinates), 0);
   }

  float readElevationOffset() {
    vec2 textureCoordinates = getComponentTextureCoordinates(componentIndex, 1.0);
    vec4 encodedElevation = texelFetch(componentColorTex, ivec2(textureCoordinates), 0);
    return uninterpolatedRGBAToFloat(encodedElevation) * ${d.H.float(g)};
  }

  ${n?d.H`
          void forwardObjectAndLayerIdColor() {
            vec2 textureCoordinates = getComponentTextureCoordinates(componentIndex, 2.0);
            vObjectAndLayerIdColor = texelFetch(componentColorTex, ivec2(textureCoordinates), 0);
          }`:d.H`void forwardObjectAndLayerIdColor() {}`}

  vec4 forwardExternalColor(out bool castShadows) {
    vec4 componentColor = _readComponentColor() * 255.0;

    float shadowFlag = mod(componentColor.b * 255.0, 2.0);
    componentColor.b -= shadowFlag;
    castShadows = shadowFlag >= 1.0;

    int decodedColorMixMode;
    vExternalColor = decodeSymbolColor(componentColor, decodedColorMixMode) * 0.003921568627451; // = 1/255;
    vExternalColorMixMode = float(decodedColorMixMode) + 0.5; // add 0.5 to avoid interpolation artifacts

    return vExternalColor;
  }
`),r.code.add(d.H`
  void readExternalColor(out vec4 externalColor, out int externalColorMixMode) {
    externalColor = vExternalColor;
    externalColorMixMode = int(vExternalColorMixMode);
  }

  void outputObjectAndLayerIdColor() {
     ${n?d.H`fragColor = vObjectAndLayerIdColor;`:""}
  }
`)}(e,t);case f.Uniform:return function(e,t){const{vertex:o,fragment:r}=e;e.varyings.add("vExternalColor","vec4"),o.uniforms.add(new l.V("externalColor",(e=>e.componentParameters.externalColor))).code.add(d.H`float readElevationOffset() {
return 0.0;
}
void forwardObjectAndLayerIdColor() {}
vec4 forwardExternalColor(out bool castShadows) {
vExternalColor = externalColor;
castShadows = true;
return externalColor;
}`);const n=t.output===s.V.ObjectAndLayerIdColor;r.uniforms.add(new p("externalColorMixMode",(e=>e.componentParameters.externalColorMixMode))).code.add(d.H`
    void readExternalColor(out vec4 color, out int colorMixMode) {
      color = vExternalColor;
      colorMixMode = externalColorMixMode;
    }

    void outputObjectAndLayerIdColor() {
      ${(0,d.If)(n,"fragColor = vec4(0, 0, 0, 0);")}
    }
  `)}(e,t);case f.COUNT:return;default:(0,r.Xb)(t.componentData)}}},91018:(e,t,o)=>{o.d(t,{h:()=>i});var r=o(73031),n=o(826);class i extends n.n{constructor(e,t){super(e,"mat3",r.c.Draw,((o,r,n)=>o.setUniformMatrix3fv(e,t(r,n))))}}},96122:(e,t,o)=>{o.d(t,{E:()=>n});var r=o(21265);function n(){return!!(0,r.A)("enable-feature:objectAndLayerId-rendering")}},96236:(e,t,o)=>{var r;function n(e){return e===r.Shadow||e===r.ShadowHighlight||e===r.ShadowExcludeHighlight||e===r.ViewshedShadow}function i(e){return function(e){return h(e)||g(e)}(e)||e===r.Normal}function s(e){return v(e)||e===r.Normal}function a(e){return e===r.Highlight||e===r.ObjectAndLayerIdColor}function l(e){return d(e)||a(e)}function d(e){return e===r.Color}function u(e){return d(e)||x(e)}function c(e){return d(e)||e===r.ObjectAndLayerIdColor}function p(e){return u(e)||e===r.ObjectAndLayerIdColor}function f(e){return d(e)||e===r.Highlight}function y(e){return f(e)||g(e)}function h(e){return d(e)||a(e)}function m(e){return u(e)||a(e)}function v(e){return m(e)||g(e)}function g(e){return e===r.Depth}function x(e){return e===r.ColorEmission}o.d(t,{CL:()=>a,LG:()=>x,Mb:()=>m,PJ:()=>n,QG:()=>p,RN:()=>u,T2:()=>v,V:()=>r,XY:()=>i,_o:()=>d,aD:()=>y,dX:()=>h,eh:()=>g,i3:()=>l,iq:()=>s,zW:()=>c}),function(e){e[e.Color=0]="Color",e[e.ColorEmission=1]="ColorEmission",e[e.Depth=2]="Depth",e[e.Normal=3]="Normal",e[e.Shadow=4]="Shadow",e[e.ShadowHighlight=5]="ShadowHighlight",e[e.ShadowExcludeHighlight=6]="ShadowExcludeHighlight",e[e.ViewshedShadow=7]="ViewshedShadow",e[e.Highlight=8]="Highlight",e[e.ObjectAndLayerIdColor=9]="ObjectAndLayerIdColor",e[e.COUNT=10]="COUNT"}(r||(r={}))}}]);