"use strict";(self.webpackChunkever_wading_birds=self.webpackChunkever_wading_birds||[]).push([[67439],{13561:(t,e,n)=>{function a(t){let e,n,a=[],i=!1;return function(){for(var r=arguments.length,l=new Array(r),o=0;o<r;o++)l[o]=arguments[o];return i&&e===this&&function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}(l,a)||(n=t.apply(this,l),e=this,a=l,i=!0),n}}n.d(e,{B:()=>a})},17528:(t,e,n)=>{n.d(e,{L:()=>d});var a=n(17741),i=n(49959),r=n(79953),l=n(10993),o=n(34156),s=n(41317),u=n(29331),c=n(68263),p=n(19565);function d(t){let{predicate:e=()=>!0,snappingManager:n,snappingContext:o,updatingHandles:d,useZ:g=!0}=t;const y=new u.rh;if(null==n)return{snappingStep:[v,y],cancelSnapping:v};let E,_=null,b=null,M=null;const x=()=>{_=(0,a.DC)(_),n.doneSnapping(),b?.frameTask.remove(),b=null,E=(0,a.xt)(E),M=null},S=(w=n,P=g,Z=y,(0,i.debounce)((async(t,e)=>{let{frameTask:n,point:a,scenePoint:i,context:r,event:o,delta:s,getLastState:u}=t;const c=await n.schedule((()=>w.snap({point:a,scenePoint:i,context:r,signal:e})),e);if(c.valid){let t=await n.schedule((()=>c.apply()),e);const i=u();null!=i.point&&a!==i.point&&(t=w.update({point:i.point,scenePoint:i.scenePoint,context:r})),null!=i.updatePoint&&(0,l.CI)(t,i.updatePoint)||(m(o.mapEnd,t,s,P),Z.execute(o))}})));var w,P,Z;let A=null,T=null,z=null;return{snappingStep:[t=>{if(!e(t))return t;const{action:a}=t;if("start"===a){const{info:e}=t,a=function(t){return"3d"===t.type?t.resourceController.scheduler.registerTask(p.W6.SNAPPING):p.nu}(n.view);if(b=function(t,e,n){return{context:new c.e({editGeometryOperations:t.editGeometryOperations,elevationInfo:t.elevationInfo,pointer:t.pointer,vertexHandle:null!=e.info?e.info.handle:null,excludeFeature:t.excludeFeature,feature:t.feature,visualizer:t.visualizer}),originalPos:null!=e.snapOrigin?t.coordinateHelper.vectorToDehydratedPoint(e.snapOrigin):e.mapStart,originalScenePos:null!=e.scenePoints?e.scenePoints.sceneStart:null,frameTask:n}}(o,t,a),b.context.selfSnappingZ=null,!g&&null!=e){const t=function(t,e){if(!t.hasZ())return null;const n=e.vertices;let a=null;for(const i of n){const e=t.getZ(i.pos);if(null!=a&&null!=e&&Math.abs(e-a)>1e-6)return null;null==a&&(a=e)}return a}(o.coordinateHelper,e.handle.component);null!=t&&(b.context.selfSnappingZ={value:t,elevationInfo:o.elevationInfo??s.qt})}}if(null!=b){const{context:e,originalScenePos:l,originalPos:o}=b,{mapEnd:s,mapStart:u,scenePoints:c}=t,p=h(o,f(s,u)),v=f(u,o),y={...t,action:"update"},x=b.context,w=function(t,e){return null==t||null==e?null:h(t,f(e.sceneEnd,e.sceneStart))}(l,c),P=n.update({point:p,scenePoint:w,context:e});if(z=P,m(s,P,v,g),A=p,T=w,"end"!==a){const{frameTask:t}=b;null==_&&(_=new AbortController),M=e=>{d.addPromise((0,i.ignoreAbortErrors)(S({frameTask:t,event:y,context:x,point:p,scenePoint:w,delta:v,getLastState:()=>({point:A,scenePoint:T,updatePoint:e.forceUpdate?null:z})},_.signal)))},M({forceUpdate:!1}),null==E&&(E=(0,r.watch)((()=>n.options.effectiveEnabled),(()=>M?.({forceUpdate:!0}))))}}return"end"===a&&x(),t},y],cancelSnapping:t=>(x(),t)}}function h(t,e){let[n,a,i]=e;const r=(0,o.EL)(t);return r.x+=n,r.y+=a,r.hasZ&&(r.z+=i),r}function f(t,e){const n=t.hasZ&&e.hasZ?t.z-e.z:0;return[t.x-e.x,t.y-e.y,n]}function m(t,e,n,a){let[i,r,l]=n;t.x=e.x+i,t.y=e.y+r,a&&t.hasZ&&e.hasZ&&(t.z=e.z+l)}function v(t){return t}},29331:(t,e,n)=>{n.d(e,{EX:()=>M,RS:()=>T,Tp:()=>S,VG:()=>E,Wp:()=>f,Xt:()=>d,an:()=>h,bl:()=>y,dp:()=>_,mc:()=>b,pg:()=>Z,rh:()=>P,sO:()=>x,y$:()=>g});var a=n(62631),i=(n(21265),n(82301)),r=n(64682),l=n(16804),o=n(96913),s=n(20444),u=n(34156),c=n(41317),p=n(30124);function d(t,e){return t.events.on("drag",function(t,e){let n=null,a=null;return i=>{if("cancel"===i.action)return void(null!=a&&(a.execute({action:"cancel"}),n=null,a=null));const r={action:i.action,screenStart:i.start,screenEnd:i.screenPoint};"start"===i.action&&null==n&&(n=new P,a=new P,e(t,n,a,i.pointerType,r)),null!=n&&n.execute(r),"end"===i.action&&null!=n&&(n=null,a=null)}}(t,e))}function h(t,e){const n=[t.x,t.y,t.z??0],a=e,i=[Math.cos(a),Math.sin(a)],r=Math.sqrt(i[0]*i[0]+i[1]*i[1]);if(0===r)return null;i[0]/=r,i[1]/=r;const l=t=>{const e=(t.x-n[0])*i[0]+(t.y-n[1])*i[1];t.x=n[0]+e*i[0],t.y=n[1]+e*i[1]};return t=>(l(t.mapStart),l(t.mapEnd),{...t,axis:i})}function f(t){let e=null;return n=>{if("start"===n.action&&(e=function(t,e){const n=t.operations;if(!n)return null;const a=n.data.geometry,i=(0,u.RS)(e);if(a.spatialReference.equals(i))return v(t,n,(()=>{}));if("mesh"!==a.type){const e=m(a,i);if(null==e)return null;const r=a.spatialReference;return v(t,p.p.fromGeometry(e,n.viewingMode),(()=>{const t=(0,o.project)(a,r);n.trySetGeometry(t)}))}if((0,s.CK)(a)){const e=m(a.origin,i);if(!e)return null;const r=a.spatialReference,l=p.p.fromGeometry(e,n.viewingMode);return v(t,n,(()=>{const t=(0,o.project)(l.data.geometry,r),e=t.x-a.origin.x,i=t.y-a.origin.y,s=(t.z??0)-(a.origin.z??0);n.move(e,i,s)}))}return null}(t,n.mapStart.spatialReference)),null==e)return null;const a=n.mapEnd.x-n.mapStart.x,i=n.mapEnd.y-n.mapStart.y,r=(n.mapEnd.z??0)-(n.mapStart.z??0);return e.move(a,i,r,n.action),{...n,translationX:a,translationY:i,translationZ:r}}}function m(t,e){return null==t?null:t.spatialReference.equals(e)?t.clone():(0,o.project)(t,e)}function v(t,e,n){let a=0,i=0,r=0;return{move:(l,o,s,u)=>{"start"===u&&(a=0,i=0,r=0);const c=l-a,p=o-i,d=s-r;e.move(c,p,d),a+=c,i+=p,r+=d,n(),"end"===u&&t.endInteraction?.()}}}function g(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0,a=null;const i=null==e||t.spatialReference?.equals(e)?t=>t:t=>null!=t?(0,o.project)(t,e):t,r={exclude:[],...n};return e=>{if("start"===e.action&&(a=i(t.toMap(e.screenStart,r))),null==a)return null;const n=i(t.toMap(e.screenEnd,r));return null!=n?{...e,mapStart:a,mapEnd:n}:null}}function y(t){const e=t.map((t=>f(t))).filter(a.Ru);return t=>{const n=t.mapEnd.x-t.mapStart.x,a=t.mapEnd.y-t.mapStart.y,i=t.mapEnd.z-t.mapStart.z;return e.forEach((e=>e(t))),{...t,translationX:n,translationY:a,translationZ:i}}}function E(t,e){const n=new Map;for(const a of e)n.set(a,(0,i.clone)(t[a]));return e=>(n.forEach(((e,n)=>{t[n]=e})),e)}function _(t){const e=t.operations?.createResetState();return t=>(e?.remove(),t)}function b(t){const e=t.map((t=>_(t))).filter((t=>null!=t));return t=>(e.forEach((e=>e(t))),t)}function M(){let t=0,e=0,n=0;return a=>{"start"===a.action&&(t=a.mapStart.x,e=a.mapStart.y,n=a.mapStart.z);const i=a.mapEnd.x-t,r=a.mapEnd.y-e,l=a.mapEnd.z-n;return t=a.mapEnd.x,e=a.mapEnd.y,n=a.mapEnd.z,{...a,mapDeltaX:i,mapDeltaY:r,mapDeltaZ:l,mapDeltaSpatialReference:a.mapStart.spatialReference}}}function x(){let t=0,e=0;return n=>{"start"===n.action&&(t=n.screenStart.x,e=n.screenStart.y);const a=n.screenEnd.x-t,i=n.screenEnd.y-e;return t=n.screenEnd.x,e=n.screenEnd.y,{...n,screenDeltaX:a,screenDeltaY:i}}}function S(t,e){let n=null,a=0,i=0;return o=>{if("start"===o.action&&(n=t.toScreen?.(e),null!=n&&(n.x<0||n.x>t.width||n.y<0||n.y>t.height?n=null:(a=o.screenStart.x-n.x,i=o.screenStart.y-n.y))),null==n)return null;const s=(0,r.qE)(o.screenEnd.x-a,0,t.width),u=(0,r.qE)(o.screenEnd.y-i,0,t.height),c=(0,l.tc)(s,u);return o.screenStart=n,o.screenEnd=c,o}}const w=()=>{};class P{constructor(){this.execute=w}next(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new P;return null!=t&&(this.execute=n=>{const a=t(n);null!=a&&e.execute(a)}),e}}function Z(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if("2d"===t.type)return t=>t;let a=null;return i=>{"start"===i.action&&(a=t.toMap(i.screenStart,{exclude:n}),null!=a&&(a.z=(0,c.id)(a,t,e)));const r=t.toMap(i.screenEnd,{exclude:n});null!=r&&(r.z=(0,c.id)(r,t,e));const l=null!=a&&null!=r?{sceneStart:a,sceneEnd:r}:null;return{...i,scenePoints:l}}}function A(t,e,n){const a=e.elevationProvider.getElevation(t.x,t.y,t.z??0,t.spatialReference,"scene")??0,i=(0,u.EL)(t);return i.z=a,i.hasZ=!0,i.z=(0,c.id)(i,e,n),i}function T(t,e){if("2d"===t.type)return t=>t;let n=null;return a=>{"start"===a.action&&(n=A(a.mapStart,t,e));const i=A(a.mapEnd,t,e),r=null!=n&&null!=i?{sceneStart:n,sceneEnd:i}:null;return{...a,scenePoints:r}}}},68263:(t,e,n)=>{n.d(e,{e:()=>a});class a{constructor(t){this.vertexHandle=null,this.excludeFeature=null,this.visualizer=null,this.selfSnappingZ=null,this.drawConstraints=null,this.editGeometryOperations=t.editGeometryOperations,this.elevationInfo=t.elevationInfo,this.pointer=t.pointer,this.vertexHandle=t.vertexHandle,this.excludeFeature=t.excludeFeature,this.feature=t.feature,this.visualizer=t.visualizer,this.selfSnappingZ=t.selfSnappingZ,this.drawConstraints=t.drawConstraints}get coordinateHelper(){return this.editGeometryOperations.data.coordinateHelper}get spatialReference(){return this.coordinateHelper.spatialReference}}},77783:(t,e,n)=>{n.d(e,{t:()=>l});var a,i,r=n(89129);(i=a||(a={}))[i.WhenToolEditable=0]="WhenToolEditable",i[i.WhenToolNotEditable=1]="WhenToolNotEditable",i[i.Always=2]="Always";class l{constructor(){this._isToolEditable=!0,this._manipulators=new r.default,this._resourceContexts={manipulator3D:{}},this._attached=!1}set isToolEditable(t){this._isToolEditable=t}get length(){return this._manipulators.length}add(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.WhenToolEditable;this.addMany([t],e)}addMany(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.WhenToolEditable;for(const n of t){const t={manipulator:n,visibilityPredicate:e,attached:!1};this._manipulators.add(t),this._attached&&this._updateManipulatorAttachment(t)}}remove(t){for(let e=0;e<this._manipulators.length;e++)if(this._manipulators.at(e).manipulator===t){const t=this._manipulators.splice(e,1)[0];this._detachManipulator(t);break}}removeAll(){this._manipulators.forEach((t=>{this._detachManipulator(t)})),this._manipulators.removeAll()}attach(){this._manipulators.forEach((t=>{this._updateManipulatorAttachment(t)})),this._attached=!0}detach(){this._manipulators.forEach((t=>{this._detachManipulator(t)})),this._attached=!1}destroy(){this.detach(),this._manipulators.forEach((t=>{let{manipulator:e}=t;return e.destroy()})),this._manipulators.destroy(),this._resourceContexts=null}on(t,e){return this._manipulators.on(t,(t=>{e(t)}))}forEach(t){for(const e of this._manipulators.items)t(e)}some(t){return this._manipulators.items.some(t)}toArray(){const t=[];return this.forEach((e=>t.push(e.manipulator))),t}intersect(t,e){let n=null,a=Number.MAX_VALUE;return this._manipulators.forEach((i=>{let{manipulator:r,attached:l}=i;if(!l||!r.interactive)return;const o=r.intersectionDistance(t,e);null!=o&&o<a&&(a=o,n=r)})),n}_updateManipulatorAttachment(t){this._isManipulatorItemVisible(t)?this._attachManipulator(t):this._detachManipulator(t)}_attachManipulator(t){t.attached||(t.manipulator.attach&&t.manipulator.attach(this._resourceContexts),t.attached=!0)}_detachManipulator(t){if(!t.attached)return;const e=t.manipulator;e.grabbing=!1,e.dragging=!1,e.hovering=!1,e.selected=!1,e.detach&&e.detach(this._resourceContexts),t.attached=!1}_isManipulatorItemVisible(t){return t.visibilityPredicate===a.Always||(this._isToolEditable?t.visibilityPredicate===a.WhenToolEditable:t.visibilityPredicate===a.WhenToolNotEditable)}}},88204:(t,e,n)=>{n.d(e,{g:()=>c});var a=n(93800),i=n(6946),r=(n(21265),n(50925),n(49959)),l=n(48602),o=(n(14746),n(75269)),s=n(54379),u=n(77783);let c=class extends i.default{constructor(t){super(t),this.manipulators=new u.t,this.automaticManipulatorSelection=!0,this.hasGrabbedManipulators=!1,this.hasHoveredManipulators=!1,this.firstGrabbedManipulator=null,this.created=!1,this.removeIncompleteOnCancel=!0,this._editableFlags=new Map([[s.PK.MANAGER,!0],[s.PK.USER,!0]]),this._creationFinishedResolver=(0,r.createResolver)()}get active(){return null!=this.view&&this.view.activeTool===this}set visible(t){this._get("visible")!==t&&(this._set("visible",t),this._syncVisible())}get editable(){return this.getEditableFlag(s.PK.USER)}set editable(t){this.setEditableFlag(s.PK.USER,t)}get updating(){return!1}get cursor(){return null}get hasFocusedManipulators(){return this.hasGrabbedManipulators||this.hasHoveredManipulators}destroy(){this.manipulators.destroy(),this._set("view",null)}onAdd(){this._syncVisible()}activate(){null!=this.view&&(this.view.focus(),this.onActivate())}deactivate(){this.onDeactivate()}handleInputEvent(t){this.onInputEvent(t)}handleInputEventAfter(t){this.onInputEventAfter(t)}setEditableFlag(t,e){this._editableFlags.set(t,e),this.manipulators.isToolEditable=this.internallyEditable,this._updateManipulatorAttachment(),t===s.PK.USER&&this.notifyChange("editable"),this.onEditableChange(),this.onManipulatorSelectionChanged()}getEditableFlag(t){return this._editableFlags.get(t)??!1}endDrag(){const t=this.view.inputManager.latestPointerLocation;if(!t)return;let e=!1;this.manipulators.forEach((n=>{let{manipulator:a}=n;a.dragging&&(e=!0,a.events.emit("drag",{action:"end",start:t,screenPoint:t}))})),e&&(this.view.toolViewManager.activeTool=null)}whenCreated(){return this._creationFinishedResolver.promise}onManipulatorSelectionChanged(){}onActivate(){}onDeactivate(){}onShow(){}onHide(){}onEditableChange(){}onInputEvent(t){}onInputEventAfter(t){}get internallyEditable(){return this.getEditableFlag(s.PK.USER)&&this.getEditableFlag(s.PK.MANAGER)}finishToolCreation(){this.created||this._creationFinishedResolver.resolve(this),this._set("created",!0)}_syncVisible(){if(this.initialized)if(this.visible)this._show();else if(this._hide(),this.active)return void(this.view.activeTool=null)}_show(){this._updateManipulatorAttachment(),this.onShow()}_hide(){this._updateManipulatorAttachment(),this.onHide()}_updateManipulatorAttachment(){this.visible?this.manipulators.attach():this.manipulators.detach()}};(0,a._)([(0,l.MZ)({constructOnly:!0})],c.prototype,"view",void 0),(0,a._)([(0,l.MZ)({readOnly:!0})],c.prototype,"active",null),(0,a._)([(0,l.MZ)({value:!0})],c.prototype,"visible",null),(0,a._)([(0,l.MZ)({value:!0})],c.prototype,"editable",null),(0,a._)([(0,l.MZ)({readOnly:!0})],c.prototype,"manipulators",void 0),(0,a._)([(0,l.MZ)({readOnly:!0})],c.prototype,"updating",null),(0,a._)([(0,l.MZ)()],c.prototype,"cursor",null),(0,a._)([(0,l.MZ)({readOnly:!0})],c.prototype,"automaticManipulatorSelection",void 0),(0,a._)([(0,l.MZ)()],c.prototype,"hasFocusedManipulators",null),(0,a._)([(0,l.MZ)()],c.prototype,"hasGrabbedManipulators",void 0),(0,a._)([(0,l.MZ)()],c.prototype,"hasHoveredManipulators",void 0),(0,a._)([(0,l.MZ)()],c.prototype,"firstGrabbedManipulator",void 0),(0,a._)([(0,l.MZ)({readOnly:!0})],c.prototype,"created",void 0),(0,a._)([(0,l.MZ)({readOnly:!0})],c.prototype,"removeIncompleteOnCancel",void 0),c=(0,a._)([(0,o.$)("esri.views.interactive.InteractiveToolBase")],c)}}]);