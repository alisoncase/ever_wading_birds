"use strict";(self.webpackChunkever_wading_birds=self.webpackChunkever_wading_birds||[]).push([[17675,52714,65104,79538],{17675:(e,t,i)=>{i.r(t),i.d(t,{getAgeExpressions:()=>m,supportedAgeUnits:()=>o,verifyDates:()=>l});var n=i(74719),s=i(79538),a=i(2938);const r=new Set(["date","number"]),o=["years","months","days","hours","minutes","seconds"];function l(e,t,i,a){const o=[];let l=null;return[t,i].every((t=>{const i=(0,s.Lk)(e,t);return i&&o.push(i),!!i}))?o[0]===o[1]?"field"===o[0]?t===i&&(l=new n.default(a,"'startTime' and 'endTime' parameters cannot be identical")):l=new n.default(a,"Invalid combination of 'startTime' and 'endTime' parameters"):r.has(o[0])&&r.has(o[1])&&(l=new n.default(a,"Invalid combination of 'startTime' and 'endTime' parameters")):l=new n.default(a,"'startTime' and 'endTime' parameters must be one of these values: a date object, unix epoch time, name of a valid date field or <now>"),l}function u(e,t,i){let n;return n="number"===t?e:"date"===t?e.getTime():'$feature["'+e+'"]',"var "+i+" = "+n+";"}function d(e,t,i,n){const a=(0,s.Lk)(e,t),r=(0,s.Lk)(e,i),o=[u(t,a,"startTime"),u(i,r,"endTime"),`var retVal = null;\n\n    if (startTime != null && endTime != null) {\n      startTime = Date(startTime);\n      endTime = Date(endTime);\n      retVal = DateDiff(endTime, startTime, "${n}");\n    }\n\n    return retVal;`],l=[];return"field"===a&&l.push(t),"field"===r&&l.push(i),function(e){const t=e.map((e=>`$feature["${e}"];`));return t.length?t.join("\n")+"\n":""}(l)+o.join("\n")}function m(e){const{layer:t,startTime:i,endTime:n}=e,r=(0,a.Jg)(t),o=e.unit||"days",l=(0,s.aM)(r,i,n,o);return{valueExpression:d(r,i,n,o),statisticsQuery:l,histogramQuery:l}}},30333:(e,t,i)=>{i.r(t),i.d(t,{default:()=>o});var n=i(74719),s=i(65104),a=i(17675),r=i(2938);async function o(e){const{layerAdapter:t,...i}=await async function(e){if(!(e&&e.layer&&e.startTime&&e.endTime&&e.unit))throw new n.default("summary-statistics-for-age:missing-parameters","'layer', 'startTime', 'endTime' and 'unit' parameters are required");const{layer:t,...i}=e,s=(0,r.Jg)(t,r.J4);if(!s)throw new n.default("summary-statistics-for-age:invalid-parameters","'layer' must be one of these types: "+(0,r.Ho)(r.J4).join(", "));const o={layerAdapter:s,...i},l=o.view,u=null!=o.signal?{signal:o.signal}:null;await Promise.all([l?.when(),s.load(u)]);const d=(0,a.verifyDates)(s,o.startTime,o.endTime,"summary-statistics-for-age:invalid-parameters");if(d)throw d;if(!o.unit||!a.supportedAgeUnits.includes(o.unit))throw new n.default("summary-statistics-for-age:invalid-parameters",`Supported units are: ${a.supportedAgeUnits.join(", ")}`);return o}(e),{view:o,startTime:l,endTime:u,unit:d,minValue:m,maxValue:f,signal:c,filter:p,outStatisticTypes:y}=i,{valueExpression:g,statisticsQuery:v}=(0,a.getAgeExpressions)({layer:t,startTime:l,endTime:u,unit:d}),w={layer:t,valueExpression:g,...v,minValue:m,maxValue:f,outStatisticTypes:y,view:o,filter:p,signal:c};return(0,s.default)(w)}},65104:(e,t,i)=>{i.r(t),i.d(t,{default:()=>d});var n=i(74719),s=i(95011),a=i(70934),r=i(85151),o=i(79538),l=i(2938);const u=[...s.numericTypes,...o.i3,"time-only","string"];async function d(e){const{layerAdapter:t,...i}=await async function(e){if(!e?.layer||!(e.field||e.valueExpression||e.sqlExpression))throw new n.default("summary-statistics:missing-parameters","'layer' and 'field', 'valueExpression' or 'sqlExpression' parameters are required");if(e.valueExpression&&!e.sqlExpression&&!e.view)throw new n.default("summary-statistics:missing-parameters","View is required when 'valueExpression' is specified");e.forBinning&&(0,r.p)(e,"summary-statistics");const{layer:t,...i}=e,d=e.forBinning?l.Mi:l.G3,m=(0,l.Jg)(t,d,e.forBinning);if(!m)throw new n.default("summary-statistics:invalid-parameters","'layer' must be one of these types: "+(0,l.Ho)(d).join(", "));const f={layerAdapter:m,...i};f.normalizationType=(0,o.Wy)(f);const c=null!=f.signal?{signal:f.signal}:null;await m.load(c);const p=f.field,y=f.normalizationType,g=f.valueExpression||f.sqlExpression,v=p?m.getField(p):null,w=await(0,o.EG)({field:f.field,normalizationField:f.normalizationField,valueExpression:f.valueExpression}),h=(0,a.MH)(m,w,"summary-statistics:invalid-parameters");if(h)throw h;if(v){const e=(0,a.a)(m,v,"summary-statistics:invalid-parameters",u);if(e)throw e;if(((0,o.fs)(v)||(0,s.isTimeOnlyField)(v))&&y)throw new n.default("summary-statistics:invalid-parameters","Normalization is not allowed for date fields")}else if(g&&y)throw new n.default("summary-statistics:invalid-parameters","Normalization is not allowed when 'valueExpression' or 'sqlExpression' is specified");f.filter&&!f.filter.spatialRelationship&&(f.filter.spatialRelationship="intersects");const T=(0,a.Wk)(f.filter,"summary-statistics:invalid-parameters");if(T)throw T;return f}(e);return t.summaryStatistics(i)}},79538:(e,t,i)=>{i.d(t,{BV:()=>q,EG:()=>h,Lk:()=>b,Ll:()=>F,Np:()=>d,R3:()=>D,SO:()=>p,T1:()=>k,UH:()=>u,Wy:()=>T,XR:()=>c,aM:()=>$,fs:()=>w,i0:()=>S,i3:()=>v});var n=i(66845),s=i(95011),a=i(96247),r=i(76983),o=i(73210),l=i(40731);const u=",",d={light:["streets","gray","topo","terrain","oceans","osm","gray-vector","streets-vector","topo-vector","streets-relief-vector","streets-navigation-vector","topo-3d","navigation-3d","streets-3d","osm-3d","gray-3d"],dark:["satellite","hybrid","dark-gray","dark-gray-vector","streets-night-vector","navigation-dark-3d","streets-dark-3d","dark-gray-3d"]},m="percent-of-total",f="field",c={exclude:["median"]},p={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864e5},y=new Set(["integer","small-integer"]);let g=null;const v=["date","date-only","timestamp-offset"];function w(e){return(0,s.isDateField)(e)||(0,s.isDateOnlyField)(e)||(0,s.isTimestampOffsetField)(e)}async function h(e){const{field:t,field2:i,field3:n,normalizationField:s,valueExpression:r}=e;let o=[];if(r){if(!g){const{arcadeUtils:e}=await(0,a.lw)();g=e}o=g.extractFieldNames(r)}return t&&o.push(t),i&&o.push(i),n&&o.push(n),s&&o.push(s),o}function T(e){let t=e.normalizationType;return t||(e.normalizationField?t=f:null!=e.normalizationTotal&&(t=m)),t??void 0}function x(e){return String(e).padStart(2,"0")}function E(e,t,i){let n;return"date"===t||"number"===t?("number"===t&&(e=new Date(e)),n=`TIMESTAMP'${i?e.getFullYear():e.getUTCFullYear()}-${x((i?e.getMonth():e.getUTCMonth())+1)}-${x(i?e.getDate():e.getUTCDate())} ${x(i?e.getHours():e.getUTCHours())}:${x(i?e.getMinutes():e.getUTCMinutes())}:${x(i?e.getSeconds():e.getUTCSeconds())}'`):n=e,n}function $(e,t,i,n){const{hasQueryEngine:s}=e,a=`(${E(i,b(e,i),s)} - ${E(t,b(e,t),s)})`;let r=p[n],o="/";return r<1&&(r=1/r,o="*"),{sqlExpression:1===r?a:`(${a} ${o} ${r})`,sqlWhere:null}}function b(e,t){if(t instanceof Date)return"date";if("number"==typeof t)return"number";if("string"==typeof t){const i=e.getField(t);if("<now>"===t.toLowerCase())return;if((0,s.isDateField)(i))return"field"}}function q(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d;for(const i in t)if(t[i].includes(e))return i}function k(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=null;return e&&("string"==typeof e?t.includes(e)&&(n=e):n=(0,r.q3)(e)),i?n||"gray":n}function D(e,t){const i=t&&e.getField(t);return!!i&&y.has(i.type)}function F(e){return`cast(${e} as float)`}function S(e,t){const{format:i,timeZoneOptions:s,fieldType:a}=t??{};let r,u;if(s&&({timeZone:r,timeZoneName:u}=(0,l.hv)(s.layerTimeZone,s.datesInUnknownTimezone,s.viewTimeZone,(0,n.J2)(i||"short-date-short-time"),a)),"string"==typeof e&&isNaN(Date.parse("time-only"===a?`1970-01-01T${e}Z`:e)))return e;switch(a){case"date-only":{const t=(0,n.J2)(i||"short-date");return"string"==typeof e?(0,n.iS)(e,{...t}):(0,n.Yq)(e,{...t,timeZone:o.n$})}case"time-only":{const t=(0,n.J2)(i||"short-time");return"string"==typeof e?(0,n.F8)(e,t):(0,n.Yq)(e,{...t,timeZone:o.n$})}case"timestamp-offset":{if(!r&&"string"==typeof e&&new Date(e).toISOString()!==e)return e;const t=i||s?(0,n.J2)(i||"short-date-short-time"):void 0,a=t?{...t,timeZone:r,timeZoneName:u}:void 0;return"string"==typeof e?(0,n.Ey)(e,a):(0,n.Yq)(e,a)}default:{const t=i||s?(0,n.J2)(i||"short-date-short-time"):void 0;return(0,n.Yq)("string"==typeof e?new Date(e):e,t?{...t,timeZone:r,timeZoneName:u}:void 0)}}}},85151:(e,t,i)=>{i.d(t,{p:()=>a,z:()=>s});var n=i(74719);const s="aggregateCount";function a(e,t){if(!e.view)throw new n.default(`${t}:missing-parameters`,"'view' parameter is required for binning");if(e.sqlExpression)throw new n.default(`${t}:invalid-parameters`,"'sqlExpression' parameter is not supported for binning");if("3d"===e.view.type)throw new n.default(`${t}:invalid-parameters`,"3d view is not supported for binning")}}}]);