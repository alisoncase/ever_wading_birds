"use strict";(self.webpackChunkever_wading_birds=self.webpackChunkever_wading_birds||[]).push([[13303,23682,49214,63643,89594],{11443:(t,e,n)=>{n.d(e,{S:()=>C});var i=Math.PI,o=Math.sin,s=Math.cos,a=Math.tan,l=Math.asin,r=Math.atan2,u=Math.acos,h=i/180,d=864e5,c=2440588,g=2451545,f={dec:0,ra:0};function m(t){return new Date((t+.5-c)*d)}function p(t){return function(t){return t.valueOf()/d-.5+c}(t)-g}var T=23.4397*h;function y(t,e){return r(o(t)*s(T)-a(e)*o(T),s(t))}function _(t,e){return l(o(e)*s(T)+s(e)*o(T)*o(t))}function z(t,e,n){return r(o(t),s(t)*o(e)-a(n)*s(e))}function O(t,e,n){return l(o(e)*o(n)+s(e)*s(n)*s(t))}function w(t,e){return h*(280.16+360.9856235*t)-e}function S(t){return h*(357.5291+.98560028*t)}function D(t){return h*(1.9148*o(t)+.02*o(2*t)+3e-4*o(3*t))}function E(t,e){return t+e+102.9372*h+i}function M(t,e){var n=S(t),i=E(n,D(n));return e||(e={dec:0,ra:0}),e.dec=_(i,0),e.ra=y(i,0),e}var C={PolarException:{NORMAL:0,MIDNIGHT_SUN:1,POLAR_NIGHT:2},getPosition:function(t,e,n,i){var o=h*-n,s=h*e,a=p(t),l=M(a,f),r=w(a,o)-l.ra;return i||(i={azimuth:0,altitude:0}),i.azimuth=z(r,s,l.dec),i.altitude=O(r,s,l.dec),i}},v=[[-.83,"sunrise","sunset"]];C.addTime=function(t,e,n){v.push([t,e,n])};var b=9e-4;function U(t,e){return Math.round(t-b-e/(2*i))}function P(t,e,n){return b+(t+e)/(2*i)+n}function k(t,e,n){return g+t+.0053*o(e)-.0069*o(2*n)}function L(t,e,n){return u((o(t)-o(e)*o(n))/(s(e)*s(n)))}function N(t){var e=h*(134.963+13.064993*t),n=h*(93.272+13.22935*t),i=h*(218.316+13.176396*t)+6.289*h*o(e),a=5.128*h*o(n),l=385001-20905*s(e);return{ra:y(i,a),dec:_(i,a),dist:l}}C.getTimes=function(t,e,n){var i=h*-n,a=h*e,l=U(p(t),i),r=P(0,i,l),u=S(r),d=D(u),c=E(u,d),g=_(c,0),f=k(r,u,c);function T(t){return k(P(L(t,a,g),i,l),u,c)}var y,z,O,w,M,b={solarNoon:m(f),nadir:m(f-.5),polarException:C.PolarException.NORMAL};for(y=0,z=v.length;y<z;y+=1)M=f-((w=T((O=v[y])[0]*h))-f),b[O[1]]=m(M),b[O[2]]=m(w);return b.polarException=function(t){var e=(o(t)-o(a)*o(g))/(s(a)*s(g));return e<-1?C.PolarException.MIDNIGHT_SUN:e>1?C.PolarException.POLAR_NIGHT:C.PolarException.NORMAL}(v[0][0]*h),b},C.getMoonPosition=function(t,e,n){var i=h*-n,o=h*e,s=p(t),l=N(s),r=w(s,i)-l.ra,u=O(r,o,l.dec);return u+=.017*h/a(u+10.26*h/(u+5.1*h)),{azimuth:z(r,o,l.dec),altitude:u,distance:l.dist}},C.getMoonFraction=function(t){var e=p(t),n=M(e),i=N(e),a=149598e3,l=u(o(n.dec)*o(i.dec)+s(n.dec)*s(i.dec)*s(n.ra-i.ra)),h=r(a*o(l),i.dist-a*s(l));return(1+s(h))/2}},13303:(t,e,n)=>{n.r(e),n.d(e,{default:()=>h});var i,o=n(93800),s=n(58448),a=n(48602),l=(n(21265),n(50925),n(14746),n(75269)),r=n(63643);let u=i=class extends(s.A.EventedMixin(r.default)){constructor(t){super(t),this.cameraTrackingEnabled=!0}clone(){return new i({...this.cloneConstructProperties(),cameraTrackingEnabled:this.cameraTrackingEnabled})}static fromWebsceneLighting(t){return new i(t.cloneConstructProperties())}cloneWithWebsceneLighting(t){const e=this.clone();return e.directShadowsEnabled=t.directShadowsEnabled,e}cloneNonPersistentConstructProperties(){return{cameraTrackingEnabled:this.cameraTrackingEnabled}}};(0,o._)([(0,a.MZ)({type:Boolean})],u.prototype,"cameraTrackingEnabled",void 0),u=i=(0,o._)([(0,l.$)("esri.views.3d.environment.VirtualLighting")],u);const h=u},23682:(t,e,n)=>{n.r(e),n.d(e,{default:()=>d});var i,o=n(93800),s=n(19455),a=n(48602),l=(n(21265),n(50925),n(14746),n(14800)),r=n(75269),u=n(15484);let h=i=class extends s.A{constructor(t){super(t),this.type="sun",this.date=null,this.directShadowsEnabled=!1,this.displayUTCOffset=null}readDate(t,e){return null!=e.datetime&&new Date(e.datetime)||null}writeDate(t,e,n){e[n]=t.getTime()}readDirectShadowsEnabled(t,e){return!!e.directShadows}writedirectShadowsEnabled(t,e,n){t&&(e[n]=t)}writeDisplayUTCOffset(t,e){null!=t&&(e.displayUTCOffset=t)}clone(){return new i(this.cloneConstructProperties())}cloneConstructProperties(){const t={directShadowsEnabled:this.directShadowsEnabled,displayUTCOffset:null!=this.displayUTCOffset?this.displayUTCOffset:null};return null!=this.date&&(t.date=new Date(this.date.getTime())),t}};(0,o._)([(0,a.MZ)({readOnly:!0,type:["sun"],json:{write:!0}})],h.prototype,"type",void 0),(0,o._)([(0,a.MZ)({type:Date,json:{type:Number,write:{target:"datetime"}}})],h.prototype,"date",void 0),(0,o._)([(0,l.w)("date",["datetime"])],h.prototype,"readDate",null),(0,o._)([(0,u.K)("date")],h.prototype,"writeDate",null),(0,o._)([(0,a.MZ)({type:Boolean,json:{default:!1,write:{target:"directShadows"}}})],h.prototype,"directShadowsEnabled",void 0),(0,o._)([(0,l.w)("directShadowsEnabled",["directShadows"])],h.prototype,"readDirectShadowsEnabled",null),(0,o._)([(0,u.K)("directShadowsEnabled")],h.prototype,"writedirectShadowsEnabled",null),(0,o._)([(0,a.MZ)({type:Number,json:{write:!0}})],h.prototype,"displayUTCOffset",void 0),(0,o._)([(0,u.K)("displayUTCOffset")],h.prototype,"writeDisplayUTCOffset",null),h=i=(0,o._)([(0,r.$)("esri.webscene.SunLighting")],h);const d=h},30957:(t,e,n)=>{n.d(e,{Gi:()=>l,J_:()=>c,T3:()=>h,ZS:()=>f,fG:()=>u,jP:()=>m,ty:()=>d});var i=n(87431),o=n(66845),s=n(11443),a=n(50821);const l={hour:"numeric",minute:"numeric",timeZone:"UTC"},r={hour:"numeric",timeZone:"UTC"};function u(t,e){const n=g(t,e);let i=(0,o.Yq)(n,l);return 0!==t&&"00:00"===i&&(i="24:00"),"tick"===e&&i.includes(" ")&&(i=(0,o.Yq)(n,r),i=i.replace(":00","")),i}function h(t){let{tickElement:e,labelElement:n,tickClasses:i=[],onClick:o}=t;e&&n&&(e.classList.add(...i,a.D.primaryTick),n.classList.add(...i,a.D.primaryTickLabel),o&&(n.onclick=e.onclick=()=>o()))}function d(t){let{tickElement:e,tickClasses:n=[],onClick:i}=t;e&&(e.classList.add(...n,a.D.secondaryTick),i&&(e.onclick=()=>i()))}function c(){return(0,o.kN)(r).formatToParts(g(0,"value")).some((t=>{let{type:e}=t;return"dayPeriod"===e}))}function g(t,e){if("tick"===e){const e=Math.round((0,i.t)(t,"minutes","hours"));return new Date((0,i.t)(e,"hours","milliseconds"))}return new Date(6e4*t)}function f(t,e,n,o){if(null==e||null==n)return null;const a=s.S.getTimes(t,e,n),l=a.sunrise,r=a.sunset,u=(0,i.S1)(t,o,"hours"),h=(0,i.S1)(l,o,"hours"),d=(0,i.S1)(r,o,"hours");if(u.getUTCDate()!==h.getUTCDate()||u.getUTCDate()!==d.getUTCDate()){const t=u.getTime()-h.getTime()>0?1:-1;l.setUTCDate(l.getUTCDate()+t),r.setUTCDate(r.getUTCDate()+t)}return{sunrise:l,sunset:r}}function m(t){return[{utcOffset:-12,short:"UTC-12",long:t.timezoneDateline},{utcOffset:-11,short:"UTC-11",long:t.timezoneSamoa},{utcOffset:-10,short:t.timezoneHAST,long:t.timezoneHawaii},{utcOffset:-9,short:t.timezoneAKST,long:t.timezoneAlaska},{utcOffset:-8,short:t.timezonePST,long:t.timezoneBaja},{utcOffset:-7,short:t.timezoneMST,long:t.timezoneMountain},{utcOffset:-7,short:t.timezoneMST,long:t.timezoneLaPaz},{utcOffset:-7,short:t.timezoneMST,long:t.timezoneArizona},{utcOffset:-6,short:t.timezoneCST,long:t.timezoneSaskatchewan},{utcOffset:-6,short:t.timezoneCST,long:t.timezoneCentralAmerica},{utcOffset:-6,short:t.timezoneCST,long:t.timezoneCentralTime},{utcOffset:-6,short:t.timezoneCST,long:t.timezoneMexico},{utcOffset:-5,short:t.timezoneEST,long:t.timezoneEasternUS},{utcOffset:-5,short:t.timezoneEST,long:t.timezoneLima},{utcOffset:-5,short:t.timezoneEST,long:t.timezoneIndiana},{utcOffset:-4,short:null,long:t.timezoneAtlantic},{utcOffset:-4,short:null,long:t.timezoneCuiaba},{utcOffset:-4,short:null,long:t.timezoneSantiago},{utcOffset:-4,short:null,long:t.timezoneManaus},{utcOffset:-4,short:null,long:t.timezoneAsuncion},{utcOffset:-3,short:null,long:t.timezoneBrasilia},{utcOffset:-3,short:null,long:t.timezoneGreenland},{utcOffset:-3,short:null,long:t.timezoneMontevideo},{utcOffset:-3,short:null,long:t.timezoneCayenne},{utcOffset:-3,short:null,long:t.timezoneBuenosAires},{utcOffset:-2,short:null,long:t.timezoneMidAtlantic},{utcOffset:-1,short:null,long:t.timezoneAzores},{utcOffset:-1,short:null,long:t.timezoneCaboVerde},{utcOffset:0,short:null,long:t.timezoneDublin},{utcOffset:0,short:null,long:t.timezoneReykjavik},{utcOffset:0,short:null,long:t.timezoneCasablanca},{utcOffset:1,short:t.timezoneCET,long:t.timezoneBelgrade},{utcOffset:1,short:t.timezoneCET,long:t.timezoneSarajevo},{utcOffset:1,short:t.timezoneCET,long:t.timezoneBrussels},{utcOffset:1,short:t.timezoneCET,long:t.timezoneWCAfrica},{utcOffset:1,short:t.timezoneCET,long:t.timezoneAmsterdam},{utcOffset:1,short:t.timezoneCET,long:t.timezoneWindhoek},{utcOffset:2,short:t.timezoneEET,long:t.timezoneMinsk},{utcOffset:2,short:t.timezoneEET,long:t.timezoneCairo},{utcOffset:2,short:t.timezoneEET,long:t.timezoneHelsinki},{utcOffset:2,short:t.timezoneEET,long:t.timezoneAthens},{utcOffset:2,short:t.timezoneEET,long:t.timezoneJerusalem},{utcOffset:2,short:t.timezoneEET,long:t.timezoneAmman},{utcOffset:2,short:t.timezoneEET,long:t.timezoneBeirut},{utcOffset:2,short:t.timezoneEET,long:t.timezoneHarare},{utcOffset:2,short:t.timezoneEET,long:t.timezoneDamascus},{utcOffset:2,short:t.timezoneEET,long:t.timezoneIstanbul},{utcOffset:3,short:t.timezoneMSK,long:t.timezoneKuwait},{utcOffset:3,short:t.timezoneMSK,long:t.timezoneBaghdad},{utcOffset:3,short:t.timezoneMSK,long:t.timezoneNairobi},{utcOffset:3,short:t.timezoneMSK,long:t.timezoneKaliningrad},{utcOffset:4,short:t.timezoneGST,long:t.timezoneMoscow},{utcOffset:4,short:t.timezoneGST,long:t.timezoneMuscat},{utcOffset:4,short:t.timezoneGST,long:t.timezoneBaku},{utcOffset:4,short:t.timezoneGST,long:t.timezoneYerevan},{utcOffset:4,short:t.timezoneGST,long:t.timezoneTbilisi},{utcOffset:4,short:t.timezoneGST,long:t.timezonePortLouis},{utcOffset:5,short:null,long:t.timezoneTashkent},{utcOffset:5,short:null,long:t.timezoneIslamabad},{utcOffset:6,short:null,long:t.timezoneEkaterinburg},{utcOffset:6,short:null,long:t.timezoneAstana},{utcOffset:6,short:null,long:t.timezoneDhaka},{utcOffset:7,short:t.timezoneICT,long:t.timezoneNovosibirsk},{utcOffset:7,short:t.timezoneICT,long:t.timezoneBangkok},{utcOffset:8,short:t.timezoneCCT,long:t.timezoneKrasnoyarsk},{utcOffset:8,short:t.timezoneCCT,long:t.timezoneBeijing},{utcOffset:8,short:t.timezoneCCT,long:t.timezoneSingapore},{utcOffset:8,short:t.timezoneCCT,long:t.timezoneTaipei},{utcOffset:8,short:t.timezoneCCT,long:t.timezonePerth},{utcOffset:8,short:t.timezoneCCT,long:t.timezoneUlaanbaatar},{utcOffset:9,short:t.timezoneJST,long:t.timezoneIrkutsk},{utcOffset:9,short:t.timezoneJST,long:t.timezoneSeoul},{utcOffset:9,short:t.timezoneJST,long:t.timezoneOsaka},{utcOffset:10,short:t.timezoneAEST,long:t.timezoneYakutsk},{utcOffset:10,short:t.timezoneAEST,long:t.timezoneCanberra},{utcOffset:10,short:t.timezoneAEST,long:t.timezoneBrisbane},{utcOffset:10,short:t.timezoneAEST,long:t.timezoneHobart},{utcOffset:10,short:t.timezoneAEST,long:t.timezoneGuam},{utcOffset:11,short:null,long:t.timezoneVladivostok},{utcOffset:11,short:null,long:t.timezoneSolomon},{utcOffset:12,short:t.timezoneNZST,long:t.timezoneMagadan},{utcOffset:12,short:t.timezoneNZST,long:t.timezoneFiji},{utcOffset:12,short:t.timezoneNZST,long:t.timezoneAuckland},{utcOffset:12,short:t.timezoneNZST,long:t.timezoneNukualofa}].map((t=>{let{utcOffset:e,short:n,long:i}=t;const o=e>0?`UTC+${e}`:e<0?`UTC${e}`:"GMT";return n?{utcOffset:e,short:n,shortWithUTC:`${o} (${n})`,long:i}:{utcOffset:e,short:o,shortWithUTC:o,long:i}}))}},49214:(t,e,n)=>{n.r(e),n.d(e,{default:()=>d});var i,o=n(93800),s=n(58448),a=n(48602),l=(n(21265),n(50925),n(14746),n(75269)),r=n(23682);let u=i=class extends(s.A.EventedMixin(r.default)){constructor(t){super(t),this.cameraTrackingEnabled=!0,this.positionTimezoneInfo={hours:0,minutes:0,seconds:0,autoUpdated:!0};const e=(new Date).getFullYear(),n=new Date("March 15, "+e+" 12:00:00 UTC");this._set("defaultDate",n),this._set("date",n)}get defaultDate(){return new Date(this._get("defaultDate").getTime())}static fromWebsceneLighting(t){return new i(t.cloneConstructProperties())}set defaultDate(t){const e=this._get("date")===this._get("defaultDate");t=new Date(t.getTime()),this._set("defaultDate",t),e&&this._set("date",t)}set date(t){null!=t&&(this.positionTimezoneInfo.autoUpdated=!1,this._set("date",new Date(t.getTime())))}autoUpdate(t,e){const n=i.calculateTimezoneOffset(this.positionTimezoneInfo);this.positionTimezoneInfo.hours=e.hours,this.positionTimezoneInfo.minutes=e.minutes,this.positionTimezoneInfo.seconds=e.seconds;let o=null;null!=t&&(this.positionTimezoneInfo.autoUpdated=!0,isNaN(t.getTime())?(o=this.defaultDate.getTime(),this._set("date",this.defaultDate)):(o=this.date&&this.date.getTime(),this._set("date",new Date(t.getTime()))));const s=i.calculateTimezoneOffset(this.positionTimezoneInfo);if(n!==s&&(h.target=this,h.timezoneOffset=s,this.emit("timezone-will-change",h),h.target=null),null!=t)return isNaN(t.getTime())||o!==t.getTime()}clone(){const t=this._get("date")===this._get("defaultDate"),e=new i({...this.cloneConstructProperties(),defaultDate:this.defaultDate,cameraTrackingEnabled:this.cameraTrackingEnabled});return t&&e._set("date",e._get("defaultDate")),e.positionTimezoneInfo.autoUpdated=this.positionTimezoneInfo.autoUpdated,e.positionTimezoneInfo.hours=this.positionTimezoneInfo.hours,e.positionTimezoneInfo.minutes=this.positionTimezoneInfo.minutes,e.positionTimezoneInfo.seconds=this.positionTimezoneInfo.seconds,e}cloneWithWebsceneLighting(t){const e=this.clone();return null!=t.date&&(e.date=t.date),e.directShadowsEnabled=t.directShadowsEnabled,e.displayUTCOffset=t.displayUTCOffset,e}cloneNonPersistentConstructProperties(){return{cameraTrackingEnabled:this.cameraTrackingEnabled}}};(0,o._)([(0,a.MZ)({type:Boolean})],u.prototype,"cameraTrackingEnabled",void 0),(0,o._)([(0,a.MZ)({type:Date})],u.prototype,"defaultDate",null),(0,o._)([(0,a.MZ)({type:Date})],u.prototype,"date",null),u=i=(0,o._)([(0,l.$)("esri.views.3d.environment.SunLighting")],u),(u||(u={})).calculateTimezoneOffset=function(t){let{hours:e,minutes:n,seconds:i}=t;return Math.round(e+n/60+i/3600)};const h={target:null,timezoneOffset:0},d=u},63643:(t,e,n)=>{n.r(e),n.d(e,{default:()=>u});var i,o=n(93800),s=n(19455),a=n(48602),l=(n(21265),n(50925),n(14746),n(75269));let r=i=class extends s.A{constructor(t){super(t),this.type="virtual",this.directShadowsEnabled=!1}clone(){return new i(this.cloneConstructProperties())}cloneConstructProperties(){return{directShadowsEnabled:this.directShadowsEnabled}}};(0,o._)([(0,a.MZ)({readOnly:!0,type:["virtual"],json:{write:{isRequired:!0}}})],r.prototype,"type",void 0),(0,o._)([(0,a.MZ)({type:Boolean,json:{default:!1,name:"directShadows",write:!0}})],r.prototype,"directShadowsEnabled",void 0),r=i=(0,o._)([(0,l.$)("esri.webscene.VirtualLighting")],r);const u=r},66797:(t,e,n)=>{n.d(e,{J_:()=>l,aE:()=>h,cq:()=>r,uu:()=>u});var i=n(64682),o=n(30142),s=n(75400);function a(t,e,n){if(null==e.longitude||null==e.latitude||null==n.longitude||null==n.latitude)throw new Error("Invalid points: no lon/lat");return function(t,e,n,o,s){const a=(0,i.kU)(n),l=(0,i.kU)(s),r=a-l,u=(0,i.kU)(e)-(0,i.kU)(o),h=Math.sin(r/2),d=Math.sin(u/2),c=2*(0,i.YN)(Math.sqrt(h*h+Math.cos(a)*Math.cos(l)*d*d))*t;return Math.round(1e4*c)/1e4}(t,e.longitude,e.latitude,n.longitude,n.latitude)}function l(t,e,n){const i=e.spatialReference,l=(0,o.tO)(i),r=new s.default(e.x,t.y,i),u=new s.default(n.x,t.y,i),h=new s.default(t.x,e.y,i),d=new s.default(t.x,n.y,i);return{lon:a(l.radius,r,u),lat:a(l.radius,h,d)}}function r(t,e,n){const o=e/n,s=(0,i.kU)(t),a=Math.sin(o/2),l=Math.cos(s),r=2*(0,i.YN)(Math.sqrt(a*a/(l*l)));return(0,i.KJ)(r)}function u(t,e){let n=t/15;return e||(n=Math.round(n)),n}function h(t,e){const n=t?.[0];if(null==n)return null;e||(e={hours:0,minutes:0,seconds:0}),e.hours=u(n,!0);const i=e.hours%1;e.hours-=i,e.minutes=60*i;const o=e.minutes%1;return e.minutes-=o,e.seconds=Math.round(60*o),e}},68765:(t,e,n)=>{n.d(e,{Cg:()=>l,E_:()=>r,M4:()=>u,XH:()=>i,_r:()=>d,el:()=>c,kD:()=>g,oV:()=>h});var i,o,s=n(87431);(o=i||(i={}))[o.NORTHERN=0]="NORTHERN",o[o.SOUTHERN=1]="SOUTHERN";const a={spring:{dayOfMonth:20,month:2},summer:{dayOfMonth:21,month:5},fall:{dayOfMonth:23,month:8},winter:{dayOfMonth:21,month:11}},l=["spring","summer","fall","winter"];function r(t,e,n){const i=h(e,n),{dayOfMonth:o,month:s}=a[i],l=new Date(t.getTime());return l.setMonth(s,o),l}function u(t,e){return h(function(t){const e=t.getTime(),n=r(t,"spring",i.NORTHERN).getTime(),o=r(t,"summer",i.NORTHERN).getTime(),s=r(t,"fall",i.NORTHERN).getTime(),a=r(t,"winter",i.NORTHERN).getTime();return e>=n&&e<o?"spring":e>=o&&e<s?"summer":e>=s&&e<a?"fall":"winter"}(t),e)}function h(t,e){return e===i.NORTHERN?t:function(t){const e=l.indexOf(t);return l[(e+2)%4]}(t)}function d(t,e){return(0,s.uf)(t,e,"minutes")}function c(t){return(0,s.mE)(t,"minutes")}function g(t,e,n){const i=12e5,o=i/4,s=18e5,a=o/3*2,l=72e5;if(null==t||null==e||isNaN(t.getTime())&&isNaN(e.getTime()))return o;const r=n.getTime(),u=t.getTime(),h=e.getTime(),d=u-l/2,c=u+l/2,g=h-l/3*2,f=h+l/3;let m=o;return r>=d&&r<=c?m=r-d<=i?s-(r-d)/i*(s-a):c-r<=i/2?o-(c-r)/i*2*(o-a):a:r>=g&&r<=f?m=r-g<=i/2?o-(r-g)/i*2*(o-a):f-r<=i?s-(f-r)/i*(s-a):a:(r<u||r>h)&&(m=s),m}},89594:(t,e,n)=>{n.r(e),n.d(e,{default:()=>z});var i=n(93800),o=n(6946),s=n(42198),a=n(50925),l=n(17741),r=n(79953),u=n(7187),h=n(87431),d=n(48602),c=(n(21265),n(14746),n(75269)),g=n(49214),f=n(13303),m=n(66797),p=n(68765),T=n(95596),y=n(30957);let _=class extends o.default{constructor(t){super(t),this.view=null,this.timeSliderViewModel=new T.h({min:0,max:1439,values:[0],labelFormatFunction:y.fG,inputFormatFunction:y.fG}),this.lightingUpdateInterval=200,this._oldLighting=null,this.playSpeedMultiplier=1,this._lastTime=null,this._sunrise=null,this._sunset=null,this._cachedLightingDateUTC=new Date(0),this._cachedDisplayUTCOffset=0,this._firstInteraction=!0,this._lastLightingUpdate=0,this._lightingUpdateHandle=null}initialize(){this.addHandles([(0,r.when)((()=>this.view),(t=>t.when((()=>this._updateLighting()))),r.initial),(0,r.watch)((()=>{const t=this._lighting;return"sun"===t?.type?this._ensureValidDate(t):null}),(t=>this._scheduleLightingUpdate(t))),(0,r.on)((()=>this._lighting),"timezone-will-change",(t=>this._timezoneWillChange(t)),{onListenerAdd:()=>this._timezoneWillChange(null)}),(0,r.watch)((()=>!0===this.view?.stationary),(()=>{(this.dayPlaying||this.yearPlaying)&&this._updateSunriseAndSunset()}),r.initial),(0,r.watch)((()=>{const t=this.timeSliderViewModel;return{vm:t,state:t.state,sliderPosition:this.timeSliderPosition}}),(t=>{let{vm:e,state:n,sliderPosition:i}=t;"ready"===n&&e.setValue(0,i)})),(0,r.watch)((()=>this.timeSliderViewModel?.utcOffset),(t=>{null!=t&&(this.utcOffset=t)})),(0,r.watch)((()=>({utcOffset:this.utcOffset,sliderViewModel:this.timeSliderViewModel})),(t=>{let{utcOffset:e,sliderViewModel:n}=t;n&&(n.utcOffset=e)}),r.syncAndInitial),(0,r.watch)((()=>this.timeSliderViewModel.timezonePickerOpen),(()=>this.stopPlaying())),(0,r.watch)((()=>this.timeSliderViewModel.values),(t=>this._setTimeSliderPosition(t?.[0]??0,{forceLightingUpdate:!1})))])}destroy(){this._cancelLightingUpdate(),this.view=null}get isSupported(){return null==this.view||"3d"===this.view.type}get utcOffset(){return this._cachedDisplayUTCOffset}set utcOffset(t){t!==this.utcOffset&&null!=this._lighting&&"virtual"!==this._lighting.type&&(this._lighting.displayUTCOffset=t,this._updateLighting())}get localDate(){return(0,h.xX)(this._lightingDateDisplay)}set localDate(t){this.view?.ready?(0,h.vd)(t)&&t.getTime()!==this.localDate.getTime()&&(this._lightingDateDisplay=(0,h.wi)(this._lightingDateDisplay,t)):a.A.getLogger(this).error("The localDate property cannot be set before the view and the widget are ready.")}get timeSliderPosition(){return(0,p.el)(this._lightingDateDisplay)}set timeSliderPosition(t){this.view?.ready&&"ready"===this.timeSliderViewModel?.state?this._setTimeSliderPosition(t,{forceLightingUpdate:!0}):a.A.getLogger(this).error("The timeSliderPosition property cannot be set before the view and the widget are ready.")}_setTimeSliderPosition(t,e){Math.abs(t-this.timeSliderPosition)<=1/60||(this.stopPlaying(),this._enableDirectShadowsIfFirstInteraction(),e.forceLightingUpdate&&(this._cancelLightingUpdate(),this._updateLighting()),this._lightingDateDisplay=(0,p._r)(this._lightingDateDisplay,t))}_timezoneFromCamera(t,e){if(null==e||!t.cameraTrackingEnabled)return 0;const n=(0,m.aE)([e.longitude,e.latitude]);return null==n?0:Math.round(n.hours+n.minutes/60+n.seconds/3600)}get directShadowsEnabled(){return this._lighting?.directShadowsEnabled??!1}set directShadowsEnabled(t){const e=this._lighting;e&&(e.directShadowsEnabled=t)}get sunLightingEnabled(){return"sun"===this._lightingType}set sunLightingEnabled(t){const e=this._environment;if(t===this._get("sunLightingEnabled")||null==e)return;const n=e.lighting,i=this._oldLighting;this._oldLighting=n;const o={directShadowsEnabled:n.directShadowsEnabled,cameraTrackingEnabled:n.cameraTrackingEnabled},s=t?"sun":"virtual";let a;a=null!=i&&i.type===s?i:t?new g.default:new f.default,a.set(o),e.lighting=a,t||(this.stopPlaying(),this.timeSliderViewModel.timezonePickerOpen=!1)}set playingState(t){this.playingState!==t&&(this._set("playingState",t),"none"!==t&&this.sunLightingEnabled&&(this._updateSunriseAndSunset(),this._lastTime=Date.now(),this._play(),this._enableDirectShadowsIfFirstInteraction()))}get dayPlaying(){return"day"===this.playingState}set dayPlaying(t){t?this.playingState="day":this.dayPlaying&&(this.playingState="none")}get yearPlaying(){return"year"===this.playingState}set yearPlaying(t){t?this.playingState="year":this.yearPlaying&&(this.playingState="none")}get currentSeason(){return(0,p.M4)(this.localDate,this._currentHemisphere)}set currentSeason(t){this.stopPlaying();const e=(0,p.oV)(t,this._currentHemisphere);this.localDate=(0,p.E_)(this.localDate,e,p.XH.NORTHERN)}get _currentHemisphere(){const t=this.view?.camera?.position?.latitude;return null==t||t>=0?p.XH.NORTHERN:p.XH.SOUTHERN}get _environment(){return this.view?.environment}get _lighting(){return this._environment?.lighting}get _lightingType(){return this._lighting?.type}get _lightingDateDisplay(){return(0,h.S1)(this._cachedLightingDateUTC,this._cachedDisplayUTCOffset,"hours")}set _lightingDateDisplay(t){const e=this._lighting;if(null==e||!this.sunLightingEnabled||"virtual"===e.type||!(0,h.vd)(t))return;const n=this._ensureValidDate(e),i=(0,h.S1)(t,-this._cachedDisplayUTCOffset,"hours");i.getTime()!==n.getTime()&&(e.date=i,this._updateLighting())}stopPlaying(){this.playingState="none"}toggleDayPlaying(){this.dayPlaying=!this.dayPlaying}toggleYearPlaying(){this.yearPlaying=!this.yearPlaying}toggleSunLightingEnabled(){this.stopPlaying(),this.sunLightingEnabled=!this.sunLightingEnabled}toggleDirectShadowsEnabled(){this.stopPlaying(),this.directShadowsEnabled=!this.directShadowsEnabled}onDateChange(t){this.dayPlaying=!1,this.localDate=t}_enableDirectShadowsIfFirstInteraction(){this._firstInteraction&&(this._firstInteraction=!1,this.directShadowsEnabled=!0)}_updateLighting(t){const e=Date.now();this._lastLightingUpdate=e;const{view:n}=this,i=this._lighting;if(null==n||null==i||"virtual"===i.type)return;t??=this._ensureValidDate(i);const o=i.displayUTCOffset,s=null!=o?o:this._timezoneFromCamera(i,n.camera?.position);this._cachedLightingDateUTC.getTime()!==t.getTime()&&(this._cachedLightingDateUTC=new Date(t.getTime())),this._cachedDisplayUTCOffset!==s&&(this._cachedDisplayUTCOffset=s)}_timezoneWillChange(t){const e=this._lighting;if(null==e||"virtual"===e.type||!e.cameraTrackingEnabled)return;let n;if(t)n=t.timezoneOffset;else{if(null!=e.displayUTCOffset)return;n=g.default.calculateTimezoneOffset(e.positionTimezoneInfo)}e.displayUTCOffset=n,this._scheduleLightingUpdate()}_scheduleLightingUpdate(t){if(t&&(this._lightingUpdateHandle=(0,l.xt)(this._lightingUpdateHandle),!(0,h.vd)(t)))return;if(this._lightingUpdateHandle)return;const e=Date.now()-this._lastLightingUpdate,n=this.lightingUpdateInterval-e;let i=null;const o=()=>{this._updateLighting(t),this._lightingUpdateHandle===i&&(this._lightingUpdateHandle=null)};if(n<=0)this._lightingUpdateHandle=i=(0,u.schedule)(o);else{const t=setTimeout(o,n);this._lightingUpdateHandle=i=(0,s.hA)((()=>clearTimeout(t)))}}_cancelLightingUpdate(){this._lightingUpdateHandle=(0,l.xt)(this._lightingUpdateHandle)}_play(){const t=this._lighting;if(null==t||!this.sunLightingEnabled||"virtual"===t.type)return;const e=this._ensureValidDate(t);if(this.dayPlaying||this.yearPlaying){const n=Date.now()-(this._lastTime??0);if(this.dayPlaying){this._lastTime=Date.now();const i=(0,p.kD)(this._sunrise,this._sunset,e)*this.playSpeedMultiplier/100*n;if(i>0){let n=new Date(e.getTime()+i);const o=t.displayUTCOffset??0;if(((n.getUTCHours()+o)%24+24)%24<((e.getUTCHours()+o)%24+24)%24){const t=864e5;n=new Date(e.getTime()+i-t)}t.date=n}}else if(n>1e3){this._lastTime=Date.now();const n=(e.getUTCMonth()+1)%12,i=new Date(e.getTime());i.setUTCMonth(n),t.date=i}requestAnimationFrame((()=>this._play()))}}_updateSunriseAndSunset(){const t=this._lighting;if(null==t||"virtual"===t.type||!this.sunLightingEnabled)return;const e=this.view?.camera?.position;if(null==e)return;const{latitude:n,longitude:i}=e,{date:o,displayUTCOffset:s}=t,a=(0,y.ZS)(o,n,i,s??0);a&&(this._sunrise=new Date(a.sunrise),this._sunset=new Date(a.sunset))}_ensureValidDate(t){return(0,h.vd)(t.date)||(a.A.getLogger(this).warn("Invalid date. Reverting to the current date/time."),t.date=new Date),t.date}};(0,i._)([(0,d.MZ)()],_.prototype,"view",void 0),(0,i._)([(0,d.MZ)({type:T.h,nonNullable:!0})],_.prototype,"timeSliderViewModel",void 0),(0,i._)([(0,d.MZ)()],_.prototype,"isSupported",null),(0,i._)([(0,d.MZ)()],_.prototype,"lightingUpdateInterval",void 0),(0,i._)([(0,d.MZ)()],_.prototype,"utcOffset",null),(0,i._)([(0,d.MZ)({type:Date})],_.prototype,"localDate",null),(0,i._)([(0,d.MZ)()],_.prototype,"timeSliderPosition",null),(0,i._)([(0,d.MZ)()],_.prototype,"directShadowsEnabled",null),(0,i._)([(0,d.MZ)()],_.prototype,"sunLightingEnabled",null),(0,i._)([(0,d.MZ)({type:["none","day","year"],value:"none"})],_.prototype,"playingState",null),(0,i._)([(0,d.MZ)()],_.prototype,"dayPlaying",null),(0,i._)([(0,d.MZ)()],_.prototype,"yearPlaying",null),(0,i._)([(0,d.MZ)()],_.prototype,"playSpeedMultiplier",void 0),(0,i._)([(0,d.MZ)()],_.prototype,"currentSeason",null),(0,i._)([(0,d.MZ)()],_.prototype,"_lastTime",void 0),(0,i._)([(0,d.MZ)()],_.prototype,"_sunrise",void 0),(0,i._)([(0,d.MZ)()],_.prototype,"_sunset",void 0),(0,i._)([(0,d.MZ)()],_.prototype,"_cachedLightingDateUTC",void 0),(0,i._)([(0,d.MZ)()],_.prototype,"_cachedDisplayUTCOffset",void 0),(0,i._)([(0,d.MZ)()],_.prototype,"_firstInteraction",void 0),(0,i._)([(0,d.MZ)()],_.prototype,"_currentHemisphere",null),(0,i._)([(0,d.MZ)()],_.prototype,"_environment",null),(0,i._)([(0,d.MZ)()],_.prototype,"_lighting",null),(0,i._)([(0,d.MZ)()],_.prototype,"_lightingType",null),(0,i._)([(0,d.MZ)()],_.prototype,"_lightingDateDisplay",null),_=(0,i._)([(0,c.$)("esri.widgets.Daylight.DaylightViewModel")],_);const z=_},95596:(t,e,n)=>{n.d(e,{h:()=>l});var i=n(93800),o=n(48602),s=(n(21265),n(50925),n(14746),n(75269)),a=n(99400);let l=class extends a.default{constructor(){super(...arguments),this.utcOffset=null,this.timezonePickerOpen=!1}};(0,i._)([(0,o.MZ)()],l.prototype,"utcOffset",void 0),(0,i._)([(0,o.MZ)()],l.prototype,"timezonePickerOpen",void 0),l=(0,i._)([(0,s.$)("esri.widgets.Daylight.support.SliderWithDropdownViewModel")],l)}}]);