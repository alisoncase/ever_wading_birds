"use strict";(self.webpackChunkever_wading_birds=self.webpackChunkever_wading_birds||[]).push([[33602],{33602:(t,e,i)=>{i.r(e),i.d(e,{default:()=>O});var o=i(93800),n=i(50925),s=i(49959),l=i(79953),r=i(7187),a=i(56612),d=i(48602),h=(i(21265),i(14746),i(75269)),c=i(73283),u=i(26614),p=i(27811),g=i(65140);const v="esri-popup",_=`${v}--is-docked`,w={base:v,baseHidden:`${v}--hidden`,main:`${v}__main-container`,shadow:`${v}--shadow`,isDocked:_,isDockedTopLeft:`${_}-top-left`,isDockedTopCenter:`${_}-top-center`,isDockedTopRight:`${_}-top-right`,isDockedBottomLeft:`${_}-bottom-left`,isDockedBottomCenter:`${_}-bottom-center`,isDockedBottomRight:`${_}-bottom-right`,alignTopCenter:`${v}--aligned-top-center`,alignBottomCenter:`${v}--aligned-bottom-center`,alignTopLeft:`${v}--aligned-top-left`,alignBottomLeft:`${v}--aligned-bottom-left`,alignTopRight:`${v}--aligned-top-right`,alignBottomRight:`${v}--aligned-bottom-right`,pointer:`${v}__pointer`,pointerDirection:`${v}__pointer-direction`};var b=i(62412),f=i(6946);let m=class extends f.default{constructor(){super(...arguments),this.actionBar=!0,this.closeButton=!0,this.collapseButton=!0,this.featureMenuHeading=!0,this.featureNavigation=!0,this.featureListLayerTitle=!0,this.heading=!0,this.spinner=!0}};(0,o._)([(0,d.MZ)({type:Boolean,nonNullable:!0})],m.prototype,"actionBar",void 0),(0,o._)([(0,d.MZ)({type:Boolean,nonNullable:!0})],m.prototype,"closeButton",void 0),(0,o._)([(0,d.MZ)({type:Boolean,nonNullable:!0})],m.prototype,"collapseButton",void 0),(0,o._)([(0,d.MZ)({type:Boolean,nonNullable:!0})],m.prototype,"featureMenuHeading",void 0),(0,o._)([(0,d.MZ)({type:Boolean,nonNullable:!0})],m.prototype,"featureNavigation",void 0),(0,o._)([(0,d.MZ)({type:Boolean,nonNullable:!0})],m.prototype,"featureListLayerTitle",void 0),(0,o._)([(0,d.MZ)({type:Boolean,nonNullable:!0})],m.prototype,"heading",void 0),(0,o._)([(0,d.MZ)({type:Boolean,nonNullable:!0})],m.prototype,"spinner",void 0),m=(0,o._)([(0,h.$)("esri.widgets.Popup.PopupVisibleElements")],m);const M=m;var k=i(50821),y=i(17745),E=i(76697),C=i(66201),D=i(87118);const A={buttonEnabled:!0,position:"auto",breakpoint:{width:544}};let P=class extends p.default{constructor(t,e){super(t,e),this._dockAction=new c.default({id:"popup-dock-action"}),this._featuresWidget=new u.default({responsiveActionsEnabled:!0}),this._containerNode=null,this._mainContainerNode=null,this._pointerOffsetInPx=16,this._focusAbortController=null,this.alignment="auto",this.dockEnabled=!1,this.headingLevel=2,this.messages=null,this.viewModel=new b.default,this.visibleElements=new M}initialize(){this.addHandles([(0,l.watch)((()=>[this.viewModel?.view?.widthBreakpoint,this.dockEnabled]),(()=>this._handleDockIcon()),l.initial),(0,l.watch)((()=>[this.dockEnabled,this.messages?.undock,this.messages?.dock]),(()=>this._handleDockEnabled()),l.initial),(0,l.watch)((()=>this.dockOptions),(t=>{const{_dockAction:e}=this,i=this._featuresWidget.headerActions;i.remove(e),t.buttonEnabled&&i.add(e)}),l.initial),(0,l.watch)((()=>this.viewModel?.screenLocation),(()=>this._positionContainer())),(0,l.watch)((()=>[this.viewModel?.active,this.dockEnabled]),(()=>this._toggleScreenLocationEnabled())),(0,l.watch)((()=>[this.viewModel?.screenLocation,this.viewModel?.view?.padding,this.viewModel?.view?.size,this.viewModel?.active,this.viewModel?.location,this.alignment]),(()=>this.reposition())),(0,l.watch)((()=>this.viewModel?.view?.size),((t,e)=>this._updateDockEnabledForViewSize(t,e))),(0,l.watch)((()=>this.viewModel?.view),((t,e)=>this._viewChange(t,e))),(0,l.watch)((()=>this.viewModel?.view?.ready),((t,e)=>this._viewReadyChange(t??!1,e??!1))),(0,l.watch)((()=>this.viewModel),(()=>this._featuresWidget.viewModel=this.viewModel),l.initial),(0,l.watch)((()=>this._featureNavigationTop),(t=>this._featuresWidget.featureNavigationTop=t),l.initial),(0,l.watch)((()=>this.headingLevel),(t=>this._featuresWidget.headingLevel=t),l.initial),(0,l.watch)((()=>this.visibleElements.actionBar),(t=>this._featuresWidget.visibleElements.actionBar=!!t),l.initial),(0,l.watch)((()=>this.visibleElements.closeButton),(t=>this._featuresWidget.visibleElements.closeButton=!!t),l.initial),(0,l.watch)((()=>this.visibleElements.collapseButton),(t=>this._featuresWidget.visibleElements.collapseButton=!!t),l.initial),(0,l.watch)((()=>this.visibleElements.heading),(t=>this._featuresWidget.visibleElements.heading=!!t),l.initial),(0,l.watch)((()=>this.visibleElements.spinner),(t=>this._featuresWidget.visibleElements.spinner=!!t),l.initial),(0,l.watch)((()=>this.visibleElements.featureNavigation),(t=>this._featuresWidget.visibleElements.featureNavigation=!!t),l.initial),(0,l.watch)((()=>this.visibleElements.featureMenuHeading),(t=>this._featuresWidget.visibleElements.featureMenuHeading=!!t),l.initial),(0,l.watch)((()=>this.visibleElements.featureListLayerTitle),(t=>this._featuresWidget.visibleElements.featureListLayerTitle=!!t),l.initial),(0,l.on)((()=>this._featuresWidget),"trigger-header-action",(t=>{t.action===this._dockAction&&(this.dockEnabled=!this.dockEnabled)}))])}destroy(){this._dockAction.destroy(),this._featuresWidget&&(this._featuresWidget.viewModel=new g.default,this._featuresWidget.destroy()),this._focusAbortController?.abort()}get _featureNavigationTop(){const{currentAlignment:t,currentDockPosition:e}=this;return"bottom-left"===t||"bottom-center"===t||"bottom-right"===t||"top-left"===e||"top-center"===e||"top-right"===e}get actions(){return this.viewModel.actions}set actions(t){this.viewModel.actions=t}get active(){return this.viewModel.active}get autoCloseEnabled(){return this.viewModel.autoCloseEnabled}set autoCloseEnabled(t){this.viewModel.autoCloseEnabled=t}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(t){this.viewModel.defaultPopupTemplateEnabled=t}get content(){return this.viewModel.content}set content(t){this.viewModel.content=t}get collapsed(){return this._featuresWidget.collapsed}set collapsed(t){this._featuresWidget.collapsed=t}get currentAlignment(){return this._getCurrentAlignment()}get currentDockPosition(){return this._getCurrentDockPosition()}get dockOptions(){return this._get("dockOptions")||A}set dockOptions(t){const e={...A},i=this.viewModel?.view?.breakpoints,o={};i&&(o.width=i.xsmall,o.height=i.xsmall);const n={...e,...t},s={...e.breakpoint,...o},{breakpoint:l}=n;"object"==typeof l?n.breakpoint={...s,...l}:l&&(n.breakpoint=s),this._set("dockOptions",n),this._setCurrentDockPosition(),this.reposition()}get featureCount(){return this.viewModel.featureCount}get featureMenuOpen(){return this.viewModel.featureMenuOpen}set featureMenuOpen(t){this.viewModel.featureMenuOpen=t}get features(){return this.viewModel.features}set features(t){this.viewModel.features=t}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(t){this.viewModel.goToOverride=t}get highlightEnabled(){return this.viewModel.highlightEnabled}set highlightEnabled(t){this.viewModel.highlightEnabled=t}get icon(){return"popup"}set icon(t){this._overrideIfSome("icon",t)}get initialDisplayMode(){return this.viewModel.initialDisplayMode}set initialDisplayMode(t){this.viewModel.initialDisplayMode=t}get location(){return this.viewModel.location}set location(t){this.viewModel.location=t}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get promises(){return this.viewModel.promises}set promises(t){this.viewModel.promises=t}get selectedFeature(){return this.viewModel.selectedFeature}get selectedDrillInFeature(){return this._featuresWidget.selectedDrillInFeature??null}get selectedFeatureIndex(){return this.viewModel.selectedFeatureIndex}set selectedFeatureIndex(t){this.viewModel.selectedFeatureIndex=t}get selectedFeatureWidget(){return this._featuresWidget.selectedFeatureWidget}get title(){return this.viewModel.title}set title(t){this.viewModel.title=t}get updateLocationEnabled(){return this.viewModel.updateLocationEnabled}set updateLocationEnabled(t){this.viewModel.updateLocationEnabled=t}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}get visible(){return this.viewModel.visible}set visible(t){this.viewModel.visible=t}blur(){const{active:t}=this.viewModel;t||n.A.getLogger(this).warn("Popup can only be blurred when currently active."),this._featuresWidget.blur()}clear(){return this.viewModel.clear()}close(){this.visible=!1}fetchFeatures(t,e){return this.viewModel.fetchFeatures(t,e)}focus(){const{active:t}=this.viewModel;t||n.A.getLogger(this).warn("Popup can only be focused when currently active."),this._handleFocus()}next(){return this.viewModel.next()}open(t){const e=!!t&&!!t.featureMenuOpen,i={collapsed:!!t&&!!t.collapsed,featureMenuOpen:e};this.set(i),this.viewModel.open(t),t?.shouldFocus&&this._handleFocus(!0)}previous(){return this.viewModel.previous()}reposition(){this.renderNow(),this._positionContainer(),this._setCurrentAlignment()}triggerAction(t){return this.viewModel.triggerAction(t)}render(){const{dockEnabled:t,currentAlignment:e,currentDockPosition:i}=this,{active:o,screenLocation:n}=this.viewModel,s=o&&t,l=o&&!t,r=this.selectedFeature?.layer?.title,d=this.selectedFeature?.layer?.id,h={[w.alignTopCenter]:"top-center"===e,[w.alignBottomCenter]:"bottom-center"===e,[w.alignTopLeft]:"top-left"===e,[w.alignBottomLeft]:"bottom-left"===e,[w.alignTopRight]:"top-right"===e,[w.alignBottomRight]:"bottom-right"===e,[w.isDocked]:s,[w.shadow]:l,[w.isDockedTopLeft]:"top-left"===i,[w.isDockedTopCenter]:"top-center"===i,[w.isDockedTopRight]:"top-right"===i,[w.isDockedBottomLeft]:"bottom-left"===i,[w.isDockedBottomCenter]:"bottom-center"===i,[w.isDockedBottomRight]:"bottom-right"===i};return(0,D.K)("div",{afterCreate:this._positionContainer,afterUpdate:this._positionContainer,"aria-hidden":(!o).toString(),"aria-label":(0,a._e)(this.title??""),"aria-modal":"false",bind:this,class:this.classes(w.base,h,{[w.baseHidden]:!n&&!t}),"data-layer-id":d,"data-layer-title":r,role:"dialog"},o?[this._renderMainContainer(),this._renderPointer()]:null)}_renderPointer(){return this.dockEnabled?null:(0,D.K)("div",{class:w.pointer,key:"popup-pointer",role:"presentation"},(0,D.K)("div",{class:this.classes(w.pointerDirection,w.shadow)}))}_renderMainContainer(){const{dockEnabled:t}=this,e={[w.shadow]:t};return(0,D.K)("div",{afterCreate:this._setMainContainerNode,afterUpdate:this._setMainContainerNode,bind:this,class:this.classes(w.main,k.D.widget,e)},this._featuresWidget.render())}_getAnimationDurationMS(){const{_containerNode:t}=this;return t?1e3*parseFloat(window.getComputedStyle(t).animationDuration):200}async _handleFocus(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._focusAbortController?.abort(),this._focusAbortController=new AbortController;const e=this._focusAbortController.signal;t&&await(0,l.whenOnce)((()=>!0===this.viewModel?.active),{signal:e}),await(0,s.ignoreAbortErrors)((0,r.waitAnimationFrame)(e)),await(0,s.ignoreAbortErrors)((0,s.after)(this._getAnimationDurationMS(),e)),this._featuresWidget.focus()}_isOutsideView(t){const{popupHeight:e,popupWidth:i,screenLocation:o,side:n,view:s}=t;if(isNaN(i)||isNaN(e)||!s||!o)return!1;const l=s.padding;return"right"===n&&o.x+i/2>s.width-l.right||"left"===n&&o.x-i/2<l.left||"top"===n&&o.y-e<l.top||"bottom"===n&&o.y+e>s.height-l.bottom}_calculateAutoAlignment(t){if("auto"!==t)return t;const{_pointerOffsetInPx:e,_containerNode:i,_mainContainerNode:o,viewModel:n}=this,{screenLocation:s,view:l}=n;if(null==s||!l||!i)return"top-center";function r(t){return parseInt(t.replaceAll(/[^-\d.]/g,""),10)}const a=o?window.getComputedStyle(o,null):null,d=a?r(a.getPropertyValue("max-height")):0,h=a?r(a.getPropertyValue("height")):0,{height:c,width:u}=i.getBoundingClientRect(),p=u+e,g=Math.max(c,d,h)+e,v=this._isOutsideView({popupHeight:g,popupWidth:p,screenLocation:s,side:"right",view:l}),_=this._isOutsideView({popupHeight:g,popupWidth:p,screenLocation:s,side:"left",view:l}),w=this._isOutsideView({popupHeight:g,popupWidth:p,screenLocation:s,side:"top",view:l}),b=this._isOutsideView({popupHeight:g,popupWidth:p,screenLocation:s,side:"bottom",view:l});return _?w?"bottom-right":"top-right":v?w?"bottom-left":"top-left":w?b?"top-center":"bottom-center":"top-center"}_callCurrentAlignment(t){return"function"==typeof t?t.call(this):t}_getCurrentAlignment(){const{alignment:t,dockEnabled:e}=this;return e||!this.viewModel.active?null:this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(t)))}_setCurrentAlignment(){this._set("currentAlignment",this._getCurrentAlignment())}_setCurrentDockPosition(){this._set("currentDockPosition",this._getCurrentDockPosition())}_calculatePositionResult(t){const e=["left","right"];return(0,y.V8)(this.container)&&e.reverse(),t?.replace(/leading/gi,e[0]).replaceAll(/trailing/gi,e[1])}_callDockPosition(t){return"function"==typeof t?t.call(this):t}_getDockPosition(){return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition(this.dockOptions?.position)))}_getCurrentDockPosition(){return this.dockEnabled&&this.viewModel.active?this._getDockPosition():null}_calculateAutoDockPosition(t){if("auto"!==t)return t;const e=this.viewModel?.view,i=(0,y.V8)(this.container)?"top-left":"top-right";if(!e)return i;const o=e.padding||{left:0,right:0,top:0,bottom:0},n=e.width-o.left-o.right,{breakpoints:s}=e;return s&&n<=s.xsmall?"bottom-center":i}_getDockIcon(){const t=this._getDockPosition();if(this.dockEnabled)return"minimize";switch(t){case"top-left":case"bottom-left":return"dock-left";case"top-center":return"maximize";case"bottom-center":return"dock-bottom";default:return"dock-right"}}_handleDockIcon(){this._dockAction.icon=this._getDockIcon()}_handleDockEnabled(){this._dockAction.title=this.dockEnabled?this.messages?.undock:this.messages?.dock}_setMainContainerNode(t){this._mainContainerNode=t}_positionContainer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._containerNode;if(t&&(this._containerNode=t),!this._containerNode)return;const{screenLocation:e}=this.viewModel,{width:i}=this._containerNode.getBoundingClientRect(),o=this._calculatePositionStyle(e,i);o&&Object.assign(this._containerNode.style,o)}_calculateFullWidth(t){const{currentAlignment:e,_pointerOffsetInPx:i}=this;return"top-left"===e||"bottom-left"===e||"top-right"===e||"bottom-right"===e?t+i:t}_calculateAlignmentPosition(t,e,i,o){const{currentAlignment:n,_pointerOffsetInPx:s}=this;if(!i)return;const{padding:l}=i,r=o/2,a=i.height-e,d=i.width-t;return"bottom-center"===n?{top:e+s-l.top,left:t-r-l.left}:"top-left"===n?{bottom:a+s-l.bottom,right:d+s-l.right}:"bottom-left"===n?{top:e+s-l.top,right:d+s-l.right}:"top-right"===n?{bottom:a+s-l.bottom,left:t+s-l.left}:"bottom-right"===n?{top:e+s-l.top,left:t+s-l.left}:"top-center"===n?{bottom:a+s-l.bottom,left:t-r-l.left}:void 0}_calculatePositionStyle(t,e){const{dockEnabled:i,view:o}=this;if(!o)return;if(i)return{left:"",top:"",right:"",bottom:""};if(null==t||!e)return;const n=this._calculateFullWidth(e),s=this._calculateAlignmentPosition(t.x,t.y,o,n);return s?{top:void 0!==s.top?`${s.top}px`:"auto",left:void 0!==s.left?`${s.left}px`:"auto",bottom:void 0!==s.bottom?`${s.bottom}px`:"auto",right:void 0!==s.right?`${s.right}px`:"auto"}:void 0}_viewChange(t,e){t&&e&&(this.close(),this.clear())}_viewReadyChange(t,e){t?this._wireUpView():e&&(this.close(),this.clear())}_wireUpView(){this._setDockEnabledForViewSize(this.dockOptions)}_dockingThresholdCrossed(t,e,i){const[o,n]=t,[s,l]=e,{width:r=0,height:a=0}=i??{};return o<=r&&s>r||o>r&&s<=r||n<=a&&l>a||n>a&&l<=a}_updateDockEnabledForViewSize(t,e){if(!t||!e)return;const i=this.viewModel?.view?.padding||{left:0,right:0,top:0,bottom:0},o=i.left+i.right,n=i.top+i.bottom,s=[],l=[];s[0]=t[0]-o,s[1]=t[1]-n,l[0]=e[0]-o,l[1]=e[1]-n;const{dockOptions:r}=this,a=r.breakpoint;this._dockingThresholdCrossed(s,l,a)&&this._setDockEnabledForViewSize(r),this._setCurrentDockPosition()}_toggleScreenLocationEnabled(){const{dockEnabled:t,viewModel:e}=this;if(!e)return;const i=e.active&&!t;e.screenLocationEnabled=i}_shouldDockAtCurrentViewSize(t){const e=t.breakpoint,i=this.viewModel?.view?.ui;if(!i)return!1;const{width:o,height:n}=i;if(isNaN(o)||isNaN(n))return!1;if(!e)return!1;const s=e.hasOwnProperty("width")&&o<=(e.width??0),l=e.hasOwnProperty("height")&&n<=(e.height??0);return s||l}_setDockEnabledForViewSize(t){t.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(t))}};(0,o._)([(0,d.MZ)({readOnly:!0})],P.prototype,"_featureNavigationTop",null),(0,o._)([(0,d.MZ)()],P.prototype,"actions",null),(0,o._)([(0,d.MZ)({readOnly:!0})],P.prototype,"active",null),(0,o._)([(0,d.MZ)()],P.prototype,"alignment",void 0),(0,o._)([(0,d.MZ)()],P.prototype,"autoCloseEnabled",null),(0,o._)([(0,d.MZ)()],P.prototype,"defaultPopupTemplateEnabled",null),(0,o._)([(0,d.MZ)()],P.prototype,"content",null),(0,o._)([(0,d.MZ)()],P.prototype,"collapsed",null),(0,o._)([(0,d.MZ)({readOnly:!0})],P.prototype,"currentAlignment",null),(0,o._)([(0,d.MZ)({readOnly:!0})],P.prototype,"currentDockPosition",null),(0,o._)([(0,d.MZ)()],P.prototype,"dockOptions",null),(0,o._)([(0,d.MZ)()],P.prototype,"dockEnabled",void 0),(0,o._)([(0,d.MZ)({readOnly:!0})],P.prototype,"featureCount",null),(0,o._)([(0,d.MZ)()],P.prototype,"featureMenuOpen",null),(0,o._)([(0,d.MZ)()],P.prototype,"features",null),(0,o._)([(0,d.MZ)()],P.prototype,"goToOverride",null),(0,o._)([(0,d.MZ)()],P.prototype,"headingLevel",void 0),(0,o._)([(0,d.MZ)()],P.prototype,"highlightEnabled",null),(0,o._)([(0,d.MZ)()],P.prototype,"icon",null),(0,o._)([(0,d.MZ)()],P.prototype,"initialDisplayMode",null),(0,o._)([(0,d.MZ)()],P.prototype,"location",null),(0,o._)([(0,d.MZ)()],P.prototype,"label",null),(0,o._)([(0,d.MZ)(),(0,E.G)("esri/widgets/Popup/t9n/Popup")],P.prototype,"messages",void 0),(0,o._)([(0,d.MZ)()],P.prototype,"promises",null),(0,o._)([(0,d.MZ)({readOnly:!0})],P.prototype,"selectedFeature",null),(0,o._)([(0,d.MZ)({readOnly:!0})],P.prototype,"selectedDrillInFeature",null),(0,o._)([(0,d.MZ)()],P.prototype,"selectedFeatureIndex",null),(0,o._)([(0,d.MZ)({readOnly:!0})],P.prototype,"selectedFeatureWidget",null),(0,o._)([(0,d.MZ)()],P.prototype,"title",null),(0,o._)([(0,d.MZ)()],P.prototype,"updateLocationEnabled",null),(0,o._)([(0,d.MZ)()],P.prototype,"view",null),(0,o._)([(0,d.MZ)({type:b.default}),(0,C.U)(["triggerAction","trigger-action"])],P.prototype,"viewModel",void 0),(0,o._)([(0,d.MZ)()],P.prototype,"visible",null),(0,o._)([(0,d.MZ)({type:M,nonNullable:!0})],P.prototype,"visibleElements",void 0),P=(0,o._)([(0,h.$)("esri.widgets.Popup")],P);const O=P},62412:(t,e,i)=>{i.r(e),i.d(e,{default:()=>r});var o=i(93800),n=(i(50925),i(21265),i(14746),i(74719),i(75269)),s=i(65140);let l=class extends s.default{constructor(t){super(t)}};l=(0,o._)([(0,n.$)("esri.widgets.Popup.PopupViewModel")],l);const r=l}}]);