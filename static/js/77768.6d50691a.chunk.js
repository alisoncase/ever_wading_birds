"use strict";(self.webpackChunkever_wading_birds=self.webpackChunkever_wading_birds||[]).push([[77768],{36409:(e,t,r)=>{r.d(t,{Ge:()=>d,WT:()=>g,XV:()=>h});var i=r(84190),n=r(75400),s=r(54824),o=r(93321),a=r(26266),l=r(30312),c=r(70576),u=r(5616),p=r(72769);function d(e,t,r){const i=1===e?10:e;return i**(r?Math.round(function(e,t){return Math.log(e)/Math.log(t)}(p.X/t,i)):0)}function h(e){const{isGeographic:t,isWebMercator:r}=e;return!t&&!r}function g(e,t,r){const p="number"==typeof e?null:e,d=r??p?.spatialReference;if(null==d||!(0,c.fn)(d)||h(d))return(0,i.GA)(d);let g=p?.x??e,f=p?.y??t;const M=1/Math.sqrt(2);let v=g+M,w=f+M;const{isWebMercator:y,isGeographic:S}=d;let R=S&&!(0,a.isSupported)(d)?o.default.WGS84:d;if(y){let e=new n.default({x:g,y:f,spatialReference:d});(0,u.webMercatorToGeographic)(e,!0,e),g=e.x,f=e.y,e=new n.default({x:v,y:w,spatialReference:d}),(0,u.webMercatorToGeographic)(e,!0,e),v=e.x,w=e.y,R=o.default.WGS84}const P=new s.default({paths:[[[g,f],[v,w]]],spatialReference:R}),x=(0,l.straightLineDensify)(P,10);let _;try{[_]=(0,a.geodesicLengths)([x],"meters")}catch{return(0,i.GA)(d)}return _}},72769:(e,t,r)=>{r.d(t,{X:()=>i,b:()=>n});const i=50,n=5},77768:(e,t,r)=>{r.d(t,{GridSnappingEngine:()=>S});var i=r(93800),n=r(6946),s=r(50925),o=r(64682),a=r(84190),l=r(48602),c=(r(21265),r(14746),r(75269)),u=r(89227),p=r(96913),d=r(30312),h=r(11099),g=r(72769),f=r(36409),M=r(49281),v=r(37229),w=r(94821),y=r(30296);let S=class extends n.default{constructor(e){super(e),this.options=null}destroy(){this._set("options",null)}get grid(){return this.view.grid}get effectiveViewRotation(){return this.grid?.rotateWithMap?0:(0,o.kU)(this.view.rotation??0)}get gridRotation(){return(0,o.kU)(this.grid?.rotation??0)}get gridCenter(){const{spatialReference:e,grid:t}=this;if(!t||!e||!(0,p.isLoadedOrLoadFor)(t.center.spatialReference,e))return null;try{const r=(0,p.project)(t.center,e),i=e.isWrappable&&null!=this.view?.center?(0,d.getClosestDenormalizedXToReference)(r.x,this.view.center.x,e):r.x;return(0,M.vt)(i,r.y,r.z)}catch(r){return s.A.getLogger(this).errorOnce("Grid Snapping - Failed to project grid center.",r),null}}get offsetScaleFactor(){const{pixelsPerStride:e,grid:t}=this;if(!t||!e)return 1;const{majorLineInterval:r,dynamicScaling:i}=t;return r<1?null:(0,f.Ge)(r,e,i)}get spatialReference(){return this.view.spatialReference}get gridMetersPerStride(){const{grid:e}=this;return e?(0,a.oU)(e.spacing,e.units,"meters"):null}get viewMetersPerPixel(){const{viewMetersPerSRUnit:e}=this;return null==e?null:e*(0,h.i1)(this.view.scale,this.view.spatialReference)}get viewMetersPerSRUnit(){const{spatialReference:e}=this.view;return this.gridCenter?(0,f.WT)(this.gridCenter[0],this.gridCenter[1],e):null}get pixelsPerStride(){const{gridMetersPerStride:e,viewMetersPerPixel:t}=this;return t&&e?e/t:null}get updating(){return null!=this.grid&&null!=this.spatialReference&&null==this.viewMetersPerSRUnit}async fetchCandidates(e,t,r){const{options:i,view:n}=this;if(!i?.effectiveGridEnabled||!n.grid||r.feature?.attributes&&v.io in r.feature.attributes)return[];const s=r.coordinateHelper.arrayToPoint(e),o=i.distance*("touch"===r.pointer?i.touchSensitivityMultiplier:1);return this.fetchCandidatesSync(s,o)}fetchCandidatesSync(e,t){const r=[],{grid:i,effectiveViewRotation:n,gridRotation:s,gridCenter:o,viewMetersPerPixel:a,viewMetersPerSRUnit:l,offsetScaleFactor:c,spatialReference:u,gridMetersPerStride:d,pixelsPerStride:h}=this;if(!(i&&a&&l&&o&&u&&c&&d&&h))return r;if(!i.dynamicScaling&&h<g.b)return r;if(!(0,p.isLoadedOrLoadFor)(e.spatialReference,u))return r;const f=(0,p.project)(e,u),v=(0,M.vt)(f.x,f.y,f.z),S=R(v,-s,o,-n),b=d/l*c,G=P(S,b,o),{shouldSnapX:Z,shouldSnapY:C}=x(G,S,t,a,l);if(!Z&&!C)return[];const L=(0,M.vt)((Z?G:S)[0],(C?G:S)[1]),U=R(L,s,o,n),W=R(G,s,o,n);if(C){const e=_(G,S,b,"y"),t=R(e,s,o,n);r.push(new y.o({lineStart:W,lineEnd:t,targetPoint:U,isDraped:!1}))}if(Z){const e=_(G,S,b,"x"),t=R(e,s,o,n);r.push(new y.o({lineStart:W,lineEnd:t,targetPoint:U,isDraped:!1}))}return Z&&C&&r.push(new w.N(U,r[0],r[1],!1)),r}};(0,i._)([(0,l.MZ)({constructOnly:!0})],S.prototype,"view",void 0),(0,i._)([(0,l.MZ)()],S.prototype,"options",void 0),(0,i._)([(0,l.MZ)()],S.prototype,"grid",null),(0,i._)([(0,l.MZ)()],S.prototype,"effectiveViewRotation",null),(0,i._)([(0,l.MZ)()],S.prototype,"gridRotation",null),(0,i._)([(0,l.MZ)()],S.prototype,"gridCenter",null),(0,i._)([(0,l.MZ)()],S.prototype,"offsetScaleFactor",null),(0,i._)([(0,l.MZ)()],S.prototype,"spatialReference",null),(0,i._)([(0,l.MZ)()],S.prototype,"gridMetersPerStride",null),(0,i._)([(0,l.MZ)()],S.prototype,"viewMetersPerPixel",null),(0,i._)([(0,l.MZ)()],S.prototype,"viewMetersPerSRUnit",null),(0,i._)([(0,l.MZ)()],S.prototype,"pixelsPerStride",null),(0,i._)([(0,l.MZ)()],S.prototype,"updating",null),S=(0,i._)([(0,c.$)("esri.views.interactive.snapping.GridSnappingEngine")],S);const R=(e,t,r,i)=>{const n=(0,M.Hh)(e[0],e[1],e[2]);return(0,u.L)(n,(0,u.L)(n,n,r,t),r,i)},P=(e,t,r)=>{const i=(e[0]-r[0])/t,n=(e[1]-r[1])/t,s=Math.trunc(i),o=Math.trunc(n),a=Math.round(i%1),l=Math.round(n%1),c=r[0]+(s+a)*t,u=r[1]+(o+l)*t;return(0,M.vt)(c,u)},x=(e,t,r,i,n)=>{if(i<=0)return{shouldSnapX:!1,shouldSnapY:!1};const s=(e[0]-t[0])/i,o=(e[1]-t[1])/i;return{shouldSnapX:Math.abs(s*n)<r,shouldSnapY:Math.abs(o*n)<r}},_=(e,t,r,i)=>{if("y"===i){const i=t[0]>e[0]?1:-1;return(0,M.vt)(e[0]+r*i,e[1])}const n=t[1]>e[1]?1:-1;return(0,M.vt)(e[0],e[1]+r*n)}}}]);