"use strict";(self.webpackChunkever_wading_birds=self.webpackChunkever_wading_birds||[]).push([[64566],{15390:(t,e,n)=>{n.d(e,{P:()=>c,r:()=>r});var r,i,o=n(89227),a=n(28473),s=n(12096);class c{get planes(){return this.frustum}get points(){return this._points}get mutablePoints(){return this._points}get direction(){return this._direction}get origin(){return this._origin}constructor(t){this.renderCoordsHelper=t,this.frustum=(0,s.vt)(),this._points=(0,s.Qy)(),this.lines=new Array(12),this._origin=(0,a.vt)(),this._direction=(0,a.vt)(),this._altitude=null;for(let e=0;e<12;e++)this.lines[e]={origin:null,direction:(0,a.vt)(),endpoint:null}}update(t){(0,s.ui)(t.viewMatrix,t.projectionMatrix,this.frustum,this._points),(0,o.c)(this._origin,t.eye),(0,o.c)(this._direction,t.viewForward),this._altitude=this.renderCoordsHelper.getAltitude(this._origin),this._updateLines()}updatePoints(t){for(let e=0;e<this._points.length;e++)(0,o.c)(this._points[e],t[e]);(0,s.DV)(this.frustum,this._points),this._updateLines()}get altitude(){return this._altitude}intersectsSphere(t){return(0,s.m7)(this.frustum,t)}intersectsRay(t){return(0,s.pw)(this.frustum,t)}intersectsLineSegment(t,e){return(0,s.ST)(this.frustum,t,e)}intersectsPoint(t){return(0,s.bU)(this.frustum,t)}_updateLines(){const t=this._points;for(let e=0;e<4;e++){const n=e+4;l(this.lines[e],t[e],t[n]),l(this.lines[e+4],t[e],3===e?t[0]:t[e+1]),l(this.lines[e+8],t[n],3===e?t[4]:t[n+1])}}}function l(t,e,n){t.origin=e,t.endpoint=n,(0,o.o)(t.direction,e,n)}c.planePointIndices=s.c8,c.nearFarLineIndices=[[s.J7.NEAR_BOTTOM_LEFT,s.J7.FAR_BOTTOM_LEFT],[s.J7.NEAR_BOTTOM_RIGHT,s.J7.FAR_BOTTOM_RIGHT],[s.J7.NEAR_TOP_RIGHT,s.J7.FAR_TOP_RIGHT],[s.J7.NEAR_TOP_LEFT,s.J7.FAR_TOP_LEFT]],(i=r||(r={}))[i.NEAR_FAR_BOTTOM_LEFT=0]="NEAR_FAR_BOTTOM_LEFT",i[i.NEAR_FAR_BOTTOM_RIGHT=1]="NEAR_FAR_BOTTOM_RIGHT",i[i.NEAR_FAR_TOP_RIGHT=2]="NEAR_FAR_TOP_RIGHT",i[i.NEAR_FAR_TOP_LEFT=3]="NEAR_FAR_TOP_LEFT",i[i.NEAR_BOTTOM=4]="NEAR_BOTTOM",i[i.NEAR_RIGHT=5]="NEAR_RIGHT",i[i.NEAR_TOP=6]="NEAR_TOP",i[i.NEAR_LEFT=7]="NEAR_LEFT",i[i.FAR_BOTTOM=8]="FAR_BOTTOM",i[i.FAR_RIGHT=9]="FAR_RIGHT",i[i.FAR_TOP=10]="FAR_TOP",i[i.FAR_LEFT=11]="FAR_LEFT"},18162:(t,e,n)=>{n.d(e,{F:()=>o});n(96913);var r=n(93321),i=n(31183);function o(t,e,n,r,o){return!(null==e||null==r||t.length<2)&&(a.x=t[0],a.y=t[1],a.z=t[2],a.spatialReference=e,(0,i.g)(a,n,r,o))}const a=(0,n(62240).T)(0,0,0,r.default.WGS84)},31183:(t,e,n)=>{n.d(e,{W:()=>s,g:()=>a});var r=n(28473),i=n(96913),o=n(67093);function a(t,e,n,r){if((0,i.canProjectWithoutEngine)(t.spatialReference,n)){c[0]=t.x,c[1]=t.y;const i=t.z;return c[2]=i??r??0,(0,o.projectBuffer)(c,t.spatialReference,0,e,n,0)}const a=(0,i.tryProjectWithZConversion)(t,n);return!!a&&(e[0]=a?.x,e[1]=a?.y,e[2]=a?.z??r??0,!0)}async function s(t,e,n,r,o){return await(0,i.initializeProjection)(t.spatialReference,n,null,o),a(t,e,n,r)}const c=(0,r.vt)()},47160:(t,e,n)=>{n.d(e,{T:()=>a});var r=n(64682),i=n(89227),o=n(28473);function a(t,e,n){t.worldUpAtPosition(e,s),(0,i.d)(c,n,e);const o=(0,i.l)(c);return 0===o?0:(0,r.XM)((0,i.f)(c,s)/o)}const s=(0,o.vt)(),c=(0,o.vt)()},64566:(t,e,n)=>{n.d(e,{AO:()=>Pt,WE:()=>Bt,gn:()=>te,Fj:()=>jt,Cz:()=>Gt,V2:()=>Qt,CA:()=>$t,gU:()=>Vt,F3:()=>de,wI:()=>he,rW:()=>ne,v2:()=>Dt,ZC:()=>Ht,dl:()=>zt,tv:()=>Jt,J9:()=>_e,Dd:()=>Te,w1:()=>pe,lr:()=>Zt,XM:()=>ye});var r,i,o,a=n(29306),s=n(5839),c=n(50925),l=n(64682),u=n(49959),f=n(89227),d=n(28473),h=n(30142),p=n(75400),T=n(96913),R=n(93321),g=n(31183),m=n(70075),v=n(18162),M=n(51064),_=n(68662),y=n(87752),A=n(10382),E=n(98080),I=n(12560),O=n(65920),w=n(53053),S=n(12096),F=n(32006);function N(t,e){const n=[],r=[];return b(n,t,e,o.LEFT),b(r,n,e,o.BOTTOM),b(n,r,e,o.RIGHT),b(r,n,e,o.TOP),r}function b(t,e,n,r){const o=x(n,r);if(t.length=0,e.length){o(U,e[0],e[0])===i.INSIDE&&C(t,e[0]);for(let n=0;n<e.length;n++){const r=e[n===e.length-1?0:n+1];switch(o(U,e[n],r)){case i.INSIDE:C(t,r);break;case i.INSIDE_OUT:C(t,(0,E.o8)(U));break;case i.OUTSIDE_IN:C(t,(0,E.o8)(U)),C(t,r);case i.OUTSIDE:}}}}function C(t,e){0!==t.length&&(0,F.aI)(t.at(-1),e)||t.push(e)}function x(t,e){const n=e===o.LEFT||e===o.RIGHT?0:1,a=t[e],s=e===o.LEFT||e===o.BOTTOM?r.MIN:r.MAX,c=0===n?1:0;return(t,e,o)=>{if(e[n]<a&&o[n]<a)return s===r.MIN?i.OUTSIDE:i.INSIDE;if(e[n]>a&&o[n]>a)return s===r.MIN?i.INSIDE:i.OUTSIDE;const l=(o[c]-e[c])/(o[n]-e[n]),u=e[c]+l*(a-e[n]);return t[n]=a,t[c]=u,(e[n]<a?1:-1)*s>0?i.OUTSIDE_IN:i.INSIDE_OUT}}!function(t){t[t.MIN=1]="MIN",t[t.MAX=-1]="MAX"}(r||(r={})),function(t){t[t.OUTSIDE=0]="OUTSIDE",t[t.INSIDE=1]="INSIDE",t[t.OUTSIDE_IN=2]="OUTSIDE_IN",t[t.INSIDE_OUT=3]="INSIDE_OUT"}(i||(i={})),function(t){t[t.LEFT=0]="LEFT",t[t.BOTTOM=1]="BOTTOM",t[t.RIGHT=2]="RIGHT",t[t.TOP=3]="TOP"}(o||(o={}));const U=(0,E.vt)();var P=n(91102),D=n(15390),L=n(86767);const H=(0,d.fA)(0,1,0),G=(0,d.fA)(0,0,1),k=(0,A.vt)(),z=(0,d.vt)(),J=(0,d.vt)();function j(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:(0,L.NP)();const{direction:i,up:o}=r;return(0,y.N9)(k,-(0,l.kU)(e)),(0,y.eL)(k,k,(0,l.kU)(n)),(0,f.t)(i,G,k),(0,f.h)(i,i,-1),(0,f.t)(o,H,k),r}function B(t,e,n,r,i){const o=e.lines[D.r.FAR_LEFT].direction,a=(i-n.getAltitude(r))/o[2];(0,f.b)(t,r,o,a)}const W=(0,d.vt)(),q=Object.freeze(Object.defineProperty({__proto__:null,directionToHeadingTilt:function(t,e,n,r){return(0,L.gn)(e,n,r,G,H)},eyeForCenterWithHeadingTilt:function(t,e,n,r){const i=j(t,n,r),o=(0,d.vt)();return(0,f.h)(o,i.direction,-e),(0,f.g)(o,o,t),{up:i.up,eye:o,heading:n,tilt:r}},eyeTiltToLookAtTilt:function(t){return(0,l.kU)(t)},headingTiltToDirectionUp:j,lookAtTiltToEyeTilt:function(t){return(0,l.KJ)(t)},toArea:function(t,e){const n=t.frustum,{renderCoordsHelper:r}=t,i=r.getAltitude(e),o=t.spatialReference,a=t.state.camera.eye,s=[],c=n.planes[S.FB.FAR];for(let l=0;l<4;l++){const t=n.lines[l];r.intersectInfiniteManifold((0,P.LV)(t.origin,t.direction),i,W)||B(W,n,r,t.endpoint,i),(0,L.gz)(W,a,W,c),s.push((0,E.fA)(W[0],W[1]))}return function(t,e,n){const r=t.map((t=>((0,f.i)(W,t[0],t[1],0),e.fromRenderCoords(W,W,n),[W[0],W[1]])));return r.length<=2?new O.default({spatialReference:n}):(r.push(r[0].slice()),(0,w.$3)(r)||r.reverse(),new O.default({rings:[r],spatialReference:n}))}(N(s,r.extent),r,o)},toExtent:function(t,e,n,r,i){const o=t.renderSpatialReference,a=t.spatialReference??e.spatialReference;return(0,g.g)(e,z,o),(0,g.g)(e,J,o),z[0]-=n/2,J[0]+=n/2,z[1]-=r/2,J[1]+=r/2,(0,v.F)(z,o,z,a),(0,v.F)(J,o,J,a),i?(i.xmin=z[0],i.ymin=z[1],i.xmax=J[0],i.ymax=J[1],i.spatialReference=a):i=new I.default(z[0],z[1],J[0],J[1],a),i}},Symbol.toStringTag,{value:"Module"}));var Y=n(60548),K=n(24646),X=n(12147),Z=n(1277),V=n(10872),$=n(89476),Q=n(5616),tt=n(47160),et=n(66797),nt=n(11741);const rt=(0,d.fA)(0,0,1),it=(0,f.n)((0,d.vt)(),(0,d.fA)(1,1,1)),ot=new s.hr(-180,180),at=(0,A.vt)(),st=(0,d.vt)(),ct=(0,d.vt)();function lt(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:(0,L.NP)();(0,f.e)(st,t,rt),0===(0,f.f)(st,st)&&(0,f.e)(st,t,it),(0,y.$0)(at,-(0,l.kU)(e),t),(0,y.e$)(at,at,-(0,l.kU)(n),st);const{up:i,direction:o}=r;return(0,f.e)(i,st,t),(0,f.n)(i,i),(0,f.t)(i,i,at),(0,f.n)(o,t),(0,f.v)(o,o),(0,f.t)(o,o,at),r}function ut(t){const e=t[1];t[1]=-t[2],t[2]=e}function ft(t,e){const n=lt(e,t.heading,t.tilt);return t.up=n.up,t}function dt(t,e){const n=[],r=[],i=(0,X.FD)();for(let a=0;a<t.length;a++){const o=t[a],s=a===t.length-1?t[0]:t[a+1],c=(0,Z.Cr)(o,s,Mt),l=(0,V.vE)(e,c.origin,c.vector,V.v1.NONE,mt);switch(l){case V.Nj.INSIDE:n.push(o);break;case V.Nj.OUTSIDE:r.push(o);break;case V.Nj.INTERSECTS_INSIDE_OUT:case V.Nj.INTERSECTS_OUTSIDE_IN:{const[t,a,s]=l===V.Nj.INTERSECTS_INSIDE_OUT?[1,n,r]:[-1,r,n],c=(0,V.Qj)(e),u=(0,f.b)((0,d.vt)(),mt,c,t*i),h=(0,f.b)((0,d.vt)(),mt,c,t*-i);a.push(o),a.push(u),s.push(h)}}}const o=[];return n.length&&o.push(n),r.length&&o.push(r),o}const ht={minCurvature:(0,l.kU)(5),maxCurvature:(0,l.kU)(50),minSamples:1,maxSamples:6},pt=(0,d.fA)(1,0,0),Tt=(0,d.fA)(0,1,0),Rt=(0,d.vt)(),gt=(0,d.vt)(),mt=(0,d.vt)(),vt=(0,$.c)(),Mt=(0,Z.vt)(),_t=(0,K.vt)(),yt=Object.freeze(Object.defineProperty({__proto__:null,directionToHeadingTilt:function(t,e,n,r){const i=st,o=ct;return(0,f.n)(i,t),(0,f.e)(ct,i,rt),0===(0,f.f)(ct,ct)&&(0,f.e)(ct,i,it),(0,f.e)(o,ct,i),(0,L.gn)(e,n,r,i,o)},eyeForCenterWithHeadingTilt:function(t,e,n,r){const i={eye:(0,d.vt)(),up:null,tilt:r,heading:n},o=st;o[0]=t[0],o[1]=t[2],o[2]=-t[1];const a=e,s=(0,l.kU)(n),c=(0,l.kU)(r),u=Math.sin(s),h=Math.cos(s),p=Math.sin(c),T=Math.cos(c),R=(0,f.l)(o);let g;if(Math.abs(c)<1e-8)g=a+R;else{const t=R/p,e=(0,l.YN)(a/t),n=Math.PI-c-e;g=t*Math.sin(n)}const m=T*a,v=a*a*(p*p),M=h*h*v,_=g-m,y=_*_,A=M*(M+y-o[1]*o[1]);if(A<0)return(0,f.h)(i.eye,o,g/R),i.tilt=0,ft(i,t);const E=Math.sqrt(A),I=o[1]*_,O=M+y;let w;if(w=h>0?-E+I:E+I,Math.abs(O)<1e-8)return R<1e-8?(i.eye[0]=0,i.eye[1]=0,i.eye[2]=a):(0,f.h)(i.eye,o,g/R),i.tilt=0,ut(i.eye),ft(i,t);i.eye[1]=w/O;const S=u*u*v,F=p*a,N=h*F*i.eye[1],b=i.eye[1]*i.eye[1],C=1-b,x=Math.sqrt(C),U=M*b+S-2*N*x*_+C*y;return Math.abs(U)<1e-8?((0,f.h)(i.eye,o,g/R),i.tilt=0,ut(i.eye),ft(i,t)):(i.eye[0]=(C*(g*o[0]-m*o[0])-F*x*(o[0]*i.eye[1]*h+o[2]*u))/U,i.eye[2]=(C*(g*o[2]-m*o[2])-F*x*(o[2]*i.eye[1]*h-o[0]*u))/U,(0,f.h)(i.eye,i.eye,g),ut(i.eye),ft(i,t))},eyeTiltToLookAtTilt:function(t,e,n){const r=(0,l.kU)(t),i=(0,f.l)(e);return(0,l.YN)(n/(i/Math.sin(r)))+r},headingTiltToDirectionUp:lt,lookAtTiltToEyeTilt:function(t,e,n){const r=(0,f.l)(e),i=Math.sqrt(n*n+r*r-2*n*r*Math.cos(Math.PI-t)),o=(0,l.YN)(n/(i/Math.sin(t)));return(0,l.KJ)(t-o)},toArea:function(t,e){const n=t.frustum,{renderCoordsHelper:r}=t,i=r.getAltitude(e),o=t.spatialReference,a=r.referenceEllipsoid.radius,s=t.state.camera,c=s.eye,u=1+(0,f.j)(c,e)/(a+i),h=Math.sqrt(u*u-1),{minCurvature:p,maxCurvature:T,minSamples:R,maxSamples:g}=ht,m=function(t){const{renderCoordsHelper:e,state:{camera:n}}=t,{center:r,eye:i}=n,o=Math.abs(e.getAltitude(r)),a=Math.abs(Math.PI/2-(0,tt.T)(e,r,i));return(0,$.b)(vt,e.referenceEllipsoid.radius+o),(0,$.d)(vt,a,n.distance,n.fovY)}(t),v=(0,l.qE)((h-p)/(T-p),0,1),M=Math.round((0,l.Cc)(R,g,v)),_=s.aboveGround,y=n.planes[S.FB.FAR],A=[],E=(0,V.O_)(d.uY,pt,(0,V.vt)()),I=(0,V.O_)(d.uY,Tt,(0,V.vt)());(0,Y.s)(_t,0,0,0,0);for(let O=0;O<4;O++){const t=O===D.r.NEAR_FAR_BOTTOM_RIGHT&&!_||O===D.r.NEAR_FAR_TOP_LEFT&&_?1-m:0,e=O===D.r.NEAR_FAR_BOTTOM_RIGHT&&_||O===D.r.NEAR_FAR_TOP_LEFT&&!_?m:1,o=n.lines[O],a=n.lines[3===O?0:O+1];for(let n=0;n<M;n++){const s=n/M,u=O===D.r.NEAR_FAR_BOTTOM_RIGHT?1-(1-s)**2:O===D.r.NEAR_FAR_TOP_LEFT?s**2:s,h=0===n?0:(0,l.Cc)(t,e,u),p=(0,f.m)(gt,o.origin,a.origin,h),T=(0,nt.nu)(o.direction,a.direction,h,Rt);r.intersectManifoldClosestSilhouette((0,P.LV)(p,T),i,mt),(0,L.gz)(mt,c,mt,y),A.push((0,d.o8)(mt)),0!==A.length&&(0,f.y)(A.at(-1),mt);const R=((0,V.Tj)(E,mt)?1:0)|((0,V.Tj)(I,mt)?2:0);_t[R]=1}}A.length>2&&(0,f.y)(A[0],A.at(-1));const F=function(t,e,n){const r=2*(0,X.FD)();return t.map((t=>{const i=[];let o=!1;for(const a of t)e.fromRenderCoords(a,mt,n),Math.abs(a[0])<r&&Math.abs(a[1])<r?(i.push([null,mt[1]]),i.push([null,mt[1]]),o=!0):i.push([mt[0],mt[1]]);if(o)for(let e=0;e<i.length;e++){const t=i[e];if(null!=t[0])continue;const n=i[e+1],r=i.at(0===e?-1:e-1);t[0]=r[0],e++;const o=i.at(e===i.length-1?0:e+1);n[0]=o[0]}return i.push(i[0]),(0,w.$3)(i)||i.reverse(),i}))}((0,Y.f)(_t)>1?function(t,e){const n=[];for(const r of t)n.push(...dt(r,e));return n}(dt(A,E),I):[A],r,o);return new O.default({rings:F,spatialReference:o})},toExtent:function(t,e,n,r,i){let o,a,c,u;const f=e.latitude,d=(0,h.tO)(t.spatialReference).radius,p=e.longitude,T=(0,et.cq)(f,n,d)/2;o=p-T,a=p+T;const g=(0,l.kU)(f),m=(1+Math.sin(g))/(1-Math.sin(g)),v=(m+1)*Math.tan(r/d/2),M=v*v;function _(t){const e=Math.PI/2;return(t=s.uC.normalize(t,-e))>e&&(t=Math.PI-t),t}if(c=1.5*Math.PI-2*Math.atan(.5*(v+Math.sqrt(4*m+M))),u=c+r/d,c=_(c),u=_(u),u<c){const t=u;u=c,c=t}if(c=Math.max((0,l.KJ)(c),-90),u=Math.min((0,l.KJ)(u),90),a=ot.monotonic(o,a),a-o>180){const t=(a-o-180)/2;o+=t,a-=t}const y=t.spatialReference&&t.spatialReference.isGeographic?t.spatialReference:R.default.WGS84;return i?(i.xmin=o,i.ymin=c,i.xmax=a,i.ymax=u,i.spatialReference=y):i=new I.default(o,c,a,u,y),t.spatialReference&&t.spatialReference.isWebMercator&&(0,Q.geographicToWebMercator)(i,!1,i),i}},Symbol.toStringTag,{value:"Module"}));var At=n(96504),Et=n(66380);const It=()=>c.A.getLogger("esri.views.3d.support.cameraUtils"),Ot=96*39.37,wt=1,St=8,Ft=5,Nt=1,bt={heading:0,tilt:0},Ct=(0,d.vt)(),xt=new s.hr(-20037508.342788905,20037508.342788905),Ut=new s.hr(-180,180);var Pt;function Dt(t){return t.spatialReference??R.default.WGS84}function Lt(t){let{state:e}=t;return e.isGlobal?yt:q}function Ht(t,e,n,r,i){return Lt(t).headingTiltToDirectionUp(e,n,r,i)}function Gt(t,e){if(null==e)return null;const n=t.renderSpatialReference,r=Lt(t).headingTiltToDirectionUp,i=(0,d.vt)();if(!(0,g.g)(e.position,i,n))return null;const o=r(i,e.heading,e.tilt);(0,f.h)(o.direction,o.direction,t.state.camera.distance),(0,f.g)(o.direction,o.direction,i);const a=(0,_.bZ)(t,i,o.direction,o.up);return a.fov=(0,l.kU)(e.fov),a.row=e.layout.row,a.rows=e.layout.rows,a.column=e.layout.column,a.columns=e.layout.columns,a}!function(t){t[t.LOCKED=0]="LOCKED",t[t.ADJUST=1]="ADJUST"}(Pt||(Pt={}));const kt=(0,d.vt)();function zt(t,e,n){const r=t.renderSpatialReference,i=te(t,e.eye,e.viewForward,e.up,bt);let o=Dt(t);return(0,v.F)(e.eye,r,kt,o)||(o=R.default.WGS84,(0,v.F)(e.eye,r,kt,o)),null==n?n=new a.default(new p.default(kt,o),i.heading,i.tilt,(0,l.KJ)(e.fov)):(n.position.x=kt[0],n.position.y=kt[1],n.position.z=kt[2],n.position.spatialReference=o,n.heading=i.heading,n.tilt=i.tilt,n.fov=(0,l.KJ)(e.fov)),n.layout.row=e.row,n.layout.rows=e.rows,n.layout.column=e.column,n.layout.columns=e.columns,n}function Jt(t,e){const{camera:n}=t.state,{unitInMeters:r}=t.renderCoordsHelper;return e/=r,n.width/2/n.pixelRatio/(Ot/e)/Math.tan(n.fovX/2)}function jt(t,e){const{camera:n}=t.state,{unitInMeters:r}=t.renderCoordsHelper,i=e*Math.tan(n.fovX/2),o=n.width/2/n.pixelRatio;return Ot/(o/i)*r}function Bt(t,e,n,r){const i=r.levelAtScale(e),o=qt(te(t,n.eye,n.viewForward,n.up).tilt),a=Math.max(i-o,0);return r.scaleAtLevel(a)}function Wt(t,e,n){const r=n.levelAtScale(t),i=qt(e);return n.scaleAtLevel(r+i)}function qt(t){return 2*((t>90?180-t:t)/90)**2}function Yt(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=Gt(t,e);return r?function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=t.basemapTerrain?.tilingScheme;if(!r)return 0;const i=(0,h.tO)(t.spatialReference).radius,o=t.state.viewingMode===M.RT.Local?e.eye[2]:(0,f.l)(e.eye)-i;return Bt(t,jt(t,Math.abs(o-n)),e,r)}(t,r,n):0}const Kt=1,Xt=100;function Zt(t,e,n,r,i){if(0===e)return 0;const o=(0,f.j)(n.eye,r),a=t.basemapTerrain?.tilingScheme;if(!a)return It().error("#scaleToTargetDistance()","Cannot compute distance from scale without a tiling scheme"),o;let s=o;const c=te(t,n.eye,n.viewForward,n.up),u=c.tilt>90;if(t.state.isLocal){const r=(Jt(t,Wt(e,c.tilt,a))-Math.abs(n.eye[2]-i[2]))/Math.cos((0,l.kU)(c.tilt));return s=u?s-r:s+r,s}let d=1/0,p=0,T=ne(t,c.heading,c.tilt,r,o,Pt.ADJUST);if(!T)return s;const R=(0,f.l)(i);for(;d>Kt&&p<Xt;){const i=(0,f.l)(T.eye),o=u?180-T.tilt:T.tilt,g=(0,l.kU)(o),m=Math.sin(g)*i,v=Math.cos(g)*i,M=Jt(t,Wt(e,T.tilt,a)),_=u?R-M:R+M,y=(0,l.YN)(m/_),A=Math.cos(y)*_-v,E=(0,f.j)(T.eye,r);s=u?E-A:E+A,T=ne(t,c.heading,c.tilt,r,s,Pt.ADJUST);const I=ve(t,T,(0,l.KJ)(n.fov));if(!T||!I)return s;const O=Yt(t,I,R-(0,h.tO)(t.spatialReference).radius);d=Math.abs(e-O),++p}return s}async function Vt(t,e,n,r,i,o){return Qt(t,e,Jt(t,n),r,i,o)}function $t(t,e,n,r,i,o){return ve(t,ne(t,r.heading,r.tilt,e,n,i),r.fov,o)}async function Qt(t,e,n,r,i,o){const a=await re(t,r.heading,r.tilt,e,n,i,o);return(0,u.throwIfAborted)(o),Me(t,a,r.fov,o)}function te(t,e,n,r,i){return Lt(t).directionToHeadingTilt(e,n,r,i)}function ee(t,e){return!!(t.basemapTerrain&&t.renderCoordsHelper.fromRenderCoords(e,Ct,t.spatialReference)&&t.elevationProvider&&((0,At.R1)(t.elevationProvider,Ct)??0)>Ct[2]-Nt)}function ne(t,e,n,r,i,o){return ie(t,e,n,r instanceof p.default?r:null,function(t,e){const n=(0,d.vt)();if(null==e)return(0,f.c)(n,t.state.camera.center);if(e instanceof p.default){if(!(0,g.g)(e,n,t.renderSpatialReference))return null;const{basemapTerrain:r,elevationProvider:i}=t;if(null==e.z&&null!=r&&null!=i){const r=(0,At.R1)(i,e);null!=r&&t.renderCoordsHelper.setAltitude(n,r)}return n}return(0,f.c)(n,e)}(t,r),i,o)}async function re(t,e,n,r,i,o,a){const s=r instanceof p.default?r:null,c=await async function(t,e,n){const r=(0,d.vt)();if(null==e)return(0,f.c)(r,t.state.camera.center);if(e instanceof p.default){const{renderSpatialReference:i,basemapTerrain:o,elevationProvider:a}=t,s=e.spatialReference;if(await(0,g.W)(e,r,i,0,{signal:n}),(0,u.throwIfAborted)(n),null==e.z&&null!=o&&null!=a){const i=await a.queryElevation(e.x,e.y,e.z??0,s,"ground",n);(0,u.throwIfAborted)(n),null!=i&&t.renderCoordsHelper.setAltitude(r,i)}return r}return(0,f.c)(r,e)}(t,r,a);return(0,u.throwIfAborted)(a),oe(t,e,n,s,c,i,o,a)}function ie(t,e,n,r,i,o,a){if(null==i)return null;if(!r&&(r=new p.default({spatialReference:Dt(t)}),!(0,m.E)(i,t.renderSpatialReference,r)))return null;const s=ae(t,e,n,i,o,a);if(se(t,n,a)&&ee(t,s.eye)){const{tilt:a,mode:s}=ce(t,n,i,o);return ie(t,e,a,r,i,o,s)}return le(s,i)}async function oe(t,e,n,r,i,o,a,s){r||(r=new p.default({spatialReference:Dt(t)}),await(0,m.C)(i,t.renderSpatialReference,r,{signal:s})||(r=null)),(0,u.throwIfAborted)(s);const c=ae(t,e,n,i,o,a);if(se(t,n,a)&&await async function(t,e,n){if(ee(t,e))return!0;const{elevationProvider:r,spatialReference:i,renderCoordsHelper:o}=t;if(null==r||!o.fromRenderCoords(e,Ct,i))return!1;const[a,s,c]=Ct,l=await r.queryElevation(a,s,c,i,"ground",n)??0;return(0,u.throwIfAborted)(n),l>c-Nt}(t,c.eye,s)){(0,u.throwIfAborted)(s);const{tilt:a,mode:c}=ce(t,n,i,o);return oe(t,e,a,r,i,o,c,s)}return le(c,i)}function ae(t,e,n,r,i,o){const a=function(t,e,n,r,i,o){let a=0;return o===Pt.ADJUST&&function(t,e,n){const r=t.pointsOfInterest.centerOnSurfaceFrequent.distance;if(Math.log(n/r)/Math.LN2>St)return!0;const i=e,o=t.pointsOfInterest.centerOnSurfaceFrequent.renderLocation;return(0,f.j)(i,o)/(Math.tan(.5*t.state.camera.fov)*r)>Ft}(t,r,i)?(e=0,a=function(t,e,n,r){const i=me(t,r,e,n);if(!t.state.constraints.tilt)return i;const o=t.state.constraints.tilt(e);o.max=Math.min(o.max,.5*Math.PI);const a=o.min*(1-Re)+o.max*Re;return Math.min(i,a)}(t,i,n,r)):a=me(t,r,i,n),a=t.state.constraints.clampTilt(i,a),{heading:e,tilt:n=ge(t,r,i,a)}}(t,e,n,r,i=Math.max(i,t.state.constraints.minimumPoiDistance),o);return(0,Lt(t).eyeForCenterWithHeadingTilt)(r,i,a.heading,a.tilt)}function se(t,e,n){const r=t.map.ground.navigationConstraint;return n===Pt.ADJUST&&t.state.isGlobal&&e>0&&(null==r||"stay-above"===r.type)}function ce(t,e,n,r){const i=ge(t,n,r,function(t,e,n,r){let i=me(t,r,e,n);if(!t.state.constraints.tilt)return i;const o=t.state.constraints.tilt(e);return i=Math.min(i,.5*Math.PI),o.min*(1-Re)+i*Re}(t,r,e,n));return{tilt:i,mode:e-i<1?Pt.LOCKED:Pt.ADJUST}}function le(t,e){return{...t,center:(0,d.o8)(e)}}function ue(t,e){const{state:n,spatialReference:r}=t,i=e.spatialReference;return n.isGlobal&&(0,Et.M)(i,M.RT.Global)||n.isLocal&&r.equals(i)}function fe(t,e){let n,r,i;if(t.state.isGlobal){const t=new p.default(e.xmin,e.ymin,e.spatialReference),o=new p.default(e.xmax,e.ymax,e.spatialReference),a=e.spatialReference.isGeographic?Ut:xt;n=new p.default({x:a.center(t.x,o.x),y:(o.y+t.y)/2,z:null!=e.zmax&&null!=e.zmin?(e.zmax+e.zmin)/2:void 0,spatialReference:e.spatialReference});const s=(0,h.tO)(e.spatialReference),c=(0,et.J_)(n,t,o);r=c.lon,i=c.lat,a.diff(t.x,o.x)>a.range/2&&(r+=s.halfCircumference),r=Math.min(r,s.halfCircumference),i=Math.min(i,s.halfCircumference)}else{const o=t.renderSpatialReference??e.spatialReference;o.equals(e.spatialReference)||(e=(0,T.project)(e,o)),r=e.xmax-e.xmin,i=e.ymax-e.ymin;const a=null!=e.zmax&&null!=e.zmin?(e.zmax+e.zmin)/2:void 0;n=new p.default({x:e.xmin+.5*r,y:e.ymin+.5*i,z:a,spatialReference:o})}const o=null!=e.zmax&&null!=e.zmin?e.zmax-e.zmin:0,a=t.state.camera,s=1/Math.tan(a.fovX/2),c=1/Math.tan(a.fovY/2),l=1/Math.tan(a.fov/2);return{center:n,distance:Math.max(.5*r*s,.5*i*c,.5*o*l)/wt}}async function de(t,e,n,r,i,o){const a=ue(t,e)?e:await(0,T.projectWithZConversion)(e,t.spatialReference,{signal:o});(0,u.throwIfAborted)(o);const{center:s,distance:c}=fe(t,a),l=await re(t,n,r,s,c,i,o);return(0,u.throwIfAborted)(o),Me(t,l,t.camera.fov,o)}function he(t,e,n,r,i,o){let a;try{a=ue(t,e)?e:(0,T.project)(e,t.spatialReference)}catch(u){return null}const{center:s,distance:c}=fe(t,a),l=ne(t,n,r,s,c,i);return null==l?null:ve(t,l,t.camera.fov,o)}function pe(t,e,n){const r=t.renderSpatialReference,i=new p.default({spatialReference:Dt(t)});if(!(0,m.E)(n,r,i))return null;const o=Math.tan(e.fovX/2),a=Math.tan(e.fovY/2),s=(0,f.G)(e.eye,n),c=2*s*o*wt,l=2*s*a*wt;return Lt(t).toExtent(t,i,c,l)}function Te(t,e){return Lt(t).toArea(t,e)}const Re=.7;function ge(t,e,n,r){return Lt(t).lookAtTiltToEyeTilt(r,e,n)}function me(t,e,n,r){return Lt(t).eyeTiltToLookAtTilt(r,e,n)}function ve(t,e,n,r){if(null==e)return null;const i=t.renderSpatialReference,o=new p.default({spatialReference:Dt(t)});return(0,m.E)(e.eye,i,o)?(r??=new a.default,r.position=o,r.heading=e.heading,r.tilt=e.tilt,r.fov=n,r):null}async function Me(t,e,n,r){const i=t.renderSpatialReference,o=new p.default({spatialReference:Dt(t)});return await(0,m.C)(e.eye,i,o,{signal:r}),(0,u.throwIfAborted)(r),new a.default(o,e.heading,e.tilt,n)}function _e(t,e){const n=t.basemapTerrain?.tilingScheme;if(n)return n.levelAtScale(e);It().error("#scaleToZoom()","Cannot compute zoom from scale without a tiling scheme")}function ye(t,e){const n=t.basemapTerrain?.tilingScheme;if(n)return n.scaleAtLevel(e);It().error("#zoomToScale()","Cannot compute scale from zoom without a tiling scheme")}},66380:(t,e,n)=>{n.d(e,{M:()=>o});var r=n(78757),i=n(51064);function o(t,e){return null!=t&&(null==e||(e===i.RT.Local?!t.isGeographic||t.isWGS84||t.wkid===r.Y.CGCS2000:t.isWebMercator||t.isWGS84||t.wkid===r.Y.CGCS2000||t.wkid===r.Y.GCSMARS2000||t.wkid===r.Y.GCSMARS2000_SPHERE||t.wkid===r.Y.GCSMOON2000))}},66797:(t,e,n)=>{n.d(e,{J_:()=>s,aE:()=>u,cq:()=>c,uu:()=>l});var r=n(64682),i=n(30142),o=n(75400);function a(t,e,n){if(null==e.longitude||null==e.latitude||null==n.longitude||null==n.latitude)throw new Error("Invalid points: no lon/lat");return function(t,e,n,i,o){const a=(0,r.kU)(n),s=(0,r.kU)(o),c=a-s,l=(0,r.kU)(e)-(0,r.kU)(i),u=Math.sin(c/2),f=Math.sin(l/2),d=2*(0,r.YN)(Math.sqrt(u*u+Math.cos(a)*Math.cos(s)*f*f))*t;return Math.round(1e4*d)/1e4}(t,e.longitude,e.latitude,n.longitude,n.latitude)}function s(t,e,n){const r=e.spatialReference,s=(0,i.tO)(r),c=new o.default(e.x,t.y,r),l=new o.default(n.x,t.y,r),u=new o.default(t.x,e.y,r),f=new o.default(t.x,n.y,r);return{lon:a(s.radius,c,l),lat:a(s.radius,u,f)}}function c(t,e,n){const i=e/n,o=(0,r.kU)(t),a=Math.sin(i/2),s=Math.cos(o),c=2*(0,r.YN)(Math.sqrt(a*a/(s*s)));return(0,r.KJ)(c)}function l(t,e){let n=t/15;return e||(n=Math.round(n)),n}function u(t,e){const n=t?.[0];if(null==n)return null;e||(e={hours:0,minutes:0,seconds:0}),e.hours=l(n,!0);const r=e.hours%1;e.hours-=r,e.minutes=60*r;const i=e.minutes%1;return e.minutes-=i,e.seconds=Math.round(60*i),e}},68662:(t,e,n)=>{n.d(e,{HD:()=>c,Rt:()=>l,bZ:()=>u});var r=n(89227),i=n(28473),o=n(30142),a=n(90772),s=n(8609);function c(t,e,n,r){return null!=t.renderCoordsHelper.fromRenderCoords(e.eye,h,r)&&(0,a.Uc)(n,h)}function l(t,e){return t.elevationProvider?t.elevationProvider.getElevation(e[0],e[1],e[2],t.renderCoordsHelper.spatialReference,"ground")??0:0}function u(t,e,n,i){const a=t.state.camera.clone();e&&n&&i&&(a.eye=e,a.center=n,a.up=i),function(t,e,n){let i=d[t.viewingMode];i||(i=(0,s.hz)(t.state.viewingMode),i.options.backfacesTerrain=!t.state.isGlobal,i.options.invisibleTerrain=!0,d[t.viewingMode]=i);const{isGlobal:a}=t.state;return!(!t.sceneIntersectionHelper.intersectRay(e,i,n)||f(t,e.origin,n))||!(!t.renderCoordsHelper.intersectManifold(e,0,n)||f(t,e.origin,n))||!!a&&function(t,e,n){const i=(0,r.f)(t.origin,t.origin)-n*n,o=i>0?Math.sqrt(i)/3:1;return(0,r.h)(e,t.direction,o/(0,r.l)(t.direction)),(0,r.g)(e,e,t.origin),!0}(e,n,(0,o.tO)(t.spatialReference).radius)}(t,a.ray,p)||(0,r.c)(p,a.center);const c=t.state.constraints,l=c.minimumPoiDistance;if((0,r.s)(a.eye,p)<l){const e=c.collision.enabled;(0,r.c)(T,a.viewForward),(0,r.h)(T,T,l),e?a.eye=(0,r.d)(h,p,T):(0,r.g)(p,a.eye,T);const n=t.renderCoordsHelper,i=n.getAltitude(a.eye),o=c.collision.elevationMargin;e&&i<o&&((0,r.d)(T,p,a.eye),a.eye=n.setAltitude(h,o,a.eye),(0,r.g)(p,a.eye,T))}return a.center=p,a}function f(t,e,n){if(!t.state.isGlobal||!t.stateManager.constraintsManager)return!1;const i=l(t,e),o=t.stateManager.constraintsManager.nearFarHeuristic,{far:a}=o.compute(e,n,t.renderDataExtent,i,R),s=a*a;return(0,r.s)(e,n)>s}const d={},h=(0,i.vt)(),p=(0,i.vt)(),T=(0,i.vt)(),R={near:0,far:0}},70075:(t,e,n)=>{n.d(e,{C:()=>s,E:()=>a});var r=n(28473),i=n(96913),o=n(18162);function a(t,e,n){return!!(0,o.F)(t,e,c,n.spatialReference)&&(n.x=c[0],n.y=c[1],n.z=c[2],!0)}async function s(t,e,n,r){return await(0,i.initializeProjection)(e,n.spatialReference,null,r),a(t,e,n)}const c=(0,r.vt)()},86767:(t,e,n)=>{n.d(e,{NP:()=>u,gn:()=>f,gz:()=>d});var r=n(64682),i=n(89227),o=n(28473),a=n(1277),s=n(10872);const c=(0,o.vt)(),l=(0,o.vt)();function u(){return{direction:(0,o.vt)(),up:(0,o.vt)()}}function f(t,e,n,o,a){let s=(0,i.n)(c,t),u=(0,i.f)(s,o);const f=u>0;u=Math.abs(u),u>.99&&(u=Math.abs((0,i.f)(e,o)),u<.99?((0,i.c)(s,e),f&&(0,i.h)(s,s,-1)):s=null);let d=0;if(s){(0,i.h)(l,o,(0,i.f)(o,s)),(0,i.d)(s,s,l);const t=(0,i.f)(s,a)/((0,i.l)(s)*(0,i.l)(a));(0,i.e)(l,s,a),d=((0,i.f)(l,o)>0?1:-1)*(0,r.KJ)((0,r.XM)(t))}const h=(0,r.KJ)((0,r.XM)(-(0,i.f)(o,t)/(0,i.l)(t)));return n?(n.heading=d,n.tilt=h,n):{heading:d,tilt:h}}function d(t,e,n,r){(0,i.d)(h,n,e),(0,s.T7)(r,(0,a.LV)(e,h),t)||t===n||(0,i.c)(t,n)}const h=(0,o.vt)()},96504:(t,e,n)=>{n.d(e,{R1:()=>a,aY:()=>i,cN:()=>o});var r=n(49807);class i{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.array=t,this.spatialReference=e,this.offset=n}}function o(t){return"array"in t}function a(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ground";if((0,r.v)(e))return t.getElevation(e.x,e.y,e.z||0,e.spatialReference,n);if(o(e)){let r=e.offset;return t.getElevation(e.array[r++],e.array[r++],e.array[r]||0,e.spatialReference??t.spatialReference,n)}return t.getElevation(e[0],e[1],e[2]||0,t.spatialReference,n)}}}]);