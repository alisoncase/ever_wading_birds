"use strict";(self.webpackChunkever_wading_birds=self.webpackChunkever_wading_birds||[]).push([[40663,63044,69345,91726],{40663:(e,n,a)=>{a.d(n,{AC:()=>r,DW:()=>s,Hj:()=>z,Ih:()=>f,Jy:()=>p,OW:()=>h,Rv:()=>c,UJ:()=>l,_i:()=>m,d8:()=>u,fs:()=>d,kc:()=>y,ke:()=>v,mE:()=>o,wx:()=>t});var i=a(74719);async function r(e,n){const{layer:a,view:r,forBinning:o,filter:t}=e;if(!a||!r)throw new i.default(`${n}:missing-parameters`,"'layer' and 'view' parameters are required");await a.load();const l="featureReduction"in a?a.featureReduction:null;if(o){if("binning"!==l?.type)throw new i.default(`${n}:invalid-parameters`,"'layer' must have 'featureReduction' property defined with 'binning' type when 'forBinning' parameter is true");if(t)throw new i.default(`${n}:invalid-parameters`,"'filter' parameter is not supported when 'forBinning' parameter is true")}return e}async function o(e){const{layer:n,forBinning:a,renderer:r}=e;await n.load();const o="featureReduction"in n?n.featureReduction:null,t=r?.clone()??(a&&"binning"===o?.type?o?.renderer?.clone():"renderer"in n?n.renderer?.clone():null);if(!t)throw new i.default("get-renderer-to-update:invalid-parameters","renderer not available");return t}function t(e,n,a){const i=e?.authoringInfo?.visualVariables;return i?.find((e=>"reference-size"===a?e.type===n&&"reference-size"===e.theme:e.type===n))}function l(e){if(!e)return null;const n=e.type,a="visualVariables"in e?e.visualVariables:null,i=a?.find(f),r=a?.find(h),o=e.authoringInfo,l=t(e,"color"),s=t(e,"size"),c=t(e,"size","reference-size");if("class-breaks"===n){if("univariate-color-size"===o?.type)return"univariate-color-size";if(i)return r?s?.units?"color-size-age":l?.units?"color-age-size":"color-size":l?.units?"color-age":c?"color-size":"color-continuous";if(r)return s?.units?"size-age":"size-continuous";if(e.classBreakInfos.length>1)return"class-breaks-color"===o?.type?"color-class-breaks":"class-breaks-size"===o?.type?"size-class-breaks":null;if(c)return"size-continuous"}return"unique-value"===n?e.valueExpression?"predominance"===o?.type?"predominance":"relationship"===o?.type?r||c?"relationship-size":"relationship":r||c?"type-size":"type":r?s?.units?"type-size-age":"type-size":c?"type-size":"type":"pie-chart"===n?"pie-chart":"dot-density"===n?"dot-density":null}function s(e){return!!e.visualVariables?.some(b)}function c(e){return!!e.visualVariables?.some(w)}function m(e){return e?.findIndex(b)??-1}function p(e){return e?.findIndex(h)??-1}function d(e){return e?.findIndex(f)??-1}function u(e){return e?.findIndex(g)??-1}function y(e){return e?.findIndex(w)??-1}function f(e){return"color"===e.type}function g(e){return"opacity"===e.type}function h(e){return"size"===e.type&&"outline"!==e.target&&"$view.scale"!==e.valueExpression}function b(e){return"size"===e.type&&"outline"===e.target}function w(e){return"size"===e.type&&"$view.scale"===e.valueExpression&&"outline"!==e.target&&Array.isArray(e.stops)}function v(e,n,a){const i=e.visualVariables,r=a(i);if(!n||Array.isArray(n)&&!n.length)return;Array.isArray(n)||(n=[n]);const o=n.map((e=>e.clone()));i?r>-1?i.splice(r,1,...o):i.push(...o):e.visualVariables=o}function z(e,n,a){const i=n?.visualVariables.find((e=>e.type===a)),r=t(e,a);r&&i&&(r.minSliderValue=i.minSliderValue,r.maxSliderValue=i.maxSliderValue,"size"===a&&"reference-size"===r.theme&&(r.sizeStops=i.sizeStops?.map((e=>e.clone())),r.referenceSizeScale=i.referenceSizeScale))}},69345:(e,n,a)=>{a.r(n),a.d(n,{createRenderer:()=>C,regenerateRenderer:()=>I});var i=a(2925),r=a(74719),o=a(53957),t=a(45023),l=a(84267),s=a(22420),c=a(72861),m=a(34441),p=a(77225),d=a(70183),u=a(39186),y=a(5926),f=a(40663),g=a(39569),h=a(76118),b=a(43943),w=a(85151),v=a(2938),z=a(77562);async function S(e){if(!(e?.layer&&e.view&&e.fields?.length))throw new r.default("predominance-renderer:missing-parameters","'layer', 'view' and 'fields' parameters are required");if(e.fields.length<2)throw new r.default("predominance-renderer:invalid-parameters","Minimum 2 fields are required");if(e.fields.length>10)throw new r.default("predominance-renderer:invalid-parameters","Maximum 10 fields are supported");e.forBinning&&(0,w.p)(e,"predominance-renderer");const n={...e,layer:e.layer,fields:e.fields};n.symbolType=n.symbolType||"2d",n.defaultSymbolEnabled??=!0,n.includeOpacityVariable=e.includeOpacityVariable||!1,n.includeSizeVariable=e.includeSizeVariable||!1,n.sortBy??="count";const a=e.forBinning?v.Mi:v.J4,i=(0,v.Jg)(n.layer,a,e.forBinning);if(!i)throw new r.default("predominance-renderer:invalid-parameters","'layer' must be one of these types: "+(0,v.Ho)(v.J4).join(", "));const o=null!=n.signal?{signal:n.signal}:null;await i.load(o);const t=i.geometryType,l=n.symbolType.includes("3d");if(n.outlineOptimizationEnabled="polygon"===t&&n.outlineOptimizationEnabled,n.includeSizeVariable||(n.sizeOptimizationEnabled=("point"===t||"multipoint"===t||"polyline"===t)&&n.sizeOptimizationEnabled),"mesh"===t)n.symbolType="3d-volumetric",n.colorMixMode=n.colorMixMode||"replace",n.edgesType=n.edgesType||"none",n.sizeOptimizationEnabled=!1;else{if(l&&("polyline"===t||"polygon"===t))throw new r.default("predominance-renderer:not-supported","3d symbols are not supported for polyline and polygon layers");if(n.symbolType.includes("3d-volumetric")&&(!n.view||"3d"!==n.view.type))throw new r.default("predominance-renderer:invalid-parameters","'view' parameter should be an instance of SceneView when 'symbolType' parameter is '3d-volumetric' or '3d-volumetric-uniform'")}const s=n.fields.map((e=>e.name)),c=(0,g.MH)(i,s,"predominance-renderer:invalid-parameters");if(c)throw c;return{...n,layer:i}}async function T(e){let n=e.predominanceScheme,a=null,i=null;const r=await(0,g.Ib)(e.basemap,e.view);if(a=null!=r.basemapId?r.basemapId:null,i=null!=r.basemapTheme?r.basemapTheme:null,n)return{scheme:(0,z.cloneScheme)(n),basemapId:a,basemapTheme:i};const o=(0,z.getSchemes)({basemapTheme:i,geometryType:e.geometryType,numColors:e.numColors,theme:e.theme,worldScale:e.worldScale,view:e.view});return o&&(n=o.primaryScheme,a=o.basemapId,i=o.basemapTheme),{scheme:n,basemapId:a,basemapTheme:i}}async function V(e,n,a){const i=await(0,o.ud)("esri/smartMapping/t9n/smartMapping");return(0,u.createVisualVariables)({layer:e.layer,basemap:e.basemap,valueExpression:n.valueExpression,sqlExpression:n.statisticsQuery.sqlExpression,sqlWhere:n.statisticsQuery.sqlWhere,sizeScheme:a,sizeOptimizationEnabled:e.sizeOptimizationEnabled,worldScale:!!e.symbolType?.includes("3d-volumetric"),legendOptions:{title:i.sumOfCategories},filter:e.filter,view:e.view,signal:e.signal})}async function x(e,n){const a=await(0,o.ud)("esri/smartMapping/t9n/smartMapping"),i=await(0,g.g2)({layer:e.layer,valueExpression:n.valueExpression,sqlExpression:n.statisticsQuery.sqlExpression,sqlWhere:n.statisticsQuery.sqlWhere,filter:e.filter,view:e.view,signal:e.signal}),{avg:r,stddev:d}=i,u=null==r||null==d,y=1/e.fields.length*100;let f=u?100:r+1.285*d;f>100&&(f=100);const h=(0,s.LI)([y,f],{strictBounds:!0}),b=new c.default({valueExpression:n.valueExpression,stops:[new m.default({value:h[0],opacity:.15}),new m.default({value:h[1],opacity:1})],legendOptions:new p.A({title:a.strengthOfPredominance})}),w=new l.default({type:"opacity",minSliderValue:i.min,maxSliderValue:i.max});return{visualVariable:b,statistics:i,defaultValuesUsed:u,authoringInfo:new t.default({visualVariables:[w]})}}async function C(e){const n=await S(e),a=n.layer,r=(await T({basemap:n.basemap,geometryType:a.geometryType,numColors:n.fields.length,predominanceScheme:n.predominanceScheme,worldScale:!!n.symbolType?.includes("3d-volumetric"),view:n.view})).scheme,l=n.fields.map((e=>e.name)),s=(0,b.getPredominanceExpressions)(a,l),c=async function(e,n,a,r){const l=await(0,o.ud)("esri/smartMapping/t9n/smartMapping"),s=e.layer,{view:c,filter:m,signal:p}=e,[u,f]=await Promise.all([(0,h.default)({layer:s,fields:r,view:c,filter:m,signal:p}),e.outlineOptimizationEnabled?(0,d.A)({layer:s,view:c,filter:m,signal:p}).catch(g.ou):null]);let b=u;u?.predominantCategoryInfos||(b={predominantCategoryInfos:r.map((e=>({value:e,count:0})))});const w=f?.opacity,v=await(0,y.createRenderer)({layer:s,basemap:e.basemap,valueExpression:n.valueExpression,valueExpressionTitle:l.predominantCategory,numTypes:-1,defaultSymbolEnabled:e.defaultSymbolEnabled,sortBy:e.sortBy,typeScheme:a,statistics:{uniqueValueInfos:b.predominantCategoryInfos},legendOptions:e.legendOptions,outlineOptimizationEnabled:!1,sizeOptimizationEnabled:(!e.includeSizeVariable||!e.sizeOptimizationEnabled)&&e.sizeOptimizationEnabled,symbolType:e.symbolType,colorMixMode:e.colorMixMode,edgesType:e.edgesType,filter:e.filter,view:e.view,signal:e.signal}),{renderer:z,basemapId:S,basemapTheme:T,uniqueValueInfos:V,excludedUniqueValueInfos:x}=v,C=z.uniqueValueInfos??[],I={};for(const i of e.fields){const e=s.getField(i.name);I[e.name]=i.label||e&&e.alias||i.name}if(C.forEach(((e,n)=>{const a=I[e.value];e.label=a,V[n].label=a})),e.includeSizeVariable){let n=s.geometryType,r=null;if("polygon"===n){const i=a.sizeScheme,o=i.background;z.backgroundFillSymbol=(0,g.v5)(n,{type:e.symbolType,color:o.color,outline:(0,g.qc)(o,n,w)}),r=i.marker.size,n="point"}else r="polyline"===n?a.width:a.size;const o=(0,i.Iy)(a.colors,C.length);C.forEach(((i,t)=>{const l=(0,g.v5)(n,{type:e.symbolType,color:o[t],size:r,outline:(0,g.qc)(a,n,w),meshInfo:{colorMixMode:e.colorMixMode,edgesType:e.edgesType}});i.symbol=l,V[t].symbol=l.clone()}))}return f?.visualVariables.length&&(z.visualVariables=f.visualVariables.map((e=>e.clone()))),z.authoringInfo=new t.default({type:"predominance",fields:[...r]}),{renderer:z,predominantCategoryInfos:V,excludedCategoryInfos:x,predominanceScheme:a,basemapId:S,basemapTheme:T}}(n,s.predominantCategory,r,l),m=n.includeSizeVariable?V(n,s.size,r.sizeScheme):null,p=n.includeOpacityVariable?x(n,s.opacity):null,[u,f,w]=await Promise.all([c,m,p]),v=[],z=[];if(f&&(Array.prototype.push.apply(v,f.visualVariables.map((e=>e.clone()))),delete f.sizeScheme,u.size=f,Array.prototype.push.apply(z,f.authoringInfo.visualVariables.map((e=>e.clone())))),w&&(v.push(w.visualVariable.clone()),u.opacity=w,Array.prototype.push.apply(z,w.authoringInfo.visualVariables.map((e=>e.clone())))),v.length){const e=u.renderer.visualVariables||[];Array.prototype.push.apply(e,v),u.renderer.visualVariables=e,u.renderer.authoringInfo??=new t.default,u.renderer.authoringInfo.visualVariables=z}return u}async function I(e){const{creatorParameters:n,view:a,signal:i,filter:o,renderer:t}=await async function(e){const n="regenerate-predominance-renderer";await(0,f.AC)(e,n);const a=await(0,f.mE)(e);if("predominance"!==(0,f.UJ)(a))throw new r.default(`${n}:invalid-parameters`,"Renderer is invalid");const{visualVariables:i}=a,{layer:o,forBinning:t,filter:l,view:s,signal:c}=e,m=(0,f.DW)(a),p=(0,f.Rv)(a),d=i?.some(f.OW),u=i?.some((e=>"opacity"===e.type)),y=a.authoringInfo,g=y?.fields?.map((e=>({name:e})));if(!g?.length)throw new r.default(`${n}:invalid-parameters`,"Fields are required");const h=await S({layer:o,fields:g,outlineOptimizationEnabled:m,sizeOptimizationEnabled:p,includeSizeVariable:d,includeOpacityVariable:u,forBinning:t,filter:l,view:s,signal:c});return{...e,creatorParameters:h,renderer:a}}(e),{layer:l,fields:s,outlineOptimizationEnabled:c,includeSizeVariable:m,includeOpacityVariable:p}=n,u=s.map((e=>e.name)),y=(0,b.getPredominanceExpressions)(l,u),h=(await T({geometryType:l.geometryType,numColors:n.fields.length,view:n.view})).scheme,w=h&&"sizeScheme"in h?h.sizeScheme:null,[v,z,C]=await Promise.all([c?(0,d.A)({layer:l,view:a,signal:i,filter:o}).catch(g.ou):null,m?V(n,y.size,w):null,p?x(n,y.opacity):null]);return(0,f.ke)(t,v?.visualVariables,f._i),(0,f.ke)(t,z?.visualVariables,f.Jy),(0,f.ke)(t,C?.visualVariable,f.d8),(0,f.Hj)(t,z?.authoringInfo,"size"),(0,f.Hj)(t,C?.authoringInfo,"opacity"),{renderer:t}}},76118:(e,n,a)=>{a.r(n),a.d(n,{default:()=>l});var i=a(74719),r=a(70934),o=a(85151),t=a(2938);async function l(e){const{layerAdapter:n,...a}=await async function(e){if(!(e&&e.layer&&e.view&&e.fields))throw new i.default("predominant-categories:missing-parameters","'layer', 'view' and 'fields' parameters are required");e.forBinning&&(0,o.p)(e,"predominant-categories");const{layer:n,...a}=e,l=e.forBinning?t.Mi:t.G3,s=(0,t.Jg)(n,l,e.forBinning);if(!s)throw new i.default("predominant-categories:invalid-parameters","'layer' must be one of these types: "+(0,t.Ho)(l).join(", "));const c={layerAdapter:s,...a};await Promise.all([c.view.when(),s.load({signal:c.signal})]);const m=(0,r.MH)(s,c.fields,"predominant-categories:invalid-parameters");if(m)throw m;return c}(e);return n.predominantCategories(a)}},77562:(e,n,a)=>{a.r(n),a.d(n,{cloneScheme:()=>w,getSchemeByName:()=>h,getSchemes:()=>g,getSchemesByTag:()=>b,getThemes:()=>f});var i=a(88102),r=a(62631),o=a(2925),t=a(2020),l=a(43073),s=a(28245),c=a(42648);const m={light:{color:[153,153,153,.25],width:"1px"},dark:{color:[153,153,153,.25],width:"1px"},darker:{color:[26,26,26,.25],width:"1px"}},p="#aaaaaa",d=["tropical-bliss","desert-blooms","under-the-sea","vibrant-rainbow","ocean-bay","prairie-summer","pastel-chalk"],u=["cat-symbols-strong","cat-symbols-autumnal","cat-symbols-bright","cat-symbols-midrange","cat-symbols-subdued","cat-symbols-pastel","cat-symbols-red","cat-symbols-blue","cat-symbols-green","cat-symbols-gray"],y=(0,s.bG)({themeDictionary:{default:{name:"default",label:"Default",description:"Default theme for visualizing features by their predominant category.",schemes:{point:{light:{common:{noDataColor:p,outline:m.light,size:"8px"},primary:"predominant-v1",secondary:["predominant-v2","predominant-v3","predominant-v4","predominant-v5","predominance-race","predominance-money","predominance-race-ethnic","predominance-rainbow","predominance-sequence"].concat(u).concat(d)},dark:{common:{noDataColor:p,outline:m.darker,size:"8px"},primary:"predominant-v2",secondary:["predominant-v1","predominant-v3","predominant-v4","predominant-v5","predominance-race","predominance-money","predominance-race-ethnic","predominance-rainbow","predominance-sequence"].concat(u).concat(d)}},polyline:{light:{common:{noDataColor:p,width:"2px"},primary:"predominant-v1",secondary:["predominant-v2","predominant-v3","predominant-v4","predominant-v5","predominance-race","predominance-money","predominance-race-ethnic","predominance-rainbow","predominance-sequence"].concat(u).concat(d)},dark:{common:{noDataColor:p,width:"2px"},primary:"predominant-v2",secondary:["predominant-v1","predominant-v3","predominant-v4","predominant-v5","predominance-race","predominance-money","predominance-race-ethnic","predominance-rainbow","predominance-sequence"].concat(u).concat(d)}},polygon:{light:{common:{noDataColor:p,outline:m.light,fillOpacity:.8,markerSize:"8px"},primary:"predominant-v1",secondary:["predominant-v2","predominant-v3","predominant-v4","predominant-v5","predominance-race","predominance-money","predominance-race-ethnic","predominance-rainbow","predominance-sequence"].concat(u).concat(d)},dark:{common:{noDataColor:p,outline:m.dark,fillOpacity:.8,markerSize:"8px"},primary:"predominant-v2",secondary:["predominant-v1","predominant-v3","predominant-v4","predominant-v5","predominance-race","predominance-money","predominance-race-ethnic","predominance-rainbow","predominance-sequence"].concat(u).concat(d)}}}}}});function f(e){return(0,s.vt)(y,e)}function g(e){const n=(0,s.Fq)({basemap:e.basemap,geometryType:e.geometryType,basemapTheme:e.basemapTheme,theme:y.get("default")});if(!n)return;const{schemesInfo:a,basemapId:i,basemapTheme:o}=n,l=a.common,c=(0,t.getSchemes)({basemap:e.basemap,geometryType:e.geometryType,worldScale:e.worldScale,view:e.view}),m=c?.primaryScheme;return{primaryScheme:v(e,a.primary,l,m),secondarySchemes:a.secondary.map((n=>v(e,n,l,m))).filter(r.Ru),basemapId:i,basemapTheme:o}}function h(e){return(0,s.Ty)(e.name,g(e))}function b(e){return(0,s.YJ)(e.includedTags,e.excludedTags,g(e))}function w(e){if(!e)return;const n={...e};return n.colors=n.colors.map((e=>new i.default(e))),n.tags=[...n.tags],n.noDataColor&&(n.noDataColor=new i.default(n.noDataColor)),"outline"in n&&n.outline&&(n.outline={color:n.outline.color&&new i.default(n.outline.color),width:n.outline.width}),"sizeScheme"in n&&n.sizeScheme&&(n.sizeScheme=(0,t.cloneScheme)(n.sizeScheme)),n}function v(e,n,a,r){const t=l.A[n];if(!t)return;const{numColors:s}=e,m=s?t[s]??(0,o.Iy)(t.stops,s):t.stops,p="mesh"!==e.geometryType&&e.worldScale?e.view:null;switch(e.geometryType){case"point":case"multipoint":{const e=a;return function(e,n){return{name:e.name,tags:[...e.tags],colors:e.colors.map((e=>new i.default(e))),noDataColor:new i.default(e.noDataColor),outline:{color:new i.default(e.outline.color),width:e.outline.width},size:n?(0,c._J)(e.size,n):e.size,sizeScheme:e.sizeScheme,opacity:e.opacity}}({name:t.name,tags:t.tags,colors:m,noDataColor:e.noDataColor,opacity:1,sizeScheme:r,outline:e.outline,size:e.size},p)}case"polyline":{const e=a;return function(e,n){return{name:e.name,tags:[...e.tags],colors:e.colors.map((e=>new i.default(e))),noDataColor:new i.default(e.noDataColor),width:n?(0,c._J)(e.width,n):e.width,sizeScheme:e.sizeScheme,opacity:e.opacity}}({name:t.name,tags:t.tags,colors:m,noDataColor:e.noDataColor,opacity:1,sizeScheme:r,width:e.width},p)}case"polygon":{const e=a,n=r;return n&&n.marker&&null!=e.markerSize&&(n.marker.size=e.markerSize),function(e,n){const{sizeScheme:a}=e;return a.marker.size=n?(0,c._J)(a.marker.size,n):a.marker.size,{name:e.name,tags:[...e.tags],colors:e.colors.map((e=>new i.default(e))),noDataColor:new i.default(e.noDataColor),outline:{color:new i.default(e.outline.color),width:e.outline.width},sizeScheme:a,opacity:e.opacity}}({name:t.name,tags:t.tags,colors:m,noDataColor:e.noDataColor,opacity:e.fillOpacity,outline:e.outline,sizeScheme:n},p)}case"mesh":{const e=a;return function(e){return{name:e.name,tags:[...e.tags],colors:e.colors.map((e=>new i.default(e))),noDataColor:new i.default(e.noDataColor),opacity:e.opacity}}({name:t.name,tags:t.tags,colors:m,noDataColor:e.noDataColor,opacity:e.fillOpacity})}default:return}}}}]);