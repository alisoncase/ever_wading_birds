"use strict";(self.webpackChunkever_wading_birds=self.webpackChunkever_wading_birds||[]).push([[29656,76005],{9137:(e,t,i)=>{i.d(t,{D:()=>n,S:()=>d});var s=i(64682),r=i(50821),a=i(17745),l=i(87118);function n(e,t){let{level:i,class:s,...n}=e;const d=o(i);return(0,l.K)(`h${d}`,{...n,"aria-level":String(d),class:(0,a.Ly)(r.D.heading,s),role:"heading"},t)}function o(e){return(0,s.qE)(Math.ceil(e),1,6)}function d(e){return o(e+(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1))}},29656:(e,t,i)=>{i.r(t),i.d(t,{default:()=>C});var s=i(93800),r=(i(88677),i(6946)),a=i(89129),l=i(79953),n=i(48602),o=(i(21265),i(50925),i(14746),i(75269)),d=i(99940),c=i(57566),y=i(12285),h=i(12711);const p="state",m="view",u="all-layer-views",v="legend-properties",f=a.default.ofType(y.default),g=new Set(["esri.layers.BuildingSceneLayer","esri.layers.CatalogLayer","esri.layers.CSVLayer","esri.layers.FeatureLayer","esri.layers.GeoJSONLayer","esri.layers.GeoRSSLayer","esri.layers.GroupLayer","esri.layers.HeatmapLayer","esri.layers.ImageryLayer","esri.layers.ImageryTileLayer","esri.layers.MapImageLayer","esri.layers.OGCFeatureLayer","esri.layers.OrientedImageryLayer","esri.layers.ParquetLayer","esri.layers.PointCloudLayer","esri.layers.StreamLayer","esri.layers.SceneLayer","esri.layers.SubtypeGroupLayer","esri.layers.TileLayer","esri.layers.VoxelLayer","esri.layers.WFSLayer","esri.layers.WMSLayer","esri.layers.WMTSLayer","esri.layers.WCSLayer","esri.layers.LinkChartLayer","esri.layers.catalog.CatalogFootprintLayer","esri.layers.catalog.CatalogDynamicGroupLayer","esri.layers.knowledgeGraph.KnowledgeGraphSublayer","esri.layers.KnowledgeGraphLayer"]),L="view.basemapView.baseLayerViews",_="view.groundView.layerViews",w="view.basemapView.referenceLayerViews",b=[L,_,"view.layerViews",w];let I=class extends r.default{constructor(e){super(e),this._layerViewByLayerId={},this._layerInfosByLayerViewId={},this._activeLayerInfosByLayerViewId={},this._activeLayerInfosWithNoParent=new a.default,this.activeLayerInfos=new f,this.basemapLegendVisible=!1,this.groundLegendVisible=!1,this.hideLayersNotInCurrentView=!1,this.keepCacheOnDestroy=!1,this.respectLayerDefinitionExpression=!1,this.respectLayerVisibility=!0,this.layerInfos=[],this.view=null}initialize(){this.addHandles((0,l.watch)((()=>this.view),(()=>this._viewHandles()),l.initial),m),this.addHandles((0,h.oQ)((()=>this._refresh())))}destroy(){this._destroyViewActiveLayerInfos(),this.view=null}get state(){return this.view?.ready?"ready":"disabled"}_viewHandles(){this.removeHandles(p),this.view&&this.addHandles((0,l.watch)((()=>this.state),(()=>this._stateHandles()),l.initial),p)}_stateHandles(){this._resetAll(),"ready"===this.state&&this._watchPropertiesAndAllLayerViews()}_resetAll(){this.removeHandles([u,v]),this._destroyViewActiveLayerInfos(),this.activeLayerInfos.removeAll()}_destroyViewActiveLayerInfos(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)}_destroyViewActiveLayerInfo(e){this.removeHandles(e);const t=this._activeLayerInfosByLayerViewId[e];delete this._activeLayerInfosByLayerViewId[e],t?.parent&&t.parent.children.remove(t)}_watchPropertiesAndAllLayerViews(){const{view:e}=this;if(!e)return;const{allLayerViews:t}=e;t.length&&this._refresh(),this.addHandles(t.on("change",(e=>this._allLayerViewsChangeHandle(e))),u),this.addHandles((0,l.watch)((()=>[this.layerInfos,this.basemapLegendVisible,this.groundLegendVisible]),(()=>this._propertiesChangeHandle())),v)}_allLayerViewsChangeHandle(e){e.moved.length?this._propertiesChangeHandle():(e.removed.forEach((e=>this._destroyViewActiveLayerInfo(e.uid))),this._refresh())}_propertiesChangeHandle(){this._destroyViewActiveLayerInfos(),this._refresh()}_refresh(){this._layerInfosByLayerViewId={},this.activeLayerInfos.removeAll(),this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this),this._sortActiveLayerInfos(this.activeLayerInfos)}_sortActiveLayerInfos(e){const t=this.view;if(e.length<2||!t)return;const i=[];e.forEach((t=>{if(!t.parent){const s=t.layer.parent,r=s&&"uid"in s&&this._layerViewByLayerId[s.uid],a=r&&this._activeLayerInfosByLayerViewId[r.uid];a&&e.includes(a)&&(i.push(t),t.parent=a,a.children.add(t),this._sortActiveLayerInfos(a.children))}})),e.removeMany(i);const s={};t.allLayerViews.forEach(((e,t)=>s[e.layer.uid]=t)),e.sort(((e,t)=>{const i=s[e.layer.uid]||0;return(s[t.layer.uid]||0)-i}))}_generateLayerViews(){const e=[];return b.filter(this._filterLayerViews,this).map((e=>(0,d.Jt)(this,e))).filter((e=>null!=e)).forEach(this._collectLayerViews("layerViews",e)),e}_filterLayerViews(e){const t=!this.basemapLegendVisible&&(e===L||e===w),i=!this.groundLegendVisible&&e===_;return!t&&!i}_collectLayerViews(e,t){const i=s=>(s&&s.forEach((s=>{t.push(s),i(s[e])})),t);return i}_filterLayerViewsByLayerInfos(e){const t=this.layerInfos;return!t||!t.length||t.some((t=>this._hasLayerInfo(t,e)))}_hasLayerInfo(e,t){const i=this._isLayerUIDMatching(e.layer,t.layer.uid);return i&&(this._layerInfosByLayerViewId[t.uid]=e),i}_isLayerUIDMatching(e,t){return e&&(e.uid===t||this._hasLayerUID(e.layers,t))}_hasLayerUID(e,t){return e&&e.some((e=>this._isLayerUIDMatching(e,t)))}_isLayerViewSupported(e){return!!g.has(e.layer.declaredClass)&&(this._layerViewByLayerId[e.layer.uid]=e,!0)}_generateActiveLayerInfo(e){this._isLayerActive(e)?this._buildActiveLayerInfo(e):(this.removeHandles(e.uid),this.addHandles((0,l.watch)((()=>[e.legendEnabled,e.layer?.legendEnabled]),(()=>this._layerActiveHandle(e))),e.uid))}_layerActiveHandle(e){this._isLayerActive(e)&&(this.removeHandles(e.uid),this._buildActiveLayerInfo(e))}_isLayerActive(e){return!this.respectLayerVisibility||e.legendEnabled&&e.layer?.legendEnabled}_buildActiveLayerInfo(e){const t=e.layer,i=e.uid,s=this._layerInfosByLayerViewId[i];let r=this._activeLayerInfosByLayerViewId[i];if(!r){const a=void 0!==s?.title&&s.layer.uid===t.uid;r=new y.default({layer:t,layerView:e,title:a?s.title:t.title,view:this.view??void 0,respectLayerDefinitionExpression:this.respectLayerDefinitionExpression,respectLayerVisibility:this.respectLayerVisibility,hideLayersNotInCurrentView:this.hideLayersNotInCurrentView,keepCacheOnDestroy:this.keepCacheOnDestroy,sublayerIds:s?.sublayerIds||[]}),this._activeLayerInfosByLayerViewId[i]=r}const a=t.parent&&"uid"in t.parent?this._layerViewByLayerId[t.parent?.uid]:null;if(r.parent=this._activeLayerInfosByLayerViewId[a?.uid],!this.hasHandles(i)){const s=[(0,l.watch)((()=>t.title),(e=>this._titleHandle(e,r))),(0,l.watch)((()=>[t.opacity,"renderer"in t&&t.renderer,"pointSymbol"in t&&t.pointSymbol,"lineSymbol"in t&&t.lineSymbol,"polygonSymbol"in t&&t.polygonSymbol]),(()=>this._constructLegendElements(r))),(0,l.when)((()=>!0===this.view?.stationary),(()=>this._scaleHandle(r)),l.initial),(0,l.watch)((()=>e.layer?(0,c.n)(e.layer,e.view):null),(()=>this._constructLegendElements(r))),(0,l.watch)((()=>e.updating),(()=>{null!=e.layer&&null!=(0,c.n)(e.layer,e.view)&&this._constructLegendElements(r)})),(0,l.watch)((()=>"effect"in t&&t.effect),(()=>this._constructLegendElements(r))),(0,l.when)((()=>this.view?.timeZone),(()=>this._constructLegendElements(r)),l.initial)];if(this.respectLayerVisibility){const i=(0,l.watch)((()=>e.legendEnabled),(e=>this._legendEnabledHandle(e,r))),a=(0,l.watch)((()=>t.legendEnabled),(e=>this._legendEnabledHandle(e,r)));s.push(i,a)}if(this.respectLayerDefinitionExpression&&"definitionExpression"in t){const e=(0,l.watch)((()=>[t.definitionExpression,this.respectLayerDefinitionExpression]),(()=>{r.respectLayerDefinitionExpression=this.respectLayerDefinitionExpression,this._constructLegendElements(r)}));s.push(e)}this.addHandles(s,i)}r.isScaleDriven||this._constructLegendElements(r),this._addActiveLayerInfo(r)}_titleHandle(e,t){t.title=e,this._constructLegendElements(t)}_legendEnabledHandle(e,t){e?this._addActiveLayerInfo(t):this._removeActiveLayerInfo(t)}_scaleHandle(e){(e.isScaleDriven||e.hideLayersNotInCurrentView)&&this._constructLegendElements(e)}_addActiveLayerInfo(e){const{layerView:t,layer:i}=e;if(this._isLayerActive(t)&&!this.activeLayerInfos.includes(e)){const t=e.parent;if(t)t.children.includes(e)||t.children.push(e),this._sortActiveLayerInfos(t.children);else{const t=this.layerInfos?.some((e=>e.layer.uid===i.uid)),s=i.parent;s&&"uid"in s&&this._layerViewByLayerId[s.uid]&&!t?this._activeLayerInfosWithNoParent.add(e):(this.activeLayerInfos.add(e),this._sortActiveLayerInfos(this.activeLayerInfos))}if(this._activeLayerInfosWithNoParent.length){const e=[];this._activeLayerInfosWithNoParent.forEach((t=>{const i=t.layer.parent,s=i&&"uid"in i?this._layerViewByLayerId[i?.uid]:null,r=this._activeLayerInfosByLayerViewId[s?.uid];r&&(e.push(t),t.parent=r)})),e.length&&(this._activeLayerInfosWithNoParent.removeMany(e),e.forEach((e=>this._addActiveLayerInfo(e))))}}}_removeActiveLayerInfo(e){const t=e.parent;t?t.children.remove(e):this.activeLayerInfos.remove(e)}_constructLegendElements(e){const t=e.layer;"featureCollections"in t&&t.featureCollections?e.buildLegendElementsForFeatureCollections(t.featureCollections):"featureReduction"in t&&t.featureReduction&&"renderer"in t.featureReduction&&("binning"===t.featureReduction.type||"cluster"===t.featureReduction.type)&&(!this.view||t.featureReduction.maxScale<=this.view.scale)?e.buildLegendElementsForFeatureReduction(t.featureReduction):"renderer"in t&&t.renderer&&!("sublayers"in t)?e.buildLegendElementsForRenderer(t.renderer):"url"in t&&t.url&&"catalog"!==t.type&&"knowledge-graph"!==t.type?e.buildLegendElementsForTools():e.children.forEach((e=>this._constructLegendElements(e)))}};(0,s._)([(0,n.MZ)({type:f})],I.prototype,"activeLayerInfos",void 0),(0,s._)([(0,n.MZ)()],I.prototype,"basemapLegendVisible",void 0),(0,s._)([(0,n.MZ)()],I.prototype,"groundLegendVisible",void 0),(0,s._)([(0,n.MZ)()],I.prototype,"hideLayersNotInCurrentView",void 0),(0,s._)([(0,n.MZ)()],I.prototype,"keepCacheOnDestroy",void 0),(0,s._)([(0,n.MZ)()],I.prototype,"respectLayerDefinitionExpression",void 0),(0,s._)([(0,n.MZ)()],I.prototype,"respectLayerVisibility",void 0),(0,s._)([(0,n.MZ)()],I.prototype,"layerInfos",void 0),(0,s._)([(0,n.MZ)({readOnly:!0})],I.prototype,"state",null),(0,s._)([(0,n.MZ)()],I.prototype,"view",void 0),I=(0,s._)([(0,o.$)("esri.widgets.Legend.LegendViewModel")],I);const C=I},57566:(e,t,i)=>{function s(e,t){const i=e.featureReduction;return i&&"selection"!==i.type&&(!("maxScale"in i)||!i.maxScale||i.maxScale<t.scale)?i:null}i.d(t,{n:()=>s})},76005:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Me});var s=i(93800),r=i(79953),a=i(48602),l=i(32980),n=(i(21265),i(14746),i(75269)),o=i(27811),d=i(29656);i(88677),i(50925);const c="esri-legend--card",y="esri-legend",h={activated:`${c}__carousel-indicator--activated`,base:c,stacked:`${y}--stacked`,carouselTitle:`${c}__carousel-title`,indicator:`${c}__carousel-indicator`,intervalSeparator:`${c}__interval-separator`,imageryLayerStretchedImage:`${c}__imagery-layer-image--stretched`,imageLabel:`${c}__image-label`,layerCaption:`${c}__layer-caption`,labelElement:`${c}__label-element`,layerRow:`${c}__layer-row`,labelCell:`${c}__label-cell`,message:`${c}__message`,rampLabel:`${c}__ramp-label`,section:`${c}__section`,relationshipSection:`${c}__relationship-section`,serviceCaptionText:`${c}__service-caption-text`,serviceContent:`${c}__service-content`,service:`${c}__service`,groupLayer:`${c}__group-layer`,groupLayerChild:`${c}__group-layer-child`,symbol:`${c}__symbol`,sizeRampRow:`${c}__size-ramp-row`,symbolRow:`${c}__symbol-row`,symbolCell:`${c}__symbol-cell`,carousel:`${c}__carousel`,carouselItem:`${c}__carousel-item`,indicatorContainer:`${c}__carousel-indicator-container`,intervalSeparatorsContainer:`${c}__interval-separators-container`,relationshipLabelContainer:`${c}__relationship-label-container`,labelContainer:`${c}__label-container`,serviceCaptionContainer:`${c}__service-caption-container`,symbolContainer:`${c}__symbol-container`,colorRampContainer:`${c}__color-ramp-container`,sizeRampContainer:`${c}__size-ramp-container`,sizeRampPreview:`${c}__size-ramp-preview`,pieChartRampPreview:`${c}__pie-chart-ramp-preview`,rampContainer:`${y}__ramps`,sizeRampHorizontal:`${y}__size-ramp--horizontal`,rampLabelsContainer:`${y}__ramp-labels`,layerInfo:`${y}__layer-cell ${y}__layer-cell--info`,univariateAboveAndBelowColorRamp:"esri-univariate-above-and-below-ramp__color--card"};var p=i(88102),m=i(79906),u=i(66319),v=i(56612),f=i(99961),g=i(23224);function L(e){e.appendChild(this)}function _(e,t,i){if(!t)return;if("number"==typeof t)return t;if("string"==typeof t)return(0,v._e)(t);if("value"in t||"unit"in t)return(0,f.V)(e.dotValue,t);if("colorName"in t&&"bandName"in t)return e[t.colorName]+": "+(e[t.bandName]||t.bandName);if("showCount"in t)return t.showCount?e.clusterCountTitle:void 0;let s=null;return i?s=t.ratioPercentTotal?"showRatioPercentTotal":t.ratioPercent?"showRatioPercent":t.ratio?"showRatio":t.normField?"showNormField":t.field?"showField":null:w(t,i)&&(s=t.normField?"showNormField":t.normByPct?"showNormPct":t.field?"showField":null),s?(0,f.V)("showField"===s?"{field}":e[s],{field:t.field,normField:t.normField}):void 0}function w(e,t){return!t}function b(e,t){return!!(t&&"Stretched"===t&&"version"in e&&"number"==typeof e.version&&e.version>=10.3&&"esri.layers.ImageryLayer"===e.declaredClass)}function I(e,t,i){switch(t){case"heatmap-ramp":return i[e.label]||e.label;case"stretch-ramp":return function(e,t){return e.label?t[e.label]+": "+("string"==typeof e.value?e.value:(0,g.ZV)(e.value??0,{style:"decimal",notation:e.value?.toString().toLowerCase().includes("e")?"scientific":"standard"})):""}(e,i);default:return e.label}}function C(e,t){if(!e.title||"string"==typeof e.title)return e.title;const i="color-ramp"===e.type||"opacity-ramp"===e.type,s=e.title,r=_(t,s,i);return w(0,i)&&s.title?`${s.title} (${r})`:r}var $=i(17745),E=i(87118);let K=class extends o.default{constructor(e,t){super(e,t),this.effectList=null,this.legendElement=null,this.opacity=1}render(){const e=this.legendElement.infos.slice().reverse();return(0,E.K)("div",{class:this.classes(h.layerRow,h.colorRampContainer)},this._renderRampLabel(e[0]),(0,E.K)("div",{class:h.symbolContainer},this._renderPreview(e),this._renderMiddleStopRampLabel(e)),this._renderRampLabel(e.at(-1)))}_renderPreview(e){const{opacity:t}=this,i="heatmap-ramp"===this.legendElement.type,s=e.length-1,r=25,a=s>2&&!i?25*s:100,l=a+20,n=10,o=[[{shape:{type:"path",path:"M0 12.5 L10 0 L10 25 Z"},fill:e[0].color,stroke:{width:0}},{shape:{type:"rect",x:n,y:0,width:a,height:r},fill:{type:"linear",x1:n,y1:0,x2:a+n,y2:0,colors:e.map(((e,t)=>({color:e.color,offset:i&&"ratio"in e?e.ratio:t/s})))},stroke:{width:0}},{shape:{type:"path",path:`M${a+n} 0 L${l} 12.5 L${a+n} 25 Z`},fill:e[e.length-1].color,stroke:{width:0}}]],d=(0,u.d8)(o,l,r),c={filter:(0,m.di)(this.effectList)??void 0,opacity:null==t?void 0:`${t}`};return(0,E.K)("div",{styles:c},d)}_renderMiddleStopRampLabel(e){const t=e.length%2!=0?e[e.length/2|0]:null;return t?(0,E.K)("div",{class:h.intervalSeparatorsContainer},(0,E.K)("div",{class:h.intervalSeparator},"|"),this._renderRampLabel(t)):null}_renderRampLabel(e){return(0,E.K)("div",{class:h.rampLabel},I(e,this.legendElement.type,this.messages))}};(0,s._)([(0,a.MZ)()],K.prototype,"effectList",void 0),(0,s._)([(0,a.MZ)()],K.prototype,"legendElement",void 0),(0,s._)([(0,a.MZ)()],K.prototype,"messages",void 0),(0,s._)([(0,a.MZ)()],K.prototype,"opacity",void 0),K=(0,s._)([(0,n.$)("esri.widgets.Legend.styles.card.ColorRamp")],K);const M=K;var k=i(16804);const R=window.devicePixelRatio;let x=class extends o.default{constructor(e,t){super(e,t),this.hasIndicators=!1,this.legendElement=null,this.opacity=1}render(){const{legendElement:e,hasIndicators:t,opacity:i}=this,s=e.infos,{label:r,...a}=s.at(0),{label:l,...n}=s.at(-1);let o=a.preview,d=n.preview;const c={"flex-direction":t?"column":"row-reverse"};o&&(o=o.cloneNode(!0),o.style.display="flex"),d&&(d=d.cloneNode(!0),d.style.display="flex");const y={opacity:null!=i?`${i}`:""};return(0,E.K)("div",{class:this.classes(h.layerRow,{[h.sizeRampRow]:t})},(0,E.K)("div",{class:h.rampLabel},t?r:l),(0,E.K)("div",{class:h.sizeRampContainer,styles:c},(0,E.K)("div",{afterCreate:L,bind:o,class:h.sizeRampPreview,styles:y}),this._renderSizeRampLines(e),(0,E.K)("div",{afterCreate:L,bind:d,class:h.sizeRampContainer,styles:y})),(0,E.K)("div",{class:h.rampLabel},t?l:r))}_renderSizeRampLines(e){const t=e.infos,i=t[0],s=t.at(-1),r=i.symbol,a=this.hasIndicators,l=(0,k.Lz)(i.size+i.outlineSize)*R,n=(0,k.Lz)(s.size+s.outlineSize)*R,o=a?l:l+50*R,d=a?l/2+50*R:l,c=function(e){if(e){if(e.type.includes("3d")){if(!e.symbolLayers?.length)return;const t=e.symbolLayers.at(-1),i=t?.resource?.primitive;return"triangle"===i||"cone"===i||"tetrahedron"===i}return"triangle"===e.style}}(r),y=function(e){if(!e)return;if(e.type.includes("3d")){if(!e.symbolLayers?.length)return;const t=e.symbolLayers.at(-1),i=t.resource?.primitive;return"circle"===i||"cross"===i||"kite"===i||"sphere"===i||"cube"===i||"diamond"===i}const t=e.style;return"circle"===t||"diamond"===t||"cross"===t}(r),h=document.createElement("canvas");h.width=o,h.height=d,h.style.width=h.width/R+"px",h.style.height=h.height/R+"px";const p=h.getContext("2d");if(a){p.beginPath();const e=0,t=0,i=o/2-n/2,s=d;p.moveTo(e,t),p.lineTo(i,s);const r=o,a=0,l=o/2+n/2,c=d;p.moveTo(r,a),p.lineTo(l,c)}else{p.beginPath();const e=0,t=d/2-n/2,i=o,s=0;p.moveTo(e,t),p.lineTo(i,s);const r=0,a=d/2+n/2,l=o,c=d;p.moveTo(r,a),p.lineTo(l,c)}return p.strokeStyle="#ddd",p.stroke(),(0,E.K)("div",{afterCreate:L,bind:h,styles:a?{display:"flex",marginTop:`-${c?0:y?l/2:0}px`,marginBottom:`-${c?n:y?n/2:0}px`}:{display:"flex",marginRight:`-${c?0:y?l/2:0}px`,marginLeft:`-${c?0:y?n/2:0}px`}})}};(0,s._)([(0,a.MZ)()],x.prototype,"hasIndicators",void 0),(0,s._)([(0,a.MZ)()],x.prototype,"legendElement",void 0),(0,s._)([(0,a.MZ)()],x.prototype,"messages",void 0),(0,s._)([(0,a.MZ)()],x.prototype,"opacity",void 0),x=(0,s._)([(0,n.$)("esri.widgets.Legend.styles.card.SizeRamp")],x);const V=x;i(63860);var z=i(62053),Z=i(26286);const A=(0,z.F)(),S="esri-univariate-above-and-below-ramp__symbol",B="esri-legend__color-ramp";function D(){const e="stroke:rgb(200, 200, 200);stroke-width:1";return"vertical"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"vertical")?(0,E.K)("svg",{height:"4",width:"10"},(0,E.K)("line",{style:e,x1:"0",x2:"10",y1:"2",y2:"2"})):(0,E.K)("svg",{height:"10",width:"10"},(0,E.K)("line",{style:e,x1:"5",x2:"5",y1:"0",y2:"10"}))}function T(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"vertical";const i=document.createElement("div");return i.style.height="20px",i.className=S,null!=e&&(i.style.opacity=e.toString()),A.append(i,D.bind(null,t)),i}function H(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"vertical",s=arguments.length>3?arguments[3]:void 0;e.infos.forEach(((e,r)=>{if(s&&2===r)e.preview=T(t,i);else{const t=(0,k.Lz)(e.size)+("horizontal"===i?20:10),s=e.preview,r="div"===s?.tagName.toLowerCase(),a=r?s:document.createElement("div");a.className=S,"horizontal"===i?a.style.width=`${t}px`:a.style.height=`${t}px`,!r&&s&&a.appendChild(s),e.preview=a}}))}function F(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"classic";const i=e.infos;return"classic"===t?((0,k.Lz)(i[0].size)+10)/2:((0,k.Lz)(i[0].size)-(0,k.Lz)(i[i.length-1].size))/2}function N(e,t){if(!e)return null;const i=e.infos.map((e=>e.color)),s=(0,Z.renderColorRampPreviewHTML)("full"===t.type?i:"above"===t.type?i.slice(0,3):i.slice(2,5),{width:t.width,height:t.height,align:t.rampAlignment,effectList:t.effectList,ariaLabel:t.ariaLabel});return s.className=B,null!=t.opacity&&(s.style.opacity=t.opacity.toString()),s}function P(e,t,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"vertical",r=0;const a=e.infos,l=Math.floor(a.length/2),n="full"===t||"above"===t?0:l,o="full"===t||"below"===t?a.length-1:l;for(let d=n;d<=o;d++)r+=i&&d===l?"horizontal"===s?10:20:(0,k.Lz)(a[d].size)+("horizontal"===s?20:10);return Math.round(r)}function O(e,t,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"vertical";const r=P(e,t,i,s),a=e.infos,l=Math.floor(a.length/2),n="full"===t||"above"===t?0:l,o="full"===t||"below"===t?a.length-1:l,d="full"===t?a[n].size+a[o].size:"above"===t?a[n].size:a[o].size,c=i?"vertical"===s?20:10:0,y="vertical"===s?10*("full"===t?2:1):20*("full"===t?2:1);return Math.round(r-((0,k.Lz)(d)/2+c/2+y/2))}function G(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"vertical";const s=e.infos;let r=s.find((e=>{let{type:t}=e;return"size-ramp"===t})),a=s.find((e=>{let{type:t}=e;return"color-ramp"===t}));return r&&(r={...r},r.infos=[...r.infos],H(r,t,i,!0)),a&&(a={...a},a.infos=[...a.infos]),"horizontal"===i&&(r?.infos.reverse(),a?.infos.reverse()),{sizeRampElement:r,colorRampElement:a}}function W(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"vertical";const i=e.infos;let s=i.find((e=>{let{type:t}=e;return"size-ramp"===t})),r=i.find((e=>{let{type:t}=e;return"color-ramp"===t}));return s&&(s={...s},s.infos=[...s.infos],H(s,null,t,!1)),r&&(r={...r},r.infos=[...r.infos]),"horizontal"===t&&(s?.infos.reverse(),r?.infos.reverse()),{sizeRampElement:s,colorRampElement:r}}const U={marginLeft:"3px"},j={display:"table-cell",verticalAlign:"middle"},q={display:"flex",alignItems:"flex-start"};let J=class extends o.default{constructor(e,t){super(e,t),this.effectList=null,this.legendElement=null,this.opacity=1}render(){const{legendElement:e,opacity:t,effectList:i,key:s}=this,{sizeRampElement:r,colorRampElement:a}=G(e,t,"horizontal");if(!r)return null;const l=P(r,"full",!0,"horizontal"),n=O(r,"above",!0,"horizontal"),o=O(r,"below",!0,"horizontal"),d=this.messages?.previewColorRampAriaLabel,c=N(a,{width:n,height:12,rampAlignment:"horizontal",opacity:t,type:"above",effectList:i,ariaLabel:d}),y=N(a,{width:o,height:12,rampAlignment:"horizontal",opacity:t,type:"below",effectList:i,ariaLabel:d}),p=F(r,"card"),m=r.infos.map((e=>e.label)),u=m.length-1,v=m.map(((e,t)=>0===t||t===u?(0,E.K)("div",{key:t},e):null)),f={marginTop:"3px",display:"flex"};(0,$.V8)(this.container)?f.marginRight=`${p}px`:f.marginLeft=`${p}px`;const g={width:`${l}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return(0,E.K)("div",{class:h.layerRow,key:`${s}-container`,styles:{display:"flex",flexDirection:"column"}},(0,E.K)("div",{class:this.classes(h.symbolContainer,h.sizeRampHorizontal),styles:{display:"flex",flexDirection:"row"}},r.infos.map(((e,t)=>(0,E.K)("div",{afterCreate:L,bind:e.preview,class:h.symbol,key:t})))),c?(0,E.K)("div",{class:h.univariateAboveAndBelowColorRamp,key:"color-ramp-preview",styles:f},(0,E.K)("div",{afterCreate:L,bind:c}),(0,E.K)("div",{afterCreate:L,bind:y})):null,(0,E.K)("div",{class:h.layerInfo},(0,E.K)("div",{class:h.rampLabelsContainer,styles:g},v)))}};(0,s._)([(0,a.MZ)()],J.prototype,"effectList",void 0),(0,s._)([(0,a.MZ)()],J.prototype,"legendElement",void 0),(0,s._)([(0,a.MZ)()],J.prototype,"messages",void 0),(0,s._)([(0,a.MZ)()],J.prototype,"opacity",void 0),J=(0,s._)([(0,n.$)("esri.widgets.Legend.styles.card.UnivariateAboveAndBelowRamp")],J);const Q=J;let X=class extends o.default{constructor(e,t){super(e,t),this.effectList=null,this.legendElement=null,this.opacity=1}render(){const{legendElement:e,opacity:t,effectList:i,key:s}=this,{sizeRampElement:r,colorRampElement:a}=W(e,"horizontal");if(!r)return null;const l=P(r,"full",!1,"horizontal"),n=N(a,{width:O(r,"full",!1,"horizontal"),height:12,rampAlignment:"horizontal",opacity:t,type:"full",effectList:i,ariaLabel:this.messages?.previewColorRampAriaLabel}),o=F(r,"card"),d=r.infos.length-1,c=r.infos.map(((e,t)=>0===t||t===d?(0,E.K)("div",{key:t},e.label):null)),y={marginTop:"3px",display:"flex"};(0,$.V8)(this.container)?y.marginRight=`${o}px`:y.marginLeft=`${o}px`;const p={width:`${l}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return(0,E.K)("div",{class:h.layerRow,key:`${s}-container`,styles:{display:"flex",flexDirection:"column"}},(0,E.K)("div",{class:this.classes(h.symbolContainer,h.sizeRampHorizontal),styles:{display:"flex",flexDirection:"row"}},r.infos.map(((e,t)=>(0,E.K)("div",{afterCreate:L,bind:e.preview,class:h.symbol,key:t})))),(0,E.K)("div",{class:h.univariateAboveAndBelowColorRamp,key:"color-ramp-preview",styles:y},(0,E.K)("div",{afterCreate:L,bind:n})),(0,E.K)("div",{class:h.layerInfo},(0,E.K)("div",{class:h.rampLabelsContainer,styles:p},c)))}};(0,s._)([(0,a.MZ)()],X.prototype,"effectList",void 0),(0,s._)([(0,a.MZ)()],X.prototype,"legendElement",void 0),(0,s._)([(0,a.MZ)()],X.prototype,"messages",void 0),(0,s._)([(0,a.MZ)()],X.prototype,"opacity",void 0),X=(0,s._)([(0,n.$)("esri.widgets.Legend.styles.card.UnivariateColorSizeRamp")],X);const Y=X;var ee,te=i(18111),ie=i(9137);let se=ee=class extends o.default{constructor(e,t){super(e,t),this.effectList=null,this.hasIndicators=!1,this.headingLevel=3,this.isChild=!1,this.legendElement=null}render(){const e=this._renderLegendElement(),t=C(this.legendElement,this.messages),i=this.hasIndicators&&!this.isChild?(0,E.K)("div",null,(0,E.K)(ie.D,{class:h.carouselTitle,level:this.headingLevel},this.activeLayerInfo.title),(0,E.K)(ie.D,{class:h.layerCaption,level:(0,ie.S)(this.headingLevel)},t)):t?(0,E.K)(ie.D,{class:h.layerCaption,level:this.headingLevel},t):null;return(0,E.K)("section",{"aria-labelledby":this.key,class:h.section,id:`${this.key}-panel`,key:this.key,role:"tabpanel",tabIndex:0},i,e)}_renderLegendElement(){switch(this.legendElement.type){case"symbol-table":return this._renderSymbolTable(this.legendElement);case"size-ramp":return(0,E.K)(V,{hasIndicators:this.hasIndicators,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});case"color-ramp":case"opacity-ramp":case"heatmap-ramp":case"stretch-ramp":return(0,E.K)(M,{effectList:this.effectList,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});case"relationship-ramp":return(0,te.p)(this.legendElement,this.id,{opacity:this.layer.opacity,effectList:this.effectList,ariaLabel:this.messages.previewRelationshipRampAriaLabel,key:this.key});case"pie-chart-ramp":return(0,E.K)("div",{afterCreate:L,bind:this.legendElement.preview,class:h.pieChartRampPreview,key:`${this.key}-preview`});case"univariate-above-and-below-ramp":return(0,E.K)(Q,{effectList:this.effectList,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});case"univariate-color-size-ramp":return(0,E.K)(Y,{effectList:this.effectList,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});default:return null}}_renderSymbolTable(e){const t=e.infos.map((t=>this._renderElementInfo(t,e.legendType))).filter(Boolean);if(!t.length)return null;const i=this.activeLayerInfo.legendElements.some((e=>{let{type:t}=e;return"relationship-ramp"===t})),s=t[0]?.properties?.classes?.[h.symbolRow],r={[h.labelContainer]:!s&&!i,[h.relationshipLabelContainer]:i};return(0,E.K)("div",{class:this.classes(r)},t)}_renderElementInfo(e,t){const{layer:i}=this,s="label"in e?e.label:null,r=`${this.key}-${s}`;if("type"in e&&e.type)return(0,E.K)(ee,{activeLayerInfo:this.activeLayerInfo,effectList:this.effectList,hasIndicators:this.hasIndicators,headingLevel:this.headingLevel,isChild:!0,key:r,layer:i,legendElement:e,messages:this.messages});if(!("preview"in e&&e.preview||"src"in e&&e.src))return null;const a=b(i,t),l=_(this.messages,s,!1)||"";if("src"in e&&e.src)return(0,E.K)("div",{class:h.layerRow,key:`${r}-row`},this._renderImage(e,i,a),(0,E.K)("div",{class:h.imageLabel},l));if("symbol"in e&&e.preview){if(!e.symbol?.type.includes("simple-fill")){if(!e.label)return(0,E.K)("div",{afterCreate:L,bind:e.preview,key:`${r}-row`});const t={[h.symbolCell]:this.hasIndicators};return(0,E.K)("div",{class:this.classes(h.layerRow,{[h.symbolRow]:this.hasIndicators}),key:`${r}-row`},(0,E.K)("div",{afterCreate:L,bind:e.preview,class:this.classes(t)}),(0,E.K)("div",{class:this.classes(h.imageLabel,{[h.labelCell]:this.hasIndicators})},l))}return(0,E.K)("div",{class:h.layerRow,key:`${r}-row`},(0,E.K)("div",{class:h.labelElement,styles:this._getBackgroundStyles(e)},l))}return null}_getBackgroundStyles(e){const t=e.symbol,i=t.color,s=!!i?.a,r="outline"in t?t.outline:null,a=!!r?.color?.a,l=new p.default(s&&i?[i.r,i.g,i.b,i.a*this.layer.opacity]:[255,255,255,0]),n=a&&r.color?new p.default([r.color.r,r.color.g,r.color.b,r.color.a*this.layer.opacity]):new p.default([255,255,255,0]),o=e.symbol.color?.isBright??!0,d=o?"black":"white",c=o?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)";return{background:s?l.toCss(!0):"none",color:d,textShadow:`-1px -1px 0 ${c},\n                  1px -1px 0 ${c},\n                  -1px 1px 0 ${c},\n                  1px 1px 0 ${c}`,border:a?`1px solid ${n.toCss(!0)}`:"none",filter:(0,m.di)(this.effectList)??void 0}}_renderImage(e,t,i){const{label:s,src:r,opacity:a}=e,l={[h.imageryLayerStretchedImage]:i,[h.symbol]:!i},n={opacity:`${a??t.opacity}`},o=_(this.messages,s,!1);return(0,E.K)("img",{alt:o,"aria-label":o,border:0,class:this.classes(l),height:e.height,src:r,styles:n,width:e.width})}};(0,s._)([(0,a.MZ)()],se.prototype,"activeLayerInfo",void 0),(0,s._)([(0,a.MZ)()],se.prototype,"effectList",void 0),(0,s._)([(0,a.MZ)()],se.prototype,"hasIndicators",void 0),(0,s._)([(0,a.MZ)()],se.prototype,"headingLevel",void 0),(0,s._)([(0,a.MZ)()],se.prototype,"isChild",void 0),(0,s._)([(0,a.MZ)()],se.prototype,"layer",void 0),(0,s._)([(0,a.MZ)()],se.prototype,"legendElement",void 0),(0,s._)([(0,a.MZ)()],se.prototype,"messages",void 0),se=ee=(0,s._)([(0,n.$)("esri.widgets.Legend.styles.card.LegendElement")],se);const re=se;var ae=i(49403),le=i(76697);let ne=class extends o.default{constructor(e,t){super(e,t),this._hasIndicators=!1,this.activeLayerInfos=null,this.headingLevel=3,this.layout="stack",this.messages=null,this.messagesCommon=null,this.type="card",this.view=null}loadDependencies(){return(0,ae.W)({carousel:()=>i.e(90034).then(i.bind(i,90034)),"carousel-item":()=>i.e(19476).then(i.bind(i,19476))})}render(){this._hasIndicators="auto"===this.layout&&this.view&&this.view.container.clientWidth<=768||"stack"===this.layout;const e=this._hasIndicators?this._renderCarousel():this._renderLayers(),t={[h.stacked]:this._hasIndicators};return(0,E.K)("div",{class:this.classes(h.base,t)},e||(0,E.K)("div",{class:h.message},this.messages.noLegend))}_renderCarousel(){const e=[],t=this.activeLayerInfos;if(t)for(const i of t)this._renderSections(i,e);return e?.length?(0,E.K)("calcite-carousel",{class:h.carousel,label:this.messages.carousel},e.map(((t,i)=>(0,E.K)("calcite-carousel-item",{class:h.carouselItem,key:i,label:(0,f.V)(this.messagesCommon.pagination.pageText,{index:i+1,total:e.length})},t)))):null}_renderLayers(){const e=this.activeLayerInfos,t=e?.toArray()?.map((e=>this._renderLegendForLayer(e))).filter(Boolean);return t?.length?t:null}_renderLegendForLayer(e){if(!e.ready)return null;if(e.children.length){const t=e.children.toArray().map(this._renderLegendForLayer,this);return(0,E.K)("section",{class:this.classes(h.service,h.groupLayer),key:e.layer.uid},(0,E.K)("div",{class:h.serviceCaptionContainer},e.title),t)}return this._renderLegendElementsForLayer(e)}_renderLegendElementsForLayer(e){const t=e.legendElements?.filter(Boolean);if(!t?.length)return null;const i=t.map((t=>(0,E.K)(re,{activeLayerInfo:e,effectList:e.effectList,hasIndicators:this._hasIndicators,headingLevel:this.headingLevel,isChild:!1,key:`${e.layer.uid}-${t.type}`,layer:e.layer,legendElement:t,messages:this.messages}))),s={[h.groupLayerChild]:!!e.parent};return(0,E.K)("section",{class:this.classes(h.service,s),key:e.layer.uid},(0,E.K)("div",{class:h.serviceCaptionContainer},(0,E.K)("div",{class:h.serviceCaptionText},e.title)),(0,E.K)("div",{class:h.serviceContent},i))}_renderSections(e,t){if(!e.ready)return;if(e.children.length)for(const s of e.children)this._renderSections(s,t);const i=e.legendElements;if(i?.length)for(const s of i){const i=(0,E.K)(re,{activeLayerInfo:e,effectList:e.effectList,hasIndicators:this._hasIndicators,headingLevel:this.headingLevel,isChild:!1,key:`${e.layer.uid}-${s.type}`,layer:e.layer,legendElement:s,messages:this.messages});i&&t.push(i)}}};(0,s._)([(0,a.MZ)()],ne.prototype,"activeLayerInfos",void 0),(0,s._)([(0,a.MZ)()],ne.prototype,"headingLevel",void 0),(0,s._)([(0,a.MZ)()],ne.prototype,"layout",void 0),(0,s._)([(0,a.MZ)(),(0,le.G)("esri/widgets/Legend/t9n/Legend")],ne.prototype,"messages",void 0),(0,s._)([(0,a.MZ)(),(0,le.G)("esri/t9n/common")],ne.prototype,"messagesCommon",void 0),(0,s._)([(0,a.MZ)({readOnly:!0})],ne.prototype,"type",void 0),(0,s._)([(0,a.MZ)()],ne.prototype,"view",void 0),ne=(0,s._)([(0,n.$)("esri.widgets.Legend.styles.card.CardView")],ne);const oe=ne,de="esri-legend",ce={service:`${de}__service`,label:`${de}__service-label`,layer:`${de}__layer`,groupLayer:`${de}__group-layer`,groupLayerChild:`${de}__group-layer-child`,layerTable:`${de}__layer-table`,layerTableSizeRamp:`${de}__layer-table--size-ramp`,layerChildTable:`${de}__layer-child-table`,layerCaption:`${de}__layer-caption`,layerBody:`${de}__layer-body`,layerRow:`${de}__layer-row`,layerCell:`${de}__layer-cell`,layerInfo:`${de}__layer-cell ${de}__layer-cell--info`,imageryLayerStretchedImage:`${de}__imagery-layer-image--stretched`,imageryLayerCellStretched:`${de}__imagery-layer-cell--stretched`,imageryLayerInfoStretched:`${de}__imagery-layer-info--stretched`,symbolContainer:`${de}__layer-cell ${de}__layer-cell--symbols`,symbol:`${de}__symbol`,rampContainer:`${de}__ramps`,sizeRamp:`${de}__size-ramp`,colorRamp:`${de}__color-ramp`,opacityRamp:`${de}__opacity-ramp`,borderlessRamp:`${de}__borderless-ramp`,rampTick:`${de}__ramp-tick`,rampFirstTick:`${de}__ramp-tick-first`,rampLastTick:`${de}__ramp-tick-last`,rampLabelsContainer:`${de}__ramp-labels`,rampLabel:`${de}__ramp-label`,message:`${de}__message`,univariateAboveAndBelowLabel:"esri-univariate-above-and-below-ramp__label"};let ye=class extends o.default{constructor(e,t){super(e,t),this.legendElement=null,this.opacity=1}get _preview(){const e=this.legendElement.preview;if(!e)return null;const t="opacity-ramp"===this.legendElement.type?ce.opacityRamp:"";return e.className=`${ce.colorRamp} ${t}`,null!=this.opacity&&(e.style.opacity=this.opacity.toString()),e}render(){const{legendElement:e,_preview:t}=this;if(!t)return null;const i={width:"24px"},s={height:t.style.height};return(0,E.K)("div",{class:ce.layerRow,key:`${this.key}-row`},(0,E.K)("div",{class:ce.symbolContainer,styles:i},(0,E.K)("div",{afterCreate:L,bind:t,class:ce.rampContainer})),(0,E.K)("div",{class:ce.layerInfo},(0,E.K)("div",{class:ce.rampLabelsContainer,styles:s},e.infos.map(((t,i)=>this._renderRampLabel(t,i,e.type))))))}_renderRampLabel(e,t,i){return(0,E.K)("div",{class:e.label?ce.rampLabel:void 0,key:`${this.key}-stop-${e.label??t}-label`},I(e,i,this.messages))}};(0,s._)([(0,a.MZ)()],ye.prototype,"_preview",null),(0,s._)([(0,a.MZ)()],ye.prototype,"legendElement",void 0),(0,s._)([(0,a.MZ)()],ye.prototype,"messages",void 0),(0,s._)([(0,a.MZ)()],ye.prototype,"opacity",void 0),ye=(0,s._)([(0,n.$)("esri.widgets.Legend.styles.classic.ColorRamp")],ye);const he=ye;let pe=class extends o.default{constructor(e,t){super(e,t),this.legendElement=null}render(){const e=this.legendElement.infos.map((e=>this._renderRow(e))).filter(Boolean);return e.length?(0,E.K)("div",{class:ce.layerBody},e):null}_renderRow(e){return e.preview?(0,E.K)("div",{class:ce.layerRow,key:`${this.key}-${e.label}-row`},(0,E.K)("div",{class:this.classes(ce.symbolContainer,ce.sizeRamp)},(0,E.K)("div",{afterCreate:L,bind:e.preview,class:ce.symbol})),(0,E.K)("div",{class:ce.layerInfo},_(this.messages,e.label,!1)||"")):null}};(0,s._)([(0,a.MZ)()],pe.prototype,"legendElement",void 0),(0,s._)([(0,a.MZ)()],pe.prototype,"messages",void 0),pe=(0,s._)([(0,n.$)("esri.widgets.Legend.styles.classic.SizeRamp")],pe);const me=pe;let ue=class extends o.default{constructor(e,t){super(e,t),this.effectList=null,this.legendElement=null,this.opacity=1}render(){const{legendElement:e,opacity:t,effectList:i,key:s}=this,{sizeRampElement:r,colorRampElement:a}=G(e,t);if(!r)return null;const l=this.messages.previewColorRampAriaLabel,n=O(r,"above",!0),o=O(r,"below",!0),d=N(a,{width:12,height:n,rampAlignment:"vertical",opacity:t,type:"above",effectList:i,ariaLabel:l}),c=N(a,{width:12,height:o,rampAlignment:"vertical",opacity:t,type:"below",effectList:i,ariaLabel:l}),y=F(r),h=r.infos.map((e=>e.label)),p=h.map(((e,t)=>{const i=2===t;return 0===t?(0,E.K)("div",{class:e?d?ce.univariateAboveAndBelowLabel:ce.rampLabel:void 0,key:`${s}-color-ramp-above-label-${e??t}`},e):i?(0,E.K)("div",null):null})),m=h.length-1,u=Math.floor(h.length/2),v=h.map(((e,t)=>t===u||t===m?(0,E.K)("div",{class:e?d?ce.univariateAboveAndBelowLabel:ce.rampLabel:void 0,key:`${s}-color-ramp-below-label-${e??t}`},e):null)),f={display:"table-cell",verticalAlign:"middle"},g={marginTop:`${y}px`},_={height:`${n}px`},w={height:`${o}px`};return(0,E.K)("div",{key:`${s}-container`,styles:q},(0,E.K)("div",{class:ce.layerBody},r.infos.map(((e,t)=>(0,E.K)("div",{class:this.classes(ce.layerRow,ce.sizeRamp),key:`${s}-row-${t}`},(0,E.K)("div",{afterCreate:L,bind:e.preview,class:ce.symbol,styles:f}),d||t%2!=0?null:(0,E.K)("div",{class:ce.layerInfo},h[t]))))),d?(0,E.K)("div",{styles:g},(0,E.K)("div",{styles:U},(0,E.K)("div",{styles:j},(0,E.K)("div",{afterCreate:L,bind:d,class:ce.rampContainer})),(0,E.K)("div",{styles:j},(0,E.K)("div",{class:ce.rampLabelsContainer,styles:_},p))),(0,E.K)("div",{styles:U},(0,E.K)("div",{styles:j},(0,E.K)("div",{afterCreate:L,bind:c,class:ce.rampContainer})),(0,E.K)("div",{styles:j},(0,E.K)("div",{class:ce.rampLabelsContainer,styles:w},v)))):null)}};(0,s._)([(0,a.MZ)()],ue.prototype,"effectList",void 0),(0,s._)([(0,a.MZ)()],ue.prototype,"legendElement",void 0),(0,s._)([(0,a.MZ)()],ue.prototype,"messages",void 0),(0,s._)([(0,a.MZ)()],ue.prototype,"opacity",void 0),ue=(0,s._)([(0,n.$)("esri.widgets.Legend.styles.classic.UnivariateAboveAndBelowRamp")],ue);const ve=ue;let fe=class extends o.default{constructor(e,t){super(e,t),this.effectList=null,this.legendElement=null,this.opacity=1}render(){const{legendElement:e,opacity:t,effectList:i,key:s}=this,{sizeRampElement:r,colorRampElement:a}=W(e);if(!r)return null;const l=F(r),n=O(r,"full",!1),o=N(a,{width:12,height:n,rampAlignment:"vertical",opacity:t,type:"full",effectList:i,ariaLabel:this.messages?.previewColorRampAriaLabel}),d=r.infos.length-1,c=r.infos.map(((e,t)=>0===t||t===d?(0,E.K)("div",{class:e.label?a?ce.univariateAboveAndBelowLabel:ce.rampLabel:void 0,key:`${s}-color-ramp-label-${e.label??t}`},e.label):null)),y={display:"table-cell",verticalAlign:"middle"},h={marginTop:`${l}px`},p={height:`${n}px`};return(0,E.K)("div",{key:`${s}-container`,styles:q},(0,E.K)("div",{class:ce.layerBody},r.infos.map(((e,t)=>(0,E.K)("div",{class:this.classes(ce.layerRow,ce.sizeRamp),key:`${s}-row-${t}`},(0,E.K)("div",{afterCreate:L,bind:e.preview,class:ce.symbol,styles:y}))))),(0,E.K)("div",{styles:h},(0,E.K)("div",{styles:U},(0,E.K)("div",{styles:j},(0,E.K)("div",{afterCreate:L,bind:o,class:ce.rampContainer})),(0,E.K)("div",{styles:j},(0,E.K)("div",{class:ce.rampLabelsContainer,styles:p},c)))))}};(0,s._)([(0,a.MZ)()],fe.prototype,"effectList",void 0),(0,s._)([(0,a.MZ)()],fe.prototype,"legendElement",void 0),(0,s._)([(0,a.MZ)()],fe.prototype,"messages",void 0),(0,s._)([(0,a.MZ)()],fe.prototype,"opacity",void 0),fe=(0,s._)([(0,n.$)("esri.widgets.Legend.styles.classic.UnivariateColorSizeRamp")],fe);const ge=fe;var Le;let _e=Le=class extends o.default{constructor(e,t){super(e,t),this.effectList=null,this.isChild=!1,this.legendElement=null}render(){const e=this._renderLegendElement(),t=C(this.legendElement,this.messages),i=this.isChild?ce.layerChildTable:ce.layerTable,s=t?(0,E.K)("div",{class:ce.layerCaption},t):null,r={[ce.layerTableSizeRamp]:"size-ramp"===this.legendElement.type||!this.isChild};return(0,E.K)("section",{class:this.classes(i,r),key:`${this.key}-table`},s,e)}_renderLegendElement(){switch(this.legendElement.type){case"symbol-table":return this._renderSymbolTable(this.legendElement);case"size-ramp":return(0,E.K)(me,{key:this.key,legendElement:this.legendElement,messages:this.messages});case"color-ramp":case"opacity-ramp":case"heatmap-ramp":case"stretch-ramp":return(0,E.K)(he,{key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});case"relationship-ramp":return(0,te.p)(this.legendElement,this.id,{opacity:this.layer.opacity,effectList:this.effectList,ariaLabel:this.messages.previewRelationshipRampAriaLabel,key:this.key});case"pie-chart-ramp":return(0,E.K)("div",{afterCreate:L,bind:this.legendElement.preview,key:`${this.key}-preview`});case"univariate-above-and-below-ramp":return(0,E.K)(ve,{effectList:this.effectList,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});case"univariate-color-size-ramp":return(0,E.K)(ge,{effectList:this.effectList,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});default:return null}}_renderSymbolTable(e){const t=e.infos.map((t=>this._renderElementInfo(t,e.legendType))).filter(Boolean);return t.length?(0,E.K)("div",{class:ce.layerBody},t):null}_renderElementInfo(e,t){const{layer:i}=this,s="label"in e?e.label:null,r=`${this.key}-${s}`;if("type"in e&&e.type)return(0,E.K)(Le,{effectList:this.effectList,isChild:!0,key:r,layer:i,legendElement:e,messages:this.messages});if(!("preview"in e&&e.preview||"src"in e&&e.src))return null;const a=b(i,t),l={[ce.imageryLayerInfoStretched]:a},n={[ce.imageryLayerInfoStretched]:a};return(0,E.K)("div",{class:ce.layerRow,key:`${r}-row`},(0,E.K)("div",{class:this.classes(ce.symbolContainer,n)},this._renderPreview(e,a)),(0,E.K)("div",{class:this.classes(ce.layerInfo,l)},_(this.messages,s,!1)||""))}_renderPreview(e,t){const{layer:i}=this;return"preview"in e&&e.preview?(0,E.K)("div",{afterCreate:L,bind:e.preview,class:ce.symbol}):"src"in e&&e.src?this._renderImage(e,i,t):null}_renderImage(e,t,i){const{label:s,src:r,opacity:a}=e,l={[ce.imageryLayerStretchedImage]:i,[ce.symbol]:!i},n={opacity:`${a??t.opacity}`},o=_(this.messages,s,!1);return(0,E.K)("img",{alt:o,"aria-label":o,border:0,class:this.classes(l),height:e.height,src:r,styles:n,width:e.width})}};(0,s._)([(0,a.MZ)()],_e.prototype,"effectList",void 0),(0,s._)([(0,a.MZ)()],_e.prototype,"isChild",void 0),(0,s._)([(0,a.MZ)()],_e.prototype,"layer",void 0),(0,s._)([(0,a.MZ)()],_e.prototype,"legendElement",void 0),(0,s._)([(0,a.MZ)()],_e.prototype,"messages",void 0),_e=Le=(0,s._)([(0,n.$)("esri.widgets.Legend.styles.classic.LegendElement")],_e);const we=_e;var be=i(50821);const Ie=`${de}__`;let Ce=class extends o.default{constructor(e,t){super(e,t),this.activeLayerInfos=null,this.headingLevel=3,this.messages=null,this.type="classic"}render(){const e=this.activeLayerInfos,t=e?.toArray().map((e=>this._renderLegendForLayer(e))).filter(Boolean);return t?.length?(0,E.K)("section",null,t):(0,E.K)("div",{class:ce.message,key:"no-legend"},this.messages.noLegend)}_renderLegendForLayer(e,t){if(!e.ready)return null;const i=`${e.layer.uid}-version-${e.version}`,s=`${Ie}${t?`${t}-`:""}${i}`,r=e.title?(0,ie.D)({level:this.headingLevel,class:this.classes(be.D.heading,ce.label)},e.title):null;if(e.children.length){const t=e.children.toArray().map((e=>this._renderLegendForLayer(e,i)));return(0,E.K)("section",{class:this.classes(ce.service,ce.groupLayer),key:s},r,t)}return this._renderLegendElementsForLayer(e,r,s)}_renderLegendElementsForLayer(e,t,i){const s=e.legendElements?.filter(Boolean);if(!s?.length)return null;const r=s.map((t=>(0,E.K)(we,{effectList:e.effectList,isChild:!1,key:`${i}-${t.type}`,layer:e.layer,legendElement:t,messages:this.messages}))),a={[ce.groupLayerChild]:!!e.parent};return(0,E.K)("section",{class:this.classes(ce.service,a),key:i},t,(0,E.K)("div",{class:ce.layer},r))}};(0,s._)([(0,a.MZ)()],Ce.prototype,"activeLayerInfos",void 0),(0,s._)([(0,a.MZ)()],Ce.prototype,"headingLevel",void 0),(0,s._)([(0,a.MZ)(),(0,le.G)("esri/widgets/Legend/t9n/Legend")],Ce.prototype,"messages",void 0),(0,s._)([(0,a.MZ)({readOnly:!0})],Ce.prototype,"type",void 0),Ce=(0,s._)([(0,n.$)("esri.widgets.Legend.styles.classic.ClassicView")],Ce);const $e=Ce,Ee="esri-legend";let Ke=class extends o.default{constructor(e,t){super(e,t),this.headingLevel=3,this.messages=null,this.style=new $e,this.viewModel=new d.default}initialize(){this.addHandles([(0,r.on)((()=>this.view),"resize",(()=>this.scheduleRender())),(0,r.on)((()=>this.activeLayerInfos),"change",(()=>this._refreshActiveLayerInfos(this.activeLayerInfos))),(0,r.watch)((()=>this.headingLevel),(e=>{const{style:t}=this;t&&(t.headingLevel=e)})),(0,r.watch)((()=>this.style),((e,t)=>{t&&e!==t&&t.destroy(),e&&(e.activeLayerInfos=this.activeLayerInfos,"card"===e.type&&(e.view=this.view),e.headingLevel=this.headingLevel)}),r.initial)])}get activeLayerInfos(){return this.viewModel.activeLayerInfos}set activeLayerInfos(e){this.viewModel.activeLayerInfos=e}get basemapLegendVisible(){return this.viewModel.basemapLegendVisible}set basemapLegendVisible(e){this.viewModel.basemapLegendVisible=e}get groundLegendVisible(){return this.viewModel.groundLegendVisible}set groundLegendVisible(e){this.viewModel.groundLegendVisible=e}get hideLayersNotInCurrentView(){return this.viewModel.hideLayersNotInCurrentView}set hideLayersNotInCurrentView(e){this.viewModel.hideLayersNotInCurrentView=e}get keepCacheOnDestroy(){return this.viewModel.keepCacheOnDestroy}set keepCacheOnDestroy(e){this.viewModel.keepCacheOnDestroy=e}get respectLayerDefinitionExpression(){return this.viewModel.respectLayerDefinitionExpression}set respectLayerDefinitionExpression(e){this.viewModel.respectLayerDefinitionExpression=e}get respectLayerVisibility(){return this.viewModel.respectLayerVisibility}set respectLayerVisibility(e){this.viewModel.respectLayerVisibility=e}get icon(){return"legend"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get layerInfos(){return this.viewModel.layerInfos}set layerInfos(e){this.viewModel.layerInfos=e}castStyle(e){if(e instanceof oe||e instanceof $e)return e;if("string"==typeof e)return"card"===e?new oe:new $e;if(e&&"string"==typeof e.type){const t={...e};return delete t.type,"card"===e.type?new oe(t):new $e(t)}return new $e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){return(0,E.K)("div",{class:this.classes(Ee,be.D.widget,this.style instanceof $e?be.D.panel:null)},this.style.render())}_refreshActiveLayerInfos(e){e.forEach((e=>{this.removeHandles(`version_${e.layer.uid}`),this._renderOnActiveLayerInfoChange(e)})),this.scheduleRender()}_renderOnActiveLayerInfoChange(e){const t=(0,r.watch)((()=>e.version),(()=>this.scheduleRender()));this.addHandles(t,`version_${e.layer.uid}`);const i=(0,r.on)((()=>e.children),"change",(()=>e.children.forEach((e=>this._renderOnActiveLayerInfoChange(e)))),r.initial);this.addHandles(i,`version_${e.layer.uid}`),e.children.forEach((e=>this._renderOnActiveLayerInfoChange(e)))}};(0,s._)([(0,a.MZ)()],Ke.prototype,"activeLayerInfos",null),(0,s._)([(0,a.MZ)()],Ke.prototype,"basemapLegendVisible",null),(0,s._)([(0,a.MZ)()],Ke.prototype,"groundLegendVisible",null),(0,s._)([(0,a.MZ)()],Ke.prototype,"headingLevel",void 0),(0,s._)([(0,a.MZ)()],Ke.prototype,"hideLayersNotInCurrentView",null),(0,s._)([(0,a.MZ)()],Ke.prototype,"keepCacheOnDestroy",null),(0,s._)([(0,a.MZ)()],Ke.prototype,"respectLayerDefinitionExpression",null),(0,s._)([(0,a.MZ)()],Ke.prototype,"respectLayerVisibility",null),(0,s._)([(0,a.MZ)()],Ke.prototype,"icon",null),(0,s._)([(0,a.MZ)()],Ke.prototype,"label",null),(0,s._)([(0,a.MZ)()],Ke.prototype,"layerInfos",null),(0,s._)([(0,a.MZ)(),(0,le.G)("esri/widgets/Legend/t9n/Legend")],Ke.prototype,"messages",void 0),(0,s._)([(0,a.MZ)()],Ke.prototype,"style",void 0),(0,s._)([(0,l.w)("style")],Ke.prototype,"castStyle",null),(0,s._)([(0,a.MZ)()],Ke.prototype,"view",null),(0,s._)([(0,a.MZ)()],Ke.prototype,"viewModel",void 0),Ke=(0,s._)([(0,n.$)("esri.widgets.Legend")],Ke);const Me=Ke}}]);